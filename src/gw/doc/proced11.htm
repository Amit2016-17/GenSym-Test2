<html><head><title>Remote Procedures</title></head>
<body bgcolor="#ffffff">
<a href="proced10.htm"><h5>| Prev </a> <a href="procedur.htm">| Start of Chapter </a> <a href="examples.htm">| Next Chapter </a> <a href="booktoc.htm">| Contents </a> <a href="bookix.htm">| Index |</a> (12 out of 12)</h5> <br>


<a name="3253">
<h1> gw-tender-resources 
</h1>
</a><a name="3254">
Configures a resource that G2 WebLink, acting as a server, can provide to an 
HTTP client. 
<p>
</a><a name="3255">
<h2> Synopsis </h2>
</a><ul><a name="3256">
<pre><code>gw-tender-resouces (</code><em>index</em><code>: integer, </code><em>pattern</em><code>: text, </code><em>response</em><code>: text) 
</code></pre>
</a><a name="3275">
<table border=4>
<tr><th align="left" valign="middle"><a name="3259">
<strong>Argument 
</strong>
</a><th align="left" valign="middle"><a name="3261">
<strong>Description 
</strong>
</a>
<tr><td valign="middle"><a name="3263">
<em>index 
</em><p>
</a><br><td valign="middle"><a name="3265">
A unique integer value that distinguishes 
this tender offer from all others. 
<p>
</a><a name="3266">
The range for valid index values is 0 - 1000, 
inclusive. 
<p>
</a><br>
<tr><td valign="middle"><a name="3268">
<em>pattern 
</em><p>
</a><br><td valign="middle"><a name="3270">
Matches a URL used to request a resource. 
<p>
</a><br>
<tr><td valign="middle"><a name="3272">
<em>response 
</em><p>
</a><br><td valign="middle"><a name="3274">
Specifies the action taken in G2 in response 
to the URL that matches <em>pattern</em>. 
<p>
</a><br>

</table>

<p></a></ul><a name="3276">
<h2> Description </h2>
</a><a name="3277">
<code>gw-tender-resources()</code> instructs the bridge how to respond to requests from HTTP 
clients for resources that G2 can provide. Each call to <code>gw-tender-resources()</code> 
defines a pattern that can match one or more of the URLs used by HTTP clients to 
request resources. 
<p>
</a><a name="3278">
When a URL used in a client request matches a tendered pattern, and G2 can 
provide a resource in response to that request, the resource is generated in a way 
specified by <code>gw-tender-resources()</code>. A resource can be generated by a user-
defined response procedure in G2, or it can be obtained from the file system. 
<p>
</a><a name="3279">
You must call <code>gw-tender-resources()</code> once for each class of resources that you 
want to make available to Internet clients. The bridge can respond to a request for 
a G2 resource only if that resource has been configured by a call to <code>gw-tender-
resources()</code>. 
<p>
</a><a name="3280">
<code>gw-tender-resources()</code> must be called <em>after</em> G2 has started the server by calling 
<a href="proced10.htm#3205">gw-start-http-server()</a>. 
<p>
</a><a name="3282">
Specifying an Index: The <em>index</em> argument makes it possible to distinguish 
patterns from each other. Using an <em>index </em>to distinguish patterns has the following 
advantages: 
<p>
</a><ul><a name="3283">
<li>If more than one pattern matches the same URL, the bridge responds to the URL by using the pattern with the lowest <em>index</em> value. 
<p></a><a name="3284">
<li>You can replace a pattern by tendering a different pattern at the same index. 
<p></a></ul><a name="3285">
<hr><strong>Note:</strong> Each <em>index</em> value must be unique. 
<hr>
</a><a name="3286">
Specifying a Pattern: The <em>pattern </em>argument must match part of the URL that 
requests the resource. For example, the following URL: 
<p>
</a><ul><a name=3287">
<pre>http://www.grsmithinc.com/news/homeoffice 
</pre>
</a></ul><a name="3288">
can be matched by any of the following <em>pattern </em>arguments: 
<p>
</a><ul><a name="3289">
<pre>"news" <br>
"news/home"<br>
"news/homeoffice" 
</pre>
</a></ul><a name="3290">
As this example shows, more than one <em>pattern</em> can match the same URL. 
<p>
</a><a name="3291">
An empty pattern ("") matches any URL. You can use an empty pattern to tender 
a resource for all requests that do not match any other tendered patterns. In this 
case, the call that specifies the empty pattern should also specify a higher index 
value than other calls, so that a request is matched to the empty pattern only after 
that request has failed to match any of the other patterns. 
<p>
</a><a name="3292">
Specifying a Response: The <em>response</em> string specifies how the bridge generates 
the resource. You can specify a response using <code>call</code> or <code>serve</code> formats: 
<p>
</a><ul><a name="3293">
<li>The <code>call</code> response formats are used to request dynamically computed resources from G2. These resources are generated by response procedures in G2. 
<p></a><a name="3294">
<li>The <code>serve</code> formats are used to request existing resources that G2 can provide without computation. These resources are obtained from the file system. 
<p></a></ul><a name="3295">
<strong>The </strong><code>call</code><strong> response format</strong>: This format specifies a user-defined G2 procedure that 
generates the requested resource. This procedure is known as a response procedure. You are responsible for providing this procedure in your G2 application. 
<p>
</a><a name="3297">
The response procedure is invoked by the bridge when the bridge receives an 
HTTP request that matches the pattern specified in the call to <code>gw-tender-
resources()</code>. As arguments to the G2 procedure, the bridge passes a set of 
attributes that it produces by analyzing the HTTP request. To get attributes from 
an HTTP request, the response procedure invokes the procedure <a href="procedu6.htm#2969">gw-get-attribute-
of-request()</a>. See the description of this procedure for information about the 
attributes in an HTTP request that can be returned by <code>gw-get-attribute-of-
request()</code>. 
<p>
</a><a name="3299">
The response procedure provides the requested resource by making calls to the 
procedures <code>gw-add-to-url-reply()</code> and <code>gw-finish-url-reply().</code> It can decline the 
request by making a single call to <code>gw-decline-to-serve-url()</code>. 
<p>
</a><a name="3300">
There are two <code>call</code> response formats: 
<p>
</a><ul><a name="3301">
<pre>call url <em>g2-function-name</em> (<em>arguments</em>...) 
</pre>
</a><a name="3302">
<pre>call cgi <em>g2-function-name</em> (<em>arguments</em>...) 
</pre>
</a></ul><a name="3303">
call url responds to a URL in any format. 
<p>
</a><a name="3304">
<code>call cgi</code><em> </em>responds to a URL formatted in conformance with the Common Gateway 
Interface (CGI) standard. The <code>call cgi</code> format notifies the bridge that the URL 
conforms to CGI standards. The bridge extracts arguments from the URL and 
makes them available as attributes of the request. 
<p>
</a><a name="3305">
<em>g2-function-name </em>is a user-defined response procedure that handles the request. 
The bridge calls the procedure by making a remote procedure call to G2. 
<p>
</a><a name="3306">
<em>arguments...</em> represents one or more argument values passed to <br>
<em>g2-function-name</em>. These arguments provide G2 with the details about the 
resource requested. Each <em>argument</em> has the following syntax: 
<p>
</a><ul><a name="3307">
<pre><em>argument-name</em> : <em>argument-type</em> 
</pre>
</a><a name="3308">
where: 
<p></a><ul><a name=3309">
<em>argument-name</em> is one of the attributes of the request that the response procedure needs in order to generate its response. As an <em>argument-name</em>, you can specify any of the possible values for an <em>attribute-name</em> argument in a call to <a href="procedu6.htm#2969"></a>gw-get-attribute-of-request()<code>. </code><p>
</a><a name=3311">
The list of argument name values must include one argument named fetch-id. The fetch-id argument denotes which request is being fulfilled when G2 is generating a reply to an HTTP request. Because the bridge can handle many requests simultaneously, each separate response must specify a unique fetch-id argument. <p>
</a><a name=3312">
<em>argument-type </em>can be <code>integer, text</code>, or <code>symbol</code>. <p>
</a></ul></ul><a name="3313">
The following example illustrates the use of the call cgi format: 
<p>
</a><ul><a name="3314">
<pre>    gw-tender-resources( 3000, "queries/lookup?" <br>
	"call cgi lookup-personnel-file(fetch-id:integer, first:text, last:text)" ) 
</pre>
</a></ul><a name="3315">
This call to gw-tender-resources() handles the URL by extracting the values of the 
first and last parameters from the URL, and passing these values to the user-
defined procedure <code>lookup-personnel-file</code> in G2. Thus, the bridge handles the 
following URL: 
<p>
</a><ul><a name="3316">
<pre>http:/www.genym.com/queries/lookup?last=smith&amp;first=john 
</pre>
</a></ul><a name="3317">
by calling lookup-personnel-file with john and smith as arguments. 
<p>
</a><a name="3318">
<strong>The </strong><code>serve</code><strong> response format:</strong> The <code>serve</code> response format is of the form:
<p>
</a><ul><a name="3319">
<pre>serve from file system <em>path </em>
</pre>
</a></ul><a name="3320">
<code>Serve </code>from <code>file system</code> <em>path</em> is used to pass stable resources to the net that were 
authored previously and placed in the file system. For example, the following 
calls can be used to publish resources from different users at your site. 
<p>
</a><ul><a name="3321">
<pre>gw-tender-resources(4900, "users/joe/", <br>
	"serve from file system: /home/joe/pub/") 
</pre>
</a><a name="3322">
<pre>gw-tender-resources(4800, "users/sam/", <br>
	"serve from file system: /home/sam/pub/") 
</pre>
</a><a name="3323">
<pre>gw-tender-resources(4700, <br>
	"users/doc/", "serve from file system: /home/projects/doc/www/") 
</pre>
</a></ul><a name="3324">
<h2> Return Values </h2>
</a><a name="3325">
None. 
<p>
</a><a name="3326">
<h2> Signals </h2>
</a><a name="3336">
<table border=4>
<tr><th align="left" valign="middle"><a name="3329">
<strong>Signal 
</strong>
</a><th align="left" valign="middle"><a name="3331">
<strong>Description 
</strong>
</a>
<tr><td valign="middle"><a name="3333">
<code>tender-failed 
</code><p>
</a><br><td valign="middle"><a name="3335">
This signal can be reported if the HTTP 
server is not currently running, either 
because you have not called <code>gw-start-
http-server()</code>, or because some error 
has forced the server to shut down. Errors 
can include use of an <em>index </em>value that is 
not between 0 ... 1000 (inclusive), or other 
syntax errors. 
<p>
</a><br>

</table> 

<p></a><a name="3337">


<p></a><a name="12824">

<p>
</a>

<a href="proced10.htm"><h5>| Prev </a> <a href="procedur.htm">| Start of Chapter </a> <a href="examples.htm">| Next Chapter </a> <a href="booktoc.htm">| Contents </a> <a href="bookix.htm">| Index |</a> (12 out of 12)</h5> <br>
<A HREF="titlepa1.htm"><h6>Copyright &#169; 1996, Gensym Corporation, Inc.</h6></A>
</body></html>