/* edit1.c
 * Input file:  edit1.lisp
 * Copyright (c) 1986 - 2017 Gensym Corporation.  All Rights Reserved.
 */

#include "user.h"
#include "edit1.h"


Object The_type_description_of_text_marking_state = UNBOUND;

Object Chain_of_available_text_marking_states = UNBOUND;

Object Text_marking_state_count = UNBOUND;

/* TEXT-MARKING-STATE-STRUCTURE-MEMORY-USAGE */
Object text_marking_state_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,0);
    temp = Text_marking_state_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)7L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-TEXT-MARKING-STATE-COUNT */
Object outstanding_text_marking_state_count()
{
    Object def_structure_text_marking_state_variable, count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,1);
    gensymed_symbol = IFIX(Text_marking_state_count);
    def_structure_text_marking_state_variable = 
	    Chain_of_available_text_marking_states;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( !TRUEP(def_structure_text_marking_state_variable))
	goto end_loop;
    def_structure_text_marking_state_variable = 
	    ISVREF(def_structure_text_marking_state_variable,(SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-TEXT-MARKING-STATE-1 */
Object reclaim_text_marking_state_1(text_marking_state)
    Object text_marking_state;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,2);
    inline_note_reclaim_cons(text_marking_state,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = text_marking_state;
    release_mouse_pointers(ISVREF(text_marking_state,(SI_Long)1L));
    SVREF(text_marking_state,FIX((SI_Long)1L)) = Nil;
    reclaim_frame_serial_number(ISVREF(text_marking_state,(SI_Long)2L));
    SVREF(text_marking_state,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = Chain_of_available_text_marking_states;
    SVREF(text_marking_state,FIX((SI_Long)0L)) = svref_new_value;
    Chain_of_available_text_marking_states = text_marking_state;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-TEXT-MARKING-STATE */
Object reclaim_structure_for_text_marking_state(text_marking_state)
    Object text_marking_state;
{
    x_note_fn_call(126,3);
    return reclaim_text_marking_state_1(text_marking_state);
}

static Object Qg2_defstruct_structure_name_text_marking_state_g2_struct;  /* g2-defstruct-structure-name::text-marking-state-g2-struct */

/* MAKE-PERMANENT-TEXT-MARKING-STATE-STRUCTURE-INTERNAL */
Object make_permanent_text_marking_state_structure_internal()
{
    Object def_structure_text_marking_state_variable;
    Object text_marking_state_count_new_value;
    Object defstruct_g2_text_marking_state_variable, the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,4);
    def_structure_text_marking_state_variable = Nil;
    text_marking_state_count_new_value = FIXNUM_ADD1(Text_marking_state_count);
    Text_marking_state_count = text_marking_state_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_text_marking_state_variable = Nil;
	gensymed_symbol = (SI_Long)7L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_text_marking_state_variable = the_array;
	SVREF(defstruct_g2_text_marking_state_variable,FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_text_marking_state_g2_struct;
	SVREF(defstruct_g2_text_marking_state_variable,FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_text_marking_state_variable,FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_text_marking_state_variable,FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_text_marking_state_variable,FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_text_marking_state_variable,FIX((SI_Long)5L)) = Nil;
	def_structure_text_marking_state_variable = 
		defstruct_g2_text_marking_state_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_text_marking_state_variable);
}

/* MAKE-TEXT-MARKING-STATE-1 */
Object make_text_marking_state_1(image_plane_with_selection_focus_of_workstation_context,
	    reference_number_of_image_plane,
	    block_with_selection_focus_of_workstation_context,
	    edit_workspace_for_text_being_marked)
    Object image_plane_with_selection_focus_of_workstation_context;
    Object reference_number_of_image_plane;
    Object block_with_selection_focus_of_workstation_context;
    Object edit_workspace_for_text_being_marked;
{
    Object def_structure_text_marking_state_variable, svref_new_value;

    x_note_fn_call(126,5);
    def_structure_text_marking_state_variable = 
	    Chain_of_available_text_marking_states;
    if (def_structure_text_marking_state_variable) {
	Chain_of_available_text_marking_states = 
		ISVREF(def_structure_text_marking_state_variable,(SI_Long)0L);
	SVREF(def_structure_text_marking_state_variable,FIX((SI_Long)0L)) 
		= Qg2_defstruct_structure_name_text_marking_state_g2_struct;
    }
    else
	def_structure_text_marking_state_variable = 
		make_permanent_text_marking_state_structure_internal();
    inline_note_allocate_cons(def_structure_text_marking_state_variable,Nil);
    SVREF(def_structure_text_marking_state_variable,FIX((SI_Long)4L)) = 
	    image_plane_with_selection_focus_of_workstation_context;
    SVREF(def_structure_text_marking_state_variable,FIX((SI_Long)5L)) = 
	    reference_number_of_image_plane;
    SVREF(def_structure_text_marking_state_variable,FIX((SI_Long)3L)) = 
	    block_with_selection_focus_of_workstation_context;
    SVREF(def_structure_text_marking_state_variable,FIX((SI_Long)6L)) = 
	    edit_workspace_for_text_being_marked;
    SVREF(def_structure_text_marking_state_variable,FIX((SI_Long)1L)) = Nil;
    svref_new_value = copy_of_current_frame_serial_number_function();
    SVREF(def_structure_text_marking_state_variable,FIX((SI_Long)2L)) = 
	    svref_new_value;
    return VALUES_1(def_structure_text_marking_state_variable);
}

static Object Qavailable_frame_vector;  /* available-frame-vector */

/* VALID-WORKSTATION-CONTEXT-P-FOR-TEXT-MARKING-STATE */
Object valid_workstation_context_p_for_text_marking_state(text_marking_state)
    Object text_marking_state;
{
    Object gensymed_symbol, gensymed_symbol_1, x, y, xa, ya;
    char temp;

    x_note_fn_call(126,6);
    gensymed_symbol = 
	    ISVREF(ISVREF(ISVREF(The_type_description_of_text_marking_state,
	    (SI_Long)9L),(SI_Long)0L),(SI_Long)4L);
    gensymed_symbol_1 = text_marking_state;
    if (inline_funcall_1(gensymed_symbol,gensymed_symbol_1)) {
	gensymed_symbol = ISVREF(ISVREF(text_marking_state,(SI_Long)6L),
		(SI_Long)3L);
	x = ISVREF(text_marking_state,(SI_Long)6L);
	temp = SIMPLE_VECTOR_P(x) ? EQ(ISVREF(x,(SI_Long)1L),
		Qavailable_frame_vector) : TRUEP(Qnil);
	if (temp);
	else
	    temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		    (SI_Long)-1L : TRUEP(Nil);
	if (temp);
	else {
	    x = gensymed_symbol;
	    y = ISVREF(text_marking_state,(SI_Long)2L);
	    if (FIXNUMP(y))
		temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
	    else if (FIXNUMP(x))
		temp = TRUEP(Nil);
	    else {
		xa = M_CAR(y);
		ya = M_CAR(x);
		temp = FIXNUM_LT(xa,ya);
		if (temp);
		else
		    temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),M_CDR(x)) 
			    : TRUEP(Qnil);
	    }
	}
	return VALUES_1( !temp ? T : Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qtext_marking;       /* text-marking */

/* ENTER-TEXT-MARKING-STATE */
Object enter_text_marking_state(text_region,image_plane,edit_workspace)
    Object text_region, image_plane, edit_workspace;
{
    Object text_marking_state;

    x_note_fn_call(126,7);
    text_marking_state = make_text_marking_state_1(image_plane,
	    ISVREF(image_plane,(SI_Long)1L),text_region,edit_workspace);
    enter_context_in_current_workstation(3,Qtext_marking,text_marking_state,T);
    return VALUES_1(text_marking_state);
}

static Object Qframe_transforms_of_block;  /* frame-transforms-of-block */

/* MOUSE-MOTION-IN-TEXT-MARKING */
Object mouse_motion_in_text_marking(mouse_pointer)
    Object mouse_pointer;
{
    Object text_marking_state, mouse_pointer_1, x_in_window, y_in_window;
    Object image_plane, text_region, gensymed_symbol;
    Object superblock_of_text_region, table_qm, temp, temp_1, temp_2;
    Object line_index_for_new_free_end, character_index_for_new_free_end;
    Object frame_transforms_of_block_qm;
    Object result;

    x_note_fn_call(126,8);
    text_marking_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    mouse_pointer_1 = mouse_pointer_blackboard_function(mouse_pointer);
    x_in_window = x_in_window_blackboard_function(mouse_pointer);
    y_in_window = y_in_window_blackboard_function(mouse_pointer);
    image_plane = 
	    image_plane_of_selection_focus_blackboard_function(mouse_pointer);
    text_region = block_of_selection_focus_blackboard_function(mouse_pointer);
    if (text_marking_state && mouse_pointer_1 && x_in_window && 
	    y_in_window && image_plane && text_region) {
	gensymed_symbol = ISVREF(text_region,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)5L) : Nil;
	superblock_of_text_region = gensymed_symbol;
	table_qm = ISVREF(text_region,(SI_Long)20L) ? 
		superblock_of_text_region : Nil;
	temp =  !TRUEP(table_qm) ? superblock_of_text_region : Nil;
	temp_1 = table_qm ? get_table_cell(table_qm,ISVREF(text_region,
		(SI_Long)20L),ISVREF(text_region,(SI_Long)21L)) : Nil;
	gensymed_symbol = ISVREF(text_region,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)0L) : FIX((SI_Long)0L);
	temp_2 = gensymed_symbol;
	gensymed_symbol = ISVREF(text_region,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)1L) : FIX((SI_Long)0L);
	result = find_position_in_text_given_image_plane(12,
		superblock_of_text_region,temp,temp_1,temp_2,
		gensymed_symbol,T,image_plane,x_in_window,y_in_window,Nil,
		Nil,Nil);
	MVS_2(result,line_index_for_new_free_end,
		character_index_for_new_free_end);
	update_text_region(3,text_region,line_index_for_new_free_end,
		character_index_for_new_free_end);
	frame_transforms_of_block_qm = 
		get_lookup_slot_value_given_default(superblock_of_text_region,
		Qframe_transforms_of_block,Nil);
	if (frame_transforms_of_block_qm) {
	    temp_2 = assq_function(image_plane,frame_transforms_of_block_qm);
	    return scroll_text_into_view(CDR(temp_2),
		    line_index_for_new_free_end,
		    character_index_for_new_free_end);
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Kok;                 /* :ok */

/* MOUSE-UP-IN-TEXT-MARKING */
Object mouse_up_in_text_marking(mouse_pointer)
    Object mouse_pointer;
{
    Object mouse_pointer_1;

    x_note_fn_call(126,9);
    mouse_pointer_1 = mouse_pointer_blackboard_function(mouse_pointer);
    if (mouse_pointer_1) {
	mouse_motion_in_text_marking(mouse_pointer_1);
	return return_from_current_workstation_context(3,Qtext_marking,Kok,
		mouse_pointer_1);
    }
    else
	return VALUES_1(Nil);
}

Object The_type_description_of_button_menu_spot = UNBOUND;

Object Chain_of_available_button_menu_spots = UNBOUND;

Object Button_menu_spot_count = UNBOUND;

/* BUTTON-MENU-SPOT-STRUCTURE-MEMORY-USAGE */
Object button_menu_spot_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,10);
    temp = Button_menu_spot_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)23L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-BUTTON-MENU-SPOT-COUNT */
Object outstanding_button_menu_spot_count()
{
    Object def_structure_button_menu_spot_variable, count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,11);
    gensymed_symbol = IFIX(Button_menu_spot_count);
    def_structure_button_menu_spot_variable = 
	    Chain_of_available_button_menu_spots;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( !TRUEP(def_structure_button_menu_spot_variable))
	goto end_loop;
    def_structure_button_menu_spot_variable = 
	    ISVREF(def_structure_button_menu_spot_variable,(SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-BUTTON-MENU-SPOT-1 */
Object reclaim_button_menu_spot_1(button_menu_spot)
    Object button_menu_spot;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,12);
    inline_note_reclaim_cons(button_menu_spot,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = button_menu_spot;
    reclaim_structure_if_any(ISVREF(button_menu_spot,(SI_Long)2L));
    SVREF(button_menu_spot,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = Chain_of_available_button_menu_spots;
    SVREF(button_menu_spot,FIX((SI_Long)0L)) = svref_new_value;
    Chain_of_available_button_menu_spots = button_menu_spot;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-BUTTON-MENU-SPOT */
Object reclaim_structure_for_button_menu_spot(button_menu_spot)
    Object button_menu_spot;
{
    x_note_fn_call(126,13);
    return reclaim_button_menu_spot_1(button_menu_spot);
}

static Object Qg2_defstruct_structure_name_button_menu_spot_g2_struct;  /* g2-defstruct-structure-name::button-menu-spot-g2-struct */

/* MAKE-PERMANENT-BUTTON-MENU-SPOT-STRUCTURE-INTERNAL */
Object make_permanent_button_menu_spot_structure_internal()
{
    Object def_structure_button_menu_spot_variable;
    Object button_menu_spot_count_new_value;
    Object defstruct_g2_button_menu_spot_variable, the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,14);
    def_structure_button_menu_spot_variable = Nil;
    button_menu_spot_count_new_value = FIXNUM_ADD1(Button_menu_spot_count);
    Button_menu_spot_count = button_menu_spot_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_button_menu_spot_variable = Nil;
	gensymed_symbol = (SI_Long)23L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_button_menu_spot_variable = the_array;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_button_menu_spot_g2_struct;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)5L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)6L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)7L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)8L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)9L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)10L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)11L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)12L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)13L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)14L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)15L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)16L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)17L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)18L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)19L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)20L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)21L)) = Nil;
	SVREF(defstruct_g2_button_menu_spot_variable,FIX((SI_Long)22L)) = Nil;
	def_structure_button_menu_spot_variable = 
		defstruct_g2_button_menu_spot_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_button_menu_spot_variable);
}

static Object Kunknown;            /* :unknown */

/* MAKE-BUTTON-MENU-SPOT-1 */
Object make_button_menu_spot_1()
{
    Object def_structure_button_menu_spot_variable;

    x_note_fn_call(126,15);
    def_structure_button_menu_spot_variable = 
	    Chain_of_available_button_menu_spots;
    if (def_structure_button_menu_spot_variable) {
	Chain_of_available_button_menu_spots = 
		ISVREF(def_structure_button_menu_spot_variable,(SI_Long)0L);
	SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_button_menu_spot_g2_struct;
    }
    else
	def_structure_button_menu_spot_variable = 
		make_permanent_button_menu_spot_structure_internal();
    inline_note_allocate_cons(def_structure_button_menu_spot_variable,Nil);
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)1L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)2L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)3L)) = T;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)4L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)5L)) = Nil;
    ISVREF(def_structure_button_menu_spot_variable,(SI_Long)6L) = 
	    FIX((SI_Long)1000L);
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)7L)) = T;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)8L)) = Kunknown;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)9L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)10L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)11L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)12L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)13L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)14L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)15L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)16L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)17L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)18L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)19L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)20L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)21L)) = Nil;
    SVREF(def_structure_button_menu_spot_variable,FIX((SI_Long)22L)) = Nil;
    return VALUES_1(def_structure_button_menu_spot_variable);
}

Object The_type_description_of_menu_button_spot = UNBOUND;

Object Chain_of_available_menu_button_spots = UNBOUND;

Object Menu_button_spot_count = UNBOUND;

/* MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE */
Object menu_button_spot_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,16);
    temp = Menu_button_spot_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)6L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-MENU-BUTTON-SPOT-COUNT */
Object outstanding_menu_button_spot_count()
{
    Object def_structure_menu_button_spot_variable, count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,17);
    gensymed_symbol = IFIX(Menu_button_spot_count);
    def_structure_menu_button_spot_variable = 
	    Chain_of_available_menu_button_spots;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( !TRUEP(def_structure_menu_button_spot_variable))
	goto end_loop;
    def_structure_menu_button_spot_variable = 
	    ISVREF(def_structure_menu_button_spot_variable,(SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-MENU-BUTTON-SPOT-1 */
Object reclaim_menu_button_spot_1(menu_button_spot)
    Object menu_button_spot;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,18);
    inline_note_reclaim_cons(menu_button_spot,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = menu_button_spot;
    reclaim_structure_if_any(ISVREF(menu_button_spot,(SI_Long)2L));
    SVREF(menu_button_spot,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = Chain_of_available_menu_button_spots;
    SVREF(menu_button_spot,FIX((SI_Long)0L)) = svref_new_value;
    Chain_of_available_menu_button_spots = menu_button_spot;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-MENU-BUTTON-SPOT */
Object reclaim_structure_for_menu_button_spot(menu_button_spot)
    Object menu_button_spot;
{
    x_note_fn_call(126,19);
    return reclaim_menu_button_spot_1(menu_button_spot);
}

static Object Qg2_defstruct_structure_name_menu_button_spot_g2_struct;  /* g2-defstruct-structure-name::menu-button-spot-g2-struct */

/* MAKE-PERMANENT-MENU-BUTTON-SPOT-STRUCTURE-INTERNAL */
Object make_permanent_menu_button_spot_structure_internal()
{
    Object def_structure_menu_button_spot_variable;
    Object menu_button_spot_count_new_value;
    Object defstruct_g2_menu_button_spot_variable, the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,20);
    def_structure_menu_button_spot_variable = Nil;
    menu_button_spot_count_new_value = FIXNUM_ADD1(Menu_button_spot_count);
    Menu_button_spot_count = menu_button_spot_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_menu_button_spot_variable = Nil;
	gensymed_symbol = (SI_Long)6L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_menu_button_spot_variable = the_array;
	SVREF(defstruct_g2_menu_button_spot_variable,FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_menu_button_spot_g2_struct;
	SVREF(defstruct_g2_menu_button_spot_variable,FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_menu_button_spot_variable,FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_menu_button_spot_variable,FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_menu_button_spot_variable,FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_menu_button_spot_variable,FIX((SI_Long)5L)) = Nil;
	def_structure_menu_button_spot_variable = 
		defstruct_g2_menu_button_spot_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_menu_button_spot_variable);
}

/* MAKE-MENU-BUTTON-SPOT-1 */
Object make_menu_button_spot_1()
{
    Object def_structure_menu_button_spot_variable;

    x_note_fn_call(126,21);
    def_structure_menu_button_spot_variable = 
	    Chain_of_available_menu_button_spots;
    if (def_structure_menu_button_spot_variable) {
	Chain_of_available_menu_button_spots = 
		ISVREF(def_structure_menu_button_spot_variable,(SI_Long)0L);
	SVREF(def_structure_menu_button_spot_variable,FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_menu_button_spot_g2_struct;
    }
    else
	def_structure_menu_button_spot_variable = 
		make_permanent_menu_button_spot_structure_internal();
    inline_note_allocate_cons(def_structure_menu_button_spot_variable,Nil);
    SVREF(def_structure_menu_button_spot_variable,FIX((SI_Long)1L)) = Nil;
    SVREF(def_structure_menu_button_spot_variable,FIX((SI_Long)2L)) = Nil;
    SVREF(def_structure_menu_button_spot_variable,FIX((SI_Long)3L)) = T;
    SVREF(def_structure_menu_button_spot_variable,FIX((SI_Long)4L)) = Nil;
    SVREF(def_structure_menu_button_spot_variable,FIX((SI_Long)5L)) = Nil;
    return VALUES_1(def_structure_menu_button_spot_variable);
}

Object The_type_description_of_subcommand_menu_button_spot = UNBOUND;

Object Chain_of_available_subcommand_menu_button_spots = UNBOUND;

Object Subcommand_menu_button_spot_count = UNBOUND;

/* SUBCOMMAND-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE */
Object subcommand_menu_button_spot_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,22);
    temp = Subcommand_menu_button_spot_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)6L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-SUBCOMMAND-MENU-BUTTON-SPOT-COUNT */
Object outstanding_subcommand_menu_button_spot_count()
{
    Object def_structure_subcommand_menu_button_spot_variable, count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,23);
    gensymed_symbol = IFIX(Subcommand_menu_button_spot_count);
    def_structure_subcommand_menu_button_spot_variable = 
	    Chain_of_available_subcommand_menu_button_spots;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( !TRUEP(def_structure_subcommand_menu_button_spot_variable))
	goto end_loop;
    def_structure_subcommand_menu_button_spot_variable = 
	    ISVREF(def_structure_subcommand_menu_button_spot_variable,
	    (SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-SUBCOMMAND-MENU-BUTTON-SPOT-1 */
Object reclaim_subcommand_menu_button_spot_1(subcommand_menu_button_spot)
    Object subcommand_menu_button_spot;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,24);
    inline_note_reclaim_cons(subcommand_menu_button_spot,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = subcommand_menu_button_spot;
    reclaim_structure_if_any(ISVREF(subcommand_menu_button_spot,(SI_Long)2L));
    SVREF(subcommand_menu_button_spot,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = Chain_of_available_subcommand_menu_button_spots;
    SVREF(subcommand_menu_button_spot,FIX((SI_Long)0L)) = svref_new_value;
    Chain_of_available_subcommand_menu_button_spots = 
	    subcommand_menu_button_spot;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-SUBCOMMAND-MENU-BUTTON-SPOT */
Object reclaim_structure_for_subcommand_menu_button_spot(subcommand_menu_button_spot)
    Object subcommand_menu_button_spot;
{
    x_note_fn_call(126,25);
    return reclaim_subcommand_menu_button_spot_1(subcommand_menu_button_spot);
}

static Object Qg2_defstruct_structure_name_subcommand_menu_button_spot_g2_struct;  /* g2-defstruct-structure-name::subcommand-menu-button-spot-g2-struct */

/* MAKE-PERMANENT-SUBCOMMAND-MENU-BUTTON-SPOT-STRUCTURE-INTERNAL */
Object make_permanent_subcommand_menu_button_spot_structure_internal()
{
    Object def_structure_subcommand_menu_button_spot_variable;
    Object subcommand_menu_button_spot_count_new_value;
    Object defstruct_g2_subcommand_menu_button_spot_variable, the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,26);
    def_structure_subcommand_menu_button_spot_variable = Nil;
    subcommand_menu_button_spot_count_new_value = 
	    FIXNUM_ADD1(Subcommand_menu_button_spot_count);
    Subcommand_menu_button_spot_count = 
	    subcommand_menu_button_spot_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_subcommand_menu_button_spot_variable = Nil;
	gensymed_symbol = (SI_Long)6L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_subcommand_menu_button_spot_variable = the_array;
	SVREF(defstruct_g2_subcommand_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_subcommand_menu_button_spot_g2_struct;
	SVREF(defstruct_g2_subcommand_menu_button_spot_variable,
		FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_subcommand_menu_button_spot_variable,
		FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_subcommand_menu_button_spot_variable,
		FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_subcommand_menu_button_spot_variable,
		FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_subcommand_menu_button_spot_variable,
		FIX((SI_Long)5L)) = Nil;
	def_structure_subcommand_menu_button_spot_variable = 
		defstruct_g2_subcommand_menu_button_spot_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_subcommand_menu_button_spot_variable);
}

/* MAKE-SUBCOMMAND-MENU-BUTTON-SPOT-1 */
Object make_subcommand_menu_button_spot_1()
{
    Object def_structure_subcommand_menu_button_spot_variable;

    x_note_fn_call(126,27);
    def_structure_subcommand_menu_button_spot_variable = 
	    Chain_of_available_subcommand_menu_button_spots;
    if (def_structure_subcommand_menu_button_spot_variable) {
	Chain_of_available_subcommand_menu_button_spots = 
		ISVREF(def_structure_subcommand_menu_button_spot_variable,
		(SI_Long)0L);
	SVREF(def_structure_subcommand_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_subcommand_menu_button_spot_g2_struct;
    }
    else
	def_structure_subcommand_menu_button_spot_variable = 
		make_permanent_subcommand_menu_button_spot_structure_internal();
    inline_note_allocate_cons(def_structure_subcommand_menu_button_spot_variable,
	    Nil);
    SVREF(def_structure_subcommand_menu_button_spot_variable,
	    FIX((SI_Long)1L)) = Nil;
    SVREF(def_structure_subcommand_menu_button_spot_variable,
	    FIX((SI_Long)2L)) = Nil;
    SVREF(def_structure_subcommand_menu_button_spot_variable,
	    FIX((SI_Long)3L)) = T;
    SVREF(def_structure_subcommand_menu_button_spot_variable,
	    FIX((SI_Long)4L)) = Nil;
    SVREF(def_structure_subcommand_menu_button_spot_variable,
	    FIX((SI_Long)5L)) = Nil;
    return VALUES_1(def_structure_subcommand_menu_button_spot_variable);
}

Object The_type_description_of_category_menu_button_spot = UNBOUND;

Object Chain_of_available_category_menu_button_spots = UNBOUND;

Object Category_menu_button_spot_count = UNBOUND;

/* CATEGORY-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE */
Object category_menu_button_spot_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,28);
    temp = Category_menu_button_spot_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)6L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-CATEGORY-MENU-BUTTON-SPOT-COUNT */
Object outstanding_category_menu_button_spot_count()
{
    Object def_structure_category_menu_button_spot_variable, count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,29);
    gensymed_symbol = IFIX(Category_menu_button_spot_count);
    def_structure_category_menu_button_spot_variable = 
	    Chain_of_available_category_menu_button_spots;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( !TRUEP(def_structure_category_menu_button_spot_variable))
	goto end_loop;
    def_structure_category_menu_button_spot_variable = 
	    ISVREF(def_structure_category_menu_button_spot_variable,
	    (SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-CATEGORY-MENU-BUTTON-SPOT-1 */
Object reclaim_category_menu_button_spot_1(category_menu_button_spot)
    Object category_menu_button_spot;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,30);
    inline_note_reclaim_cons(category_menu_button_spot,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = category_menu_button_spot;
    reclaim_structure_if_any(ISVREF(category_menu_button_spot,(SI_Long)2L));
    SVREF(category_menu_button_spot,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = Chain_of_available_category_menu_button_spots;
    SVREF(category_menu_button_spot,FIX((SI_Long)0L)) = svref_new_value;
    Chain_of_available_category_menu_button_spots = category_menu_button_spot;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-CATEGORY-MENU-BUTTON-SPOT */
Object reclaim_structure_for_category_menu_button_spot(category_menu_button_spot)
    Object category_menu_button_spot;
{
    x_note_fn_call(126,31);
    return reclaim_category_menu_button_spot_1(category_menu_button_spot);
}

static Object Qg2_defstruct_structure_name_category_menu_button_spot_g2_struct;  /* g2-defstruct-structure-name::category-menu-button-spot-g2-struct */

/* MAKE-PERMANENT-CATEGORY-MENU-BUTTON-SPOT-STRUCTURE-INTERNAL */
Object make_permanent_category_menu_button_spot_structure_internal()
{
    Object def_structure_category_menu_button_spot_variable;
    Object category_menu_button_spot_count_new_value;
    Object defstruct_g2_category_menu_button_spot_variable, the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,32);
    def_structure_category_menu_button_spot_variable = Nil;
    category_menu_button_spot_count_new_value = 
	    FIXNUM_ADD1(Category_menu_button_spot_count);
    Category_menu_button_spot_count = 
	    category_menu_button_spot_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_category_menu_button_spot_variable = Nil;
	gensymed_symbol = (SI_Long)6L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_category_menu_button_spot_variable = the_array;
	SVREF(defstruct_g2_category_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_category_menu_button_spot_g2_struct;
	SVREF(defstruct_g2_category_menu_button_spot_variable,
		FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_category_menu_button_spot_variable,
		FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_category_menu_button_spot_variable,
		FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_category_menu_button_spot_variable,
		FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_category_menu_button_spot_variable,
		FIX((SI_Long)5L)) = Nil;
	def_structure_category_menu_button_spot_variable = 
		defstruct_g2_category_menu_button_spot_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_category_menu_button_spot_variable);
}

/* MAKE-CATEGORY-MENU-BUTTON-SPOT-1 */
Object make_category_menu_button_spot_1()
{
    Object def_structure_category_menu_button_spot_variable;

    x_note_fn_call(126,33);
    def_structure_category_menu_button_spot_variable = 
	    Chain_of_available_category_menu_button_spots;
    if (def_structure_category_menu_button_spot_variable) {
	Chain_of_available_category_menu_button_spots = 
		ISVREF(def_structure_category_menu_button_spot_variable,
		(SI_Long)0L);
	SVREF(def_structure_category_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_category_menu_button_spot_g2_struct;
    }
    else
	def_structure_category_menu_button_spot_variable = 
		make_permanent_category_menu_button_spot_structure_internal();
    inline_note_allocate_cons(def_structure_category_menu_button_spot_variable,
	    Nil);
    SVREF(def_structure_category_menu_button_spot_variable,
	    FIX((SI_Long)1L)) = Nil;
    SVREF(def_structure_category_menu_button_spot_variable,
	    FIX((SI_Long)2L)) = Nil;
    SVREF(def_structure_category_menu_button_spot_variable,
	    FIX((SI_Long)3L)) = T;
    SVREF(def_structure_category_menu_button_spot_variable,
	    FIX((SI_Long)4L)) = Nil;
    SVREF(def_structure_category_menu_button_spot_variable,
	    FIX((SI_Long)5L)) = Nil;
    return VALUES_1(def_structure_category_menu_button_spot_variable);
}

Object The_type_description_of_token_menu_button_spot = UNBOUND;

Object Chain_of_available_token_menu_button_spots = UNBOUND;

Object Token_menu_button_spot_count = UNBOUND;

/* TOKEN-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE */
Object token_menu_button_spot_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,34);
    temp = Token_menu_button_spot_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)6L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-TOKEN-MENU-BUTTON-SPOT-COUNT */
Object outstanding_token_menu_button_spot_count()
{
    Object def_structure_token_menu_button_spot_variable, count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,35);
    gensymed_symbol = IFIX(Token_menu_button_spot_count);
    def_structure_token_menu_button_spot_variable = 
	    Chain_of_available_token_menu_button_spots;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( !TRUEP(def_structure_token_menu_button_spot_variable))
	goto end_loop;
    def_structure_token_menu_button_spot_variable = 
	    ISVREF(def_structure_token_menu_button_spot_variable,(SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-TOKEN-MENU-BUTTON-SPOT-1 */
Object reclaim_token_menu_button_spot_1(token_menu_button_spot)
    Object token_menu_button_spot;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,36);
    inline_note_reclaim_cons(token_menu_button_spot,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = token_menu_button_spot;
    reclaim_structure_if_any(ISVREF(token_menu_button_spot,(SI_Long)2L));
    SVREF(token_menu_button_spot,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = Chain_of_available_token_menu_button_spots;
    SVREF(token_menu_button_spot,FIX((SI_Long)0L)) = svref_new_value;
    Chain_of_available_token_menu_button_spots = token_menu_button_spot;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-TOKEN-MENU-BUTTON-SPOT */
Object reclaim_structure_for_token_menu_button_spot(token_menu_button_spot)
    Object token_menu_button_spot;
{
    x_note_fn_call(126,37);
    return reclaim_token_menu_button_spot_1(token_menu_button_spot);
}

static Object Qg2_defstruct_structure_name_token_menu_button_spot_g2_struct;  /* g2-defstruct-structure-name::token-menu-button-spot-g2-struct */

/* MAKE-PERMANENT-TOKEN-MENU-BUTTON-SPOT-STRUCTURE-INTERNAL */
Object make_permanent_token_menu_button_spot_structure_internal()
{
    Object def_structure_token_menu_button_spot_variable;
    Object token_menu_button_spot_count_new_value;
    Object defstruct_g2_token_menu_button_spot_variable, the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,38);
    def_structure_token_menu_button_spot_variable = Nil;
    token_menu_button_spot_count_new_value = 
	    FIXNUM_ADD1(Token_menu_button_spot_count);
    Token_menu_button_spot_count = token_menu_button_spot_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_token_menu_button_spot_variable = Nil;
	gensymed_symbol = (SI_Long)6L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_token_menu_button_spot_variable = the_array;
	SVREF(defstruct_g2_token_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_token_menu_button_spot_g2_struct;
	SVREF(defstruct_g2_token_menu_button_spot_variable,
		FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_token_menu_button_spot_variable,
		FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_token_menu_button_spot_variable,
		FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_token_menu_button_spot_variable,
		FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_token_menu_button_spot_variable,
		FIX((SI_Long)5L)) = Nil;
	def_structure_token_menu_button_spot_variable = 
		defstruct_g2_token_menu_button_spot_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_token_menu_button_spot_variable);
}

/* MAKE-TOKEN-MENU-BUTTON-SPOT-1 */
Object make_token_menu_button_spot_1()
{
    Object def_structure_token_menu_button_spot_variable;

    x_note_fn_call(126,39);
    def_structure_token_menu_button_spot_variable = 
	    Chain_of_available_token_menu_button_spots;
    if (def_structure_token_menu_button_spot_variable) {
	Chain_of_available_token_menu_button_spots = 
		ISVREF(def_structure_token_menu_button_spot_variable,
		(SI_Long)0L);
	SVREF(def_structure_token_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_token_menu_button_spot_g2_struct;
    }
    else
	def_structure_token_menu_button_spot_variable = 
		make_permanent_token_menu_button_spot_structure_internal();
    inline_note_allocate_cons(def_structure_token_menu_button_spot_variable,
	    Nil);
    SVREF(def_structure_token_menu_button_spot_variable,FIX((SI_Long)1L)) 
	    = Nil;
    SVREF(def_structure_token_menu_button_spot_variable,FIX((SI_Long)2L)) 
	    = Nil;
    SVREF(def_structure_token_menu_button_spot_variable,FIX((SI_Long)3L)) = T;
    SVREF(def_structure_token_menu_button_spot_variable,FIX((SI_Long)4L)) 
	    = Nil;
    SVREF(def_structure_token_menu_button_spot_variable,FIX((SI_Long)5L)) 
	    = Nil;
    return VALUES_1(def_structure_token_menu_button_spot_variable);
}

Object The_type_description_of_replacement_token_menu_button_spot = UNBOUND;

Object Chain_of_available_replacement_token_menu_button_spots = UNBOUND;

Object Replacement_token_menu_button_spot_count = UNBOUND;

/* REPLACEMENT-TOKEN-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE */
Object replacement_token_menu_button_spot_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,40);
    temp = Replacement_token_menu_button_spot_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)6L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-REPLACEMENT-TOKEN-MENU-BUTTON-SPOT-COUNT */
Object outstanding_replacement_token_menu_button_spot_count()
{
    Object def_structure_replacement_token_menu_button_spot_variable, count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,41);
    gensymed_symbol = IFIX(Replacement_token_menu_button_spot_count);
    def_structure_replacement_token_menu_button_spot_variable = 
	    Chain_of_available_replacement_token_menu_button_spots;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( !TRUEP(def_structure_replacement_token_menu_button_spot_variable))
	goto end_loop;
    def_structure_replacement_token_menu_button_spot_variable = 
	    ISVREF(def_structure_replacement_token_menu_button_spot_variable,
	    (SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-REPLACEMENT-TOKEN-MENU-BUTTON-SPOT-1 */
Object reclaim_replacement_token_menu_button_spot_1(replacement_token_menu_button_spot)
    Object replacement_token_menu_button_spot;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,42);
    inline_note_reclaim_cons(replacement_token_menu_button_spot,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = replacement_token_menu_button_spot;
    reclaim_structure_if_any(ISVREF(replacement_token_menu_button_spot,
	    (SI_Long)2L));
    SVREF(replacement_token_menu_button_spot,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = Chain_of_available_replacement_token_menu_button_spots;
    SVREF(replacement_token_menu_button_spot,FIX((SI_Long)0L)) = 
	    svref_new_value;
    Chain_of_available_replacement_token_menu_button_spots = 
	    replacement_token_menu_button_spot;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-REPLACEMENT-TOKEN-MENU-BUTTON-SPOT */
Object reclaim_structure_for_replacement_token_menu_button_spot(replacement_token_menu_button_spot)
    Object replacement_token_menu_button_spot;
{
    x_note_fn_call(126,43);
    return reclaim_replacement_token_menu_button_spot_1(replacement_token_menu_button_spot);
}

static Object Qg2_defstruct_structure_name_replacement_token_menu_button_spot_g2_struct;  /* g2-defstruct-structure-name::replacement-token-menu-button-spot-g2-struct */

/* MAKE-PERMANENT-REPLACEMENT-TOKEN-MENU-BUTTON-SPOT-STRUCTURE-INTERNAL */
Object make_permanent_replacement_token_menu_button_spot_structure_internal()
{
    Object def_structure_replacement_token_menu_button_spot_variable;
    Object replacement_token_menu_button_spot_count_new_value;
    Object defstruct_g2_replacement_token_menu_button_spot_variable, the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,44);
    def_structure_replacement_token_menu_button_spot_variable = Nil;
    replacement_token_menu_button_spot_count_new_value = 
	    FIXNUM_ADD1(Replacement_token_menu_button_spot_count);
    Replacement_token_menu_button_spot_count = 
	    replacement_token_menu_button_spot_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_replacement_token_menu_button_spot_variable = Nil;
	gensymed_symbol = (SI_Long)6L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_replacement_token_menu_button_spot_variable = the_array;
	SVREF(defstruct_g2_replacement_token_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_replacement_token_menu_button_spot_g2_struct;
	SVREF(defstruct_g2_replacement_token_menu_button_spot_variable,
		FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_replacement_token_menu_button_spot_variable,
		FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_replacement_token_menu_button_spot_variable,
		FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_replacement_token_menu_button_spot_variable,
		FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_replacement_token_menu_button_spot_variable,
		FIX((SI_Long)5L)) = Nil;
	def_structure_replacement_token_menu_button_spot_variable = 
		defstruct_g2_replacement_token_menu_button_spot_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_replacement_token_menu_button_spot_variable);
}

/* MAKE-REPLACEMENT-TOKEN-MENU-BUTTON-SPOT-1 */
Object make_replacement_token_menu_button_spot_1()
{
    Object def_structure_replacement_token_menu_button_spot_variable;

    x_note_fn_call(126,45);
    def_structure_replacement_token_menu_button_spot_variable = 
	    Chain_of_available_replacement_token_menu_button_spots;
    if (def_structure_replacement_token_menu_button_spot_variable) {
	Chain_of_available_replacement_token_menu_button_spots = 
		ISVREF(def_structure_replacement_token_menu_button_spot_variable,
		(SI_Long)0L);
	SVREF(def_structure_replacement_token_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_replacement_token_menu_button_spot_g2_struct;
    }
    else
	def_structure_replacement_token_menu_button_spot_variable = 
		make_permanent_replacement_token_menu_button_spot_structure_internal();
    inline_note_allocate_cons(def_structure_replacement_token_menu_button_spot_variable,
	    Nil);
    SVREF(def_structure_replacement_token_menu_button_spot_variable,
	    FIX((SI_Long)1L)) = Nil;
    SVREF(def_structure_replacement_token_menu_button_spot_variable,
	    FIX((SI_Long)2L)) = Nil;
    SVREF(def_structure_replacement_token_menu_button_spot_variable,
	    FIX((SI_Long)3L)) = T;
    SVREF(def_structure_replacement_token_menu_button_spot_variable,
	    FIX((SI_Long)4L)) = Nil;
    SVREF(def_structure_replacement_token_menu_button_spot_variable,
	    FIX((SI_Long)5L)) = Nil;
    return VALUES_1(def_structure_replacement_token_menu_button_spot_variable);
}

Object The_type_description_of_character_sequence_token_menu_button_spot = UNBOUND;

Object Chain_of_available_character_sequence_token_menu_button_spots = UNBOUND;

Object Character_sequence_token_menu_button_spot_count = UNBOUND;

/* CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE */
Object character_sequence_token_menu_button_spot_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,46);
    temp = Character_sequence_token_menu_button_spot_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)6L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT-COUNT */
Object outstanding_character_sequence_token_menu_button_spot_count()
{
    Object def_structure_character_sequence_token_menu_button_spot_variable;
    Object count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,47);
    gensymed_symbol = IFIX(Character_sequence_token_menu_button_spot_count);
    def_structure_character_sequence_token_menu_button_spot_variable = 
	    Chain_of_available_character_sequence_token_menu_button_spots;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( 
	    !TRUEP(def_structure_character_sequence_token_menu_button_spot_variable))
	goto end_loop;
    def_structure_character_sequence_token_menu_button_spot_variable = 
	    ISVREF(def_structure_character_sequence_token_menu_button_spot_variable,
	    (SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT-1 */
Object reclaim_character_sequence_token_menu_button_spot_1(character_sequence_token_menu_button_spot)
    Object character_sequence_token_menu_button_spot;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,48);
    inline_note_reclaim_cons(character_sequence_token_menu_button_spot,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = character_sequence_token_menu_button_spot;
    reclaim_structure_if_any(ISVREF(character_sequence_token_menu_button_spot,
	    (SI_Long)2L));
    SVREF(character_sequence_token_menu_button_spot,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = 
	    Chain_of_available_character_sequence_token_menu_button_spots;
    SVREF(character_sequence_token_menu_button_spot,FIX((SI_Long)0L)) = 
	    svref_new_value;
    Chain_of_available_character_sequence_token_menu_button_spots = 
	    character_sequence_token_menu_button_spot;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT */
Object reclaim_structure_for_character_sequence_token_menu_button_spot(character_sequence_token_menu_button_spot)
    Object character_sequence_token_menu_button_spot;
{
    x_note_fn_call(126,49);
    return reclaim_character_sequence_token_menu_button_spot_1(character_sequence_token_menu_button_spot);
}

static Object Qg2_defstruct_structure_name_character_sequence_token_menu_button_spot_g2_struct;  /* g2-defstruct-structure-name::character-sequence-token-menu-button-spot-g2-struct */

/* MAKE-PERMANENT-CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT-STRUCTURE-INTERNAL */
Object make_permanent_character_sequence_token_menu_button_spot_structure_internal()
{
    Object def_structure_character_sequence_token_menu_button_spot_variable;
    Object character_sequence_token_menu_button_spot_count_new_value;
    Object defstruct_g2_character_sequence_token_menu_button_spot_variable;
    Object the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,50);
    def_structure_character_sequence_token_menu_button_spot_variable = Nil;
    character_sequence_token_menu_button_spot_count_new_value = 
	    FIXNUM_ADD1(Character_sequence_token_menu_button_spot_count);
    Character_sequence_token_menu_button_spot_count = 
	    character_sequence_token_menu_button_spot_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_character_sequence_token_menu_button_spot_variable = Nil;
	gensymed_symbol = (SI_Long)6L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_character_sequence_token_menu_button_spot_variable = 
		the_array;
	SVREF(defstruct_g2_character_sequence_token_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_character_sequence_token_menu_button_spot_g2_struct;
	SVREF(defstruct_g2_character_sequence_token_menu_button_spot_variable,
		FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_character_sequence_token_menu_button_spot_variable,
		FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_character_sequence_token_menu_button_spot_variable,
		FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_character_sequence_token_menu_button_spot_variable,
		FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_character_sequence_token_menu_button_spot_variable,
		FIX((SI_Long)5L)) = Nil;
	def_structure_character_sequence_token_menu_button_spot_variable = 
		defstruct_g2_character_sequence_token_menu_button_spot_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_character_sequence_token_menu_button_spot_variable);
}

/* MAKE-CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT-1 */
Object make_character_sequence_token_menu_button_spot_1()
{
    Object def_structure_character_sequence_token_menu_button_spot_variable;

    x_note_fn_call(126,51);
    def_structure_character_sequence_token_menu_button_spot_variable = 
	    Chain_of_available_character_sequence_token_menu_button_spots;
    if (def_structure_character_sequence_token_menu_button_spot_variable) {
	Chain_of_available_character_sequence_token_menu_button_spots = 
		ISVREF(def_structure_character_sequence_token_menu_button_spot_variable,
		(SI_Long)0L);
	SVREF(def_structure_character_sequence_token_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_character_sequence_token_menu_button_spot_g2_struct;
    }
    else
	def_structure_character_sequence_token_menu_button_spot_variable = 
		make_permanent_character_sequence_token_menu_button_spot_structure_internal();
    inline_note_allocate_cons(def_structure_character_sequence_token_menu_button_spot_variable,
	    Nil);
    SVREF(def_structure_character_sequence_token_menu_button_spot_variable,
	    FIX((SI_Long)1L)) = Nil;
    SVREF(def_structure_character_sequence_token_menu_button_spot_variable,
	    FIX((SI_Long)2L)) = Nil;
    SVREF(def_structure_character_sequence_token_menu_button_spot_variable,
	    FIX((SI_Long)3L)) = T;
    SVREF(def_structure_character_sequence_token_menu_button_spot_variable,
	    FIX((SI_Long)4L)) = Nil;
    SVREF(def_structure_character_sequence_token_menu_button_spot_variable,
	    FIX((SI_Long)5L)) = Nil;
    return VALUES_1(def_structure_character_sequence_token_menu_button_spot_variable);
}

Object The_type_description_of_pathname_component_token_menu_button_spot = UNBOUND;

Object Chain_of_available_pathname_component_token_menu_button_spots = UNBOUND;

Object Pathname_component_token_menu_button_spot_count = UNBOUND;

/* PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE */
Object pathname_component_token_menu_button_spot_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,52);
    temp = Pathname_component_token_menu_button_spot_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)6L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT-COUNT */
Object outstanding_pathname_component_token_menu_button_spot_count()
{
    Object def_structure_pathname_component_token_menu_button_spot_variable;
    Object count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,53);
    gensymed_symbol = IFIX(Pathname_component_token_menu_button_spot_count);
    def_structure_pathname_component_token_menu_button_spot_variable = 
	    Chain_of_available_pathname_component_token_menu_button_spots;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( 
	    !TRUEP(def_structure_pathname_component_token_menu_button_spot_variable))
	goto end_loop;
    def_structure_pathname_component_token_menu_button_spot_variable = 
	    ISVREF(def_structure_pathname_component_token_menu_button_spot_variable,
	    (SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT-1 */
Object reclaim_pathname_component_token_menu_button_spot_1(pathname_component_token_menu_button_spot)
    Object pathname_component_token_menu_button_spot;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,54);
    inline_note_reclaim_cons(pathname_component_token_menu_button_spot,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = pathname_component_token_menu_button_spot;
    reclaim_structure_if_any(ISVREF(pathname_component_token_menu_button_spot,
	    (SI_Long)2L));
    SVREF(pathname_component_token_menu_button_spot,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = 
	    Chain_of_available_pathname_component_token_menu_button_spots;
    SVREF(pathname_component_token_menu_button_spot,FIX((SI_Long)0L)) = 
	    svref_new_value;
    Chain_of_available_pathname_component_token_menu_button_spots = 
	    pathname_component_token_menu_button_spot;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT */
Object reclaim_structure_for_pathname_component_token_menu_button_spot(pathname_component_token_menu_button_spot)
    Object pathname_component_token_menu_button_spot;
{
    x_note_fn_call(126,55);
    return reclaim_pathname_component_token_menu_button_spot_1(pathname_component_token_menu_button_spot);
}

static Object Qg2_defstruct_structure_name_pathname_component_token_menu_button_spot_g2_struct;  /* g2-defstruct-structure-name::pathname-component-token-menu-button-spot-g2-struct */

/* MAKE-PERMANENT-PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT-STRUCTURE-INTERNAL */
Object make_permanent_pathname_component_token_menu_button_spot_structure_internal()
{
    Object def_structure_pathname_component_token_menu_button_spot_variable;
    Object pathname_component_token_menu_button_spot_count_new_value;
    Object defstruct_g2_pathname_component_token_menu_button_spot_variable;
    Object the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,56);
    def_structure_pathname_component_token_menu_button_spot_variable = Nil;
    pathname_component_token_menu_button_spot_count_new_value = 
	    FIXNUM_ADD1(Pathname_component_token_menu_button_spot_count);
    Pathname_component_token_menu_button_spot_count = 
	    pathname_component_token_menu_button_spot_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_pathname_component_token_menu_button_spot_variable = Nil;
	gensymed_symbol = (SI_Long)6L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_pathname_component_token_menu_button_spot_variable = 
		the_array;
	SVREF(defstruct_g2_pathname_component_token_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_pathname_component_token_menu_button_spot_g2_struct;
	SVREF(defstruct_g2_pathname_component_token_menu_button_spot_variable,
		FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_pathname_component_token_menu_button_spot_variable,
		FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_pathname_component_token_menu_button_spot_variable,
		FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_pathname_component_token_menu_button_spot_variable,
		FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_pathname_component_token_menu_button_spot_variable,
		FIX((SI_Long)5L)) = Nil;
	def_structure_pathname_component_token_menu_button_spot_variable = 
		defstruct_g2_pathname_component_token_menu_button_spot_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_pathname_component_token_menu_button_spot_variable);
}

/* MAKE-PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT-1 */
Object make_pathname_component_token_menu_button_spot_1()
{
    Object def_structure_pathname_component_token_menu_button_spot_variable;

    x_note_fn_call(126,57);
    def_structure_pathname_component_token_menu_button_spot_variable = 
	    Chain_of_available_pathname_component_token_menu_button_spots;
    if (def_structure_pathname_component_token_menu_button_spot_variable) {
	Chain_of_available_pathname_component_token_menu_button_spots = 
		ISVREF(def_structure_pathname_component_token_menu_button_spot_variable,
		(SI_Long)0L);
	SVREF(def_structure_pathname_component_token_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_pathname_component_token_menu_button_spot_g2_struct;
    }
    else
	def_structure_pathname_component_token_menu_button_spot_variable = 
		make_permanent_pathname_component_token_menu_button_spot_structure_internal();
    inline_note_allocate_cons(def_structure_pathname_component_token_menu_button_spot_variable,
	    Nil);
    SVREF(def_structure_pathname_component_token_menu_button_spot_variable,
	    FIX((SI_Long)1L)) = Nil;
    SVREF(def_structure_pathname_component_token_menu_button_spot_variable,
	    FIX((SI_Long)2L)) = Nil;
    SVREF(def_structure_pathname_component_token_menu_button_spot_variable,
	    FIX((SI_Long)3L)) = T;
    SVREF(def_structure_pathname_component_token_menu_button_spot_variable,
	    FIX((SI_Long)4L)) = Nil;
    SVREF(def_structure_pathname_component_token_menu_button_spot_variable,
	    FIX((SI_Long)5L)) = Nil;
    return VALUES_1(def_structure_pathname_component_token_menu_button_spot_variable);
}

Object The_type_description_of_kfep_conversion_choice_menu_button_spot = UNBOUND;

Object Chain_of_available_kfep_conversion_choice_menu_button_spots = UNBOUND;

Object Kfep_conversion_choice_menu_button_spot_count = UNBOUND;

/* KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE */
Object kfep_conversion_choice_menu_button_spot_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,58);
    temp = Kfep_conversion_choice_menu_button_spot_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)6L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT-COUNT */
Object outstanding_kfep_conversion_choice_menu_button_spot_count()
{
    Object def_structure_kfep_conversion_choice_menu_button_spot_variable;
    Object count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,59);
    gensymed_symbol = IFIX(Kfep_conversion_choice_menu_button_spot_count);
    def_structure_kfep_conversion_choice_menu_button_spot_variable = 
	    Chain_of_available_kfep_conversion_choice_menu_button_spots;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( 
	    !TRUEP(def_structure_kfep_conversion_choice_menu_button_spot_variable))
	goto end_loop;
    def_structure_kfep_conversion_choice_menu_button_spot_variable = 
	    ISVREF(def_structure_kfep_conversion_choice_menu_button_spot_variable,
	    (SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT-1 */
Object reclaim_kfep_conversion_choice_menu_button_spot_1(kfep_conversion_choice_menu_button_spot)
    Object kfep_conversion_choice_menu_button_spot;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,60);
    inline_note_reclaim_cons(kfep_conversion_choice_menu_button_spot,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = kfep_conversion_choice_menu_button_spot;
    reclaim_structure_if_any(ISVREF(kfep_conversion_choice_menu_button_spot,
	    (SI_Long)2L));
    SVREF(kfep_conversion_choice_menu_button_spot,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = 
	    Chain_of_available_kfep_conversion_choice_menu_button_spots;
    SVREF(kfep_conversion_choice_menu_button_spot,FIX((SI_Long)0L)) = 
	    svref_new_value;
    Chain_of_available_kfep_conversion_choice_menu_button_spots = 
	    kfep_conversion_choice_menu_button_spot;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT */
Object reclaim_structure_for_kfep_conversion_choice_menu_button_spot(kfep_conversion_choice_menu_button_spot)
    Object kfep_conversion_choice_menu_button_spot;
{
    x_note_fn_call(126,61);
    return reclaim_kfep_conversion_choice_menu_button_spot_1(kfep_conversion_choice_menu_button_spot);
}

static Object Qg2_defstruct_structure_name_kfep_conversion_choice_menu_button_spot_g2_struct;  /* g2-defstruct-structure-name::kfep-conversion-choice-menu-button-spot-g2-struct */

/* MAKE-PERMANENT-KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT-STRUCTURE-INTERNAL */
Object make_permanent_kfep_conversion_choice_menu_button_spot_structure_internal()
{
    Object def_structure_kfep_conversion_choice_menu_button_spot_variable;
    Object kfep_conversion_choice_menu_button_spot_count_new_value;
    Object defstruct_g2_kfep_conversion_choice_menu_button_spot_variable;
    Object the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,62);
    def_structure_kfep_conversion_choice_menu_button_spot_variable = Nil;
    kfep_conversion_choice_menu_button_spot_count_new_value = 
	    FIXNUM_ADD1(Kfep_conversion_choice_menu_button_spot_count);
    Kfep_conversion_choice_menu_button_spot_count = 
	    kfep_conversion_choice_menu_button_spot_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_kfep_conversion_choice_menu_button_spot_variable = Nil;
	gensymed_symbol = (SI_Long)6L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_kfep_conversion_choice_menu_button_spot_variable = 
		the_array;
	SVREF(defstruct_g2_kfep_conversion_choice_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_kfep_conversion_choice_menu_button_spot_g2_struct;
	SVREF(defstruct_g2_kfep_conversion_choice_menu_button_spot_variable,
		FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_kfep_conversion_choice_menu_button_spot_variable,
		FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_kfep_conversion_choice_menu_button_spot_variable,
		FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_kfep_conversion_choice_menu_button_spot_variable,
		FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_kfep_conversion_choice_menu_button_spot_variable,
		FIX((SI_Long)5L)) = Nil;
	def_structure_kfep_conversion_choice_menu_button_spot_variable = 
		defstruct_g2_kfep_conversion_choice_menu_button_spot_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_kfep_conversion_choice_menu_button_spot_variable);
}

/* MAKE-KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT-1 */
Object make_kfep_conversion_choice_menu_button_spot_1()
{
    Object def_structure_kfep_conversion_choice_menu_button_spot_variable;

    x_note_fn_call(126,63);
    def_structure_kfep_conversion_choice_menu_button_spot_variable = 
	    Chain_of_available_kfep_conversion_choice_menu_button_spots;
    if (def_structure_kfep_conversion_choice_menu_button_spot_variable) {
	Chain_of_available_kfep_conversion_choice_menu_button_spots = 
		ISVREF(def_structure_kfep_conversion_choice_menu_button_spot_variable,
		(SI_Long)0L);
	SVREF(def_structure_kfep_conversion_choice_menu_button_spot_variable,
		FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_kfep_conversion_choice_menu_button_spot_g2_struct;
    }
    else
	def_structure_kfep_conversion_choice_menu_button_spot_variable = 
		make_permanent_kfep_conversion_choice_menu_button_spot_structure_internal();
    inline_note_allocate_cons(def_structure_kfep_conversion_choice_menu_button_spot_variable,
	    Nil);
    SVREF(def_structure_kfep_conversion_choice_menu_button_spot_variable,
	    FIX((SI_Long)1L)) = Nil;
    SVREF(def_structure_kfep_conversion_choice_menu_button_spot_variable,
	    FIX((SI_Long)2L)) = Nil;
    SVREF(def_structure_kfep_conversion_choice_menu_button_spot_variable,
	    FIX((SI_Long)3L)) = T;
    SVREF(def_structure_kfep_conversion_choice_menu_button_spot_variable,
	    FIX((SI_Long)4L)) = Nil;
    SVREF(def_structure_kfep_conversion_choice_menu_button_spot_variable,
	    FIX((SI_Long)5L)) = Nil;
    return VALUES_1(def_structure_kfep_conversion_choice_menu_button_spot_variable);
}

static Object Qeditor_subcommand_button;  /* editor-subcommand-button */

static Object Qeditor_subcommand_disabled_p;  /* editor-subcommand-disabled-p */

static Object Qline_color;         /* line-color */

static Object list_constant;       /* # */

static Object Qbackground_color;   /* background-color */

static Object Qtype_description_of_unique_type_name_of_gensym_structure;  /* type-description-of-unique-type-name-of-gensym-structure */

/* GENERATE-SPOT-FOR-BUTTON-MENU */
Object generate_spot_for_button_menu(suggested_menu_button_spot,
	    button_menu,mouse_pointer)
    Object suggested_menu_button_spot, button_menu, mouse_pointer;
{
    Object table_cell_qm, text_cell_plist_qm, sub_class_bit_vector, s;
    Object gensymed_symbol_3, gensymed_symbol_4;
    SI_Long superior_class_bit_number, sub_class_vector_index, gensymed_symbol;
    SI_Long gensymed_symbol_1, gensymed_symbol_2;
    char temp;

    x_note_fn_call(126,64);
    generate_spot_for_pure_input_table(button_menu,mouse_pointer,
	    make_button_menu_spot_1());
    table_cell_qm = cell_of_table_blackboard_function(mouse_pointer);
    text_cell_plist_qm = text_plist_blackboard_function(mouse_pointer);
    temp =  !TRUEP(table_cell_qm);
    if (temp);
    else if (ATOM(table_cell_qm)) {
	sub_class_bit_vector = ISVREF(ISVREF(table_cell_qm,(SI_Long)1L),
		(SI_Long)19L);
	superior_class_bit_number = 
		IFIX(ISVREF(Icon_cell_class_description,(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_1 = (SI_Long)1L;
	    gensymed_symbol_2 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_1 = gensymed_symbol_1 << gensymed_symbol_2;
	    gensymed_symbol = gensymed_symbol & gensymed_symbol_1;
	    temp = (SI_Long)0L < gensymed_symbol;
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    s = first_subblock(table_cell_qm);
	    if (s) {
		gensymed_symbol_3 = 
			lookup_global_or_kb_specific_property_value(Qeditor_subcommand_button,
			Class_description_gkbprop);
		if (gensymed_symbol_3) {
		    sub_class_bit_vector = ISVREF(ISVREF(s,(SI_Long)1L),
			    (SI_Long)19L);
		    superior_class_bit_number = 
			    IFIX(ISVREF(gensymed_symbol_3,(SI_Long)18L));
		    sub_class_vector_index = superior_class_bit_number >>  
			    -  - (SI_Long)3L;
		    if (sub_class_vector_index < 
			    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				{
			gensymed_symbol = 
				UBYTE_8_ISAREF_1(sub_class_bit_vector,
				sub_class_vector_index);
			gensymed_symbol_1 = (SI_Long)1L;
			gensymed_symbol_2 = superior_class_bit_number & 
				(SI_Long)7L;
			gensymed_symbol_1 = gensymed_symbol_1 << 
				gensymed_symbol_2;
			gensymed_symbol = gensymed_symbol & gensymed_symbol_1;
			temp = (SI_Long)0L < gensymed_symbol;
		    }
		    else
			temp = TRUEP(Nil);
		}
		else
		    temp = TRUEP(Nil);
	    }
	    else
		temp = TRUEP(Nil);
	    temp = temp ? TRUEP(get_slot_value_function(s,
		    Qeditor_subcommand_disabled_p,Nil)) : TRUEP(Nil);
	}
	else
	    temp = TRUEP(Nil);
    }
    else {
	temp =  !TRUEP(text_cell_plist_qm);
	if (temp);
	else
	    temp = memq_function(getf(text_cell_plist_qm,Qline_color,_),
		    list_constant) ? 
		    TRUEP(memq_function(getf(text_cell_plist_qm,
		    Qbackground_color,_),list_constant)) : TRUEP(Qnil);
    }
    if (temp) {
	gensymed_symbol_3 = ISVREF(suggested_menu_button_spot,(SI_Long)0L);
	gensymed_symbol_3 = 
		ISVREF(ISVREF(getfq_function_no_default(INLINE_SYMBOL_PLIST(gensymed_symbol_3),
		Qtype_description_of_unique_type_name_of_gensym_structure),
		(SI_Long)9L),(SI_Long)3L);
	gensymed_symbol_4 = suggested_menu_button_spot;
	inline_funcall_1(gensymed_symbol_3,gensymed_symbol_4);
	return push_last_spot(mouse_pointer,
		make_workspace_background_spot_1(),Nil);
    }
    else
	return push_last_spot(mouse_pointer,suggested_menu_button_spot,
		button_menu);
}

Object Override_preferred_editor = UNBOUND;

static Object Qprefer_native_editor;  /* prefer-native-editor */

static Object Qnative;             /* native */

/* PUT-PREFERRED-EDITOR-WHERE-SLOT-IS-ABSENT */
Object put_preferred_editor_where_slot_is_absent(editor_parameters,value)
    Object editor_parameters, value;
{
    Declare_special(1);
    Object result;

    x_note_fn_call(126,65);
    PUSH_SPECIAL(Editor_parameters,editor_parameters,0);
      change_slot_value(3,Editor_parameters,Qprefer_native_editor,EQ(value,
	      Qnative) ? T : Nil);
      result = VALUES_1(Nil);
    POP_SPECIAL();
    return result;
}

static Object Qclassic;            /* classic */

/* PREFER-NATIVE-EDITOR-P */
Object prefer_native_editor_p(gensym_window)
    Object gensym_window;
{
    x_note_fn_call(126,66);
    if (EQ(Override_preferred_editor,Qclassic))
	return VALUES_1(Nil);
    else if (EQ(Override_preferred_editor,Qnative))
	return VALUES_1(T);
    else
	return VALUES_1(ISVREF(Editor_parameters,(SI_Long)38L));
}

/* COMPILE-ATTRIBUTES-TO-EDIT-USING-MULTILINE-EDITOR-FOR-SLOT */
Object compile_attributes_to_edit_using_multiline_editor_for_slot varargs_1(int, n)
{
    Object parse_result, gensymed_symbol, gensymed_symbol_1;
    Declare_varargs_nonrelocating;

    x_note_fn_call(126,67);
    INIT_ARGS_nonrelocating();
    parse_result = REQUIRED_ARG_nonrelocating();
    gensymed_symbol = REQUIRED_ARG_nonrelocating();
    gensymed_symbol_1 = REQUIRED_ARG_nonrelocating();
    if (OPTIONAL_ARG_P_nonrelocating())
	OPTIONAL_ARG_nonrelocating();
    if (OPTIONAL_ARG_P_nonrelocating())
	OPTIONAL_ARG_nonrelocating();
    if (OPTIONAL_ARG_P_nonrelocating())
	OPTIONAL_ARG_nonrelocating();
    END_ARGS_nonrelocating();
    simplify_associative_list_operation_all_at_once(parse_result);
    return VALUES_1(CDR(parse_result));
}

static Object Qcm;                 /* \, */

static Object Qnone;               /* none */

/* WRITE-ATTRIBUTES-TO-EDIT-USING-MULTILINE-EDITOR-FROM-SLOT */
Object write_attributes_to_edit_using_multiline_editor_from_slot(value,
	    gensymed_symbol)
    Object value, gensymed_symbol;
{
    x_note_fn_call(126,68);
    return write_symbol_list(4,value,Qcm,Nil,Qnone);
}

static Object Qedit_workspace;     /* edit-workspace */

static Object Qediting;            /* editing */

/* CLEANUP-FOR-EDIT-WORKSPACE */
Object cleanup_for_edit_workspace(edit_workspace)
    Object edit_workspace;
{
    Object frame, sub_vector_qm, method_function_qm, workstation;
    Object ab_loop_list_, workstation_context, ab_loop_list__1, edit_state_qm;
    Object frame_being_edited_qm, serial_number_of_frame_being_edited_qm;
    Object gensymed_symbol, xa, ya;
    SI_Long index_1, ab_loop_bind_;
    char temp;

    x_note_fn_call(126,69);
    frame = edit_workspace;
    sub_vector_qm = ISVREF(ISVREF(ISVREF(frame,(SI_Long)1L),(SI_Long)11L),
	    (SI_Long)1L);
    index_1 = (SI_Long)0L;
    ab_loop_bind_ = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_vector_qm)) - 
	    (SI_Long)3L;
  next_loop:
    if (index_1 >= ab_loop_bind_)
	goto end_loop;
    if (EQ(ISVREF(sub_vector_qm,index_1),Qedit_workspace)) {
	method_function_qm = ISVREF(sub_vector_qm,index_1 + (SI_Long)3L);
	goto end_1;
    }
    index_1 = index_1 + (SI_Long)2L;
    goto next_loop;
  end_loop:
    method_function_qm = Qnil;
  end_1:;
    if (method_function_qm)
	inline_funcall_1(method_function_qm,frame);
    workstation = Nil;
    ab_loop_list_ = Workstations_in_service;
  next_loop_1:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop_1;
    workstation = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    workstation_context = Nil;
    ab_loop_list__1 = ISVREF(workstation,(SI_Long)17L);
    edit_state_qm = Nil;
  next_loop_2:
    if ( !TRUEP(ab_loop_list__1))
	goto end_loop_2;
    workstation_context = M_CAR(ab_loop_list__1);
    ab_loop_list__1 = M_CDR(ab_loop_list__1);
    edit_state_qm = EQ(ISVREF(workstation_context,(SI_Long)1L),Qediting) ? 
	    ISVREF(workstation_context,(SI_Long)2L) : Nil;
    if (edit_state_qm && EQ(ISVREF(edit_state_qm,(SI_Long)12L),
		edit_workspace)) {
	frame_being_edited_qm = ISVREF(edit_state_qm,(SI_Long)3L);
	serial_number_of_frame_being_edited_qm = ISVREF(edit_state_qm,
		(SI_Long)4L);
	temp =  !TRUEP(frame_being_edited_qm);
	if (temp);
	else {
	    gensymed_symbol = ISVREF(frame_being_edited_qm,(SI_Long)3L);
	    temp = SIMPLE_VECTOR_P(frame_being_edited_qm) ? 
		    EQ(ISVREF(frame_being_edited_qm,(SI_Long)1L),
		    Qavailable_frame_vector) : TRUEP(Qnil);
	    if (temp);
	    else
		temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
			(SI_Long)-1L : TRUEP(Nil);
	    if (temp);
	    else if (FIXNUMP(serial_number_of_frame_being_edited_qm))
		temp = FIXNUMP(gensymed_symbol) ? 
			FIXNUM_LT(serial_number_of_frame_being_edited_qm,
			gensymed_symbol) : TRUEP(T);
	    else if (FIXNUMP(gensymed_symbol))
		temp = TRUEP(Nil);
	    else {
		xa = M_CAR(serial_number_of_frame_being_edited_qm);
		ya = M_CAR(gensymed_symbol);
		temp = FIXNUM_LT(xa,ya);
		if (temp);
		else
		    temp = FIXNUM_EQ(xa,ya) ? 
			    FIXNUM_LT(M_CDR(serial_number_of_frame_being_edited_qm),
			    M_CDR(gensymed_symbol)) : TRUEP(Qnil);
	    }
	}
	if ( !temp)
	    highlight_or_unhighlight_for_slot(8,frame_being_edited_qm,
		    ISVREF(edit_state_qm,(SI_Long)5L),ISVREF(edit_state_qm,
		    (SI_Long)6L),Nil,T,Nil,ISVREF(edit_state_qm,
		    (SI_Long)7L),ISVREF(edit_state_qm,(SI_Long)8L));
    }
    goto next_loop_2;
  end_loop_2:;
    goto next_loop_1;
  end_loop_1:
    return VALUES_1(Qnil);
}

Object Chain_of_recycled_edit_states = UNBOUND;

Object Tokenizer_for_category_prop = UNBOUND;

Object Default_tokenizer = UNBOUND;

static Object Qtokenizer_for_category;  /* tokenizer-for-category */

/* GET-TOKENIZER-FOR-CATEGORY */
Object get_tokenizer_for_category(top_level_grammar_category)
    Object top_level_grammar_category;
{
    Object temp;

    x_note_fn_call(126,70);
    temp = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(top_level_grammar_category),
	    Qtokenizer_for_category);
    if (temp);
    else
	temp = Default_tokenizer;
    return VALUES_1(temp);
}

Object Java_tokenizer = UNBOUND;

static Object Qgeneric_file_pathname;  /* generic-file-pathname */

static Object list_constant_1;     /* # */

/* DETERMINE-APPROPRIATE-TOKENIZER */
Object determine_appropriate_tokenizer()
{
    Object temp, type_of_slot;

    x_note_fn_call(126,71);
    if (Current_edit_state) {
	temp = ISVREF(Current_edit_state,(SI_Long)9L);
	type_of_slot = CADR(temp);
	temp = java_editing_category_p(type_of_slot) ? Java_tokenizer : Nil;
	if (temp);
	else if (EQ(type_of_slot,Qgeneric_file_pathname))
	    temp = G2_load_kb_tokenizer;
	else if (member_eql(type_of_slot,list_constant_1))
	    temp = G2_simple_tokenizer;
	else
	    temp = G2_standard_tokenizer;
    }
    else
	temp = G2_standard_tokenizer;
    return VALUES_1(temp);
}

static Object array_constant;      /* # */

/* TWRITE-EDIT-BACKTRACE-INFO */
Object twrite_edit_backtrace_info()
{
    Object temp, index_of_top_of_backtrace_stack_new_value;

    x_note_fn_call(126,72);
    twrite_beginning_of_wide_string(array_constant,FIX((SI_Long)8L));
    if (IFIX(Index_of_top_of_backtrace_stack) < (SI_Long)0L)
	temp = Nil;
    else {
	temp = ISVREF(Backtrace_stack_for_internal_error,
		IFIX(Index_of_top_of_backtrace_stack));
	index_of_top_of_backtrace_stack_new_value = 
		FIXNUM_SUB1(Index_of_top_of_backtrace_stack);
	Index_of_top_of_backtrace_stack = 
		index_of_top_of_backtrace_stack_new_value;
    }
    return twrite_symbol(1,temp);
}

Object Editor_specific_natural_language_override_qm = UNBOUND;

Object Editor_frame_style_override_qm = UNBOUND;

Object Editor_background_color_override_qm = UNBOUND;

Object Editor_text_color_override_qm = UNBOUND;

Object Editor_font_size_override_qm = UNBOUND;

Object Editor_initial_editor_height_override_qm = UNBOUND;

Object Editor_caption_text_override_qm = UNBOUND;

Object Editor_prompt_filter_qm = UNBOUND;

static Object Qedit;               /* edit */

static Object Qtwrite_edit_backtrace_info;  /* twrite-edit-backtrace-info */

static Object Qtext_editor;        /* text-editor */

static Object Qvirtual_attribute;  /* virtual-attribute */

static Object Qimage_data;         /* image-data */

static Object Qmedia_bin_data;     /* media-bin-data */

static Object Quuid;               /* uuid */

static Object list_constant_2;     /* # */

static Object list_constant_3;     /* # */

static Object list_constant_4;     /* # */

static Object Qg2_defstruct_structure_name_class_description_g2_struct;  /* g2-defstruct-structure-name::class-description-g2-struct */

static Object Qtitle_bar_caption_text;  /* title-bar-caption-text */

static Object Qframe_style;        /* frame-style */

static Object Qworkspace_background_color_qm;  /* workspace-background-color? */

static Object Qfont_for_editing;   /* font-for-editing */

static Object Qsmall;              /* small */

static Object Qsmall_edit_cursor;  /* small-edit-cursor */

static Object Qedit_cursor;        /* edit-cursor */

static Object Qno_native_clipboard;  /* no-native-clipboard */

static Object Qmenus_for_this;     /* menus-for-this */

static Object Qwhat_this_is_a_menu_for_qm;  /* what-this-is-a-menu-for? */

static Object Qfree;               /* free */

static Object Qfree_text_attribute;  /* free-text-attribute */

/* ENTER-EDITING-CONTEXT */
Object enter_editing_context varargs_1(int, n)
{
    Object frame_qm, slot_denotation;
    Object initial_text_or_edit_box_qm, edit_workspace_hidden_qm;
    Object edit_box_format_or_format_name_qm, width_for_cell_qm;
    Object cursor_line_index_qm, cursor_character_index_qm;
    Object specific_image_plane_on_which_to_edit_in_place_qm;
    Object specific_text_box_or_table_on_which_to_edit_in_place_qm;
    Object left_edge_of_cell_in_table_on_which_to_edit_in_place_qm;
    Object top_edge_of_cell_in_table_on_which_to_edit_in_place_qm;
    Object right_edge_of_cell_in_table_on_which_to_edit_in_place_qm;
    Object bottom_edge_of_cell_in_table_on_which_to_edit_in_place_qm;
    Object type_of_slot_qm, special_entry_context_qm;
    Object function_to_call_on_changed_edit_box_text_qm;
    Object do_not_have_edit_option_buttons_qm, do_not_have_edit_menus_qm;
    Object slot_component_name_qm, slot_component_indicator_qm, table_qm;
    Object attribute_is_virtual_qm, use_exported_format_qm, modal, size_x;
    Object size_y, pos_x, pos_y, defining_class_qm, temp, slot_name;
    Object index_of_top_of_backtrace_stack, old_top_of_stack;
    Object elements_to_push_qm, temp_1, stored_elements_to_push, index_1;
    Object elements_to_push_qm_old_value, info_symbol, twrite_function_qm;
    Object number_of_args, svref_arg_2, slot_description_qm;
    Object virtual_attribute_qm, type_of_slot, es, edit_state;
    Object current_edit_state, slot_value, x2, initial_text_qm;
    Object minimum_edit_box_width_qm, gensymed_symbol;
    Object minimum_or_desired_edit_box_height_qm, temp_3, temp_4;
    Object edit_workspace, caption_text, current_edit_workspace;
    Object edit_workspace_margin, edit_box, gensymed_symbol_3;
    Object gensymed_symbol_4, text_being_edited, edit_cursor;
    Object edit_subcommand_menu_qm, frame_serial_number_setf_arg, old, new_1;
    Object sub_class_bit_vector;
    SI_Long gensymed_symbol_1, gensymed_symbol_2;
    SI_Long edit_workspace_inside_left_edge, edit_workspace_inside_top_edge;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_5;
    char temp_2;
    Declare_varargs_nonrelocating;
    Declare_stack_pointer;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,73);
    INIT_ARGS_nonrelocating();
    frame_qm = REQUIRED_ARG_nonrelocating();
    slot_denotation = REQUIRED_ARG_nonrelocating();
    SAVE_STACK();
    initial_text_or_edit_box_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    edit_workspace_hidden_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    edit_box_format_or_format_name_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    width_for_cell_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    cursor_line_index_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    cursor_character_index_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    specific_image_plane_on_which_to_edit_in_place_qm = 
	    OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    specific_text_box_or_table_on_which_to_edit_in_place_qm = 
	    OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    left_edge_of_cell_in_table_on_which_to_edit_in_place_qm = 
	    OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    top_edge_of_cell_in_table_on_which_to_edit_in_place_qm = 
	    OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    right_edge_of_cell_in_table_on_which_to_edit_in_place_qm = 
	    OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    bottom_edge_of_cell_in_table_on_which_to_edit_in_place_qm = 
	    OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    type_of_slot_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    special_entry_context_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    function_to_call_on_changed_edit_box_text_qm = 
	    OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    do_not_have_edit_option_buttons_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    do_not_have_edit_menus_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    slot_component_name_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    slot_component_indicator_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    table_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    attribute_is_virtual_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    use_exported_format_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    modal = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    size_x = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() 
	    : Nil;
    size_y = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() 
	    : Nil;
    pos_x = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    pos_y = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    defining_class_qm = CONSP(slot_denotation) ? 
	    M_CAR(M_CDR(slot_denotation)) : Nil;
    temp = CONSP(slot_denotation) ? M_CAR(M_CDR(M_CDR(slot_denotation))) : 
	    slot_denotation;
    reclaim_slot_value(slot_denotation);
    slot_denotation = Nil;
    slot_name = temp;
    END_ARGS_nonrelocating();
    index_of_top_of_backtrace_stack = Index_of_top_of_backtrace_stack;
    PUSH_SPECIAL(Index_of_top_of_backtrace_stack,index_of_top_of_backtrace_stack,
	    2);
      if (FIXNUM_LE(FIXNUM_ADD(Index_of_top_of_backtrace_stack,
	      Size_of_basic_backtrace_information),
	      Maximum_index_in_backtrace_stack_for_internal_error)) {
	  old_top_of_stack = Index_of_top_of_backtrace_stack;
	  elements_to_push_qm = Nil;
	  temp_1 = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
	  Index_of_top_of_backtrace_stack = temp_1;
	  elements_to_push_qm = gensym_cons_1(slot_name,elements_to_push_qm);
	  if (FIXNUM_LE(FIXNUM_ADD(Index_of_top_of_backtrace_stack,
		  Size_of_basic_backtrace_information),
		  Maximum_index_in_backtrace_stack_for_internal_error)) {
	      stored_elements_to_push = elements_to_push_qm;
	      index_1 = Index_of_top_of_backtrace_stack;
	    next_loop:
	      if ( !TRUEP(elements_to_push_qm))
		  goto end_loop;
	      temp_1 = Backtrace_stack_for_internal_error;
	      elements_to_push_qm_old_value = elements_to_push_qm;
	      temp = FIRST(elements_to_push_qm_old_value);
	      elements_to_push_qm = REST(elements_to_push_qm_old_value);
	      SVREF(temp_1,index_1) = temp;
	      index_1 = FIXNUM_SUB1(index_1);
	      goto next_loop;
	    end_loop:;
	      reclaim_gensym_list_1(stored_elements_to_push);
	      info_symbol = Qedit;
	      twrite_function_qm = Qtwrite_edit_backtrace_info;
	      number_of_args = 
		      FIXNUM_MINUS(Index_of_top_of_backtrace_stack,
		      old_top_of_stack);
	      temp_1 = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
	      Index_of_top_of_backtrace_stack = temp_1;
	      temp_1 = Backtrace_stack_for_internal_error;
	      svref_arg_2 = Index_of_top_of_backtrace_stack;
	      SVREF(temp_1,svref_arg_2) = number_of_args;
	      temp_1 = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
	      Index_of_top_of_backtrace_stack = temp_1;
	      temp_1 = Backtrace_stack_for_internal_error;
	      svref_arg_2 = Index_of_top_of_backtrace_stack;
	      SVREF(temp_1,svref_arg_2) = twrite_function_qm;
	      temp_1 = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
	      Index_of_top_of_backtrace_stack = temp_1;
	      temp_1 = Backtrace_stack_for_internal_error;
	      svref_arg_2 = Index_of_top_of_backtrace_stack;
	      SVREF(temp_1,svref_arg_2) = info_symbol;
	  }
	  else {
	      Index_of_top_of_backtrace_stack = old_top_of_stack;
	      temp_1 = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
	      Index_of_top_of_backtrace_stack = temp_1;
	      temp_1 = Backtrace_stack_for_internal_error;
	      svref_arg_2 = Index_of_top_of_backtrace_stack;
	      SVREF(temp_1,svref_arg_2) = FIX((SI_Long)0L);
	      temp_1 = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
	      Index_of_top_of_backtrace_stack = temp_1;
	      temp_1 = Backtrace_stack_for_internal_error;
	      svref_arg_2 = Index_of_top_of_backtrace_stack;
	      SVREF(temp_1,svref_arg_2) = Nil;
	      temp_1 = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
	      Index_of_top_of_backtrace_stack = temp_1;
	      temp_1 = Backtrace_stack_for_internal_error;
	      svref_arg_2 = Index_of_top_of_backtrace_stack;
	      SVREF(temp_1,svref_arg_2) = Qedit;
	  }
      }
      push_item_to_end_of_current_localization_domains(Qtext_editor);
      slot_description_qm = frame_qm &&  !TRUEP(attribute_is_virtual_qm) ? 
	      get_slot_description_of_class_description_function(slot_name,
	      ISVREF(frame_qm,(SI_Long)1L),defining_class_qm) : Nil;
      virtual_attribute_qm = attribute_is_virtual_qm ? 
	      get_property_value_function(3,
	      get_symbol_properties_function(slot_name),Qvirtual_attribute,
	      Nil) : Nil;
      type_of_slot = type_of_slot_qm;
      if (type_of_slot);
      else
	  type_of_slot = frame_qm ? ((slot_component_name_qm || 
		  slot_description_qm) &&  !TRUEP(use_exported_format_qm) ?
		   assq_function(Qtype,slot_component_name_qm ? 
		  get_slot_component_features(slot_name,defining_class_qm,
		  slot_component_name_qm) : ISVREF(slot_description_qm,
		  (SI_Long)9L)) : virtual_attribute_qm || 
		  use_exported_format_qm ? ((virtual_attribute_qm ? 
		  EQ(slot_name,Qimage_data) || EQ(slot_name,
		  Qmedia_bin_data) : EQ(slot_name,Quuid)) ? 
		  list_constant_2 : list_constant_3) : Nil) : list_constant_4;
      es = make_edit_state_1();
      SVREF(es,FIX((SI_Long)3L)) = frame_qm;
      SVREF(es,FIX((SI_Long)5L)) = slot_name;
      SVREF(es,FIX((SI_Long)9L)) = type_of_slot;
      temp_1 = get_tokenizer_for_category(CADR(type_of_slot));
      SVREF(es,FIX((SI_Long)10L)) = temp_1;
      temp_1 = should_this_editor_state_scroll_qm(es);
      SVREF(es,FIX((SI_Long)68L)) = temp_1;
      temp_1 = 
	      get_natural_language_for_editor(Editor_specific_natural_language_override_qm);
      SVREF(es,FIX((SI_Long)78L)) = temp_1;
      temp_1 = Editor_specific_natural_language_override_qm;
      if (temp_1);
      else
	  temp_1 = current_natural_language_for_editor();
      SVREF(es,FIX((SI_Long)45L)) = temp_1;
      temp_1 = Editor_frame_style_override_qm;
      SVREF(es,FIX((SI_Long)79L)) = temp_1;
      temp_1 = Editor_background_color_override_qm;
      SVREF(es,FIX((SI_Long)80L)) = temp_1;
      temp_1 = Editor_text_color_override_qm;
      SVREF(es,FIX((SI_Long)81L)) = temp_1;
      temp_1 = Editor_font_size_override_qm;
      SVREF(es,FIX((SI_Long)84L)) = temp_1;
      temp_1 = Editor_initial_editor_height_override_qm;
      SVREF(es,FIX((SI_Long)85L)) = temp_1;
      if (Generate_source_annotation_info) {
	  temp_1 = make_sexp_annotation_hash();
	  SVREF(es,FIX((SI_Long)90L)) = temp_1;
      }
      SVREF(es,FIX((SI_Long)92L)) = table_qm;
      temp_1 = table_qm ? copy_frame_serial_number(ISVREF(table_qm,
	      (SI_Long)3L)) : Nil;
      SVREF(es,FIX((SI_Long)93L)) = temp_1;
      SVREF(es,FIX((SI_Long)94L)) = attribute_is_virtual_qm;
      SVREF(es,FIX((SI_Long)95L)) = use_exported_format_qm;
      temp_1 = edit_workspace_hidden_qm;
      if (temp_1);
      else
	  temp_1 = Keep_edit_workspace_hidden_no_matter_what_qm;
      SVREF(es,FIX((SI_Long)96L)) = temp_1;
      temp_1 = Editor_prompt_filter_qm;
      SVREF(es,FIX((SI_Long)99L)) = temp_1;
      edit_state = es;
      current_edit_state = edit_state;
      PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
	if ( !TRUEP(frame_qm))
	    slot_value = Nil;
	else if (slot_component_name_qm)
	    slot_value = get_slot_component_value(frame_qm,slot_name,
		    defining_class_qm,slot_component_name_qm,
		    slot_component_indicator_qm);
	else if (slot_description_qm)
	    slot_value = use_exported_format_qm ? 
		    get_attribute_description_evaluation_value(frame_qm,
		    slot_description_qm) : 
		    get_slot_description_value(frame_qm,slot_description_qm);
	else if (virtual_attribute_qm)
	    slot_value = 
		    get_attribute_description_evaluation_value(frame_qm,
		    virtual_attribute_qm);
	else
	    slot_value = Qnil;
	if (SIMPLE_VECTOR_P(initial_text_or_edit_box_qm) && 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(initial_text_or_edit_box_qm)) 
		> (SI_Long)2L &&  !EQ(ISVREF(initial_text_or_edit_box_qm,
		(SI_Long)1L),Qavailable_frame_vector)) {
	    x2 = ISVREF(initial_text_or_edit_box_qm,(SI_Long)1L);
	    temp_2 = SIMPLE_VECTOR_P(x2) && EQ(ISVREF(x2,(SI_Long)0L),
		    Qg2_defstruct_structure_name_class_description_g2_struct) 
		    ? TRUEP(x2) : TRUEP(Qnil);
	}
	else
	    temp_2 = TRUEP(Nil);
	if (temp_2)
	    initial_text_qm = Nil;
	else if (intercepted_text_p(initial_text_or_edit_box_qm))
	    initial_text_qm = initial_text_or_edit_box_qm;
	else if ( !TRUEP(edit_workspace_hidden_qm) && frame_qm &&  
		!TRUEP(slot_value)) {
	    if (initial_text_or_edit_box_qm)
		reclaim_text(initial_text_or_edit_box_qm);
	    cursor_line_index_qm = Nil;
	    cursor_character_index_qm = Nil;
	    initial_text_qm = make_empty_text();
	}
	else {
	    initial_text_qm = initial_text_or_edit_box_qm;
	    if (initial_text_qm);
	    else
		initial_text_qm = frame_qm ? (virtual_attribute_qm || 
			use_exported_format_qm ? 
			text_for_item_or_value(slot_value) : 
			make_text_representation_for_slot_value_itself(frame_qm,
			slot_value,type_of_slot)) : Nil;
	    if (initial_text_qm);
	    else
		initial_text_qm = make_empty_text();
	}
	if (specific_image_plane_on_which_to_edit_in_place_qm) {
	    if (left_edge_of_cell_in_table_on_which_to_edit_in_place_qm)
		minimum_edit_box_width_qm = 
			FIXNUM_MINUS(right_edge_of_cell_in_table_on_which_to_edit_in_place_qm,
			left_edge_of_cell_in_table_on_which_to_edit_in_place_qm);
	    else {
		gensymed_symbol = 
			ISVREF(specific_text_box_or_table_on_which_to_edit_in_place_qm,
			(SI_Long)14L);
		gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
			(SI_Long)2L) : FIX((SI_Long)0L);
		gensymed_symbol_1 = IFIX(gensymed_symbol);
		gensymed_symbol = 
			ISVREF(specific_text_box_or_table_on_which_to_edit_in_place_qm,
			(SI_Long)14L);
		gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
			(SI_Long)0L) : FIX((SI_Long)0L);
		gensymed_symbol_2 = IFIX(gensymed_symbol);
		minimum_edit_box_width_qm = FIX(gensymed_symbol_1 - 
			gensymed_symbol_2);
	    }
	}
	else
	    minimum_edit_box_width_qm = Nil;
	minimum_or_desired_edit_box_height_qm = 
		Editor_initial_editor_height_override_qm;
	if (minimum_or_desired_edit_box_height_qm);
	else if (specific_image_plane_on_which_to_edit_in_place_qm) {
	    if (left_edge_of_cell_in_table_on_which_to_edit_in_place_qm)
		minimum_or_desired_edit_box_height_qm = 
			FIXNUM_MINUS(bottom_edge_of_cell_in_table_on_which_to_edit_in_place_qm,
			top_edge_of_cell_in_table_on_which_to_edit_in_place_qm);
	    else {
		gensymed_symbol = 
			ISVREF(specific_text_box_or_table_on_which_to_edit_in_place_qm,
			(SI_Long)14L);
		gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
			(SI_Long)3L) : FIX((SI_Long)0L);
		gensymed_symbol_1 = IFIX(gensymed_symbol);
		gensymed_symbol = 
			ISVREF(specific_text_box_or_table_on_which_to_edit_in_place_qm,
			(SI_Long)14L);
		gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
			(SI_Long)1L) : FIX((SI_Long)0L);
		gensymed_symbol_2 = IFIX(gensymed_symbol);
		minimum_or_desired_edit_box_height_qm = 
			FIX(gensymed_symbol_1 - gensymed_symbol_2);
	    }
	}
	else
	    minimum_or_desired_edit_box_height_qm = Nil;
	if (specific_image_plane_on_which_to_edit_in_place_qm) {
	    temp_3 =  !TRUEP(ISVREF(edit_state,(SI_Long)68L)) && 
		    do_not_have_edit_option_buttons_qm && 
		    do_not_have_edit_menus_qm ? FIX((SI_Long)0L) : 
		    FIX((SI_Long)5L);
	    temp_4 = minimum_edit_box_width_qm;
	    if (temp_4);
	    else
		temp_4 = FIX((SI_Long)0L);
	    temp = minimum_or_desired_edit_box_height_qm;
	    if (temp);
	    else
		temp = FIX((SI_Long)0L);
	    edit_workspace = make_workspace(6,Qedit_workspace,Nil,Nil,
		    temp_3,temp_4,temp);
	}
	else
	    edit_workspace = make_workspace(6,Qedit_workspace,Nil,Nil,Nil,
		    FIX((SI_Long)200L),FIX((SI_Long)200L));
	if (New_g2_classic_ui_p) {
	    caption_text = make_caption_text_for_edit_workspace(4,frame_qm,
		    slot_name,slot_component_name_qm,
		    slot_component_indicator_qm);
	    change_slot_value(3,edit_workspace,Qtitle_bar_caption_text,
		    caption_text);
	}
	if (ISVREF(edit_state,(SI_Long)79L))
	    change_slot_value(3,edit_workspace,Qframe_style,
		    ISVREF(edit_state,(SI_Long)79L));
	if (ISVREF(edit_state,(SI_Long)80L) && 
		color_or_metacolor_p(ISVREF(edit_state,(SI_Long)80L)))
	    change_slot_value(3,edit_workspace,
		    Qworkspace_background_color_qm,ISVREF(edit_state,
		    (SI_Long)80L));
	current_edit_workspace = edit_workspace;
	PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	  edit_workspace_margin = ISVREF(Current_edit_workspace,(SI_Long)17L);
	  gensymed_symbol = ISVREF(Current_edit_workspace,(SI_Long)14L);
	  gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		  (SI_Long)0L) : FIX((SI_Long)0L);
	  gensymed_symbol_1 = IFIX(gensymed_symbol);
	  gensymed_symbol_2 = IFIX(edit_workspace_margin);
	  edit_workspace_inside_left_edge = gensymed_symbol_1 + 
		  gensymed_symbol_2;
	  gensymed_symbol = ISVREF(Current_edit_workspace,(SI_Long)14L);
	  gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		  (SI_Long)1L) : FIX((SI_Long)0L);
	  gensymed_symbol_1 = IFIX(gensymed_symbol);
	  gensymed_symbol_2 = IFIX(edit_workspace_margin);
	  edit_workspace_inside_top_edge = gensymed_symbol_1 + 
		  gensymed_symbol_2;
	  if (ISVREF(edit_state,(SI_Long)68L)) {
	      if ( !TRUEP(cursor_line_index_qm)) {
		  cursor_line_index_qm = FIX((SI_Long)1L);
		  cursor_character_index_qm = FIX((SI_Long)0L);
	      }
	  }
	  if (initial_text_or_edit_box_qm && ATOM(initial_text_or_edit_box_qm))
	      edit_box = initial_text_or_edit_box_qm;
	  else {
	      result = make_edit_box(initial_text_qm,T,
		      edit_box_format_or_format_name_qm,Nil,
		      cursor_line_index_qm,cursor_character_index_qm,
		      minimum_edit_box_width_qm,
		      minimum_or_desired_edit_box_height_qm,
		      ISVREF(edit_state,(SI_Long)68L));
	      MVS_3(result,gensymed_symbol,gensymed_symbol_3,
		      gensymed_symbol_4);
	      cursor_character_index_qm = gensymed_symbol_4;
	      cursor_line_index_qm = gensymed_symbol_3;
	      edit_box = gensymed_symbol;
	  }
	  if (ISVREF(edit_state,(SI_Long)81L) && 
		  color_or_metacolor_p(ISVREF(edit_state,(SI_Long)81L)))
	      change_color_of_text_box(5,edit_box,Nil,Nil,Nil,
		      ISVREF(edit_state,(SI_Long)81L));
	  temp = ISVREF(edit_box,(SI_Long)16L);
	  text_being_edited = CDR(temp);
	  temp = ISVREF(Current_edit_state,(SI_Long)84L);
	  if (temp);
	  else
	      temp = New_g2_classic_ui_p ? get_ui_parameter(1,
		      Qfont_for_editing) : ISVREF(Fonts,(SI_Long)25L);
	  edit_cursor = make_entity(1,EQ(temp,Qsmall) ? Qsmall_edit_cursor 
		  : Qedit_cursor);
	  edit_subcommand_menu_qm =  
		  !TRUEP(do_not_have_edit_option_buttons_qm) ? 
		  make_edit_subcommand_menu() : Nil;
	  if ( !TRUEP(edit_workspace_hidden_qm)) {
	      if (FIXNUM_LT(Icp_window_protocol_supports_request_for_paste_availability,
		      ISVREF(Current_workstation_window,(SI_Long)11L)) &&  
		      !TRUEP(get_gensym_window_parameter(Current_workstation_window,
		      Qno_native_clipboard)))
		  request_paste_availability_for_editor();
	  }
	  frame_serial_number_setf_arg = frame_qm ? ISVREF(frame_qm,
		  (SI_Long)3L) : Nil;
	  old = ISVREF(edit_state,(SI_Long)4L);
	  new_1 = frame_serial_number_setf_arg;
	  temp_1 = (FIXNUMP(old) ||  !TRUEP(old)) && (FIXNUMP(new_1) ||  
		  !TRUEP(new_1)) ? new_1 : 
		  frame_serial_number_setf_helper_1(old,new_1);
	  SVREF(edit_state,FIX((SI_Long)4L)) = temp_1;
	  if (frame_qm) {
	      sub_class_bit_vector = ISVREF(ISVREF(frame_qm,(SI_Long)1L),
		      (SI_Long)19L);
	      superior_class_bit_number = 
		      IFIX(ISVREF(Block_class_description,(SI_Long)18L));
	      sub_class_vector_index = superior_class_bit_number >>  -  - 
		      (SI_Long)3L;
	      if (sub_class_vector_index < 
		      IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
		  gensymed_symbol_1 = 
			  UBYTE_8_ISAREF_1(sub_class_bit_vector,
			  sub_class_vector_index);
		  gensymed_symbol_2 = (SI_Long)1L;
		  gensymed_symbol_5 = superior_class_bit_number & (SI_Long)7L;
		  gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_5;
		  gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
		  temp_2 = (SI_Long)0L < gensymed_symbol_1;
	      }
	      else
		  temp_2 = TRUEP(Nil);
	  }
	  else
	      temp_2 = TRUEP(Nil);
	  if (temp_2) {
	      temp = Current_edit_workspace;
	      set_non_savable_lookup_slot_value(frame_qm,Qmenus_for_this,
		      gensym_cons_1(temp,
		      get_lookup_slot_value_given_default(frame_qm,
		      Qmenus_for_this,Nil)));
	      set_non_savable_lookup_slot_value(Current_edit_workspace,
		      Qwhat_this_is_a_menu_for_qm,frame_qm);
	  }
	  SVREF(edit_state,FIX((SI_Long)6L)) = defining_class_qm;
	  SVREF(edit_state,FIX((SI_Long)7L)) = slot_component_name_qm;
	  SVREF(edit_state,FIX((SI_Long)8L)) = slot_component_indicator_qm;
	  temp_1 = EQ(CADR(type_of_slot),Qfree) ? T : Nil;
	  if (temp_1);
	  else
	      temp_1 = EQ(CADR(type_of_slot),Qfree_text_attribute) ? T : Nil;
	  SVREF(edit_state,FIX((SI_Long)11L)) = temp_1;
	  temp_1 = Current_edit_workspace;
	  SVREF(edit_state,FIX((SI_Long)12L)) = temp_1;
	  frame_serial_number_setf_arg = ISVREF(Current_edit_workspace,
		  (SI_Long)3L);
	  old = ISVREF(edit_state,(SI_Long)2L);
	  new_1 = frame_serial_number_setf_arg;
	  temp_1 = (FIXNUMP(old) ||  !TRUEP(old)) && (FIXNUMP(new_1) ||  
		  !TRUEP(new_1)) ? new_1 : 
		  frame_serial_number_setf_helper_1(old,new_1);
	  SVREF(edit_state,FIX((SI_Long)2L)) = temp_1;
	  SVREF(edit_state,FIX((SI_Long)13L)) = edit_box;
	  SVREF(edit_state,FIX((SI_Long)14L)) = edit_cursor;
	  add_subblock(edit_cursor,edit_box);
	  if (edit_subcommand_menu_qm) {
	      SVREF(edit_state,FIX((SI_Long)43L)) = edit_subcommand_menu_qm;
	      add_to_workspace(4,edit_subcommand_menu_qm,
		      Current_edit_workspace,
		      FIX(edit_workspace_inside_left_edge),
		      FIX(edit_workspace_inside_top_edge));
	  }
	  SVREF(edit_state,FIX((SI_Long)58L)) = do_not_have_edit_menus_qm;
	  SVREF(edit_state,FIX((SI_Long)15L)) = text_being_edited;
	  SVREF(edit_state,FIX((SI_Long)16L)) = 
		  specific_image_plane_on_which_to_edit_in_place_qm;
	  SVREF(edit_state,FIX((SI_Long)17L)) = 
		  specific_text_box_or_table_on_which_to_edit_in_place_qm;
	  SVREF(edit_state,FIX((SI_Long)19L)) = 
		  top_edge_of_cell_in_table_on_which_to_edit_in_place_qm;
	  SVREF(edit_state,FIX((SI_Long)18L)) = 
		  left_edge_of_cell_in_table_on_which_to_edit_in_place_qm;
	  SVREF(edit_state,FIX((SI_Long)20L)) = 
		  right_edge_of_cell_in_table_on_which_to_edit_in_place_qm;
	  SVREF(edit_state,FIX((SI_Long)21L)) = 
		  bottom_edge_of_cell_in_table_on_which_to_edit_in_place_qm;
	  SVREF(edit_state,FIX((SI_Long)23L)) = 
		  function_to_call_on_changed_edit_box_text_qm;
	  SVREF(edit_state,FIX((SI_Long)22L)) = special_entry_context_qm;
	  SVREF(edit_state,FIX((SI_Long)97L)) = cursor_line_index_qm;
	  SVREF(edit_state,FIX((SI_Long)98L)) = cursor_character_index_qm;
	  temp = enter_editing_context_1(6,edit_state,modal,size_x,size_y,
		  pos_x,pos_y);
	POP_SPECIAL();
      POP_SPECIAL();
      SAVE_VALUES(VALUES_1(temp));
      remove_last_item_in_current_localization_domains();
      result = RESTORE_VALUES();
    POP_SPECIAL();
    RESTORE_STACK();
    return result;
}

static Object Qirrelevant;         /* irrelevant */

static Object Qsystem_workspace_background_color;  /* system-workspace-background-color */

/* ENTER-EDITING-CONTEXT-1 */
Object enter_editing_context_1 varargs_1(int, n)
{
    Object edit_state;
    Object modal, size_x, size_y, pos_x, pos_y;
    Object do_not_put_up_edit_workspace_qm, current_edit_state;
    Object current_edit_workspace, current_grammar;
    Object current_indicator_for_category_of_this_name;
    Object current_indicator_for_category_of_symbol_token, irrelevant_category;
    Object temp, temp_1, temp_2, svref_new_value, edit_workspace_margin;
    Object gensymed_symbol, temp_3, frame, sub_vector_qm, function_qm;
    Object gensymed_symbol_3, gensymed_symbol_4, gensymed_symbol_5;
    Object gensymed_symbol_6, cursor_line_index_qm, cursor_character_index_qm;
    Object text_tail_for_cursor, slot_description_qm;
    SI_Long gensymed_symbol_1, gensymed_symbol_2;
    SI_Long edit_workspace_inside_left_edge, edit_workspace_inside_top_edge;
    SI_Long method_index;
    Declare_varargs_nonrelocating;
    Declare_special(5);
    Object result;

    x_note_fn_call(126,74);
    INIT_ARGS_nonrelocating();
    edit_state = REQUIRED_ARG_nonrelocating();
    modal = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    size_x = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() 
	    : Nil;
    size_y = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() 
	    : Nil;
    pos_x = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    pos_y = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    do_not_put_up_edit_workspace_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    enter_context_in_current_workstation(2,Qediting,edit_state);
    current_edit_state = edit_state;
    PUSH_SPECIAL(Current_edit_state,current_edit_state,4);
      current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
      PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,3);
	if (ISVREF(edit_state,(SI_Long)11L)) {
	    push_for_token(FIX((SI_Long)1L),FIX((SI_Long)0L),T,
		    ISVREF(edit_state,(SI_Long)15L),Nil,Nil,Nil);
	    enable_or_disable_edit_end_and_update_buttons(Nil);
	}
	else {
	    current_grammar = Global_grammar;
	    PUSH_SPECIAL(Current_grammar,current_grammar,2);
	      current_indicator_for_category_of_this_name = 
		      ISVREF(Current_grammar,(SI_Long)3L);
	      PUSH_SPECIAL(Current_indicator_for_category_of_this_name,current_indicator_for_category_of_this_name,
		      1);
		current_indicator_for_category_of_symbol_token = 
			ISVREF(Current_grammar,(SI_Long)4L);
		PUSH_SPECIAL(Current_indicator_for_category_of_symbol_token,current_indicator_for_category_of_symbol_token,
			0);
		  irrelevant_category = 
			  get_or_make_category_for_category_symbol(Qirrelevant);
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	    temp = 
		    gensym_cons_1(make_phrase_rule_completion_1(irrelevant_category,
		    irrelevant_category,Nil),Nil);
	    SVREF(edit_state,FIX((SI_Long)30L)) = temp;
	    temp_1 = ISVREF(edit_state,(SI_Long)15L);
	    temp = Current_edit_state;
	    current_grammar = Global_grammar;
	    PUSH_SPECIAL(Current_grammar,current_grammar,2);
	      current_indicator_for_category_of_this_name = 
		      ISVREF(Current_grammar,(SI_Long)3L);
	      PUSH_SPECIAL(Current_indicator_for_category_of_this_name,current_indicator_for_category_of_this_name,
		      1);
		current_indicator_for_category_of_symbol_token = 
			ISVREF(Current_grammar,(SI_Long)4L);
		PUSH_SPECIAL(Current_indicator_for_category_of_symbol_token,current_indicator_for_category_of_symbol_token,
			0);
		  temp_2 = ISVREF(edit_state,(SI_Long)9L);
		  temp_2 = 
			  get_or_make_category_for_category_symbol(SECOND(temp_2));
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	    svref_new_value = 
		    make_incomplete_phrase_structure_1(gensym_cons_1(make_phrase_rule_completion_1(irrelevant_category,
		    temp_2,ISVREF(edit_state,(SI_Long)30L)),Nil),Nil,Nil,
		    ISVREF(Current_edit_state,(SI_Long)36L));
	    push_for_token(FIX((SI_Long)1L),FIX((SI_Long)0L),T,temp_1,
		    phrase_cons(SVREF(temp,FIX((SI_Long)36L)) = 
		    svref_new_value,Nil),Nil,Nil);
	}
	edit_workspace_margin = ISVREF(Current_edit_workspace,(SI_Long)17L);
	gensymed_symbol = ISVREF(Current_edit_workspace,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)0L) : FIX((SI_Long)0L);
	gensymed_symbol_1 = IFIX(gensymed_symbol);
	gensymed_symbol_2 = IFIX(ISVREF(Current_edit_workspace,(SI_Long)17L));
	edit_workspace_inside_left_edge = gensymed_symbol_1 + 
		gensymed_symbol_2;
	gensymed_symbol = ISVREF(Current_edit_workspace,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)1L) : FIX((SI_Long)0L);
	gensymed_symbol_1 = IFIX(gensymed_symbol);
	gensymed_symbol_2 = IFIX(edit_workspace_margin);
	edit_workspace_inside_top_edge = gensymed_symbol_1 + gensymed_symbol_2;
	temp_1 = ISVREF(edit_state,(SI_Long)13L);
	temp_2 = Current_edit_workspace;
	if (ISVREF(edit_state,(SI_Long)43L)) {
	    gensymed_symbol = ISVREF(ISVREF(edit_state,(SI_Long)43L),
		    (SI_Long)14L);
	    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		    (SI_Long)2L) : FIX((SI_Long)0L);
	    gensymed_symbol_1 = IFIX(gensymed_symbol);
	    gensymed_symbol_2 = IFIX(edit_workspace_margin);
	    temp_3 = FIX(gensymed_symbol_1 + gensymed_symbol_2);
	}
	else
	    temp_3 = FIX(edit_workspace_inside_left_edge);
	add_to_workspace(4,temp_1,temp_2,temp_3,
		FIX(edit_workspace_inside_top_edge));
	if (ISVREF(edit_state,(SI_Long)43L)) {
	    if ( !TRUEP(Keep_edit_workspace_hidden_no_matter_what_qm))
		initialize_edit_subcommand_menu(ISVREF(edit_state,
			(SI_Long)43L));
	}
	if (ISVREF(edit_state,(SI_Long)3L)) {
	    method_index = (SI_Long)42L;
	    frame = ISVREF(edit_state,(SI_Long)3L);
	    sub_vector_qm = ISVREF(ISVREF(ISVREF(frame,(SI_Long)1L),
		    (SI_Long)11L),method_index);
	    function_qm = sub_vector_qm ? ISVREF(sub_vector_qm,
		    (SI_Long)1L) : Nil;
	    if (function_qm) {
		gensymed_symbol = function_qm;
		gensymed_symbol_3 = frame;
		gensymed_symbol_4 = Current_edit_workspace;
		gensymed_symbol_5 = ISVREF(edit_state,(SI_Long)13L);
		gensymed_symbol_6 = Nil;
		inline_funcall_4(gensymed_symbol,gensymed_symbol_3,
			gensymed_symbol_4,gensymed_symbol_5,gensymed_symbol_6);
	    }
	}
	if ( !TRUEP(do_not_put_up_edit_workspace_qm)) {
	    if ( !TRUEP(ISVREF(edit_state,(SI_Long)96L))) {
		if (New_g2_classic_ui_p) {
		    temp_1 = Current_edit_workspace;
		    change_slot_value(3,temp_1,
			    Qworkspace_background_color_qm,
			    get_ui_parameter(1,
			    Qsystem_workspace_background_color));
		}
		put_up_edit_workspace(7,Current_edit_workspace,
			Current_workstation,modal,size_x,size_y,pos_x,pos_y);
	    }
	}
	if ( !TRUEP(Keep_edit_workspace_hidden_no_matter_what_qm))
	    highlight_or_unhighlight_what_is_being_edited(Nil);
	cursor_line_index_qm = ISVREF(edit_state,(SI_Long)97L);
	cursor_character_index_qm = ISVREF(edit_state,(SI_Long)98L);
	text_tail_for_cursor = Nil;
	if (cursor_line_index_qm)
	    text_tail_for_cursor = 
		    find_text_tail_for_line(ISVREF(edit_state,
		    (SI_Long)15L),cursor_line_index_qm);
	else {
	    result = find_end_of_text(2,ISVREF(edit_state,(SI_Long)15L),
		    FIX((SI_Long)1L));
	    MVS_3(result,cursor_line_index_qm,cursor_character_index_qm,
		    text_tail_for_cursor);
	}
	change_edit_box(3,text_tail_for_cursor,cursor_line_index_qm,
		cursor_character_index_qm);
	slot_description_qm = ISVREF(edit_state,(SI_Long)3L) &&  
		!TRUEP(ISVREF(edit_state,(SI_Long)94L)) ? 
		get_slot_description_of_class_description_function(ISVREF(edit_state,
		(SI_Long)5L),ISVREF(ISVREF(edit_state,(SI_Long)3L),
		(SI_Long)1L),ISVREF(edit_state,(SI_Long)6L)) : Nil;
	if (ISVREF(edit_state,(SI_Long)3L) && slot_description_qm &&  
		!TRUEP(ISVREF(edit_state,(SI_Long)96L)) &&  
		!TRUEP(Keep_edit_workspace_hidden_no_matter_what_qm))
	    put_barrier_on_destabilization_via_editing(ISVREF(edit_state,
		    (SI_Long)3L),slot_description_qm);
      POP_SPECIAL();
    POP_SPECIAL();
    return VALUES_1(edit_state);
}

static Object Qwide_string;        /* wide-string */

static Object string_constant;     /* "Text Editor" */

static Object string_constant_1;   /* " for " */

static Object Qab_or;              /* or */

static Object Qinspect_history;    /* inspect-history */

static Object string_constant_2;   /* "Inspect Command" */

static Object Qfile_command;       /* file-command */

static Object string_constant_3;   /* "File Command" */

static Object string_constant_4;   /* "the " */

static Object string_constant_5;   /* "~(~A~) of " */

static Object string_constant_6;   /* "the ~(~A~) of " */

static Object Qab_gensym;          /* gensym */

/* MAKE-CAPTION-TEXT-FOR-EDIT-WORKSPACE */
Object make_caption_text_for_edit_workspace varargs_1(int, n)
{
    Object frame_qm;
    Object slot_name_qm, slot_component_name_qm, slot_component_indicator_qm;
    Object wide_string_bv16, new_wide_string, current_wide_string_list;
    Object current_wide_string, fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object gensymed_symbol, gensymed_symbol_1, sub_class_bit_vector;
    Object slot_description_qm, slot_name_for_user, pretty_slot_name;
    Object class_or_frame_qm, temp_1, aref_arg_2_1;
    Object gensym_list_of_wide_strings, string_1, ab_loop_list_, ab_loopvar_;
    Object ab_loopvar__1, ab_loopvar__2, new_cons, short_string, temp_2;
    SI_Long bv16_length, aref_arg_2, aref_new_value, length_1;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_2, gensymed_symbol_3, gensymed_symbol_4;
    char temp;
    Declare_varargs_nonrelocating;
    Declare_special(5);

    x_note_fn_call(126,75);
    INIT_ARGS_nonrelocating();
    frame_qm = REQUIRED_ARG_nonrelocating();
    slot_name_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    slot_component_name_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    slot_component_indicator_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    wide_string_bv16 = 
	    allocate_byte_vector_16(FIX(IFIX(Wide_string_list_maximum_length) 
	    + (SI_Long)3L));
    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
    aref_arg_2 = bv16_length - (SI_Long)2L;
    aref_new_value = IFIX(Wide_string_list_maximum_length) & (SI_Long)65535L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    aref_arg_2 = bv16_length - (SI_Long)1L;
    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    UBYTE_16_ISASET_1(wide_string_bv16,
	    IFIX(Wide_string_list_maximum_length),(SI_Long)0L);
    new_wide_string = wide_string_bv16;
    current_wide_string_list = gensym_cons_1(new_wide_string,Nil);
    PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
      current_wide_string = new_wide_string;
      PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
	fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		2);
	  length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
	  total_length_of_current_wide_string = 
		  FIX(UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		  (SI_Long)2L) + ((UBYTE_16_ISAREF_1(Current_wide_string,
		  length_1 - (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
	  PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
		  1);
	    current_twriting_output_type = Qwide_string;
	    PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
		    0);
	      if (Editor_caption_text_override_qm)
		  twrite_general_string(Editor_caption_text_override_qm);
	      else {
		  tformat(1,string_constant);
		  if (frame_qm) {
		      tformat(1,string_constant_1);
		      gensymed_symbol = ISVREF(frame_qm,(SI_Long)1L);
		      gensymed_symbol_1 = 
			      lookup_global_or_kb_specific_property_value(Qab_or,
			      Class_description_gkbprop);
		      if (gensymed_symbol_1) {
			  sub_class_bit_vector = ISVREF(gensymed_symbol,
				  (SI_Long)19L);
			  superior_class_bit_number = 
				  IFIX(ISVREF(gensymed_symbol_1,(SI_Long)18L));
			  sub_class_vector_index = 
				  superior_class_bit_number >>  -  - 
				  (SI_Long)3L;
			  if (sub_class_vector_index < 
				  IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				      {
			      gensymed_symbol_2 = 
				      UBYTE_8_ISAREF_1(sub_class_bit_vector,
				      sub_class_vector_index);
			      gensymed_symbol_3 = (SI_Long)1L;
			      gensymed_symbol_4 = 
				      superior_class_bit_number & (SI_Long)7L;
			      gensymed_symbol_3 = gensymed_symbol_3 << 
				      gensymed_symbol_4;
			      gensymed_symbol_2 = gensymed_symbol_2 & 
				      gensymed_symbol_3;
			      temp = (SI_Long)0L < gensymed_symbol_2;
			  }
			  else
			      temp = TRUEP(Nil);
		      }
		      else
			  temp = TRUEP(Nil);
		      if (temp);
		      else {
			  sub_class_bit_vector = ISVREF(gensymed_symbol,
				  (SI_Long)19L);
			  superior_class_bit_number = 
				  IFIX(ISVREF(Inspect_command_class_description,
				  (SI_Long)18L));
			  sub_class_vector_index = 
				  superior_class_bit_number >>  -  - 
				  (SI_Long)3L;
			  if (sub_class_vector_index < 
				  IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				      {
			      gensymed_symbol_2 = 
				      UBYTE_8_ISAREF_1(sub_class_bit_vector,
				      sub_class_vector_index);
			      gensymed_symbol_3 = (SI_Long)1L;
			      gensymed_symbol_4 = 
				      superior_class_bit_number & (SI_Long)7L;
			      gensymed_symbol_3 = gensymed_symbol_3 << 
				      gensymed_symbol_4;
			      gensymed_symbol_2 = gensymed_symbol_2 & 
				      gensymed_symbol_3;
			      temp = (SI_Long)0L < gensymed_symbol_2;
			  }
			  else
			      temp = TRUEP(Nil);
		      }
		      if (temp);
		      else {
			  gensymed_symbol_1 = 
				  lookup_global_or_kb_specific_property_value(Qinspect_history,
				  Class_description_gkbprop);
			  if (gensymed_symbol_1) {
			      sub_class_bit_vector = 
				      ISVREF(gensymed_symbol,(SI_Long)19L);
			      superior_class_bit_number = 
				      IFIX(ISVREF(gensymed_symbol_1,
				      (SI_Long)18L));
			      sub_class_vector_index = 
				      superior_class_bit_number >>  -  - 
				      (SI_Long)3L;
			      if (sub_class_vector_index < 
				      IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
					  {
				  gensymed_symbol_2 = 
					  UBYTE_8_ISAREF_1(sub_class_bit_vector,
					  sub_class_vector_index);
				  gensymed_symbol_3 = (SI_Long)1L;
				  gensymed_symbol_4 = 
					  superior_class_bit_number & 
					  (SI_Long)7L;
				  gensymed_symbol_3 = gensymed_symbol_3 << 
					  gensymed_symbol_4;
				  gensymed_symbol_2 = gensymed_symbol_2 & 
					  gensymed_symbol_3;
				  temp = (SI_Long)0L < gensymed_symbol_2;
			      }
			      else
				  temp = TRUEP(Nil);
			  }
			  else
			      temp = TRUEP(Nil);
		      }
		      if (temp)
			  tformat(1,string_constant_2);
		      else {
			  gensymed_symbol_1 = 
				  lookup_global_or_kb_specific_property_value(Qfile_command,
				  Class_description_gkbprop);
			  if (gensymed_symbol_1) {
			      sub_class_bit_vector = 
				      ISVREF(gensymed_symbol,(SI_Long)19L);
			      superior_class_bit_number = 
				      IFIX(ISVREF(gensymed_symbol_1,
				      (SI_Long)18L));
			      sub_class_vector_index = 
				      superior_class_bit_number >>  -  - 
				      (SI_Long)3L;
			      if (sub_class_vector_index < 
				      IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
					  {
				  gensymed_symbol_2 = 
					  UBYTE_8_ISAREF_1(sub_class_bit_vector,
					  sub_class_vector_index);
				  gensymed_symbol_3 = (SI_Long)1L;
				  gensymed_symbol_4 = 
					  superior_class_bit_number & 
					  (SI_Long)7L;
				  gensymed_symbol_3 = gensymed_symbol_3 << 
					  gensymed_symbol_4;
				  gensymed_symbol_2 = gensymed_symbol_2 & 
					  gensymed_symbol_3;
				  temp = (SI_Long)0L < gensymed_symbol_2;
			      }
			      else
				  temp = TRUEP(Nil);
			  }
			  else
			      temp = TRUEP(Nil);
			  if (temp)
			      tformat(1,string_constant_3);
			  else {
			      if (slot_name_qm) {
				  slot_description_qm = 
					  get_slot_description_of_class_description_function(slot_name_qm,
					  ISVREF(frame_qm,(SI_Long)1L),Nil);
				  if (slot_description_qm) {
				      if (ISVREF(slot_description_qm,
					      (SI_Long)8L))
					  slot_name_for_user = 
						  ISVREF(slot_description_qm,
						  (SI_Long)2L);
				      else {
					  pretty_slot_name = 
						  ISVREF(slot_description_qm,
						  (SI_Long)2L);
					  class_or_frame_qm = 
						  ISVREF(slot_description_qm,
						  (SI_Long)3L);
					  slot_name_for_user = 
						  get_alias_for_slot_name_if_any(pretty_slot_name,
						  class_or_frame_qm);
					  if (slot_name_for_user);
					  else
					      slot_name_for_user = 
						      pretty_slot_name;
				      }
				  }
				  else
				      slot_name_for_user = slot_name_qm;
				  if (slot_component_name_qm || 
					  slot_component_indicator_qm) {
				      tformat(1,string_constant_4);
				      if (slot_component_name_qm)
					  tformat(2,string_constant_5,
						  slot_component_name_qm);
				      if (slot_component_indicator_qm)
					  tformat(2,string_constant_5,
						  slot_component_indicator_qm);
				  }
				  tformat(2,string_constant_6,
					  slot_name_for_user);
			      }
			      write_class_instance_header_from_slot(ISVREF(ISVREF(frame_qm,
				      (SI_Long)1L),(SI_Long)1L),frame_qm);
			  }
		      }
		  }
	      }
	      temp_1 = Current_wide_string;
	      aref_arg_2_1 = Fill_pointer_for_current_wide_string;
	      bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(temp_1));
	      aref_arg_2 = bv16_length - (SI_Long)2L;
	      aref_new_value = IFIX(aref_arg_2_1) & (SI_Long)65535L;
	      UBYTE_16_ISASET_1(temp_1,aref_arg_2,aref_new_value);
	      aref_arg_2 = bv16_length - (SI_Long)1L;
	      aref_new_value = (SI_Long)57344L | IFIX(aref_arg_2_1) >>  -  
		      - (SI_Long)16L;
	      UBYTE_16_ISASET_1(temp_1,aref_arg_2,aref_new_value);
	      UBYTE_16_ISASET_1(temp_1,IFIX(aref_arg_2_1),(SI_Long)0L);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
      POP_SPECIAL();
      gensym_list_of_wide_strings = Current_wide_string_list;
    POP_SPECIAL();
    string_1 = Nil;
    ab_loop_list_ = gensym_list_of_wide_strings;
    ab_loopvar_ = Nil;
    ab_loopvar__1 = Nil;
    ab_loopvar__2 = Nil;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    string_1 = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    new_cons = Available_gensym_conses;
    if (new_cons) {
	Available_gensym_conses = M_CDR(new_cons);
	gensymed_symbol = new_cons;
    }
    else
	gensymed_symbol = Nil;
    if ( !TRUEP(gensymed_symbol))
	gensymed_symbol = replenish_gensym_cons_pool();
    temp_1 = make_lost_spaces_text_element(FIX((SI_Long)0L));
    M_CAR(gensymed_symbol) = temp_1;
    M_CDR(gensymed_symbol) = Nil;
    inline_note_allocate_cons(gensymed_symbol,Qab_gensym);
    ab_loopvar__2 = gensymed_symbol;
    if (ab_loopvar__1)
	M_CDR(ab_loopvar__1) = ab_loopvar__2;
    else
	ab_loopvar_ = ab_loopvar__2;
    ab_loopvar__1 = ab_loopvar__2;
    new_cons = Available_gensym_conses;
    if (new_cons) {
	Available_gensym_conses = M_CDR(new_cons);
	gensymed_symbol = new_cons;
    }
    else
	gensymed_symbol = Nil;
    if ( !TRUEP(gensymed_symbol))
	gensymed_symbol = replenish_gensym_cons_pool();
    length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(string_1));
    if (FIXNUM_LT(FIX(UBYTE_16_ISAREF_1(string_1,length_1 - (SI_Long)2L) + 
	    ((UBYTE_16_ISAREF_1(string_1,length_1 - (SI_Long)1L) & 
	    (SI_Long)8191L) << (SI_Long)16L)),
	    Use_full_size_of_with_output_wide_string_cutoff)) {
	short_string = copy_text_string(string_1);
	reclaim_text_string(string_1);
	temp_1 = short_string;
    }
    else
	temp_1 = string_1;
    M_CAR(gensymed_symbol) = temp_1;
    M_CDR(gensymed_symbol) = Nil;
    inline_note_allocate_cons(gensymed_symbol,Qab_gensym);
    ab_loopvar__2 = gensymed_symbol;
    if (ab_loopvar__1)
	M_CDR(ab_loopvar__1) = ab_loopvar__2;
    else
	ab_loopvar_ = ab_loopvar__2;
    ab_loopvar__1 = ab_loopvar__2;
    goto next_loop;
  end_loop:
    temp_2 = ab_loopvar_;
    goto end_1;
    temp_2 = Qnil;
  end_1:;
    reclaim_gensym_list_1(gensym_list_of_wide_strings);
    return VALUES_1(temp_2);
}

Object Editor_scroll_decision_override_qm = UNBOUND;

static Object Qalways;             /* always */

static Object Qnever;              /* never */

/* G2-USE-SCROLLING-EDITOR */
Object g2_use_scrolling_editor(when_to)
    Object when_to;
{
    x_note_fn_call(126,76);
    if (EQ(when_to,Qalways)) {
	Editor_scroll_decision_override_qm = T;
	return VALUES_1(Editor_scroll_decision_override_qm);
    }
    else if (EQ(when_to,Qnever)) {
	Editor_scroll_decision_override_qm = Qnever;
	return VALUES_1(Editor_scroll_decision_override_qm);
    }
    else {
	Editor_scroll_decision_override_qm = Nil;
	return VALUES_1(Editor_scroll_decision_override_qm);
    }
}

Object Attributes_to_edit_using_scrolling_editor = UNBOUND;

static Object list_constant_5;     /* # */

/* SHOULD-THIS-EDITOR-STATE-SCROLL? */
Object should_this_editor_state_scroll_qm(edit_state)
    Object edit_state;
{
    Object type_of_slot, temp, pretty_slot_name, class_or_frame_qm;

    x_note_fn_call(126,77);
    if (EQ(Editor_scroll_decision_override_qm,Qnil)) {
	type_of_slot = ISVREF(edit_state,(SI_Long)9L);
	temp = memq_function(SECOND(type_of_slot),list_constant_5);
	if (temp)
	    return VALUES_1(temp);
	else {
	    pretty_slot_name = ISVREF(edit_state,(SI_Long)5L);
	    class_or_frame_qm = ISVREF(edit_state,(SI_Long)3L);
	    temp = get_alias_for_slot_name_if_any(pretty_slot_name,
		    class_or_frame_qm);
	    if (temp);
	    else
		temp = pretty_slot_name;
	    return memq_function(temp,
		    Attributes_to_edit_using_scrolling_editor);
	}
    }
    else if (EQ(Editor_scroll_decision_override_qm,Qnever))
	return VALUES_1(Nil);
    else
	return VALUES_1(T);
}

/* VALID-WORKSTATION-CONTEXT-P-FOR-EDIT-STATE */
Object valid_workstation_context_p_for_edit_state(edit_state)
    Object edit_state;
{
    Object gensymed_symbol, gensymed_symbol_1, superior_edit_state_qm, temp;

    x_note_fn_call(126,78);
    gensymed_symbol = 
	    ISVREF(ISVREF(ISVREF(The_type_description_of_edit_state,
	    (SI_Long)9L),(SI_Long)0L),(SI_Long)4L);
    gensymed_symbol_1 = edit_state;
    if (inline_funcall_1(gensymed_symbol,gensymed_symbol_1) ? 
	    TRUEP(general_valid_edit_state_p(edit_state)) : TRUEP(Nil)) {
	superior_edit_state_qm = get_superior_edit_state_if_any(edit_state);
	temp =  !TRUEP(superior_edit_state_qm) ? T : Nil;
	if (temp)
	    return VALUES_1(temp);
	else
	    return general_valid_edit_state_p(superior_edit_state_qm);
    }
    else
	return VALUES_1(Nil);
}

/* GENERAL-VALID-EDIT-STATE-P */
Object general_valid_edit_state_p(edit_state)
    Object edit_state;
{
    Object gensymed_symbol, x, y, xa, ya, temp_1;
    char temp;

    x_note_fn_call(126,79);
    gensymed_symbol = ISVREF(ISVREF(edit_state,(SI_Long)12L),(SI_Long)3L);
    x = ISVREF(edit_state,(SI_Long)12L);
    temp = SIMPLE_VECTOR_P(x) ? EQ(ISVREF(x,(SI_Long)1L),
	    Qavailable_frame_vector) : TRUEP(Qnil);
    if (temp);
    else
	temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		(SI_Long)-1L : TRUEP(Nil);
    if (temp);
    else {
	x = gensymed_symbol;
	y = ISVREF(edit_state,(SI_Long)2L);
	if (FIXNUMP(y))
	    temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
	else if (FIXNUMP(x))
	    temp = TRUEP(Nil);
	else {
	    xa = M_CAR(y);
	    ya = M_CAR(x);
	    temp = FIXNUM_LT(xa,ya);
	    if (temp);
	    else
		temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),M_CDR(x)) : 
			TRUEP(Qnil);
	}
    }
    if ( !temp) {
	temp_1 =  !TRUEP(ISVREF(edit_state,(SI_Long)3L)) ? T : Nil;
	if (temp_1)
	    return VALUES_1(temp_1);
	else {
	    gensymed_symbol = ISVREF(ISVREF(edit_state,(SI_Long)3L),
		    (SI_Long)3L);
	    x = ISVREF(edit_state,(SI_Long)3L);
	    temp = SIMPLE_VECTOR_P(x) ? EQ(ISVREF(x,(SI_Long)1L),
		    Qavailable_frame_vector) : TRUEP(Qnil);
	    if (temp);
	    else
		temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
			(SI_Long)-1L : TRUEP(Nil);
	    if (temp);
	    else {
		x = gensymed_symbol;
		y = ISVREF(edit_state,(SI_Long)2L);
		if (FIXNUMP(y))
		    temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
		else if (FIXNUMP(x))
		    temp = TRUEP(Nil);
		else {
		    xa = M_CAR(y);
		    ya = M_CAR(x);
		    temp = FIXNUM_LT(xa,ya);
		    if (temp);
		    else
			temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),
				M_CDR(x)) : TRUEP(Qnil);
		}
	    }
	    return VALUES_1( !temp ? T : Nil);
	}
    }
    else
	return VALUES_1(Nil);
}

/* GET-SUPERIOR-EDIT-STATE-IF-ANY */
Object get_superior_edit_state_if_any(edit_state)
    Object edit_state;
{
    Object temp, superior_context_qm;

    x_note_fn_call(126,80);
    if (ISVREF(edit_state,(SI_Long)22L)) {
	temp = ISVREF(Current_workstation,(SI_Long)17L);
	superior_context_qm = SECOND(temp);
	if (superior_context_qm && EQ(ISVREF(superior_context_qm,
		(SI_Long)1L),Qediting))
	    return VALUES_1(ISVREF(superior_context_qm,(SI_Long)2L));
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* EDIT-CONTEXT-REMAINS-VALID-P */
Object edit_context_remains_valid_p(kb_serial_number)
    Object kb_serial_number;
{
    Object gensymed_symbol, gensymed_symbol_1;
    char temp;

    x_note_fn_call(126,81);
    if (EQ(Current_edit_state,
	    Specific_structure_for_current_workstation_context)) {
	gensymed_symbol = ISVREF(Current_edit_state,(SI_Long)0L);
	gensymed_symbol = 
		ISVREF(ISVREF(getfq_function_no_default(INLINE_SYMBOL_PLIST(gensymed_symbol),
		Qtype_description_of_unique_type_name_of_gensym_structure),
		(SI_Long)9L),(SI_Long)4L);
	gensymed_symbol_1 = Current_edit_state;
	temp = TRUEP(inline_funcall_1(gensymed_symbol,gensymed_symbol_1));
    }
    else
	temp = TRUEP(Nil);
    if (temp)
	return VALUES_1( !FIXNUM_GT(Current_kb_serial_number,
		kb_serial_number) ? T : Nil);
    else
	return VALUES_1(Nil);
}

static Object Qitem_reference;     /* item-reference */

static Object Qname_or_names_for_frame;  /* name-or-names-for-frame */

/* CLEAN-UP-WORKSTATION-CONTEXT-FOR-EDIT-STATE */
Object clean_up_workstation_context_for_edit_state(edit_state)
    Object edit_state;
{
    Object current_edit_state, item_or_value, menu_of_names_workspace_qm;
    Object gensymed_symbol, x, y, xa, ya, temp_1, gensymed_symbol_1;
    char temp;
    Declare_special(1);

    x_note_fn_call(126,82);
    current_edit_state = edit_state;
    PUSH_SPECIAL(Current_edit_state,current_edit_state,0);
      if ( !TRUEP(parsing_context_p_function(edit_state))) {
	  if ( !TRUEP(Keep_edit_workspace_hidden_no_matter_what_qm))
	      highlight_or_unhighlight_what_is_being_edited(T);
	  item_or_value = ISVREF(Current_edit_state,(SI_Long)52L);
	  menu_of_names_workspace_qm = CONSP(item_or_value) && 
		  EQ(M_CDR(item_or_value),Qitem_reference) ? 
		  ISVREF(M_CAR(item_or_value),(SI_Long)3L) : item_or_value;
	  if (menu_of_names_workspace_qm &&  
		  !TRUEP(get_lookup_slot_value_given_default(menu_of_names_workspace_qm,
		  Qname_or_names_for_frame,Nil)))
	      delete_frame(menu_of_names_workspace_qm);
	  gensymed_symbol = ISVREF(ISVREF(edit_state,(SI_Long)12L),
		  (SI_Long)3L);
	  x = ISVREF(edit_state,(SI_Long)12L);
	  temp = SIMPLE_VECTOR_P(x) ? EQ(ISVREF(x,(SI_Long)1L),
		  Qavailable_frame_vector) : TRUEP(Qnil);
	  if (temp);
	  else
	      temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		      (SI_Long)-1L : TRUEP(Nil);
	  if (temp);
	  else {
	      x = gensymed_symbol;
	      y = ISVREF(Current_edit_state,(SI_Long)2L);
	      if (FIXNUMP(y))
		  temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
	      else if (FIXNUMP(x))
		  temp = TRUEP(Nil);
	      else {
		  xa = M_CAR(y);
		  ya = M_CAR(x);
		  temp = FIXNUM_LT(xa,ya);
		  if (temp);
		  else
		      temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),
			      M_CDR(x)) : TRUEP(Qnil);
	      }
	  }
	  if ( !temp)
	      delete_frame(ISVREF(edit_state,(SI_Long)12L));
      }
      if (ISVREF(Current_edit_state,(SI_Long)31L)) {
	  temp_1 = last(ISVREF(Current_edit_state,(SI_Long)31L),_);
	  temp_1 = CAR(temp_1);
	  reclaim_phrase_rule_completions(ISVREF(CAR(temp_1),(SI_Long)1L));
      }
      temp_1 = ISVREF(Current_edit_state,(SI_Long)33L);
      if (CONSP(temp_1))
	  reclaim_menu_content_structure_for_character_position(ISVREF(Current_edit_state,
		  (SI_Long)33L));
    next_loop:
      if ( !TRUEP(ISVREF(Current_edit_state,(SI_Long)29L)))
	  goto end_loop;
      pop_for_token();
      goto next_loop;
    end_loop:;
    POP_SPECIAL();
    if (ISVREF(edit_state,(SI_Long)86L)) {
	gensymed_symbol = ISVREF(ISVREF(edit_state,(SI_Long)86L),(SI_Long)3L);
	x = ISVREF(edit_state,(SI_Long)86L);
	temp = SIMPLE_VECTOR_P(x) ? EQ(ISVREF(x,(SI_Long)1L),
		Qavailable_frame_vector) : TRUEP(Qnil);
	if (temp);
	else
	    temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		    (SI_Long)-1L : TRUEP(Nil);
	if (temp);
	else {
	    x = gensymed_symbol;
	    y = ISVREF(edit_state,(SI_Long)2L);
	    if (FIXNUMP(y))
		temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
	    else if (FIXNUMP(x))
		temp = TRUEP(Nil);
	    else {
		xa = M_CAR(y);
		ya = M_CAR(x);
		temp = FIXNUM_LT(xa,ya);
		if (temp);
		else
		    temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),M_CDR(x)) 
			    : TRUEP(Qnil);
	    }
	}
	temp =  !temp;
    }
    else
	temp = TRUEP(Nil);
    if (temp)
	delete_frame(ISVREF(edit_state,(SI_Long)86L));
    gensymed_symbol = 
	    ISVREF(ISVREF(ISVREF(The_type_description_of_edit_state,
	    (SI_Long)9L),(SI_Long)0L),(SI_Long)1L);
    gensymed_symbol_1 = edit_state;
    inline_funcall_1(gensymed_symbol,gensymed_symbol_1);
    if (EQ(Current_edit_state,edit_state)) {
	Current_edit_state = Nil;
	return VALUES_1(Current_edit_state);
    }
    else
	return VALUES_1(Nil);
}

static Object Qabove;              /* above */

static Object Qthick_workspace_frame_style;  /* thick-workspace-frame-style */

static Object Qdefault_workspace_frame_style;  /* default-workspace-frame-style */

static Object Qriding;             /* riding */

static Object Qriding_workspace_x_offset_qm;  /* riding-workspace-x-offset? */

static Object Qriding_workspace_y_offset_qm;  /* riding-workspace-y-offset? */

static Object Qleft;               /* left */

static Object Qtop;                /* top */

/* PUT-UP-EDIT-WORKSPACE */
Object put_up_edit_workspace varargs_1(int, n)
{
    Object edit_workspace, workstation;
    Object modal, size_x, size_y, pos_x, pos_y, pane, specific_image_plane;
    Object new_g2_classic_ui_p, frame_description_reference;
    Object available_image_plane, text_box_or_table, left_edge_in_workspace;
    Object top_edge_in_workspace, gensymed_symbol, temp, temp_1, temp_2;
    Object temp_3, scale, value, temp_4, svref_arg_1, base_plane;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, unshifted_result, temp_5;
    Declare_varargs_nonrelocating;
    Declare_special(1);

    x_note_fn_call(126,83);
    INIT_ARGS_nonrelocating();
    edit_workspace = REQUIRED_ARG_nonrelocating();
    workstation = REQUIRED_ARG_nonrelocating();
    modal = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    size_x = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() 
	    : Nil;
    size_y = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() 
	    : Nil;
    pos_x = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    pos_y = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    END_ARGS_nonrelocating();
    pane = ISVREF(Current_edit_state,(SI_Long)16L) ? 
	    ISVREF(ISVREF(Current_edit_state,(SI_Long)16L),(SI_Long)2L) : 
	    detail_pane(ISVREF(workstation,(SI_Long)1L));
    if (ISVREF(Current_edit_state,(SI_Long)16L)) {
	specific_image_plane = ISVREF(Current_edit_state,(SI_Long)16L);
	new_g2_classic_ui_p = Nil;
	PUSH_SPECIAL(New_g2_classic_ui_p,new_g2_classic_ui_p,0);
	  frame_description_reference = 
		  lookup_frame_description_reference_of_block_qm(edit_workspace);
	POP_SPECIAL();
	available_image_plane = new_get_available_image_plane(pane,
		frame_description_reference,Qabove,specific_image_plane);
	text_box_or_table = ISVREF(Current_edit_state,(SI_Long)17L);
	left_edge_in_workspace = Nil;
	top_edge_in_workspace = Nil;
	left_edge_in_workspace = ISVREF(Current_edit_state,(SI_Long)18L);
	if (left_edge_in_workspace) {
	    top_edge_in_workspace = ISVREF(Current_edit_state,(SI_Long)19L);
	    change_frame_description_reference_of_image_plane(available_image_plane,
		    lookup_frame_description_reference_of_frame_style(Qthick_workspace_frame_style,
		    Qdefault_workspace_frame_style));
	}
	else {
	    gensymed_symbol = ISVREF(text_box_or_table,(SI_Long)14L);
	    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		    (SI_Long)0L) : FIX((SI_Long)0L);
	    left_edge_in_workspace = gensymed_symbol;
	    gensymed_symbol = ISVREF(text_box_or_table,(SI_Long)14L);
	    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		    (SI_Long)1L) : FIX((SI_Long)0L);
	    top_edge_in_workspace = gensymed_symbol;
	}
	temp = ISVREF(specific_image_plane,(SI_Long)11L);
	temp_1 = ISVREF(specific_image_plane,(SI_Long)12L);
	gensymed_symbol = ISVREF(ISVREF(Current_edit_state,(SI_Long)13L),
		(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)0L) : FIX((SI_Long)0L);
	temp_2 = gensymed_symbol;
	gensymed_symbol = ISVREF(ISVREF(Current_edit_state,(SI_Long)13L),
		(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)1L) : FIX((SI_Long)0L);
	temp_3 = gensymed_symbol;
	gensymed_symbol_1 = IFIX(ISVREF(specific_image_plane,(SI_Long)13L));
	scale = ISVREF(specific_image_plane,(SI_Long)11L);
	value = left_edge_in_workspace;
	if (IFIX(scale) == (SI_Long)4096L)
	    gensymed_symbol_2 = IFIX(value);
	else if (FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,scale) 
		&& FIXNUM_LT(scale,Isqrt_of_most_positive_fixnum) && 
		FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,value) && 
		FIXNUM_LT(value,Isqrt_of_most_positive_fixnum)) {
	    unshifted_result = IFIX(FIXNUM_TIMES(scale,value)) + 
		    (SI_Long)2048L;
	    gensymed_symbol_2 = unshifted_result >>  -  - (SI_Long)12L;
	}
	else
	    gensymed_symbol_2 = IFIX(scalef_function(scale,value));
	temp_4 = FIX(gensymed_symbol_1 + gensymed_symbol_2);
	gensymed_symbol_1 = IFIX(ISVREF(specific_image_plane,(SI_Long)14L));
	scale = ISVREF(specific_image_plane,(SI_Long)12L);
	value = top_edge_in_workspace;
	if (IFIX(scale) == (SI_Long)4096L)
	    gensymed_symbol_2 = IFIX(value);
	else if (FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,scale) 
		&& FIXNUM_LT(scale,Isqrt_of_most_positive_fixnum) && 
		FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,value) && 
		FIXNUM_LT(value,Isqrt_of_most_positive_fixnum)) {
	    unshifted_result = IFIX(FIXNUM_TIMES(scale,value)) + 
		    (SI_Long)2048L;
	    gensymed_symbol_2 = unshifted_result >>  -  - (SI_Long)12L;
	}
	else
	    gensymed_symbol_2 = IFIX(scalef_function(scale,value));
	put_image_on_image_plane(10,available_image_plane,edit_workspace,
		temp,temp_1,Nil,Nil,temp_2,temp_3,temp_4,
		FIX(gensymed_symbol_1 + gensymed_symbol_2));
	if (ISVREF(ISVREF(Current_edit_state,(SI_Long)16L),(SI_Long)3L))
	    delete_image_plane(ISVREF(ISVREF(Current_edit_state,
		    (SI_Long)16L),(SI_Long)3L));
	svref_arg_1 = ISVREF(Current_edit_state,(SI_Long)16L);
	SVREF(svref_arg_1,FIX((SI_Long)3L)) = available_image_plane;
	svref_arg_1 = ISVREF(Current_edit_state,(SI_Long)16L);
	SVREF(svref_arg_1,FIX((SI_Long)4L)) = Qriding;
	base_plane = 
		find_base_plane_in_stack_of_coupled_image_planes(specific_image_plane);
	if (Noting_changes_to_kb_p)
	    note_change_to_block_1(edit_workspace,
		    Qriding_workspace_x_offset_qm);
	scale = ISVREF(base_plane,(SI_Long)11L);
	value = FIXNUM_MINUS(ISVREF(available_image_plane,(SI_Long)13L),
		ISVREF(base_plane,(SI_Long)13L));
	if (IFIX(scale) == (SI_Long)4096L)
	    temp = value;
	else if ( !(FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,
		value) && FIXNUM_LT(value,Isqrt_of_most_positive_fixnum)))
	    temp = inverse_scalef_function(scale,value);
	else if (IFIX(value) >= (SI_Long)0L)
	    temp = FIX(((IFIX(value) << (SI_Long)12L) + (IFIX(scale) >>  - 
		     - (SI_Long)1L)) / IFIX(scale));
	else {
	    temp_5 = ((IFIX(FIXNUM_NEGATE(value)) << (SI_Long)12L) + 
		    (IFIX(scale) >>  -  - (SI_Long)1L)) / IFIX(scale);
	    temp = FIXNUM_NEGATE(FIX(temp_5));
	}
	SVREF(edit_workspace,FIX((SI_Long)28L)) = temp;
	if (Noting_changes_to_kb_p)
	    note_change_to_block_1(edit_workspace,
		    Qriding_workspace_y_offset_qm);
	scale = ISVREF(base_plane,(SI_Long)12L);
	value = FIXNUM_MINUS(ISVREF(available_image_plane,(SI_Long)14L),
		ISVREF(base_plane,(SI_Long)14L));
	if (IFIX(scale) == (SI_Long)4096L)
	    temp = value;
	else if ( !(FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,
		value) && FIXNUM_LT(value,Isqrt_of_most_positive_fixnum)))
	    temp = inverse_scalef_function(scale,value);
	else if (IFIX(value) >= (SI_Long)0L)
	    temp = FIX(((IFIX(value) << (SI_Long)12L) + (IFIX(scale) >>  - 
		     - (SI_Long)1L)) / IFIX(scale));
	else {
	    temp_5 = ((IFIX(FIXNUM_NEGATE(value)) << (SI_Long)12L) + 
		    (IFIX(scale) >>  -  - (SI_Long)1L)) / IFIX(scale);
	    temp = FIXNUM_NEGATE(FIX(temp_5));
	}
	return VALUES_1(SVREF(edit_workspace,FIX((SI_Long)29L)) = temp);
    }
    else {
	if ( !TRUEP(size_x))
	    size_x = FIX((SI_Long)0L);
	if ( !TRUEP(size_y))
	    size_y = FIX((SI_Long)0L);
	if ( !TRUEP(pos_x))
	    pos_x = FIX((SI_Long)0L);
	if ( !TRUEP(pos_y))
	    pos_y = FIX((SI_Long)0L);
	if (EQ(modal,Nil) && IFIX(size_x) <= (SI_Long)0L && IFIX(size_y) 
		<= (SI_Long)0L && IFIX(pos_x) <= (SI_Long)0L && 
		IFIX(pos_y) <= (SI_Long)0L)
	    return put_workspace_on_pane_function(edit_workspace,pane,
		    Qleft,Qtop,T,FIX((SI_Long)11L),Nil,Nil,Nil,Nil,Nil,Nil,
		    Nil);
	else
	    return put_workspace_on_pane_function(edit_workspace,pane,
		    Qleft,Qtop,T,FIX((SI_Long)11L),Nil,Nil,modal,size_x,
		    size_y,pos_x,pos_y);
    }
}

/* SUSPEND-WORKSTATION-CONTEXT-FOR-EDIT-STATE */
Object suspend_workstation_context_for_edit_state(edit_state)
    Object edit_state;
{
    Object gensymed_symbol, gensymed_symbol_1, edit_workspace, x2;
    char temp;

    x_note_fn_call(126,84);
    gensymed_symbol = 
	    ISVREF(ISVREF(ISVREF(The_type_description_of_edit_state,
	    (SI_Long)9L),(SI_Long)0L),(SI_Long)6L);
    gensymed_symbol_1 = edit_state;
    inline_funcall_1(gensymed_symbol,gensymed_symbol_1);
    edit_workspace = ISVREF(edit_state,(SI_Long)12L);
    if (SIMPLE_VECTOR_P(edit_workspace) && 
	    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(edit_workspace)) > (SI_Long)2L 
	    &&  !EQ(ISVREF(edit_workspace,(SI_Long)1L),
	    Qavailable_frame_vector)) {
	x2 = ISVREF(edit_workspace,(SI_Long)1L);
	temp = SIMPLE_VECTOR_P(x2) && EQ(ISVREF(x2,(SI_Long)0L),
		Qg2_defstruct_structure_name_class_description_g2_struct) ?
		 TRUEP(x2) : TRUEP(Qnil);
    }
    else
	temp = TRUEP(Nil);
    if (temp ? TRUEP(native_editor_workspace_p(edit_workspace)) : TRUEP(Nil))
	return suspend_native_editor(edit_state);
    else
	return VALUES_1(Nil);
}

/* RESUME-WORKSTATION-CONTEXT-FOR-EDIT-STATE */
Object resume_workstation_context_for_edit_state(edit_state)
    Object edit_state;
{
    Object gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,85);
    gensymed_symbol = 
	    ISVREF(ISVREF(ISVREF(The_type_description_of_edit_state,
	    (SI_Long)9L),(SI_Long)0L),(SI_Long)7L);
    gensymed_symbol_1 = edit_state;
    inline_funcall_1(gensymed_symbol,gensymed_symbol_1);
    if (native_editor_workspace_p(ISVREF(edit_state,(SI_Long)12L)))
	return resume_native_editor(edit_state);
    else
	return VALUES_1(Nil);
}

static Object Qedit_box;           /* edit-box */

static Object Qscrolling_editor_text_format;  /* scrolling-editor-text-format */

static Object Qdefault_text_box_format_name;  /* default-text-box-format-name */

static Object Qformat_frame;       /* format-frame */

static Object Qbox_translation_and_text;  /* box-translation-and-text */

static Object Qtext_box_format;    /* text-box-format */

static Object Qtext_cell_plist_for_text_box;  /* text-cell-plist-for-text-box */

static Object Kedit_box_with_scroll_bar_frame_style;  /* :edit-box-with-scroll-bar-frame-style */

static Object Qminimum_width_of_text_box;  /* minimum-width-of-text-box */

static Object Qminimum_height_of_text_box;  /* minimum-height-of-text-box */

static Object Qmaximum_width_of_text_box_qm;  /* maximum-width-of-text-box? */

static Object Qmaximum_height_of_text_box;  /* maximum-height-of-text-box */

static Object Qremembered_block_transform;  /* remembered-block-transform */

/* MAKE-EDIT-BOX */
Object make_edit_box(initial_text_1,reformat_text_qm,
	    text_box_format_or_format_name_qm,text_cell_plist,
	    cursor_line_index_qm,cursor_character_index_qm,
	    minimum_width_qm,minimum_or_desired_height_qm,scrolling_editor_p)
    Object initial_text_1, reformat_text_qm, text_box_format_or_format_name_qm;
    Object text_cell_plist, cursor_line_index_qm, cursor_character_index_qm;
    Object minimum_width_qm, minimum_or_desired_height_qm, scrolling_editor_p;
{
    Object edit_box, format_name, temp, temp_1, text_box_format;
    Object svref_new_value, text_cell_interline_distance, text_box;
    Object revised_cursor_line_index_qm, revised_cursor_character_index_qm;
    Object gensymed_symbol_3, gensymed_symbol_4, gensymed_symbol_5;
    SI_Long temp_2, min_height, height_if_scrolling, gensymed_symbol;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, minimum_width;
    SI_Long minimum_height;
    Object result;

    x_note_fn_call(126,86);
    edit_box = make_frame(Qedit_box);
    if (SYMBOLP(text_box_format_or_format_name_qm)) {
	format_name = text_box_format_or_format_name_qm;
	if (format_name);
	else {
	    temp = scrolling_editor_p ? Qscrolling_editor_text_format : 
		    get_lookup_slot_value(edit_box,
		    Qdefault_text_box_format_name);
	    temp_1 = ISVREF(Current_edit_state,(SI_Long)84L);
	    if (temp_1);
	    else
		temp_1 = New_g2_classic_ui_p ? get_ui_parameter(1,
			Qfont_for_editing) : ISVREF(Fonts,(SI_Long)25L);
	    format_name = choose_font_format_per_font_size(temp,temp_1);
	}
	text_box_format = get_instance_with_name_if_any(Qformat_frame,
		format_name);
	if (text_box_format);
	else
	    text_box_format = make_format_frame(format_name);
    }
    else
	text_box_format = text_box_format_or_format_name_qm;
    if (Noting_changes_to_kb_p)
	note_change_to_block_1(edit_box,Qbox_translation_and_text);
    svref_new_value = gensym_cons_1(No_value,initial_text_1);
    SVREF(edit_box,FIX((SI_Long)16L)) = svref_new_value;
    if (Noting_changes_to_kb_p)
	note_change_to_block_1(edit_box,Qtext_box_format);
    SVREF(edit_box,FIX((SI_Long)17L)) = text_box_format;
    if (Noting_changes_to_kb_p)
	note_change_to_block_1(edit_box,Qtext_cell_plist_for_text_box);
    SVREF(edit_box,FIX((SI_Long)18L)) = text_cell_plist;
    if (scrolling_editor_p)
	set_frame_style_of_block(edit_box,
		Kedit_box_with_scroll_bar_frame_style);
    text_cell_interline_distance = FIXNUM_ADD(ISVREF(text_box_format,
	    (SI_Long)33L),ISVREF(text_box_format,(SI_Long)31L));
    temp_2 = IFIX(ISVREF(Editor_parameters,(SI_Long)28L));
    min_height = MAX((SI_Long)500L,temp_2);
    height_if_scrolling = IFIX(FIXNUM_TIMES(text_cell_interline_distance,
	    FIXNUM_ADD1(ltruncate(FIX(min_height),
	    text_cell_interline_distance))));
    gensymed_symbol = scrolling_editor_p ? (SI_Long)46L : (SI_Long)0L;
    temp_1 = minimum_width_qm;
    if (temp_1);
    else {
	gensymed_symbol_1 = IFIX(ISVREF(Editor_parameters,(SI_Long)27L));
	if (scrolling_editor_p) {
	    temp_2 = IFIX(ISVREF(text_box_format,(SI_Long)41L));
	    gensymed_symbol_2 = MIN((SI_Long)500L,temp_2);
	}
	else
	    gensymed_symbol_2 = (SI_Long)0L;
	temp_1 = FIX(MAX(gensymed_symbol_1,gensymed_symbol_2));
    }
    gensymed_symbol_1 = IFIX(temp_1);
    minimum_width = MAX(gensymed_symbol,gensymed_symbol_1);
    gensymed_symbol = scrolling_editor_p ? (SI_Long)46L : (SI_Long)0L;
    gensymed_symbol_1 = IFIX(text_cell_interline_distance);
    gensymed_symbol = gensymed_symbol + gensymed_symbol_1;
    temp_1 = minimum_or_desired_height_qm;
    if (temp_1);
    else if (scrolling_editor_p) {
	temp_2 = IFIX(ISVREF(Editor_parameters,(SI_Long)28L));
	temp_1 = FIX(MAX(height_if_scrolling,temp_2));
    }
    else
	temp_1 = FIX((SI_Long)0L);
    gensymed_symbol_1 = IFIX(temp_1);
    minimum_height = MAX(gensymed_symbol,gensymed_symbol_1);
    if (Noting_changes_to_kb_p)
	note_change_to_block_1(edit_box,Qminimum_width_of_text_box);
    temp_2 = IFIX(Maximum_text_box_width_or_height);
    set_lookup_slot_value_1(edit_box,Qminimum_width_of_text_box,
	    FIX(MIN(minimum_width,temp_2)));
    if (Noting_changes_to_kb_p)
	note_change_to_block_1(edit_box,Qminimum_height_of_text_box);
    set_lookup_slot_value_1(edit_box,Qminimum_height_of_text_box,
	    FIX(MIN(minimum_height,(SI_Long)2000L)));
    if (scrolling_editor_p) {
	set_non_savable_lookup_slot_value(edit_box,
		Qmaximum_width_of_text_box_qm,FIX(MAX((SI_Long)400L,
		minimum_width)));
	if (Noting_changes_to_kb_p)
	    note_change_to_block_1(edit_box,Qmaximum_height_of_text_box);
	gensymed_symbol = IFIX(get_lookup_slot_value(edit_box,
		Qminimum_height_of_text_box));
	temp_1 = minimum_or_desired_height_qm;
	if (temp_1);
	else
	    temp_1 = FIX(height_if_scrolling);
	gensymed_symbol_1 = IFIX(temp_1);
	set_lookup_slot_value_1(edit_box,Qmaximum_height_of_text_box,
		FIX(MAX(gensymed_symbol,gensymed_symbol_1)));
    }
    result = reformat_text_box_in_place(5,edit_box,T, 
	    !TRUEP(reformat_text_qm) ? T : Nil,cursor_line_index_qm,
	    cursor_character_index_qm);
    MVS_3(result,text_box,revised_cursor_line_index_qm,
	    revised_cursor_character_index_qm);
    if (Noting_changes_to_kb_p)
	note_change_to_block_1(edit_box,Qremembered_block_transform);
    gensymed_symbol_3 = make_gensym_list_1(FIX((SI_Long)8L));
    gensymed_symbol_4 = gensymed_symbol_3;
    gensymed_symbol_5 = ISVREF(edit_box,(SI_Long)14L);
    gensymed_symbol_5 = gensymed_symbol_5 ? ISVREF(gensymed_symbol_5,
	    (SI_Long)0L) : FIX((SI_Long)0L);
    M_CAR(gensymed_symbol_4) = gensymed_symbol_5;
    gensymed_symbol_4 = M_CDR(gensymed_symbol_4);
    gensymed_symbol_5 = ISVREF(edit_box,(SI_Long)14L);
    gensymed_symbol_5 = gensymed_symbol_5 ? ISVREF(gensymed_symbol_5,
	    (SI_Long)1L) : FIX((SI_Long)0L);
    M_CAR(gensymed_symbol_4) = gensymed_symbol_5;
    gensymed_symbol_4 = M_CDR(gensymed_symbol_4);
    gensymed_symbol_5 = ISVREF(edit_box,(SI_Long)14L);
    gensymed_symbol_5 = gensymed_symbol_5 ? ISVREF(gensymed_symbol_5,
	    (SI_Long)2L) : FIX((SI_Long)0L);
    M_CAR(gensymed_symbol_4) = gensymed_symbol_5;
    gensymed_symbol_4 = M_CDR(gensymed_symbol_4);
    gensymed_symbol_5 = ISVREF(edit_box,(SI_Long)14L);
    gensymed_symbol_5 = gensymed_symbol_5 ? ISVREF(gensymed_symbol_5,
	    (SI_Long)3L) : FIX((SI_Long)0L);
    M_CAR(gensymed_symbol_4) = gensymed_symbol_5;
    gensymed_symbol_4 = M_CDR(gensymed_symbol_4);
    gensymed_symbol_5 = ISVREF(edit_box,(SI_Long)14L);
    gensymed_symbol_5 = gensymed_symbol_5 ? ISVREF(gensymed_symbol_5,
	    (SI_Long)0L) : FIX((SI_Long)0L);
    M_CAR(gensymed_symbol_4) = gensymed_symbol_5;
    gensymed_symbol_4 = M_CDR(gensymed_symbol_4);
    gensymed_symbol_5 = ISVREF(edit_box,(SI_Long)14L);
    gensymed_symbol_5 = gensymed_symbol_5 ? ISVREF(gensymed_symbol_5,
	    (SI_Long)1L) : FIX((SI_Long)0L);
    M_CAR(gensymed_symbol_4) = gensymed_symbol_5;
    gensymed_symbol_4 = M_CDR(gensymed_symbol_4);
    gensymed_symbol_5 = ISVREF(edit_box,(SI_Long)14L);
    gensymed_symbol_5 = gensymed_symbol_5 ? ISVREF(gensymed_symbol_5,
	    (SI_Long)2L) : FIX((SI_Long)0L);
    M_CAR(gensymed_symbol_4) = gensymed_symbol_5;
    gensymed_symbol_4 = M_CDR(gensymed_symbol_4);
    gensymed_symbol_5 = ISVREF(edit_box,(SI_Long)14L);
    gensymed_symbol_5 = gensymed_symbol_5 ? ISVREF(gensymed_symbol_5,
	    (SI_Long)3L) : FIX((SI_Long)0L);
    M_CAR(gensymed_symbol_4) = gensymed_symbol_5;
    set_lookup_slot_value_1(edit_box,Qremembered_block_transform,
	    gensymed_symbol_3);
    return VALUES_3(text_box,revised_cursor_line_index_qm,
	    revised_cursor_character_index_qm);
}

Object The_type_description_of_edit_box_spot = UNBOUND;

Object Chain_of_available_edit_box_spots = UNBOUND;

Object Edit_box_spot_count = UNBOUND;

/* EDIT-BOX-SPOT-STRUCTURE-MEMORY-USAGE */
Object edit_box_spot_structure_memory_usage()
{
    Object temp;

    x_note_fn_call(126,87);
    temp = Edit_box_spot_count;
    temp = FIXNUM_TIMES(temp,bytes_per_simple_vector(FIX((SI_Long)16L)));
    return VALUES_1(temp);
}

/* OUTSTANDING-EDIT-BOX-SPOT-COUNT */
Object outstanding_edit_box_spot_count()
{
    Object def_structure_edit_box_spot_variable, count_1;
    SI_Long gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,88);
    gensymed_symbol = IFIX(Edit_box_spot_count);
    def_structure_edit_box_spot_variable = Chain_of_available_edit_box_spots;
    count_1 = FIX((SI_Long)0L);
  next_loop:
    if ( !TRUEP(def_structure_edit_box_spot_variable))
	goto end_loop;
    def_structure_edit_box_spot_variable = 
	    ISVREF(def_structure_edit_box_spot_variable,(SI_Long)0L);
    count_1 = FIXNUM_ADD1(count_1);
    goto next_loop;
  end_loop:
    gensymed_symbol_1 = IFIX(count_1);
    goto end_1;
    gensymed_symbol_1 = IFIX(Qnil);
  end_1:;
    return VALUES_1(FIX(gensymed_symbol - gensymed_symbol_1));
}

/* RECLAIM-EDIT-BOX-SPOT-1 */
Object reclaim_edit_box_spot_1(edit_box_spot)
    Object edit_box_spot;
{
    Object old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(126,89);
    inline_note_reclaim_cons(edit_box_spot,Nil);
    old_structure_being_reclaimed = Structure_being_reclaimed;
    Structure_being_reclaimed = edit_box_spot;
    reclaim_structure_if_any(ISVREF(edit_box_spot,(SI_Long)2L));
    SVREF(edit_box_spot,FIX((SI_Long)2L)) = Nil;
    Structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = Chain_of_available_edit_box_spots;
    SVREF(edit_box_spot,FIX((SI_Long)0L)) = svref_new_value;
    Chain_of_available_edit_box_spots = edit_box_spot;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-EDIT-BOX-SPOT */
Object reclaim_structure_for_edit_box_spot(edit_box_spot)
    Object edit_box_spot;
{
    x_note_fn_call(126,90);
    return reclaim_edit_box_spot_1(edit_box_spot);
}

static Object Qg2_defstruct_structure_name_edit_box_spot_g2_struct;  /* g2-defstruct-structure-name::edit-box-spot-g2-struct */

/* MAKE-PERMANENT-EDIT-BOX-SPOT-STRUCTURE-INTERNAL */
Object make_permanent_edit_box_spot_structure_internal()
{
    Object def_structure_edit_box_spot_variable, edit_box_spot_count_new_value;
    Object defstruct_g2_edit_box_spot_variable, the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(126,91);
    def_structure_edit_box_spot_variable = Nil;
    edit_box_spot_count_new_value = FIXNUM_ADD1(Edit_box_spot_count);
    Edit_box_spot_count = edit_box_spot_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_edit_box_spot_variable = Nil;
	gensymed_symbol = (SI_Long)16L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_edit_box_spot_variable = the_array;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_edit_box_spot_g2_struct;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)1L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)2L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)3L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)4L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)5L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)6L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)7L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)8L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)9L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)10L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)11L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)12L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)13L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)14L)) = Nil;
	SVREF(defstruct_g2_edit_box_spot_variable,FIX((SI_Long)15L)) = Nil;
	def_structure_edit_box_spot_variable = 
		defstruct_g2_edit_box_spot_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_edit_box_spot_variable);
}

/* MAKE-EDIT-BOX-SPOT-1 */
Object make_edit_box_spot_1()
{
    Object def_structure_edit_box_spot_variable;

    x_note_fn_call(126,92);
    def_structure_edit_box_spot_variable = Chain_of_available_edit_box_spots;
    if (def_structure_edit_box_spot_variable) {
	Chain_of_available_edit_box_spots = 
		ISVREF(def_structure_edit_box_spot_variable,(SI_Long)0L);
	SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_edit_box_spot_g2_struct;
    }
    else
	def_structure_edit_box_spot_variable = 
		make_permanent_edit_box_spot_structure_internal();
    inline_note_allocate_cons(def_structure_edit_box_spot_variable,Nil);
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)1L)) = Nil;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)2L)) = Nil;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)3L)) = T;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)4L)) = Nil;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)5L)) = Nil;
    ISVREF(def_structure_edit_box_spot_variable,(SI_Long)6L) = 
	    FIX((SI_Long)1000L);
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)7L)) = T;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)8L)) = Kunknown;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)9L)) = Nil;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)10L)) = Nil;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)11L)) = Nil;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)12L)) = Nil;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)13L)) = Nil;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)14L)) = Nil;
    SVREF(def_structure_edit_box_spot_variable,FIX((SI_Long)15L)) = Nil;
    return VALUES_1(def_structure_edit_box_spot_variable);
}

/* GENERATE-SPOT-FOR-EDIT-BOX */
Object generate_spot_for_edit_box(edit_box,mouse_pointer)
    Object edit_box, mouse_pointer;
{
    x_note_fn_call(126,93);
    return generate_text_box_spot(edit_box,mouse_pointer,
	    make_edit_box_spot_1());
}

static Object Qtext_region;        /* text-region */

/* HIGHLIGHT-OR-UNHIGHLIGHT-WHAT-IS-BEING-EDITED */
Object highlight_or_unhighlight_what_is_being_edited(unhighlight_case_qm)
    Object unhighlight_case_qm;
{
    Object edit_state, frame_qm, gensymed_symbol, gensymed_symbol_1;
    char temp;

    x_note_fn_call(126,94);
    edit_state = Current_edit_state;
    frame_qm = ISVREF(edit_state,(SI_Long)3L);
    if (frame_qm &&  !(SIMPLE_VECTOR_P(frame_qm) && EQ(ISVREF(frame_qm,
	    (SI_Long)1L),Qavailable_frame_vector))) {
	gensymed_symbol = ISVREF(frame_qm,(SI_Long)3L);
	gensymed_symbol_1 = ISVREF(edit_state,(SI_Long)4L);
	temp = FIXNUMP(gensymed_symbol) ? (FIXNUMP(gensymed_symbol_1) ? 
		FIXNUM_EQ(gensymed_symbol,gensymed_symbol_1) : TRUEP(Nil)) 
		: FIXNUMP(gensymed_symbol_1) ? TRUEP(Nil) : 
		FIXNUM_EQ(M_CAR(gensymed_symbol),M_CAR(gensymed_symbol_1)) 
		&& FIXNUM_EQ(M_CDR(gensymed_symbol),M_CDR(gensymed_symbol_1));
    }
    else
	temp = TRUEP(Nil);
    if (temp)
	return highlight_or_unhighlight_for_slot(8,frame_qm,
		ISVREF(edit_state,(SI_Long)5L),ISVREF(edit_state,
		(SI_Long)6L),Nil,unhighlight_case_qm,Nil ? Qtext_region : 
		Nil,ISVREF(edit_state,(SI_Long)7L),ISVREF(edit_state,
		(SI_Long)8L));
    else
	return VALUES_1(Nil);
}

/* HIGHLIGHT-OR-UNHIGHLIGHT-FOR-SLOT */
Object highlight_or_unhighlight_for_slot varargs_1(int, n)
{
    Object frame, slot_name, defining_class_qm, highlight_color_qm;
    Object unhighlight_case_qm;
    Object text_region_class_qm, slot_component_name_qm;
    Object slot_component_indicator_qm, sub_class_bit_vector;
    Object text_box_to_highlight_qm, gensymed_symbol_3, ab_queue_form_;
    Object ab_next_queue_element_, subblock;
    SI_Long superior_class_bit_number, sub_class_vector_index, gensymed_symbol;
    SI_Long gensymed_symbol_1, gensymed_symbol_2;
    char temp;
    Declare_varargs_nonrelocating;

    x_note_fn_call(126,95);
    INIT_ARGS_nonrelocating();
    frame = REQUIRED_ARG_nonrelocating();
    slot_name = REQUIRED_ARG_nonrelocating();
    defining_class_qm = REQUIRED_ARG_nonrelocating();
    highlight_color_qm = REQUIRED_ARG_nonrelocating();
    unhighlight_case_qm = REQUIRED_ARG_nonrelocating();
    text_region_class_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    slot_component_name_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    slot_component_indicator_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    sub_class_bit_vector = ISVREF(ISVREF(frame,(SI_Long)1L),(SI_Long)19L);
    superior_class_bit_number = IFIX(ISVREF(Text_box_class_description,
	    (SI_Long)18L));
    sub_class_vector_index = superior_class_bit_number >>  -  - (SI_Long)3L;
    if (sub_class_vector_index < 
	    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	gensymed_symbol = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		sub_class_vector_index);
	gensymed_symbol_1 = (SI_Long)1L;
	gensymed_symbol_2 = superior_class_bit_number & (SI_Long)7L;
	gensymed_symbol_1 = gensymed_symbol_1 << gensymed_symbol_2;
	gensymed_symbol = gensymed_symbol & gensymed_symbol_1;
	temp = (SI_Long)0L < gensymed_symbol;
    }
    else
	temp = TRUEP(Nil);
    if (temp)
	text_box_to_highlight_qm = frame;
    else if (EQ(slot_name,Qname_or_names_for_frame)) {
	gensymed_symbol_3 = ISVREF(frame,(SI_Long)14L);
	gensymed_symbol_3 = gensymed_symbol_3 ? ISVREF(gensymed_symbol_3,
		(SI_Long)4L) : Nil;
	ab_queue_form_ = gensymed_symbol_3;
	ab_next_queue_element_ = Nil;
	subblock = Nil;
	if (ab_queue_form_)
	    ab_next_queue_element_ = ISVREF(ab_queue_form_,(SI_Long)0L);
      next_loop:
	if (EQ(ab_next_queue_element_,ab_queue_form_))
	    goto end_loop;
	subblock = ISVREF(ab_next_queue_element_,(SI_Long)2L);
	ab_next_queue_element_ = ISVREF(ab_next_queue_element_,(SI_Long)0L);
	sub_class_bit_vector = ISVREF(ISVREF(subblock,(SI_Long)1L),
		(SI_Long)19L);
	superior_class_bit_number = IFIX(ISVREF(Name_box_class_description,
		(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_1 = (SI_Long)1L;
	    gensymed_symbol_2 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_1 = gensymed_symbol_1 << gensymed_symbol_2;
	    gensymed_symbol = gensymed_symbol & gensymed_symbol_1;
	    temp = (SI_Long)0L < gensymed_symbol;
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    text_box_to_highlight_qm = subblock;
	    goto end_1;
	}
	goto next_loop;
      end_loop:
	text_box_to_highlight_qm = Qnil;
      end_1:;
    }
    else
	text_box_to_highlight_qm = Qnil;
    if (text_box_to_highlight_qm)
	highlight_or_unhighlight_text_box(4,text_box_to_highlight_qm,
		highlight_color_qm,unhighlight_case_qm,text_region_class_qm);
    return highlight_or_unhighlight_attribute(frame,slot_name,
	    defining_class_qm,slot_component_name_qm,
	    slot_component_indicator_qm,highlight_color_qm,
	    unhighlight_case_qm,text_region_class_qm);
}

static Object Qeditor_notification;  /* editor-notification */

/* DISPLAY-EDITOR-NOTIFICATION-1 */
Object display_editor_notification_1(notification_string)
    Object notification_string;
{
    Object svref_arg_1, temp, temp_1, gensymed_symbol, temp_2, temp_3;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;

    x_note_fn_call(126,96);
    if (native_editor_workspace_p(Current_edit_workspace))
	native_editor_display_notification(Current_edit_state,
		notification_string);
    erase_any_temporary_information_on_edit_workspace(1,Nil);
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)33L)) = Qeditor_notification;
    temp = make_free_text_box(2,notification_string,Qeditor_notification);
    temp_1 = Current_edit_workspace;
    gensymed_symbol = ISVREF(ISVREF(Current_edit_state,(SI_Long)13L),
	    (SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)0L) : FIX((SI_Long)0L);
    temp_2 = gensymed_symbol;
    gensymed_symbol = ISVREF(ISVREF(Current_edit_state,(SI_Long)13L),
	    (SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)3L) : FIX((SI_Long)0L);
    gensymed_symbol_1 = IFIX(gensymed_symbol);
    gensymed_symbol_2 = IFIX(ISVREF(Current_edit_workspace,(SI_Long)17L));
    if (ISVREF(Current_edit_state,(SI_Long)46L) && 
	    ISVREF(Current_edit_state,(SI_Long)47L))
	gensymed_symbol_3 = IFIX(ISVREF(Current_edit_state,(SI_Long)51L));
    else {
	temp_3 = ISVREF(Current_edit_state,(SI_Long)70L);
	if (temp_3);
	else
	    temp_3 = FIX((SI_Long)0L);
	gensymed_symbol_3 = IFIX(temp_3);
    }
    return add_to_workspace(6,temp,temp_1,temp_2,FIX(gensymed_symbol_1 + 
	    gensymed_symbol_2 + gensymed_symbol_3),T,T);
}

/* GENERATE-SPOT-FOR-EDITOR-NOTIFICATION */
Object generate_spot_for_editor_notification(editor_notification,mouse_pointer)
    Object editor_notification, mouse_pointer;
{
    x_note_fn_call(126,97);
    return generate_workspace_background_spot(mouse_pointer);
}

Object Editor_command_p_prop = UNBOUND;

Object Name_of_current_editor_command_qm = UNBOUND;

/* EDITOR-POST-COMMAND-HOOK */
Object editor_post_command_hook(command_name,edit_state)
    Object command_name, edit_state;
{
    Object svref_new_value;

    x_note_fn_call(126,98);
    svref_new_value = Name_of_current_editor_command_qm;
    if (svref_new_value);
    else
	svref_new_value = command_name;
    return VALUES_1(SVREF(edit_state,FIX((SI_Long)56L)) = svref_new_value);
}

static Object Qg2_defstruct_structure_name_edit_state_g2_struct;  /* g2-defstruct-structure-name::edit-state-g2-struct */

static Object Qeditor_catch_all;   /* editor-catch-all */

/* COM-EDITOR-CATCH-ALL */
Object com_editor_catch_all(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, key_code;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,99);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      key_code = ISVREF(event,(SI_Long)1L);
	      if (FIXNUMP(key_code)) {
		  if (ISVREF(Current_edit_state,(SI_Long)66L))
		      handle_cyrillic_character_in_text_event(event);
		  else if (ISVREF(Current_edit_state,(SI_Long)61L) ? 
			  TRUEP(handle_hangul_character_in_text_event(event)) 
			  : TRUEP(Nil));
		  else if (IFIX(FIXNUM_LOGAND(key_code,Unicode_bit)) != 
			  (SI_Long)0L)
		      handle_character_in_text_event(event);
		  else if (convert_key_code_to_gensym_character(key_code))
		      handle_character_in_text_event(event);
	      }
	      editor_post_command_hook(Qeditor_catch_all,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

static Object Qevent;              /* event */

static Object Qedit_state;         /* edit-state */

static Object Qworkstation_context_specifics;  /* workstation-context-specifics */

/* EDITOR-CATCH-ALL-COMMAND-PURSUER */
Object editor_catch_all_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,100);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* EDITOR-CATCH-ALL-COMMAND-TRANSLATOR */
Object editor_catch_all_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,101);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qeditor_catch_all,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qunicode_character_in_text;  /* unicode-character-in-text */

/* COM-UNICODE-CHARACTER-IN-TEXT */
Object com_unicode_character_in_text(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,102);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      handle_character_in_text_event(event);
	      editor_post_command_hook(Qunicode_character_in_text,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* UNICODE-CHARACTER-IN-TEXT-COMMAND-PURSUER */
Object unicode_character_in_text_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,103);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* UNICODE-CHARACTER-IN-TEXT-COMMAND-TRANSLATOR */
Object unicode_character_in_text_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,104);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qunicode_character_in_text,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qinsertion_of_symbol;  /* insertion-of-symbol */

/* HANDLE-INSERTION-OF-SYMBOL */
Object handle_insertion_of_symbol(event)
    Object event;
{
    x_note_fn_call(126,105);
    if (ISVREF(Current_edit_state,(SI_Long)22L))
	return VALUES_1(Nil);
    else
	return enter_escape_context(1,Qinsertion_of_symbol);
}

static Object Qspace_or_convert_sl_next;  /* space-or-convert/next */

/* COM-SPACE-OR-CONVERT/NEXT */
Object com_space_or_convert_sl_next(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,106);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (ISVREF(Current_edit_state,(SI_Long)46L) && 
		      ISVREF(Current_edit_state,(SI_Long)47L))
		  do_trial_kfep_conversion(1,Nil);
	      else if (ISVREF(Current_edit_state,(SI_Long)69L) && 
		      token_menu_choices_exist_p())
		  convert_current_menu_choice();
	      else
		  insert_typed_in_character_at_cursor(FIX((SI_Long)32L));
	      editor_post_command_hook(Qspace_or_convert_sl_next,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* SPACE-OR-CONVERT/NEXT-COMMAND-PURSUER */
Object space_or_convert_sl_next_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,107);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* SPACE-OR-CONVERT/NEXT-COMMAND-TRANSLATOR */
Object space_or_convert_sl_next_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,108);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qspace_or_convert_sl_next,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qright;              /* right */

static Object Qgo_forward_character;  /* go-forward-character */

/* COM-GO-FORWARD-CHARACTER */
Object com_go_forward_character(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,109);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (arrows_usable_for_kfep_conversion_choices_p(Current_edit_state))
		  do_trial_kfep_conversion(2,Nil,Qright);
	      else if (ISVREF(Current_edit_state,(SI_Long)69L))
		  select_next_token_menu_choice(Qright);
	      else
		  move_or_delete_from_cursor(3,Nil,Nil,Nil);
	      editor_post_command_hook(Qgo_forward_character,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-FORWARD-CHARACTER-COMMAND-PURSUER */
Object go_forward_character_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,110);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-FORWARD-CHARACTER-COMMAND-TRANSLATOR */
Object go_forward_character_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,111);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_forward_character,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_backward_character;  /* go-backward-character */

/* COM-GO-BACKWARD-CHARACTER */
Object com_go_backward_character(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,112);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (arrows_usable_for_kfep_conversion_choices_p(Current_edit_state))
		  do_trial_kfep_conversion(2,Nil,Qleft);
	      else if (ISVREF(Current_edit_state,(SI_Long)69L))
		  select_next_token_menu_choice(Qleft);
	      else
		  move_or_delete_from_cursor(3,Nil,T,Nil);
	      editor_post_command_hook(Qgo_backward_character,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-BACKWARD-CHARACTER-COMMAND-PURSUER */
Object go_backward_character_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,113);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-BACKWARD-CHARACTER-COMMAND-TRANSLATOR */
Object go_backward_character_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,114);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_backward_character,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qup;                 /* up */

static Object Qgo_up_line;         /* go-up-line */

/* COM-GO-UP-LINE */
Object com_go_up_line(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,115);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (arrows_usable_for_kfep_conversion_choices_p(Current_edit_state))
		  do_trial_kfep_conversion(2,Nil,Qup);
	      else if (ISVREF(Current_edit_state,(SI_Long)69L))
		  select_next_token_menu_choice(Qleft);
	      else
		  move_down_line(1,FIX((SI_Long)-1L));
	      editor_post_command_hook(Qgo_up_line,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-UP-LINE-COMMAND-PURSUER */
Object go_up_line_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,116);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-UP-LINE-COMMAND-TRANSLATOR */
Object go_up_line_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,117);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_up_line,gensym_list_2(temp_1,
		    snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qdown;               /* down */

static Object Qgo_down_line;       /* go-down-line */

/* COM-GO-DOWN-LINE */
Object com_go_down_line(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,118);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (arrows_usable_for_kfep_conversion_choices_p(Current_edit_state))
		  do_trial_kfep_conversion(2,Nil,Qdown);
	      else if (ISVREF(Current_edit_state,(SI_Long)69L))
		  select_next_token_menu_choice(Qright);
	      else
		  move_down_line(1,FIX((SI_Long)1L));
	      editor_post_command_hook(Qgo_down_line,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-DOWN-LINE-COMMAND-PURSUER */
Object go_down_line_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,119);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-DOWN-LINE-COMMAND-TRANSLATOR */
Object go_down_line_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,120);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_down_line,gensym_list_2(temp_1,
		    snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qdelete_backward_word;  /* delete-backward-word */

/* COM-DELETE-BACKWARD-WORD */
Object com_delete_backward_word(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,121);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      move_or_delete_from_cursor_to_next_adjacent_word(T,T);
	      editor_post_command_hook(Qdelete_backward_word,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* DELETE-BACKWARD-WORD-COMMAND-PURSUER */
Object delete_backward_word_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,122);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* DELETE-BACKWARD-WORD-COMMAND-TRANSLATOR */
Object delete_backward_word_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,123);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qdelete_backward_word,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qdelete_forward_word;  /* delete-forward-word */

/* COM-DELETE-FORWARD-WORD */
Object com_delete_forward_word(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,124);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      move_or_delete_from_cursor_to_next_adjacent_word(T,Nil);
	      editor_post_command_hook(Qdelete_forward_word,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* DELETE-FORWARD-WORD-COMMAND-PURSUER */
Object delete_forward_word_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,125);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* DELETE-FORWARD-WORD-COMMAND-TRANSLATOR */
Object delete_forward_word_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,126);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qdelete_forward_word,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_backward_word;   /* go-backward-word */

/* COM-GO-BACKWARD-WORD */
Object com_go_backward_word(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,127);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      move_or_delete_from_cursor_to_next_adjacent_word(Nil,T);
	      editor_post_command_hook(Qgo_backward_word,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-BACKWARD-WORD-COMMAND-PURSUER */
Object go_backward_word_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,128);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-BACKWARD-WORD-COMMAND-TRANSLATOR */
Object go_backward_word_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,129);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_backward_word,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_forward_word;    /* go-forward-word */

/* COM-GO-FORWARD-WORD */
Object com_go_forward_word(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,130);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      move_or_delete_from_cursor_to_next_adjacent_word(Nil,Nil);
	      editor_post_command_hook(Qgo_forward_word,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-FORWARD-WORD-COMMAND-PURSUER */
Object go_forward_word_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,131);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-FORWARD-WORD-COMMAND-TRANSLATOR */
Object go_forward_word_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,132);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_forward_word,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object string_constant_7;   /* "There is nothing more to undo" */

static Object Qundo;               /* undo */

/* COM-UNDO */
Object com_undo(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,133);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (undo_or_redo_edit_possible_p(Nil))
		  undo_or_redo_edit(Nil);
	      else
		  display_editor_notification_1(tformat_text_string(1,
			  string_constant_7));
	      editor_post_command_hook(Qundo,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* UNDO-COMMAND-PURSUER */
Object undo_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,134);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* UNDO-COMMAND-TRANSLATOR */
Object undo_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,135);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qundo,gensym_list_2(temp_1,
		    snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object string_constant_8;   /* "There is nothing more to redo.  (You may only redo edits right after undoing them.)" */

static Object Qredo;               /* redo */

/* COM-REDO */
Object com_redo(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,136);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (undo_or_redo_edit_possible_p(T))
		  undo_or_redo_edit(T);
	      else
		  display_editor_notification_1(tformat_text_string(1,
			  string_constant_8));
	      editor_post_command_hook(Qredo,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* REDO-COMMAND-PURSUER */
Object redo_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,137);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* REDO-COMMAND-TRANSLATOR */
Object redo_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,138);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qredo,gensym_list_2(temp_1,
		    snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qdelete_backward_character;  /* delete-backward-character */

/* COM-DELETE-BACKWARD-CHARACTER */
Object com_delete_backward_character(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,139);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      delete_character(T);
	      editor_post_command_hook(Qdelete_backward_character,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* DELETE-BACKWARD-CHARACTER-COMMAND-PURSUER */
Object delete_backward_character_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,140);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* DELETE-BACKWARD-CHARACTER-COMMAND-TRANSLATOR */
Object delete_backward_character_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,141);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qdelete_backward_character,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qrubout_on_blank_text;  /* rubout-on-blank-text */

/* DELETE-CHARACTER */
Object delete_character(backward_p)
    Object backward_p;
{
    Object function_qm, text_region_qm;

    x_note_fn_call(126,142);
    if (ISVREF(Current_edit_state,(SI_Long)22L) && 
	    text_blank_p(ISVREF(Current_edit_state,(SI_Long)15L))) {
	function_qm = ISVREF(Current_edit_state,(SI_Long)23L);
	if (function_qm)
	    return FUNCALL_2(function_qm,ISVREF(Current_edit_state,
		    (SI_Long)15L),Qrubout_on_blank_text);
	else
	    return abort_current_workstation_context(Type_of_current_workstation_context);
    }
    else if (ISVREF(Current_edit_state,(SI_Long)46L) && 
	    ISVREF(Current_edit_state,(SI_Long)47L) && 
	    ISVREF(Current_edit_state,(SI_Long)48L))
	return unconvert_kfep_conversion_text_region();
    else {
	text_region_qm = get_selected_text_region_for_edit_box();
	if (text_region_qm)
	    return do_delete_within_editor();
	else
	    return move_or_delete_from_cursor(3,T,backward_p,Nil);
    }
}

static Object Qdelete_forward_character;  /* delete-forward-character */

/* COM-DELETE-FORWARD-CHARACTER */
Object com_delete_forward_character(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,143);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      delete_character(Nil);
	      editor_post_command_hook(Qdelete_forward_character,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* DELETE-FORWARD-CHARACTER-COMMAND-PURSUER */
Object delete_forward_character_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,144);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* DELETE-FORWARD-CHARACTER-COMMAND-TRANSLATOR */
Object delete_forward_character_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,145);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qdelete_forward_character,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qdelete_backward_to_beginning;  /* delete-backward-to-beginning */

/* COM-DELETE-BACKWARD-TO-BEGINNING */
Object com_delete_backward_to_beginning(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,146);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      change_edit_box(5,ISVREF(Current_edit_state,(SI_Long)15L),
		      FIX((SI_Long)1L),FIX((SI_Long)0L),
		      ISVREF(Current_edit_state,(SI_Long)24L),
		      ISVREF(Current_edit_state,(SI_Long)25L));
	      editor_post_command_hook(Qdelete_backward_to_beginning,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* DELETE-BACKWARD-TO-BEGINNING-COMMAND-PURSUER */
Object delete_backward_to_beginning_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,147);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* DELETE-BACKWARD-TO-BEGINNING-COMMAND-TRANSLATOR */
Object delete_backward_to_beginning_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,148);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qdelete_backward_to_beginning,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qforward;            /* forward */

static Object Qpage;               /* page */

/* MOVE-CURSOR-BY-PAGE-IN-EDITOR */
Object move_cursor_by_page_in_editor(direction_qm)
    Object direction_qm;
{
    Object text_box, text_box_format, gensymed_symbol_1;
    Object suppress_scrolling_into_view_global_flag_qm, image_plane;
    Object ab_loop_list_, gensymed_symbol_4, gensymed_symbol_5;
    Object gensymed_symbol_6, gensymed_symbol_7;
    SI_Long text_cell_interline_distance, gensymed_symbol, gensymed_symbol_2;
    SI_Long gensymed_symbol_3, number_of_lines_to_move_down;
    Declare_special(1);
    Object result;

    x_note_fn_call(126,149);
    text_box = ISVREF(Current_edit_state,(SI_Long)13L);
    text_box_format = ISVREF(text_box,(SI_Long)17L);
    text_cell_interline_distance = IFIX(FIXNUM_ADD(ISVREF(text_box_format,
	    (SI_Long)33L),ISVREF(text_box_format,(SI_Long)31L)));
    gensymed_symbol = EQ(direction_qm,Qforward) ? (SI_Long)1L : (SI_Long)-1L;
    gensymed_symbol_1 = ISVREF(text_box,(SI_Long)14L);
    gensymed_symbol_1 = gensymed_symbol_1 ? ISVREF(gensymed_symbol_1,
	    (SI_Long)3L) : FIX((SI_Long)0L);
    gensymed_symbol_2 = IFIX(gensymed_symbol_1);
    gensymed_symbol_1 = ISVREF(text_box,(SI_Long)14L);
    gensymed_symbol_1 = gensymed_symbol_1 ? ISVREF(gensymed_symbol_1,
	    (SI_Long)1L) : FIX((SI_Long)0L);
    gensymed_symbol_3 = IFIX(gensymed_symbol_1);
    gensymed_symbol_2 = gensymed_symbol_2 - gensymed_symbol_3;
    gensymed_symbol_3 = text_cell_interline_distance;
    gensymed_symbol_2 = IFIX(ltruncate(FIX(gensymed_symbol_2),
	    FIX(gensymed_symbol_3)));
    gensymed_symbol_3 = (SI_Long)1L;
    gensymed_symbol_2 = gensymed_symbol_2 - gensymed_symbol_3;
    number_of_lines_to_move_down = gensymed_symbol * gensymed_symbol_2;
    suppress_scrolling_into_view_global_flag_qm = T;
    PUSH_SPECIAL(Suppress_scrolling_into_view_global_flag_qm,suppress_scrolling_into_view_global_flag_qm,
	    0);
      move_down_line(2,FIX(number_of_lines_to_move_down),T);
      if (get_lookup_slot_value_given_default(text_box,
	      Qframe_transforms_of_block,Nil)) {
	  image_plane = Nil;
	  ab_loop_list_ = ISVREF(Current_edit_workspace,(SI_Long)16L);
	next_loop:
	  if ( !TRUEP(ab_loop_list_))
	      goto end_loop;
	  image_plane = M_CAR(ab_loop_list_);
	  ab_loop_list_ = M_CDR(ab_loop_list_);
	  gensymed_symbol_1 = ISVREF(ISVREF(ISVREF(ISVREF(text_box,
		  (SI_Long)1L),(SI_Long)11L),(SI_Long)24L),(SI_Long)1L);
	  gensymed_symbol_4 = text_box;
	  gensymed_symbol_5 = image_plane;
	  gensymed_symbol_6 = Qpage;
	  gensymed_symbol_7 = EQ(direction_qm,Qforward) ? Qdown : Qup;
	  inline_funcall_4(gensymed_symbol_1,gensymed_symbol_4,
		  gensymed_symbol_5,gensymed_symbol_6,gensymed_symbol_7);
	  goto next_loop;
	end_loop:
	  result = VALUES_1(Qnil);
      }
      else
	  result = VALUES_1(Nil);
    POP_SPECIAL();
    return result;
}

static Object Qbackward;           /* backward */

static Object Qgo_up_page;         /* go-up-page */

/* COM-GO-UP-PAGE */
Object com_go_up_page(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,150);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      move_cursor_by_page_in_editor(Qbackward);
	      editor_post_command_hook(Qgo_up_page,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-UP-PAGE-COMMAND-PURSUER */
Object go_up_page_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,151);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-UP-PAGE-COMMAND-TRANSLATOR */
Object go_up_page_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,152);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_up_page,gensym_list_2(temp_1,
		    snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_down_page;       /* go-down-page */

/* COM-GO-DOWN-PAGE */
Object com_go_down_page(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,153);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      move_cursor_by_page_in_editor(Qforward);
	      editor_post_command_hook(Qgo_down_page,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-DOWN-PAGE-COMMAND-PURSUER */
Object go_down_page_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,154);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-DOWN-PAGE-COMMAND-TRANSLATOR */
Object go_down_page_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,155);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_down_page,gensym_list_2(temp_1,
		    snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_to_beginning;    /* go-to-beginning */

/* COM-GO-TO-BEGINNING */
Object com_go_to_beginning(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,156);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      home_cursor();
	      editor_post_command_hook(Qgo_to_beginning,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-TO-BEGINNING-COMMAND-PURSUER */
Object go_to_beginning_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,157);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-TO-BEGINNING-COMMAND-TRANSLATOR */
Object go_to_beginning_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,158);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_to_beginning,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_to_end;          /* go-to-end */

/* COM-GO-TO-END */
Object com_go_to_end(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,159);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      home_down_cursor();
	      editor_post_command_hook(Qgo_to_end,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-TO-END-COMMAND-PURSUER */
Object go_to_end_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,160);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-TO-END-COMMAND-TRANSLATOR */
Object go_to_end_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,161);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_to_end,gensym_list_2(temp_1,
		    snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_to_beginning_of_line;  /* go-to-beginning-of-line */

/* COM-GO-TO-BEGINNING-OF-LINE */
Object com_go_to_beginning_of_line(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,162);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      move_or_delete_from_cursor(4,Nil,T,T,T);
	      editor_post_command_hook(Qgo_to_beginning_of_line,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-TO-BEGINNING-OF-LINE-COMMAND-PURSUER */
Object go_to_beginning_of_line_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,163);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-TO-BEGINNING-OF-LINE-COMMAND-TRANSLATOR */
Object go_to_beginning_of_line_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,164);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_to_beginning_of_line,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_to_end_of_line;  /* go-to-end-of-line */

/* COM-GO-TO-END-OF-LINE */
Object com_go_to_end_of_line(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,165);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      move_or_delete_from_cursor(4,Nil,Nil,T,T);
	      editor_post_command_hook(Qgo_to_end_of_line,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-TO-END-OF-LINE-COMMAND-PURSUER */
Object go_to_end_of_line_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,166);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-TO-END-OF-LINE-COMMAND-TRANSLATOR */
Object go_to_end_of_line_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,167);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_to_end_of_line,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qinsert_newline_complex_character;  /* insert-newline-complex-character */

/* COM-INSERT-NEWLINE-COMPLEX-CHARACTER */
Object com_insert_newline_complex_character(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,168);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      editor_newline();
	      editor_post_command_hook(Qinsert_newline_complex_character,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* INSERT-NEWLINE-COMPLEX-CHARACTER-COMMAND-PURSUER */
Object insert_newline_complex_character_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,169);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* INSERT-NEWLINE-COMPLEX-CHARACTER-COMMAND-TRANSLATOR */
Object insert_newline_complex_character_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,170);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qinsert_newline_complex_character,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object array_constant_1;    /* # */

/* EDITOR-NEWLINE */
Object editor_newline()
{
    Object text_region_qm, string_to_insert;

    x_note_fn_call(126,171);
    text_region_qm = get_selected_text_region_for_edit_box();
    string_to_insert = array_constant_1;
    if (text_region_qm)
	return replace_pending_delete_text_region(text_region_qm,
		string_to_insert);
    else
	return change_edit_box(6,ISVREF(Current_edit_state,(SI_Long)26L),
		ISVREF(Current_edit_state,(SI_Long)24L),
		ISVREF(Current_edit_state,(SI_Long)25L),Nil,Nil,
		string_to_insert);
}

static Object Qmaybe_insert_newline;  /* maybe-insert-newline */

/* COM-MAYBE-INSERT-NEWLINE */
Object com_maybe_insert_newline varargs_1(int, n)
{
    Object event, edit_state, mouse_pointer;
    Object selected_workspace_1, workspace, current_edit_state;
    Object current_edit_workspace, name_of_current_editor_command_qm, temp, x2;
    Object gensymed_symbol, gensymed_symbol_1, sub_class_bit_vector;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_2, gensymed_symbol_3, gensymed_symbol_4;
    char temp_1;
    Declare_varargs_nonrelocating;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,172);
    INIT_ARGS_nonrelocating();
    event = REQUIRED_ARG_nonrelocating();
    edit_state = REQUIRED_ARG_nonrelocating();
    mouse_pointer = REQUIRED_ARG_nonrelocating();
    selected_workspace_1 = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    workspace = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    if (event && edit_state && mouse_pointer && 
	    SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
	    (SI_Long)0L),Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (SIMPLE_VECTOR_P(workspace) && 
		      IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(workspace)) > 
		      (SI_Long)2L &&  !EQ(ISVREF(workspace,(SI_Long)1L),
		      Qavailable_frame_vector)) {
		  x2 = ISVREF(workspace,(SI_Long)1L);
		  gensymed_symbol = SIMPLE_VECTOR_P(x2) && EQ(ISVREF(x2,
			  (SI_Long)0L),
			  Qg2_defstruct_structure_name_class_description_g2_struct) 
			  ? x2 : Qnil;
	      }
	      else
		  gensymed_symbol = Nil;
	      if (gensymed_symbol) {
		  gensymed_symbol_1 = 
			  lookup_global_or_kb_specific_property_value(Qedit_workspace,
			  Class_description_gkbprop);
		  if (gensymed_symbol_1) {
		      sub_class_bit_vector = ISVREF(gensymed_symbol,
			      (SI_Long)19L);
		      superior_class_bit_number = 
			      IFIX(ISVREF(gensymed_symbol_1,(SI_Long)18L));
		      sub_class_vector_index = superior_class_bit_number 
			      >>  -  - (SI_Long)3L;
		      if (sub_class_vector_index < 
			      IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				  {
			  gensymed_symbol_2 = 
				  UBYTE_8_ISAREF_1(sub_class_bit_vector,
				  sub_class_vector_index);
			  gensymed_symbol_3 = (SI_Long)1L;
			  gensymed_symbol_4 = superior_class_bit_number & 
				  (SI_Long)7L;
			  gensymed_symbol_3 = gensymed_symbol_3 << 
				  gensymed_symbol_4;
			  gensymed_symbol_2 = gensymed_symbol_2 & 
				  gensymed_symbol_3;
			  temp_1 = (SI_Long)0L < gensymed_symbol_2;
		      }
		      else
			  temp_1 = TRUEP(Nil);
		  }
		  else
		      temp_1 = TRUEP(Nil);
	      }
	      else
		  temp_1 = TRUEP(Nil);
	      if (temp_1);
	      else {
		  if (SIMPLE_VECTOR_P(selected_workspace_1) && 
			  IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(selected_workspace_1)) 
			  > (SI_Long)2L &&  
			  !EQ(ISVREF(selected_workspace_1,(SI_Long)1L),
			  Qavailable_frame_vector)) {
		      x2 = ISVREF(selected_workspace_1,(SI_Long)1L);
		      gensymed_symbol = SIMPLE_VECTOR_P(x2) && 
			      EQ(ISVREF(x2,(SI_Long)0L),
			      Qg2_defstruct_structure_name_class_description_g2_struct) 
			      ? x2 : Qnil;
		  }
		  else
		      gensymed_symbol = Nil;
		  if (gensymed_symbol) {
		      gensymed_symbol_1 = 
			      lookup_global_or_kb_specific_property_value(Qedit_workspace,
			      Class_description_gkbprop);
		      if (gensymed_symbol_1) {
			  sub_class_bit_vector = ISVREF(gensymed_symbol,
				  (SI_Long)19L);
			  superior_class_bit_number = 
				  IFIX(ISVREF(gensymed_symbol_1,(SI_Long)18L));
			  sub_class_vector_index = 
				  superior_class_bit_number >>  -  - 
				  (SI_Long)3L;
			  if (sub_class_vector_index < 
				  IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				      {
			      gensymed_symbol_2 = 
				      UBYTE_8_ISAREF_1(sub_class_bit_vector,
				      sub_class_vector_index);
			      gensymed_symbol_3 = (SI_Long)1L;
			      gensymed_symbol_4 = 
				      superior_class_bit_number & (SI_Long)7L;
			      gensymed_symbol_3 = gensymed_symbol_3 << 
				      gensymed_symbol_4;
			      gensymed_symbol_2 = gensymed_symbol_2 & 
				      gensymed_symbol_3;
			      temp_1 = (SI_Long)0L < gensymed_symbol_2;
			  }
			  else
			      temp_1 = TRUEP(Nil);
		      }
		      else
			  temp_1 = TRUEP(Nil);
		  }
		  else
		      temp_1 = TRUEP(Nil);
	      }
	      if (temp_1)
		  editor_newline();
	      else
		  run_top_level_event_handler(mouse_pointer);
	      editor_post_command_hook(Qmaybe_insert_newline,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

static Object Qmouse_pointer;      /* mouse-pointer */

static Object Qselected_workspace;  /* selected-workspace */

static Object Qworkspace;          /* workspace */

/* MAYBE-INSERT-NEWLINE-COMMAND-PURSUER */
Object maybe_insert_newline_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state, mouse_pointer;
    Object selected_workspace_1, workspace;

    x_note_fn_call(126,173);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    mouse_pointer = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    selected_workspace_1 = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    workspace = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    mouse_pointer = command_argument_value(mouse_pointer);
    selected_workspace_1 = command_argument_value(selected_workspace_1);
    workspace = command_argument_value(workspace);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else if (EQ(mouse_pointer,Plus_missing_argument_plus))
	return VALUES_3(Qmouse_pointer,Qmouse_pointer,FIX((SI_Long)2L));
    else if (EQ(selected_workspace_1,Plus_missing_argument_plus))
	return VALUES_3(Qselected_workspace,Qselected_workspace,
		FIX((SI_Long)3L));
    else if (EQ(workspace,Plus_missing_argument_plus))
	return VALUES_3(Qworkspace,Qworkspace,FIX((SI_Long)4L));
    else
	return VALUES_1(Qnil);
}

/* MAYBE-INSERT-NEWLINE-COMMAND-TRANSLATOR */
Object maybe_insert_newline_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, mouse_pointer_1, selected_workspace_1, workspace;
    Object gensymed_symbol, gensymed_symbol_1, temp, car_new_value;

    x_note_fn_call(126,174);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    mouse_pointer_1 = mouse_pointer_blackboard_function(mouse_pointer);
    selected_workspace_1 = 
	    selected_workspace_blackboard_function(mouse_pointer);
    workspace = find_frame_of_class_in_mouse_pointer(mouse_pointer,Qworkspace);
    if (event && edit_state && mouse_pointer_1) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    gensymed_symbol = make_gensym_list_1(FIX((SI_Long)5L));
	    gensymed_symbol_1 = gensymed_symbol;
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    car_new_value = snapshot_command_argument(temp);
	    M_CAR(gensymed_symbol_1) = car_new_value;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    car_new_value = snapshot_command_argument(temp);
	    M_CAR(gensymed_symbol_1) = car_new_value;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    temp = mouse_pointer_1;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    car_new_value = snapshot_command_argument(temp);
	    M_CAR(gensymed_symbol_1) = car_new_value;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    car_new_value = snapshot_command_argument(selected_workspace_1);
	    M_CAR(gensymed_symbol_1) = car_new_value;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    car_new_value = snapshot_command_argument(workspace);
	    M_CAR(gensymed_symbol_1) = car_new_value;
	    return make_partial_command(Qmaybe_insert_newline,gensymed_symbol);
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qend_editing;        /* end-editing */

static Object Qdo_return_key_function;  /* do-return-key-function */

/* COM-DO-RETURN-KEY-FUNCTION */
Object com_do_return_key_function(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, temp_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,175);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (use_return_key_as_end_key_in_current_editor_p()) {
		  temp_1 = get_ui_command_function(Qend_editing);
		  FUNCALL_2(temp_1,Current_workstation_event,
			  Current_edit_state);
	      }
	      else {
		  temp_1 = 
			  get_ui_command_function(Qinsert_newline_complex_character);
		  FUNCALL_2(temp_1,Current_workstation_event,
			  Current_edit_state);
	      }
	      editor_post_command_hook(Qdo_return_key_function,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* DO-RETURN-KEY-FUNCTION-COMMAND-PURSUER */
Object do_return_key_function_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,176);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* DO-RETURN-KEY-FUNCTION-COMMAND-TRANSLATOR */
Object do_return_key_function_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,177);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qdo_return_key_function,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* USE-RETURN-KEY-AS-END-KEY-IN-CURRENT-EDITOR-P */
Object use_return_key_as_end_key_in_current_editor_p()
{
    Object edit_state, temp;

    x_note_fn_call(126,178);
    edit_state = Current_edit_state;
    temp = ISVREF(edit_state,(SI_Long)46L) ? ( 
	    !TRUEP(empty_text_region_p(ISVREF(edit_state,(SI_Long)46L))) ? 
	    T : Nil) : Qnil;
    if (temp)
	return VALUES_1(temp);
    else
	return VALUES_1( !TRUEP(ISVREF(edit_state,(SI_Long)68L)) ? T : Nil);
}

static Object Qtab_exit;           /* tab-exit */

static Object Qend;                /* end */

static Object Qdo_tab_function;    /* do-tab-function */

/* COM-DO-TAB-FUNCTION */
Object com_do_tab_function(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, svref_arg_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,179);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (ISVREF(Current_edit_state,(SI_Long)59L)) {
		  svref_arg_1 = Current_edit_state;
		  SVREF(svref_arg_1,FIX((SI_Long)60L)) = Qtab_exit;
		  extend_parsing_as_appropriate(1,Qend);
	      }
	      else
		  insert_n_spaces_or_tab();
	      editor_post_command_hook(Qdo_tab_function,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* DO-TAB-FUNCTION-COMMAND-PURSUER */
Object do_tab_function_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,180);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* DO-TAB-FUNCTION-COMMAND-TRANSLATOR */
Object do_tab_function_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,181);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qdo_tab_function,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* INSERT-N-SPACES-OR-TAB */
Object insert_n_spaces_or_tab()
{
    Object text_line_to_insert;

    x_note_fn_call(126,182);
    text_line_to_insert = EQ(ISVREF(Current_edit_state,(SI_Long)22L),
	    Qinsertion_of_symbol) || IFIX(ISVREF(Editor_parameters,
	    (SI_Long)25L)) == (SI_Long)0L ? 
	    make_stringw_function(FIX((SI_Long)1L),FIX((SI_Long)9L)) : 
	    make_stringw_function(ISVREF(Editor_parameters,(SI_Long)25L),
	    FIX((SI_Long)32L));
    change_edit_box(6,ISVREF(Current_edit_state,(SI_Long)26L),
	    ISVREF(Current_edit_state,(SI_Long)24L),
	    ISVREF(Current_edit_state,(SI_Long)25L),Nil,Nil,
	    text_line_to_insert);
    return reclaim_text_string(text_line_to_insert);
}

/* COM-END-EDITING */
Object com_end_editing(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,183);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      end_editing();
	      editor_post_command_hook(Qend_editing,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* END-EDITING-COMMAND-PURSUER */
Object end_editing_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,184);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* END-EDITING-COMMAND-TRANSLATOR */
Object end_editing_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,185);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qend_editing,gensym_list_2(temp_1,
		    snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qend_exit;           /* end-exit */

/* END-EDITING */
Object end_editing()
{
    Object temp, svref_arg_1;

    x_note_fn_call(126,186);
    if (ISVREF(Current_edit_state,(SI_Long)22L)) {
	if (ISVREF(Current_edit_state,(SI_Long)23L)) {
	    temp = SYMBOL_FUNCTION(ISVREF(Current_edit_state,(SI_Long)23L));
	    return FUNCALL_2(temp,ISVREF(Current_edit_state,(SI_Long)15L),
		    Qend_editing);
	}
	else
	    return VALUES_1(Nil);
    }
    else if (ISVREF(Current_edit_state,(SI_Long)46L) &&  
	    !TRUEP(empty_text_region_p(ISVREF(Current_edit_state,
	    (SI_Long)46L))))
	return accept_kfep_conversion();
    else {
	svref_arg_1 = Current_edit_state;
	SVREF(svref_arg_1,FIX((SI_Long)60L)) = Qend_exit;
	return extend_parsing_as_appropriate(1,Qend);
    }
}

static Object Qabort_editing;      /* abort-editing */

/* COM-ABORT-EDITING */
Object com_abort_editing(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,187);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      cancel_editing();
	      editor_post_command_hook(Qabort_editing,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* ABORT-EDITING-COMMAND-PURSUER */
Object abort_editing_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,188);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* ABORT-EDITING-COMMAND-TRANSLATOR */
Object abort_editing_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,189);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qabort_editing,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object string_constant_9;   /* "Discard edits? (Changes made to the edited text will be lost!)" */

static Object Qabort_editing_current_workstation_context;  /* abort-editing-current-workstation-context */

/* CANCEL-EDITING */
Object cancel_editing()
{
    Object block, image_plane, ab_loop_list_;
    char temp;

    x_note_fn_call(126,190);
    temp =  !TRUEP(ISVREF(Current_edit_state,(SI_Long)34L));
    if (temp);
    else {
	temp =  !TRUEP(ISVREF(Current_edit_state,(SI_Long)3L));
	if (temp);
	else {
	    block = ISVREF(Current_edit_state,(SI_Long)3L);
	    temp = (SI_Long)0L != (IFIX(ISVREF(block,(SI_Long)4L)) & 
		    (SI_Long)1L);
	    if (temp);
	    else {
		block = ISVREF(Current_edit_state,(SI_Long)3L);
		temp = (SI_Long)0L != (IFIX(ISVREF(block,(SI_Long)5L)) & 
			(SI_Long)262144L);
	    }
	    temp =  !temp;
	}
    }
    if (temp);
    else
	temp = TRUEP(ISVREF(Current_edit_state,(SI_Long)76L));
    if (temp)
	return abort_editing_current_workstation_context();
    else {
	image_plane = Nil;
	ab_loop_list_ = ISVREF(Current_edit_workspace,(SI_Long)16L);
      next_loop:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	image_plane = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	raise_image_plane_to_top(2,image_plane,Nil);
	goto next_loop;
      end_loop:;
	return confirm_or_cancel(2,tformat_text_string(1,
		string_constant_9),Qabort_editing_current_workstation_context);
    }
}

/* ABORT-EDITING-CURRENT-WORKSTATION-CONTEXT */
Object abort_editing_current_workstation_context()
{
    x_note_fn_call(126,191);
    return abort_current_workstation_context(Qediting);
}

static Object Qinsert_accented_or_special_or_coded_character;  /* insert-accented-or-special-or-coded-character */

/* COM-INSERT-ACCENTED-OR-SPECIAL-OR-CODED-CHARACTER */
Object com_insert_accented_or_special_or_coded_character(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,192);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      handle_insertion_of_symbol(event);
	      editor_post_command_hook(Qinsert_accented_or_special_or_coded_character,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* INSERT-ACCENTED-OR-SPECIAL-OR-CODED-CHARACTER-COMMAND-PURSUER */
Object insert_accented_or_special_or_coded_character_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,193);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* INSERT-ACCENTED-OR-SPECIAL-OR-CODED-CHARACTER-COMMAND-TRANSLATOR */
Object insert_accented_or_special_or_coded_character_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,194);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qinsert_accented_or_special_or_coded_character,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* MOUSE-UP-IN-EDITING-CONTEXT */
Object mouse_up_in_editing_context(mouse_pointer)
    Object mouse_pointer;
{
    x_note_fn_call(126,195);
    return VALUES_1(mouse_pointer);
}

static Object Qkorean;             /* korean */

static Object Qjapanese;           /* japanese */

static Object Qkatakana;           /* katakana */

static Object Qhiragana;           /* hiragana */

static Object Qrussian;            /* russian */

static Object Qcycle_to_next_kana;  /* cycle-to-next-kana */

/* COM-CYCLE-TO-NEXT-KANA */
Object com_cycle_to_next_kana(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, temp_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,196);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      temp_1 = ISVREF(Current_edit_state,(SI_Long)45L);
	      if (EQ(temp_1,Qkorean)) {
		  if (ISVREF(Current_edit_state,(SI_Long)61L))
		      exit_hangul_input_mode();
		  else
		      enter_hangul_input_mode();
	      }
	      else if (EQ(temp_1,Qjapanese)) {
		  temp_1 = ISVREF(Current_edit_state,(SI_Long)46L) ? 
			  ISVREF(Current_edit_state,(SI_Long)50L) : Nil;
		  if (EQ(temp_1,Qnil)) {
		      if (ISVREF(Current_edit_state,(SI_Long)46L))
			  enter_kana_conversion_mode(Qkatakana);
		      else
			  enter_kana_conversion_mode(Nil);
		  }
		  else if (EQ(temp_1,Qhiragana))
		      exit_kfep_mode_if_necessary(0);
		  else if (EQ(temp_1,Qkatakana))
		      enter_kana_conversion_mode(Qhiragana);
	      }
	      else if (EQ(temp_1,Qrussian)) {
		  if (ISVREF(Current_edit_state,(SI_Long)66L))
		      exit_cyrillic_input_mode();
		  else
		      enter_cyrillic_input_mode();
	      }
	      editor_post_command_hook(Qcycle_to_next_kana,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* CYCLE-TO-NEXT-KANA-COMMAND-PURSUER */
Object cycle_to_next_kana_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,197);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* CYCLE-TO-NEXT-KANA-COMMAND-TRANSLATOR */
Object cycle_to_next_kana_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,198);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qcycle_to_next_kana,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qenter_kanji_mode;   /* enter-kanji-mode */

/* COM-ENTER-KANJI-MODE */
Object com_enter_kanji_mode(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,199);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (EQ(ISVREF(Current_edit_state,(SI_Long)45L),Qjapanese))
		  enter_kana_conversion_mode(Nil);
	      editor_post_command_hook(Qenter_kanji_mode,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* ENTER-KANJI-MODE-COMMAND-PURSUER */
Object enter_kanji_mode_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,200);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* ENTER-KANJI-MODE-COMMAND-TRANSLATOR */
Object enter_kanji_mode_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,201);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qenter_kanji_mode,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_up_one_row_in_kfep_conversion_choice_menu;  /* go-up-one-row-in-kfep-conversion-choice-menu */

/* COM-GO-UP-ONE-ROW-IN-KFEP-CONVERSION-CHOICE-MENU */
Object com_go_up_one_row_in_kfep_conversion_choice_menu(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,202);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (arrows_usable_for_kfep_conversion_choices_p(Current_edit_state))
		  do_trial_kfep_conversion(2,Nil,Qup);
	      editor_post_command_hook(Qgo_up_one_row_in_kfep_conversion_choice_menu,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-UP-ONE-ROW-IN-KFEP-CONVERSION-CHOICE-MENU-COMMAND-PURSUER */
Object go_up_one_row_in_kfep_conversion_choice_menu_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,203);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-UP-ONE-ROW-IN-KFEP-CONVERSION-CHOICE-MENU-COMMAND-TRANSLATOR */
Object go_up_one_row_in_kfep_conversion_choice_menu_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,204);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_up_one_row_in_kfep_conversion_choice_menu,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_down_one_row_in_kfep_conversion_choice_menu;  /* go-down-one-row-in-kfep-conversion-choice-menu */

/* COM-GO-DOWN-ONE-ROW-IN-KFEP-CONVERSION-CHOICE-MENU */
Object com_go_down_one_row_in_kfep_conversion_choice_menu(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,205);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (arrows_usable_for_kfep_conversion_choices_p(Current_edit_state))
		  do_trial_kfep_conversion(2,Nil,Qdown);
	      editor_post_command_hook(Qgo_down_one_row_in_kfep_conversion_choice_menu,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-DOWN-ONE-ROW-IN-KFEP-CONVERSION-CHOICE-MENU-COMMAND-PURSUER */
Object go_down_one_row_in_kfep_conversion_choice_menu_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,206);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-DOWN-ONE-ROW-IN-KFEP-CONVERSION-CHOICE-MENU-COMMAND-TRANSLATOR */
Object go_down_one_row_in_kfep_conversion_choice_menu_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,207);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_down_one_row_in_kfep_conversion_choice_menu,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qskip_kfep_conversion;  /* skip-kfep-conversion */

/* COM-SKIP-KFEP-CONVERSION */
Object com_skip_kfep_conversion(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,208);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (ISVREF(Current_edit_state,(SI_Long)46L) &&  
		      !TRUEP(ISVREF(Current_edit_state,(SI_Long)50L)) &&  
		      !(ISVREF(Current_edit_state,(SI_Long)47L) && 
		      ISVREF(Current_edit_state,(SI_Long)48L)) &&  
		      !(FIXNUM_EQ(ISVREF(Current_edit_state,(SI_Long)24L),
		      ISVREF(ISVREF(Current_edit_state,(SI_Long)46L),
		      (SI_Long)16L)) && 
		      FIXNUM_EQ(ISVREF(Current_edit_state,(SI_Long)25L),
		      ISVREF(ISVREF(Current_edit_state,(SI_Long)46L),
		      (SI_Long)17L))))
		  skip_kfep_conversion();
	      editor_post_command_hook(Qskip_kfep_conversion,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* SKIP-KFEP-CONVERSION-COMMAND-PURSUER */
Object skip_kfep_conversion_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,209);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* SKIP-KFEP-CONVERSION-COMMAND-TRANSLATOR */
Object skip_kfep_conversion_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,210);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qskip_kfep_conversion,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* ARROWS-USABLE-FOR-KFEP-CONVERSION-CHOICES-P */
Object arrows_usable_for_kfep_conversion_choices_p(edit_state)
    Object edit_state;
{
    Object temp;

    x_note_fn_call(126,211);
    if (ISVREF(edit_state,(SI_Long)46L) && ISVREF(edit_state,(SI_Long)47L) 
	    && ISVREF(edit_state,(SI_Long)48L)) {
	temp = ISVREF(edit_state,(SI_Long)47L);
	return VALUES_1( !EQ(CADR(temp),T) ? T : Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qshrink_kfep_conversion_text_region;  /* shrink-kfep-conversion-text-region */

/* COM-SHRINK-KFEP-CONVERSION-TEXT-REGION */
Object com_shrink_kfep_conversion_text_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,212);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (ISVREF(Current_edit_state,(SI_Long)46L) ? 
		      TRUEP(ISVREF(Current_edit_state,(SI_Long)47L)) : 
		      TRUEP(Nil))
		  expand_or_shrink_kfep_conversion_text_region(Nil);
	      editor_post_command_hook(Qshrink_kfep_conversion_text_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* SHRINK-KFEP-CONVERSION-TEXT-REGION-COMMAND-PURSUER */
Object shrink_kfep_conversion_text_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,213);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* SHRINK-KFEP-CONVERSION-TEXT-REGION-COMMAND-TRANSLATOR */
Object shrink_kfep_conversion_text_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,214);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qshrink_kfep_conversion_text_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qexpand_kfep_conversion_text_region;  /* expand-kfep-conversion-text-region */

/* COM-EXPAND-KFEP-CONVERSION-TEXT-REGION */
Object com_expand_kfep_conversion_text_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, adjacent_line_index_qm;
    Object adjacent_character_index_qm;
    char temp_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,215);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (ISVREF(Current_edit_state,(SI_Long)46L)) {
		  if (ISVREF(Current_edit_state,(SI_Long)47L)) {
		      result = find_position_adjacent_to_end_of_kfep_conversion_text_region(Nil);
		      MVS_2(result,adjacent_line_index_qm,
			      adjacent_character_index_qm);
		      temp_1 = adjacent_line_index_qm ?  
			      !(FIXNUM_LT(ISVREF(Current_edit_state,
			      (SI_Long)24L),adjacent_line_index_qm) || 
			      FIXNUM_EQ(ISVREF(Current_edit_state,
			      (SI_Long)24L),adjacent_line_index_qm) && 
			      FIXNUM_LT(ISVREF(Current_edit_state,
			      (SI_Long)25L),adjacent_character_index_qm)) :
			       TRUEP(Qnil);
		  }
		  else
		      temp_1 = TRUEP(Nil);
	      }
	      else
		  temp_1 = TRUEP(Nil);
	      if (temp_1)
		  expand_or_shrink_kfep_conversion_text_region(T);
	      editor_post_command_hook(Qexpand_kfep_conversion_text_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* EXPAND-KFEP-CONVERSION-TEXT-REGION-COMMAND-PURSUER */
Object expand_kfep_conversion_text_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,216);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* EXPAND-KFEP-CONVERSION-TEXT-REGION-COMMAND-TRANSLATOR */
Object expand_kfep_conversion_text_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,217);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qexpand_kfep_conversion_text_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* HOME-CURSOR */
Object home_cursor()
{
    x_note_fn_call(126,218);
    return move_or_delete_from_cursor(3,Nil,T,T);
}

/* HOME-DOWN-CURSOR */
Object home_down_cursor()
{
    x_note_fn_call(126,219);
    return move_or_delete_from_cursor(3,Nil,Nil,T);
}

static Object list_constant_6;     /* # */

static Object Qsearch_for_text_in_editor;  /* search-for-text-in-editor */

static Object Qtext_inserter;      /* text-inserter */

static Object Qdo_edit_subcommand;  /* do-edit-subcommand */

static Object Qg2_login;           /* g2-login */

static Object Qtoken_menu;         /* token-menu */

static Object Qbutton;             /* button */

static Object Quser_settings_editor_workspace;  /* user-settings-editor-workspace */

static Object Qno_autocompletion;  /* no-autocompletion */

static Object Qcategory_menu;      /* category-menu */

static Object Qchoice;             /* choice */

static Object Qcategory_instance_menu_workspace;  /* category-instance-menu-workspace */

static Object Qobject_name;        /* object-name */

static Object string_constant_10;  /* "Enter ~a" */

static Object Qblinker;            /* blinker */

static Object Qallow_selection_of_outside_text_from_editor;  /* allow-selection-of-outside-text-from-editor */

static Object Qkfep_conversion_choice_menu;  /* kfep-conversion-choice-menu */

static Object Qallow_selection_of_text;  /* allow-selection-of-text */

static Object list_constant_7;     /* # */

static Object Qtable;              /* table */

static Object Qmenu;               /* menu */

static Object Qscrap;              /* scrap */

static Object list_constant_8;     /* # */

static Object Qcontinue_edit_after_mouse_watch;  /* continue-edit-after-mouse-watch */

/* HANDLE-MOUSE-DOWN-EVENT-IN-EDIT-CONTEXT */
Object handle_mouse_down_event_in_edit_context(mouse_pointer)
    Object mouse_pointer;
{
    Object mouse_pointer_1, mouse_event, innermost_spot, edit_state;
    Object current_edit_state, current_edit_workspace, object_near_cursor_qm;
    Object image_plane, x_in_window, y_in_window, x2, block_near_cursor_qm;
    Object class_description, inheritance_path_qm, gensymed_symbol;
    Object superblock_qm, click_on_editor_qm, temp_1, sub_class_bit_vector;
    Object button, workspace_for_selected_block, token_cell_qm;
    Object token_text_string, temp_2, temp_3, temp_4, temp_5, temp_6, temp_7;
    Object token_value, category_symbol, menu_of_names, workspace;
    Object old_image_plane_qm, item_or_value, old_workspace_qm, temp_8;
    Object svref_new_value, text_box_or_table, text_cell_format, cell_qm;
    Object text_cell_qm, left_edge_of_area, top_edge_of_area;
    Object right_edge_of_area, bottom_edge_of_area, line_index_for_fixed_end;
    Object character_index_for_fixed_end, text_region, x_in_workspace;
    Object y_in_workspace, current_image_plane, gensym_window;
    Object left_edge_of_draw_area, top_edge_of_draw_area;
    Object right_edge_of_draw_area, bottom_edge_of_draw_area;
    Object current_image_x_scale, current_image_y_scale;
    Object current_x_origin_of_drawing, current_y_origin_of_drawing;
    Object current_frame_transform_qm, enclosing_block;
    Object frame_transforms_of_block_qm, frame_transforms_of_enclosing_block;
    Object frame_transform, value, incff_1_arg, scale_1, class_1;
    Object ab_loop_list_, ab_loop_it_, temp_10, gensymed_symbol_4;
    Object gensymed_symbol_5, gensymed_symbol_6, gensymed_symbol_7;
    Object gensymed_symbol_8, text_region_qm, row;
    Object frame_serial_number_setf_arg, old, new_1;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3, scale;
    SI_Long unshifted_result, x_offset, y_offset, temp_9, left, top, right;
    SI_Long bottom;
    char temp;
    Declare_special(31);
    Object result;

    x_note_fn_call(126,220);
    mouse_pointer_1 = mouse_pointer_blackboard_function(mouse_pointer);
    mouse_event = event_blackboard_function(mouse_pointer);
    innermost_spot = innermost_spot_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (mouse_pointer_1 && mouse_event && innermost_spot && edit_state) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,30);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,29);
	    result = find_object_near_workstation_event(3,mouse_event,Nil,
		    list_constant_6);
	    MVS_4(result,object_near_cursor_qm,image_plane,x_in_window,
		    y_in_window);
	    if (object_near_cursor_qm) {
		if (SIMPLE_VECTOR_P(object_near_cursor_qm) && 
			IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(object_near_cursor_qm)) 
			> (SI_Long)2L &&  !EQ(ISVREF(object_near_cursor_qm,
			(SI_Long)1L),Qavailable_frame_vector)) {
		    x2 = ISVREF(object_near_cursor_qm,(SI_Long)1L);
		    temp = SIMPLE_VECTOR_P(x2) && EQ(ISVREF(x2,
			    (SI_Long)0L),
			    Qg2_defstruct_structure_name_class_description_g2_struct) 
			    ? TRUEP(x2) : TRUEP(Qnil);
		}
		else
		    temp = TRUEP(Nil);
	    }
	    else
		temp = TRUEP(Nil);
	    block_near_cursor_qm = temp ? object_near_cursor_qm : Nil;
	    if (block_near_cursor_qm) {
		class_description = ISVREF(block_near_cursor_qm,(SI_Long)1L);
		inheritance_path_qm = ISVREF(class_description,(SI_Long)2L);
	    }
	    else
		inheritance_path_qm = Nil;
	    if (block_near_cursor_qm) {
		gensymed_symbol = ISVREF(block_near_cursor_qm,(SI_Long)14L);
		gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
			(SI_Long)5L) : Nil;
		superblock_qm = gensymed_symbol;
	    }
	    else
		superblock_qm = Nil;
	    click_on_editor_qm = memq_function(image_plane,
		    ISVREF(ISVREF(edit_state,(SI_Long)12L),(SI_Long)16L));
	    if (ISVREF(Current_edit_state,(SI_Long)22L) &&  
		    !EQ(ISVREF(Current_edit_state,(SI_Long)22L),
		    Qsearch_for_text_in_editor) && ( !EQ(image_plane,
		    ISVREF(Current_workstation_context,(SI_Long)5L)) ||  
		    !TRUEP(inheritance_path_qm) ||  
		    !TRUEP(memq_function(Qtext_inserter,
			inheritance_path_qm)))) {
		if ( !(EQ(image_plane,ISVREF(Current_workstation_context,
			(SI_Long)5L)) || click_on_editor_qm)) {
		    requeue_workstation_event(Current_workstation,mouse_event);
		    abort_current_workstation_context(Qediting);
		}
		if (SIMPLE_VECTOR_P(innermost_spot) && 
			EQ(ISVREF(innermost_spot,(SI_Long)0L),
			Qg2_defstruct_structure_name_subcommand_menu_button_spot_g2_struct) 
			&& click_on_editor_qm) {
		    establish_next_workstation_context_continuation(Qdo_edit_subcommand,
			    Nil,Nil,Nil);
		    result = enter_subcommand_context(mouse_pointer_1);
		}
		else
		    result = VALUES_1(Nil);
	    }
	    else {
		if (EQ(ISVREF(Current_workstation,(SI_Long)18L),Qg2_login)) {
		    temp =  !TRUEP(inheritance_path_qm);
		    if (temp);
		    else {
			temp_1 = get_workspace_if_any(object_near_cursor_qm);
			temp =  !(EQ(temp_1,ISVREF(Current_edit_state,
				(SI_Long)12L)) || 
				memq_function(Qtoken_menu,
				inheritance_path_qm));
		    }
		}
		else
		    temp = TRUEP(Nil);
		if (temp) {
		    requeue_workstation_event(Current_workstation,mouse_event);
		    result = abort_current_workstation_context(Qediting);
		}
		else {
		    if (click_on_editor_qm) {
			temp = TRUEP(memq_function(Qbutton,
				inheritance_path_qm));
			if (temp);
			else if (superblock_qm) {
			    sub_class_bit_vector = 
				    ISVREF(ISVREF(superblock_qm,
				    (SI_Long)1L),(SI_Long)19L);
			    superior_class_bit_number = 
				    IFIX(ISVREF(Button_class_description,
				    (SI_Long)18L));
			    sub_class_vector_index = 
				    superior_class_bit_number >>  -  - 
				    (SI_Long)3L;
			    if (sub_class_vector_index < 
				    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
					{
				gensymed_symbol_1 = 
					UBYTE_8_ISAREF_1(sub_class_bit_vector,
					sub_class_vector_index);
				gensymed_symbol_2 = (SI_Long)1L;
				gensymed_symbol_3 = 
					superior_class_bit_number & 
					(SI_Long)7L;
				gensymed_symbol_2 = gensymed_symbol_2 << 
					gensymed_symbol_3;
				gensymed_symbol_1 = gensymed_symbol_1 & 
					gensymed_symbol_2;
				temp = (SI_Long)0L < gensymed_symbol_1;
			    }
			    else
				temp = TRUEP(Nil);
			}
			else
			    temp = TRUEP(Nil);
		    }
		    else
			temp = TRUEP(Nil);
		    if (temp) {
			button = memq_function(Qbutton,
				inheritance_path_qm) ? 
				object_near_cursor_qm : superblock_qm;
			result = enter_button_down_context(button,image_plane);
		    }
		    else if ( !TRUEP(inheritance_path_qm) ||  
			    !TRUEP(memq_function(Qblock,inheritance_path_qm)))
			result = run_top_level_event_handler(mouse_pointer_1);
		    else {
			workspace_for_selected_block = 
				get_workspace_if_any(object_near_cursor_qm);
			sub_class_bit_vector = 
				ISVREF(ISVREF(workspace_for_selected_block,
				(SI_Long)1L),(SI_Long)19L);
			superior_class_bit_number = 
				IFIX(ISVREF(Icon_editor_workspace_class_description,
				(SI_Long)18L));
			sub_class_vector_index = superior_class_bit_number 
				>>  -  - (SI_Long)3L;
			if (sub_class_vector_index < 
				IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				    {
			    gensymed_symbol_1 = 
				    UBYTE_8_ISAREF_1(sub_class_bit_vector,
				    sub_class_vector_index);
			    gensymed_symbol_2 = (SI_Long)1L;
			    gensymed_symbol_3 = superior_class_bit_number 
				    & (SI_Long)7L;
			    gensymed_symbol_2 = gensymed_symbol_2 << 
				    gensymed_symbol_3;
			    gensymed_symbol_1 = gensymed_symbol_1 & 
				    gensymed_symbol_2;
			    temp = (SI_Long)0L < gensymed_symbol_1;
			}
			else
			    temp = TRUEP(Nil);
			if (temp);
			else {
			    gensymed_symbol = 
				    lookup_global_or_kb_specific_property_value(Quser_settings_editor_workspace,
				    Class_description_gkbprop);
			    if (gensymed_symbol) {
				sub_class_bit_vector = 
					ISVREF(ISVREF(workspace_for_selected_block,
					(SI_Long)1L),(SI_Long)19L);
				superior_class_bit_number = 
					IFIX(ISVREF(gensymed_symbol,
					(SI_Long)18L));
				sub_class_vector_index = 
					superior_class_bit_number >>  -  - 
					(SI_Long)3L;
				if (sub_class_vector_index < 
					IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
					    {
				    gensymed_symbol_1 = 
					    UBYTE_8_ISAREF_1(sub_class_bit_vector,
					    sub_class_vector_index);
				    gensymed_symbol_2 = (SI_Long)1L;
				    gensymed_symbol_3 = 
					    superior_class_bit_number & 
					    (SI_Long)7L;
				    gensymed_symbol_2 = gensymed_symbol_2 
					    << gensymed_symbol_3;
				    gensymed_symbol_1 = gensymed_symbol_1 
					    & gensymed_symbol_2;
				    temp = (SI_Long)0L < gensymed_symbol_1;
				}
				else
				    temp = TRUEP(Nil);
			    }
			    else
				temp = TRUEP(Nil);
			}
			if (temp)
			    result = run_top_level_event_handler(mouse_pointer_1);
			else {
			    if (SIMPLE_VECTOR_P(innermost_spot) && 
				    EQ(ISVREF(innermost_spot,(SI_Long)0L),
				    Qg2_defstruct_structure_name_subcommand_menu_button_spot_g2_struct)) 
					{
				temp_1 = 
					get_workspace_if_any(object_near_cursor_qm);
				temp = EQ(temp_1,Current_edit_workspace);
			    }
			    else
				temp = TRUEP(Nil);
			    if (temp) {
				establish_next_workstation_context_continuation(Qdo_edit_subcommand,
					Nil,Nil,Nil);
				result = enter_subcommand_context(mouse_pointer_1);
			    }
			    else {
				if (memq_function(Qeditor_notification,
					inheritance_path_qm)) {
				    temp_1 = 
					    get_workspace_if_any(object_near_cursor_qm);
				    temp = EQ(temp_1,Current_edit_workspace);
				}
				else
				    temp = TRUEP(Nil);
				if (temp)
				    result = extend_parsing_as_appropriate(1,
					    Qno_autocompletion);
				else {
				    if (memq_function(Qcategory_menu,
					    inheritance_path_qm)) {
					temp_1 = 
						get_workspace_if_any(object_near_cursor_qm);
					temp = EQ(temp_1,
						Current_edit_workspace);
				    }
				    else
					temp = TRUEP(Nil);
				    if (temp) {
					token_cell_qm = 
						pick_cell_from_table(6,
						object_near_cursor_qm,
						image_plane,x_in_window,
						y_in_window,Nil,T);
					if (token_cell_qm) {
					    token_text_string = 
						    convert_text_to_text_string(1,
						    CDDDR(token_cell_qm));
					    temp_2 = 
						    determine_appropriate_tokenizer();
					    temp_3 = 
						    ISVREF(Current_edit_state,
						    (SI_Long)24L);
					    temp_4 = 
						    ISVREF(Current_edit_state,
						    (SI_Long)25L);
					    temp_1 = 
						    ISVREF(Current_edit_state,
						    (SI_Long)29L);
					    temp_1 = CAR(temp_1);
					    temp_5 = CAR(temp_1);
					    temp_1 = 
						    ISVREF(Current_edit_state,
						    (SI_Long)29L);
					    temp_1 = CAR(temp_1);
					    temp_6 = CADR(temp_1);
					    temp_7 = 
						    ISVREF(Current_edit_state,
						    (SI_Long)28L);
					    temp_1 = 
						    ISVREF(Current_edit_state,
						    (SI_Long)31L);
					    temp_1 = 
						    get_next_token_from_text_if_available(7,
						    temp_2,temp_3,temp_4,
						    temp_5,temp_6,temp_7,
						    CAR(temp_1));
					    token_value = temp_1;
					    category_symbol = 
						    getfq_function_no_default(CADR(token_cell_qm),
						    Qchoice);
					    menu_of_names = 
						    make_menu_of_names_from_directory(category_symbol,
						    text_string_p(token_value) 
						    ? token_value : Nil);
					    if (text_string_p(token_value))
						reclaim_text_string(token_value);
					    if (menu_of_names) {
						workspace = 
							make_workspace(3,
							Qcategory_instance_menu_workspace,
							Nil,
							make_token_menu_table(3,
							menu_of_names,
							EQ(category_symbol,
							Qobject_name) ? 
							ISVREF(Editor_parameters,
							(SI_Long)23L) : 
							Nil,category_symbol));
						old_image_plane_qm = 
							ISVREF(Current_edit_state,
							(SI_Long)53L);
						item_or_value = 
							ISVREF(Current_edit_state,
							(SI_Long)52L);
						old_workspace_qm = 
							CONSP(item_or_value) 
							&& 
							EQ(M_CDR(item_or_value),
							Qitem_reference) ? 
							ISVREF(M_CAR(item_or_value),
							(SI_Long)3L) : 
							item_or_value;
						if (old_image_plane_qm && 
							old_workspace_qm 
							&& 
							EQ(ISVREF(old_image_plane_qm,
							(SI_Long)5L),
							old_workspace_qm) 
							&&  
							!TRUEP(get_lookup_slot_value_given_default(old_workspace_qm,
							Qname_or_names_for_frame,
							Nil))) {
						    gensymed_symbol = 
							    ISVREF(workspace,
							    (SI_Long)14L);
						    gensymed_symbol = 
							    gensymed_symbol 
							    ? 
							    ISVREF(gensymed_symbol,
							    (SI_Long)2L) : 
							    FIX((SI_Long)0L);
						    temp_1 = gensymed_symbol;
						    gensymed_symbol = 
							    ISVREF(workspace,
							    (SI_Long)14L);
						    gensymed_symbol = 
							    gensymed_symbol 
							    ? 
							    ISVREF(gensymed_symbol,
							    (SI_Long)1L) : 
							    FIX((SI_Long)0L);
						    transform_image(10,
							    old_image_plane_qm,
							    workspace,Nil,
							    Nil,Nil,Nil,
							    temp_1,
							    gensymed_symbol,
							    FIX(IFIX(ISVREF(old_image_plane_qm,
							    (SI_Long)8L)) 
							    - 
							    (SI_Long)11L),
							    FIX(IFIX(ISVREF(image_plane,
							    (SI_Long)7L)) 
							    + (SI_Long)11L));
						    delete_frame(old_workspace_qm);
						}
						else {
						    temp_8 = 
							    Current_edit_state;
						    svref_new_value = 
							    put_workspace_on_pane_function(workspace,
							    ISVREF(image_plane,
							    (SI_Long)2L),
							    Qright,Qtop,
							    Nil,
							    FIX((SI_Long)11L),
							    Nil,Nil,Nil,
							    Nil,Nil,Nil,Nil);
						    SVREF(temp_8,
							    FIX((SI_Long)53L)) 
							    = svref_new_value;
						}
						temp_8 = Current_edit_state;
						item_or_value = workspace;
						if (SIMPLE_VECTOR_P(item_or_value) 
							&& 
							IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(item_or_value)) 
							> (SI_Long)2L &&  
							!EQ(ISVREF(item_or_value,
							(SI_Long)1L),
							Qavailable_frame_vector)) 
							    {
						    x2 = 
							    ISVREF(item_or_value,
							    (SI_Long)1L);
						    temp = 
							    SIMPLE_VECTOR_P(x2) 
							    && 
							    EQ(ISVREF(x2,
							    (SI_Long)0L),
							    Qg2_defstruct_structure_name_class_description_g2_struct) 
							    ? TRUEP(x2) : 
							    TRUEP(Qnil);
						}
						else
						    temp = TRUEP(Nil);
						svref_new_value = temp ? 
							get_reference_to_item(item_or_value) 
							: item_or_value;
						SVREF(temp_8,
							FIX((SI_Long)52L)) 
							= svref_new_value;
						reclaim_gensym_list_1(menu_of_names);
					    }
					    else
						display_editor_notification_1(tformat_text_string(2,
							string_constant_10,
							token_text_string));
					    result = reclaim_text_string(token_text_string);
					}
					else
					    result = VALUES_1(Nil);
				    }
				    else {
					temp_1 = memq_function(Qblinker,
						inheritance_path_qm);
					if (temp_1)
					    result = VALUES_1(temp_1);
					else {
					    text_box_or_table = Nil;
					    text_cell_format = Nil;
					    cell_qm = Nil;
					    text_cell_qm = Nil;
					    left_edge_of_area = Nil;
					    top_edge_of_area = Nil;
					    right_edge_of_area = Nil;
					    bottom_edge_of_area = Nil;
					    line_index_for_fixed_end = Nil;
					    character_index_for_fixed_end 
						    = Nil;
					    text_region = Nil;
					    x_in_workspace = Nil;
					    y_in_workspace = Nil;
					    if (object_near_cursor_qm) {
						current_image_plane = 
							image_plane;
						PUSH_SPECIAL(Current_image_plane,current_image_plane,
							28);
						  gensym_window = 
							  ISVREF(ISVREF(image_plane,
							  (SI_Long)2L),
							  (SI_Long)2L);
						  left_edge_of_draw_area = 
							  ISVREF(gensym_window,
							  (SI_Long)7L);
						  top_edge_of_draw_area = 
							  ISVREF(gensym_window,
							  (SI_Long)8L);
						  right_edge_of_draw_area 
							  = 
							  ISVREF(gensym_window,
							  (SI_Long)9L);
						  bottom_edge_of_draw_area 
							  = 
							  ISVREF(gensym_window,
							  (SI_Long)10L);
						  PUSH_SPECIAL(Bottom_edge_of_draw_area,bottom_edge_of_draw_area,
							  27);
						    PUSH_SPECIAL(Right_edge_of_draw_area,right_edge_of_draw_area,
							    26);
						      PUSH_SPECIAL(Top_edge_of_draw_area,top_edge_of_draw_area,
							      25);
							PUSH_SPECIAL(Left_edge_of_draw_area,left_edge_of_draw_area,
								24);
							  current_image_x_scale 
								  = 
								  FIX((SI_Long)4096L);
							  current_image_y_scale 
								  = 
								  FIX((SI_Long)4096L);
							  current_x_origin_of_drawing 
								  = 
								  FIX((SI_Long)0L);
							  current_y_origin_of_drawing 
								  = 
								  FIX((SI_Long)0L);
							  PUSH_SPECIAL(Current_y_origin_of_drawing,current_y_origin_of_drawing,
								  23);
							    PUSH_SPECIAL(Current_x_origin_of_drawing,current_x_origin_of_drawing,
								    22);
							      PUSH_SPECIAL(Current_image_y_scale,current_image_y_scale,
								      21);
								PUSH_SPECIAL(Current_image_x_scale,current_image_x_scale,
									20);
								  left_edge_of_draw_area 
									  = 
									  Left_edge_of_draw_area;
								  top_edge_of_draw_area 
									  = 
									  Top_edge_of_draw_area;
								  right_edge_of_draw_area 
									  = 
									  Right_edge_of_draw_area;
								  bottom_edge_of_draw_area 
									  = 
									  Bottom_edge_of_draw_area;
								  PUSH_SPECIAL(Bottom_edge_of_draw_area,bottom_edge_of_draw_area,
									  19);
								    PUSH_SPECIAL(Right_edge_of_draw_area,right_edge_of_draw_area,
									    18);
								      PUSH_SPECIAL(Top_edge_of_draw_area,top_edge_of_draw_area,
									      17);
									PUSH_SPECIAL(Left_edge_of_draw_area,left_edge_of_draw_area,
										16);
									  temp_1 
										  = 
										  ISVREF(image_plane,
										  (SI_Long)6L);
									  Left_edge_of_draw_area 
										  = 
										  FIXNUM_MAX(temp_1,
										  Left_edge_of_draw_area);
									  temp_1 
										  = 
										  ISVREF(image_plane,
										  (SI_Long)7L);
									  Top_edge_of_draw_area 
										  = 
										  FIXNUM_MAX(temp_1,
										  Top_edge_of_draw_area);
									  temp_1 
										  = 
										  ISVREF(image_plane,
										  (SI_Long)8L);
									  Right_edge_of_draw_area 
										  = 
										  FIXNUM_MIN(temp_1,
										  Right_edge_of_draw_area);
									  temp_1 
										  = 
										  ISVREF(image_plane,
										  (SI_Long)9L);
									  Bottom_edge_of_draw_area 
										  = 
										  FIXNUM_MIN(temp_1,
										  Bottom_edge_of_draw_area);
									  if (FIXNUM_LT(Left_edge_of_draw_area,
										  Right_edge_of_draw_area) 
										  && 
										  FIXNUM_LT(Top_edge_of_draw_area,
										  Bottom_edge_of_draw_area)) 
										      {
									      left_edge_of_draw_area 
										      = 
										      Left_edge_of_draw_area;
									      top_edge_of_draw_area 
										      = 
										      Top_edge_of_draw_area;
									      right_edge_of_draw_area 
										      = 
										      Right_edge_of_draw_area;
									      bottom_edge_of_draw_area 
										      = 
										      Bottom_edge_of_draw_area;
									      PUSH_SPECIAL(Bottom_edge_of_draw_area,bottom_edge_of_draw_area,
										      15);
										PUSH_SPECIAL(Right_edge_of_draw_area,right_edge_of_draw_area,
											14);
										  PUSH_SPECIAL(Top_edge_of_draw_area,top_edge_of_draw_area,
											  13);
										    PUSH_SPECIAL(Left_edge_of_draw_area,left_edge_of_draw_area,
											    12);
										      temp_1 
											      = 
											      ISVREF(image_plane,
											      (SI_Long)19L);
										      Left_edge_of_draw_area 
											      = 
											      FIXNUM_MAX(temp_1,
											      Left_edge_of_draw_area);
										      temp_1 
											      = 
											      ISVREF(image_plane,
											      (SI_Long)20L);
										      Top_edge_of_draw_area 
											      = 
											      FIXNUM_MAX(temp_1,
											      Top_edge_of_draw_area);
										      temp_1 
											      = 
											      ISVREF(image_plane,
											      (SI_Long)21L);
										      Right_edge_of_draw_area 
											      = 
											      FIXNUM_MIN(temp_1,
											      Right_edge_of_draw_area);
										      temp_1 
											      = 
											      ISVREF(image_plane,
											      (SI_Long)22L);
										      Bottom_edge_of_draw_area 
											      = 
											      FIXNUM_MIN(temp_1,
											      Bottom_edge_of_draw_area);
										      if (FIXNUM_LT(Left_edge_of_draw_area,
											      Right_edge_of_draw_area) 
											      && 
											      FIXNUM_LT(Top_edge_of_draw_area,
											      Bottom_edge_of_draw_area)) 
												  {
											  current_frame_transform_qm 
												  = 
												  Nil;
											  current_image_x_scale 
												  = 
												  ISVREF(image_plane,
												  (SI_Long)11L);
											  current_image_y_scale 
												  = 
												  ISVREF(image_plane,
												  (SI_Long)12L);
											  current_x_origin_of_drawing 
												  = 
												  ISVREF(image_plane,
												  (SI_Long)13L);
											  current_y_origin_of_drawing 
												  = 
												  ISVREF(image_plane,
												  (SI_Long)14L);
											  PUSH_SPECIAL(Current_y_origin_of_drawing,current_y_origin_of_drawing,
												  11);
											    PUSH_SPECIAL(Current_x_origin_of_drawing,current_x_origin_of_drawing,
												    10);
											      PUSH_SPECIAL(Current_image_y_scale,current_image_y_scale,
												      9);
												PUSH_SPECIAL(Current_image_x_scale,current_image_x_scale,
													8);
												  PUSH_SPECIAL(Current_frame_transform_qm,current_frame_transform_qm,
													  7);
												    left_edge_of_draw_area 
													    = 
													    Left_edge_of_draw_area;
												    top_edge_of_draw_area 
													    = 
													    Top_edge_of_draw_area;
												    right_edge_of_draw_area 
													    = 
													    Right_edge_of_draw_area;
												    bottom_edge_of_draw_area 
													    = 
													    Bottom_edge_of_draw_area;
												    PUSH_SPECIAL(Bottom_edge_of_draw_area,bottom_edge_of_draw_area,
													    6);
												      PUSH_SPECIAL(Right_edge_of_draw_area,right_edge_of_draw_area,
													      5);
													PUSH_SPECIAL(Top_edge_of_draw_area,top_edge_of_draw_area,
														4);
													  PUSH_SPECIAL(Left_edge_of_draw_area,left_edge_of_draw_area,
														  3);
													    current_frame_transform_qm 
														    = 
														    Current_frame_transform_qm;
													    current_x_origin_of_drawing 
														    = 
														    Current_x_origin_of_drawing;
													    current_y_origin_of_drawing 
														    = 
														    Current_y_origin_of_drawing;
													    PUSH_SPECIAL(Current_y_origin_of_drawing,current_y_origin_of_drawing,
														    2);
													      PUSH_SPECIAL(Current_x_origin_of_drawing,current_x_origin_of_drawing,
														      1);
														PUSH_SPECIAL(Current_frame_transform_qm,current_frame_transform_qm,
															0);
														  if ((SI_Long)0L 
															  != 
															  (IFIX(ISVREF(object_near_cursor_qm,
															  (SI_Long)5L)) 
															  & 
															  (SI_Long)32768L)) 
															      {
														      enclosing_block 
															      = 
															      object_near_cursor_qm;
														      frame_transforms_of_block_qm 
															      = 
															      Nil;
														    next_loop:
														      frame_transforms_of_block_qm 
															      = 
															      get_lookup_slot_value_given_default(enclosing_block,
															      Qframe_transforms_of_block,
															      Nil);
														      if (frame_transforms_of_block_qm) 
																  {
															  frame_transforms_of_enclosing_block 
																  = 
																  frame_transforms_of_block_qm;
															  goto end_1;
														      }
														      gensymed_symbol 
															      = 
															      ISVREF(enclosing_block,
															      (SI_Long)14L);
														      gensymed_symbol 
															      = 
															      gensymed_symbol 
															      ?
															       
															      ISVREF(gensymed_symbol,
															      (SI_Long)5L) 
															      :
															       
															      Nil;
														      enclosing_block 
															      = 
															      gensymed_symbol;
														      goto next_loop;
														    end_loop:
														      frame_transforms_of_enclosing_block 
															      = 
															      Qnil;
														    end_1:;
														      temp_1 
															      = 
															      assq_function(Current_image_plane,
															      frame_transforms_of_enclosing_block);
														      frame_transform 
															      = 
															      CDR(temp_1);
														      if ( 
															      !EQ(Current_frame_transform_qm,
															      frame_transform)) 
																  {
															  nest_draw_area_for_frame_1(frame_transform);
															  Current_frame_transform_qm 
																  = 
																  frame_transform;
															  gensymed_symbol_1 
																  = 
																  IFIX(ISVREF(frame_transform,
																  (SI_Long)10L));
															  scale 
																  = 
																  (SI_Long)4096L;
															  value 
																  = 
																  ISVREF(frame_transform,
																  (SI_Long)6L);
															  if (scale 
																  == 
																  (SI_Long)4096L)
															      gensymed_symbol_2 
																      = 
																      IFIX(value);
															  else if (IFIX(Minus_of_isqrt_of_most_positive_fixnum) 
																  < 
																  scale 
																  && 
																  scale 
																  < 
																  IFIX(Isqrt_of_most_positive_fixnum) 
																  && 
																  FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,
																  value) 
																  && 
																  FIXNUM_LT(value,
																  Isqrt_of_most_positive_fixnum)) 
																      {
															      unshifted_result 
																      = 
																      scale 
																      * 
																      IFIX(value) 
																      + 
																      (SI_Long)2048L;
															      gensymed_symbol_2 
																      = 
																      unshifted_result 
																      >> 
																       
																      - 
																       
																      - 
																      (SI_Long)12L;
															  }
															  else
															      gensymed_symbol_2 
																      = 
																      IFIX(scalef_function(FIX(scale),
																      value));
															  x_offset 
																  = 
																  gensymed_symbol_1 
																  + 
																  gensymed_symbol_2;
															  if ( 
																  !((SI_Long)0L 
																  == 
																  x_offset)) 
																      {
															      if (IFIX(Current_image_x_scale) 
																      == 
																      (SI_Long)4096L)
																  incff_1_arg 
																	  = 
																	  FIX(x_offset);
															      else if (FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,
																      Current_image_x_scale) 
																      && 
																      FIXNUM_LT(Current_image_x_scale,
																      Isqrt_of_most_positive_fixnum) 
																      && 
																      IFIX(Minus_of_isqrt_of_most_positive_fixnum) 
																      < 
																      x_offset 
																      && 
																      x_offset 
																      < 
																      IFIX(Isqrt_of_most_positive_fixnum)) 
																	  {
																  unshifted_result 
																	  = 
																	  IFIX(Current_image_x_scale) 
																	  * 
																	  x_offset 
																	  + 
																	  (SI_Long)2048L;
																  incff_1_arg 
																	  = 
																	  FIX(unshifted_result 
																	  >> 
																	   
																	  - 
																	   
																	  - 
																	  (SI_Long)12L);
															      }
															      else
																  incff_1_arg 
																	  = 
																	  scalef_function(Current_image_x_scale,
																	  FIX(x_offset));
															      temp_8 
																      = 
																      FIXNUM_ADD(Current_x_origin_of_drawing,
																      incff_1_arg);
															      Current_x_origin_of_drawing 
																      = 
																      temp_8;
															  }
															  gensymed_symbol_1 
																  = 
																  IFIX(ISVREF(frame_transform,
																  (SI_Long)11L));
															  scale 
																  = 
																  (SI_Long)4096L;
															  value 
																  = 
																  ISVREF(frame_transform,
																  (SI_Long)7L);
															  if (scale 
																  == 
																  (SI_Long)4096L)
															      gensymed_symbol_2 
																      = 
																      IFIX(value);
															  else if (IFIX(Minus_of_isqrt_of_most_positive_fixnum) 
																  < 
																  scale 
																  && 
																  scale 
																  < 
																  IFIX(Isqrt_of_most_positive_fixnum) 
																  && 
																  FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,
																  value) 
																  && 
																  FIXNUM_LT(value,
																  Isqrt_of_most_positive_fixnum)) 
																      {
															      unshifted_result 
																      = 
																      scale 
																      * 
																      IFIX(value) 
																      + 
																      (SI_Long)2048L;
															      gensymed_symbol_2 
																      = 
																      unshifted_result 
																      >> 
																       
																      - 
																       
																      - 
																      (SI_Long)12L;
															  }
															  else
															      gensymed_symbol_2 
																      = 
																      IFIX(scalef_function(FIX(scale),
																      value));
															  y_offset 
																  = 
																  gensymed_symbol_1 
																  + 
																  gensymed_symbol_2;
															  if ( 
																  !((SI_Long)0L 
																  == 
																  y_offset)) 
																      {
															      if (IFIX(Current_image_y_scale) 
																      == 
																      (SI_Long)4096L)
																  incff_1_arg 
																	  = 
																	  FIX(y_offset);
															      else if (FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,
																      Current_image_y_scale) 
																      && 
																      FIXNUM_LT(Current_image_y_scale,
																      Isqrt_of_most_positive_fixnum) 
																      && 
																      IFIX(Minus_of_isqrt_of_most_positive_fixnum) 
																      < 
																      y_offset 
																      && 
																      y_offset 
																      < 
																      IFIX(Isqrt_of_most_positive_fixnum)) 
																	  {
																  unshifted_result 
																	  = 
																	  IFIX(Current_image_y_scale) 
																	  * 
																	  y_offset 
																	  + 
																	  (SI_Long)2048L;
																  incff_1_arg 
																	  = 
																	  FIX(unshifted_result 
																	  >> 
																	   
																	  - 
																	   
																	  - 
																	  (SI_Long)12L);
															      }
															      else
																  incff_1_arg 
																	  = 
																	  scalef_function(Current_image_y_scale,
																	  FIX(y_offset));
															      temp_8 
																      = 
																      FIXNUM_ADD(Current_y_origin_of_drawing,
																      incff_1_arg);
															      Current_y_origin_of_drawing 
																      = 
																      temp_8;
															  }
														      }
														  }
														  scale_1 
															  = 
															  Current_image_x_scale;
														  value 
															  = 
															  FIXNUM_MINUS(x_in_window,
															  Current_x_origin_of_drawing);
														  if (IFIX(scale_1) 
															  == 
															  (SI_Long)4096L)
														      x_in_workspace 
															      = 
															      value;
														  else if ( 
															  !(FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,
															  value) 
															  && 
															  FIXNUM_LT(value,
															  Isqrt_of_most_positive_fixnum)))
														      x_in_workspace 
															      = 
															      inverse_scalef_function(scale_1,
															      value);
														  else if (IFIX(value) 
															  >= 
															  (SI_Long)0L) 
															      {
														      temp_1 
															      = 
															      FIX(((IFIX(value) 
															      << 
															      (SI_Long)12L) 
															      + 
															      (IFIX(scale_1) 
															      >> 
															       
															      - 
															       
															      - 
															      (SI_Long)1L)) 
															      / 
															      IFIX(scale_1));
														      x_in_workspace 
															      = 
															      temp_1;
														  }
														  else {
														      temp_9 
															      = 
															      ((IFIX(FIXNUM_NEGATE(value)) 
															      << 
															      (SI_Long)12L) 
															      + 
															      (IFIX(scale_1) 
															      >> 
															       
															      - 
															       
															      - 
															      (SI_Long)1L)) 
															      / 
															      IFIX(scale_1);
														      temp_1 
															      = 
															      FIXNUM_NEGATE(FIX(temp_9));
														      x_in_workspace 
															      = 
															      temp_1;
														  }
														  scale_1 
															  = 
															  Current_image_y_scale;
														  value 
															  = 
															  FIXNUM_MINUS(y_in_window,
															  Current_y_origin_of_drawing);
														  if (IFIX(scale_1) 
															  == 
															  (SI_Long)4096L)
														      y_in_workspace 
															      = 
															      value;
														  else if ( 
															  !(FIXNUM_LT(Minus_of_isqrt_of_most_positive_fixnum,
															  value) 
															  && 
															  FIXNUM_LT(value,
															  Isqrt_of_most_positive_fixnum)))
														      y_in_workspace 
															      = 
															      inverse_scalef_function(scale_1,
															      value);
														  else if (IFIX(value) 
															  >= 
															  (SI_Long)0L) 
															      {
														      temp_1 
															      = 
															      FIX(((IFIX(value) 
															      << 
															      (SI_Long)12L) 
															      + 
															      (IFIX(scale_1) 
															      >> 
															       
															      - 
															       
															      - 
															      (SI_Long)1L)) 
															      / 
															      IFIX(scale_1));
														      y_in_workspace 
															      = 
															      temp_1;
														  }
														  else {
														      temp_9 
															      = 
															      ((IFIX(FIXNUM_NEGATE(value)) 
															      << 
															      (SI_Long)12L) 
															      + 
															      (IFIX(scale_1) 
															      >> 
															       
															      - 
															       
															      - 
															      (SI_Long)1L)) 
															      / 
															      IFIX(scale_1);
														      temp_1 
															      = 
															      FIXNUM_NEGATE(FIX(temp_9));
														      y_in_workspace 
															      = 
															      temp_1;
														  }
														POP_SPECIAL();
													      POP_SPECIAL();
													    POP_SPECIAL();
													  POP_SPECIAL();
													POP_SPECIAL();
												      POP_SPECIAL();
												    POP_SPECIAL();
												  POP_SPECIAL();
												POP_SPECIAL();
											      POP_SPECIAL();
											    POP_SPECIAL();
											  POP_SPECIAL();
										      }
										    POP_SPECIAL();
										  POP_SPECIAL();
										POP_SPECIAL();
									      POP_SPECIAL();
									  }
									POP_SPECIAL();
								      POP_SPECIAL();
								    POP_SPECIAL();
								  POP_SPECIAL();
								POP_SPECIAL();
							      POP_SPECIAL();
							    POP_SPECIAL();
							  POP_SPECIAL();
							POP_SPECIAL();
						      POP_SPECIAL();
						    POP_SPECIAL();
						  POP_SPECIAL();
						POP_SPECIAL();
					    }
					    if ((non_menu_choice_permitted_p(Qallow_selection_of_outside_text_from_editor,
						    ISVREF(Current_edit_state,
						    (SI_Long)3L)) || 
						    memq_function(Qedit_box,
						    inheritance_path_qm) 
						    || 
						    memq_function(Qtoken_menu,
						    inheritance_path_qm) 
						    || 
						    memq_function(Qkfep_conversion_choice_menu,
						    inheritance_path_qm)) 
						    && 
						    non_menu_choice_permitted_p(Qallow_selection_of_text,
						    block_near_cursor_qm) 
						    &&  
						    !TRUEP(ISVREF(Current_edit_state,
						    (SI_Long)75L))) {
						class_1 = Nil;
						ab_loop_list_ = 
							list_constant_7;
						ab_loop_it_ = Nil;
					      next_loop_1:
						if ( !TRUEP(ab_loop_list_))
						    goto end_loop_1;
						class_1 = M_CAR(ab_loop_list_);
						ab_loop_list_ = 
							M_CDR(ab_loop_list_);
						ab_loop_it_ = 
							memq_function(class_1,
							inheritance_path_qm);
						if (ab_loop_it_) {
						    temp = TRUEP(ab_loop_it_);
						    goto end_2;
						}
						goto next_loop_1;
					      end_loop_1:
						temp = TRUEP(Qnil);
					      end_2:;
						if (temp);
						else {
						    if (memq_function(Qtoken_menu,
							    inheritance_path_qm) 
							    || 
							    memq_function(Qkfep_conversion_choice_menu,
							    inheritance_path_qm) 
							    || 
							    memq_function(Qtable,
							    inheritance_path_qm) 
							    &&  
							    !TRUEP(memq_function(Qmenu,
							    inheritance_path_qm))) 
								{
							result = pick_cell_from_table(5,
								object_near_cursor_qm,
								image_plane,
								x_in_window,
								y_in_window,T);
							MVS_8(result,
								gensymed_symbol,
								gensymed_symbol_4,
								temp_1,
								temp_1,
								gensymed_symbol_5,
								gensymed_symbol_6,
								gensymed_symbol_7,
								gensymed_symbol_8);
							bottom_edge_of_area 
								= 
								gensymed_symbol_8;
							right_edge_of_area 
								= 
								gensymed_symbol_7;
							top_edge_of_area = 
								gensymed_symbol_6;
							left_edge_of_area 
								= 
								gensymed_symbol_5;
							text_box_or_table 
								= 
								gensymed_symbol_4;
							cell_qm = 
								gensymed_symbol;
							temp = TRUEP(cell_qm);
						    }
						    else
							temp = TRUEP(Nil);
						    if (temp) {
							if (CONSP(cell_qm)) {
							    text_cell_qm = 
								    cell_qm;
							    temp = 
								    TRUEP(text_cell_qm);
							}
							else
							    temp = TRUEP(Nil);
						    }
						    else
							temp = TRUEP(Nil);
						}
					    }
					    else
						temp = TRUEP(Nil);
					    if (temp) {
						if (text_cell_qm)
						    text_cell_format = 
							    CAR(text_cell_qm);
						else {
						    text_box_or_table = 
							    object_near_cursor_qm;
						    text_cell_format = 
							    ISVREF(text_box_or_table,
							    (SI_Long)17L);
						}
						temp = 
							TRUEP(text_visible_p(text_cell_format,
							text_cell_qm ? 
							CADR(text_cell_qm) 
							: 
							ISVREF(text_box_or_table,
							(SI_Long)18L),
							ISVREF(image_plane,
							(SI_Long)11L),
							ISVREF(image_plane,
							(SI_Long)12L)));
						if (temp);
						else
						    temp = 
							    TRUEP(memq_function(Qscrap,
							    inheritance_path_qm));
					    }
					    else
						temp = TRUEP(Nil);
					    if (temp) {
						if ( !TRUEP(text_cell_qm)) {
						    gensymed_symbol = 
							    ISVREF(text_box_or_table,
							    (SI_Long)14L);
						    gensymed_symbol = 
							    gensymed_symbol 
							    ? 
							    ISVREF(gensymed_symbol,
							    (SI_Long)0L) : 
							    FIX((SI_Long)0L);
						    gensymed_symbol_1 = 
							    IFIX(gensymed_symbol);
						    gensymed_symbol_2 = 
							    IFIX(ISVREF(text_cell_format,
							    (SI_Long)44L));
						    left_edge_of_area = 
							    FIX(gensymed_symbol_1 
							    + 
							    gensymed_symbol_2);
						    gensymed_symbol = 
							    ISVREF(text_box_or_table,
							    (SI_Long)14L);
						    gensymed_symbol = 
							    gensymed_symbol 
							    ? 
							    ISVREF(gensymed_symbol,
							    (SI_Long)1L) : 
							    FIX((SI_Long)0L);
						    gensymed_symbol_1 = 
							    IFIX(gensymed_symbol);
						    gensymed_symbol_2 = 
							    IFIX(ISVREF(text_cell_format,
							    (SI_Long)45L));
						    top_edge_of_area = 
							    FIX(gensymed_symbol_1 
							    + 
							    gensymed_symbol_2);
						    gensymed_symbol = 
							    ISVREF(text_box_or_table,
							    (SI_Long)14L);
						    gensymed_symbol = 
							    gensymed_symbol 
							    ? 
							    ISVREF(gensymed_symbol,
							    (SI_Long)2L) : 
							    FIX((SI_Long)0L);
						    gensymed_symbol_1 = 
							    IFIX(gensymed_symbol);
						    gensymed_symbol_2 = 
							    IFIX(ISVREF(text_cell_format,
							    (SI_Long)46L));
						    right_edge_of_area = 
							    FIX(gensymed_symbol_1 
							    - 
							    gensymed_symbol_2);
						    gensymed_symbol = 
							    ISVREF(text_box_or_table,
							    (SI_Long)14L);
						    gensymed_symbol = 
							    gensymed_symbol 
							    ? 
							    ISVREF(gensymed_symbol,
							    (SI_Long)3L) : 
							    FIX((SI_Long)0L);
						    gensymed_symbol_1 = 
							    IFIX(gensymed_symbol);
						    gensymed_symbol_2 = 
							    IFIX(ISVREF(text_cell_format,
							    (SI_Long)47L));
						    bottom_edge_of_area = 
							    FIX(gensymed_symbol_1 
							    - 
							    gensymed_symbol_2);
						}
						temp = 
							EQ(object_near_cursor_qm,
							ISVREF(Current_edit_state,
							(SI_Long)13L)) ? 
							TRUEP(ISVREF(Current_edit_state,
							(SI_Long)16L)) : 
							TRUEP(Qnil);
						if (temp);
						else {
						    left = 
							    IFIX(left_edge_of_area) 
							    + 
							    (IFIX(ISVREF(text_cell_format,
							    (SI_Long)27L)) 
							    >>  -  - 
							    (SI_Long)1L);
						    top = 
							    IFIX(top_edge_of_area) 
							    + 
							    (IFIX(ISVREF(text_cell_format,
							    (SI_Long)28L)) 
							    >>  -  - 
							    (SI_Long)1L);
						    right = 
							    IFIX(right_edge_of_area) 
							    - 
							    (IFIX(ISVREF(text_cell_format,
							    (SI_Long)29L)) 
							    >>  -  - 
							    (SI_Long)1L);
						    bottom = 
							    IFIX(bottom_edge_of_area) 
							    - 
							    (IFIX(ISVREF(text_cell_format,
							    (SI_Long)30L)) 
							    >>  -  - 
							    (SI_Long)1L);
						    temp = left <= 
							    IFIX(x_in_workspace) 
							    && 
							    IFIX(x_in_workspace) 
							    < right && top 
							    <= 
							    IFIX(y_in_workspace) 
							    ? 
							    IFIX(y_in_workspace) 
							    < bottom : 
							    TRUEP(Qnil);
						}
						if (temp);
						else
						    temp = 
							    SIMPLE_VECTOR_P(innermost_spot) 
							    ? 
							    EQ(ISVREF(innermost_spot,
							    (SI_Long)0L),
							    Qg2_defstruct_structure_name_edit_box_spot_g2_struct) 
							    : TRUEP(Qnil);
					    }
					    else
						temp = TRUEP(Nil);
					    if (temp) {
						temp_3 =  
							!TRUEP(text_cell_qm) 
							? 
							text_box_or_table :
							 Nil;
						temp_4 = text_cell_qm;
						temp_5 = left_edge_of_area;
						temp_6 = top_edge_of_area;
						temp_7 = x_in_workspace;
						temp_1 = y_in_workspace;
						class_1 = Nil;
						ab_loop_list_ = 
							list_constant_8;
						ab_loop_it_ = Nil;
					      next_loop_2:
						if ( !TRUEP(ab_loop_list_))
						    goto end_loop_2;
						class_1 = M_CAR(ab_loop_list_);
						ab_loop_list_ = 
							M_CDR(ab_loop_list_);
						ab_loop_it_ = 
							memq_function(class_1,
							inheritance_path_qm);
						if (ab_loop_it_) {
						    temp = TRUEP(ab_loop_it_);
						    goto end_3;
						}
						goto next_loop_2;
					      end_loop_2:
						temp = TRUEP(Qnil);
					      end_3:;
						result = find_position_in_text(12,
							temp_3,temp_4,
							temp_5,temp_6,T,
							temp_7,temp_1,Nil,
							Nil,Nil,temp ? Nil 
							:  
							!(memq_function(Qtoken_menu,
							inheritance_path_qm) 
							|| 
							memq_function(Qkfep_conversion_choice_menu,
							inheritance_path_qm)) 
							? T : Nil,
							memq_function(Qscrap,
							inheritance_path_qm));
						MVS_2(result,
							line_index_for_fixed_end,
							character_index_for_fixed_end);
						temp = 
							TRUEP(line_index_for_fixed_end);
					    }
					    else
						temp = TRUEP(Nil);
					    if (temp) {
						if (EQ(text_box_or_table,
							ISVREF(Current_edit_state,
							(SI_Long)13L))) {
						    text_region_qm = 
							    get_selected_text_region_for_edit_box();
						    if (text_region_qm)
							deselect_current_text_region(text_region_qm);
						}
						temp_1 = 
							memq_function(Qscrap,
							inheritance_path_qm) 
							? 
							select_text_region_in_scrap(text_box_or_table,
							x_in_workspace,
							y_in_workspace) : Nil;
						if (temp_1);
						else {
						    if (memq_function(Qtable,
							    inheritance_path_qm) 
							    && 
							    text_cell_qm 
							    && 
							    attribute_table_p(text_box_or_table)) 
								{
							row = Nil;
							ab_loop_list_ = 
								ISVREF(text_box_or_table,
								(SI_Long)19L);
							ab_loop_it_ = Nil;
						      next_loop_3:
							if ( 
								!TRUEP(ab_loop_list_))
							    goto end_loop_3;
							row = 
								M_CAR(ab_loop_list_);
							ab_loop_list_ = 
								M_CDR(ab_loop_list_);
							ab_loop_it_ = 
								CDR(row) ? 
								(EQ(CAR(row),
								text_cell_qm) 
								? T : Nil) 
								: Qnil;
							if (ab_loop_it_) {
							    temp = 
								    TRUEP(ab_loop_it_);
							    goto end_4;
							}
							goto next_loop_3;
						      end_loop_3:
							temp = TRUEP(Qnil);
						      end_4:;
						    }
						    else
							temp = TRUEP(Nil);
						    temp_1 = temp ? 
							    make_text_region(5,
							    text_box_or_table,
							    text_cell_qm,
							    FIX((SI_Long)1L),
							    FIX((SI_Long)0L),
							    Qend) : Nil;
						}
						if (temp_1);
						else
						    temp_1 = 
							    make_text_region(4,
							    text_box_or_table,
							    text_cell_qm,
							    line_index_for_fixed_end,
							    character_index_for_fixed_end);
						text_region = temp_1;
						temp_8 = Current_edit_state;
						frame_serial_number_setf_arg 
							= 
							Current_frame_serial_number;
						old = ISVREF(temp_8,
							(SI_Long)2L);
						new_1 = 
							frame_serial_number_setf_arg;
						svref_new_value = 
							(FIXNUMP(old) ||  
							!TRUEP(old)) && 
							(FIXNUMP(new_1) || 
							 !TRUEP(new_1)) ? 
							new_1 : 
							frame_serial_number_setf_helper_1(old,
							new_1);
						SVREF(temp_8,
							FIX((SI_Long)2L)) 
							= svref_new_value;
						select_current_text_region(text_region);
						establish_next_workstation_context_continuation(Qcontinue_edit_after_mouse_watch,
							Nil,Nil,Nil);
						result = enter_mouse_watch_state(mouse_pointer_1,
							text_region);
					    }
					    else if (EQ(object_near_cursor_qm,
						    ISVREF(Current_edit_state,
						    (SI_Long)13L)))
						result = change_edit_box(8,
							Nil,Nil,Nil,Nil,
							Nil,Nil,
							x_in_workspace,
							y_in_workspace);
					    else
						result = run_top_level_event_handler(mouse_pointer_1);
					}
				    }
				}
			    }
			}
		    }
		}
	    }
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

static Object Kselect;             /* :select */

static Object Kdrag;               /* :drag */

static Object Qcontinue_editing_by_posting_cut_copy_paste_menu;  /* continue-editing-by-posting-cut-copy-paste-menu */

static Object Qcontinue_editing_by_doing_insert_selected_text_command;  /* continue-editing-by-doing-insert-selected-text-command */

/* CONTINUE-EDIT-AFTER-MOUSE-WATCH */
Object continue_edit_after_mouse_watch(workstation_context)
    Object workstation_context;
{
    Object edit_state, status, mouse_pointer, text_region_qm, gensymed_symbol;
    Object x, y, xa, ya, current_edit_state, current_edit_workspace;
    Object text_region, temp_1, line_index, character_index, text_string_qm;
    Object superblock_qm, text_string_qm_old_value, image_plane;
    char temp;
    Declare_special(2);
    Object result;

    x_note_fn_call(126,221);
    edit_state = ISVREF(workstation_context,(SI_Long)2L);
    status = ISVREF(Current_workstation,(SI_Long)33L);
    mouse_pointer = ISVREF(Current_workstation,(SI_Long)34L);
    text_region_qm = ISVREF(Current_workstation,(SI_Long)35L);
    if (text_region_qm) {
	gensymed_symbol = ISVREF(text_region_qm,(SI_Long)3L);
	temp = SIMPLE_VECTOR_P(text_region_qm) ? EQ(ISVREF(text_region_qm,
		(SI_Long)1L),Qavailable_frame_vector) : TRUEP(Qnil);
	if (temp);
	else
	    temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		    (SI_Long)-1L : TRUEP(Nil);
	if (temp);
	else {
	    x = gensymed_symbol;
	    y = ISVREF(edit_state,(SI_Long)2L);
	    if (FIXNUMP(y))
		temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
	    else if (FIXNUMP(x))
		temp = TRUEP(Nil);
	    else {
		xa = M_CAR(y);
		ya = M_CAR(x);
		temp = FIXNUM_LT(xa,ya);
		if (temp);
		else
		    temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),M_CDR(x)) 
			    : TRUEP(Qnil);
	    }
	}
	temp =  ! !temp;
    }
    else
	temp = TRUEP(Nil);
    if (temp)
	status = Kabort;
    if (EQ(status,Kabort)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	    text_region = ISVREF(edit_state,(SI_Long)86L);
	    gensymed_symbol = ISVREF(text_region,(SI_Long)3L);
	    temp = SIMPLE_VECTOR_P(text_region) ? EQ(ISVREF(text_region,
		    (SI_Long)1L),Qavailable_frame_vector) : TRUEP(Qnil);
	    if (temp);
	    else
		temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
			(SI_Long)-1L : TRUEP(Nil);
	    if (temp);
	    else {
		x = gensymed_symbol;
		y = ISVREF(edit_state,(SI_Long)2L);
		if (FIXNUMP(y))
		    temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
		else if (FIXNUMP(x))
		    temp = TRUEP(Nil);
		else {
		    xa = M_CAR(y);
		    ya = M_CAR(x);
		    temp = FIXNUM_LT(xa,ya);
		    if (temp);
		    else
			temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),
				M_CDR(x)) : TRUEP(Qnil);
		}
	    }
	    result = deselect_current_text_region( !temp ? text_region : Nil);
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else if (EQ(status,Kselect)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	    temp_1 = ISVREF(edit_state,(SI_Long)13L);
	    gensymed_symbol = ISVREF(text_region_qm,(SI_Long)14L);
	    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		    (SI_Long)5L) : Nil;
	    if (EQ(temp_1,gensymed_symbol)) {
		deselect_current_text_region(text_region_qm);
		line_index = line_index_blackboard_function(mouse_pointer);
		character_index = 
			character_index_blackboard_function(mouse_pointer);
		if (line_index && character_index)
		    result = change_edit_box_cursor_position(2,line_index,
			    character_index);
		else
		    result = VALUES_1(Nil);
	    }
	    else {
		text_string_qm = 
			text_string_qm_to_insert_from_text_region(mouse_pointer,
			text_region_qm);
		gensymed_symbol = ISVREF(text_region_qm,(SI_Long)14L);
		gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
			(SI_Long)5L) : Nil;
		superblock_qm = gensymed_symbol;
		deselect_current_text_region(text_region_qm);
		if (text_string_qm) {
		    if ((SI_Long)0L == 
			    IFIX(text_string_length(text_string_qm))) {
			text_string_qm_old_value = text_string_qm;
			text_string_qm = Nil;
			temp_1 = text_string_qm_old_value;
			reclaim_text_string(temp_1);
		    }
		}
		if (text_string_qm)
		    result = auto_insert_text_from_block(text_string_qm,
			    superblock_qm);
		else
		    result = run_top_level_event_handler(mouse_pointer);
	    }
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else if (EQ(status,Kdrag)) {
	image_plane = image_plane_blackboard_function(mouse_pointer);
	if (image_plane) {
	    gensymed_symbol = ISVREF(text_region_qm,(SI_Long)14L);
	    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		    (SI_Long)5L) : Nil;
	    if (EQ(gensymed_symbol,ISVREF(edit_state,(SI_Long)13L))) {
		establish_next_workstation_context_continuation(Qcontinue_editing_by_posting_cut_copy_paste_menu,
			Nil,Nil,Nil);
		return enter_text_marking_state(text_region_qm,image_plane,
			ISVREF(edit_state,(SI_Long)12L));
	    }
	    else {
		establish_next_workstation_context_continuation(Qcontinue_editing_by_doing_insert_selected_text_command,
			Nil,Nil,Nil);
		return enter_text_marking_state(text_region_qm,image_plane,
			ISVREF(edit_state,(SI_Long)12L));
	    }
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Qnil);
}

static Object Qobject_name_menus_in_upper_case_qm;  /* object-name-menus-in-upper-case? */

static Object Qattribute_name_represented_by_table_spot;  /* attribute-name-represented-by-table-spot */

static Object Qtype_description_of_type;  /* type-description-of-type */

/* TEXT-STRING?-TO-INSERT-FROM-TEXT-REGION */
Object text_string_qm_to_insert_from_text_region(mouse_down_mouse_pointer,
	    text_region)
    Object mouse_down_mouse_pointer, text_region;
{
    Object gensymed_symbol, text_region_superblock, sub_class_bit_vector;
    Object name_qm, text_cell_of_table, gensymed_symbol_4;
    Object type_description_of_desired_type, spot;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    char temp;

    x_note_fn_call(126,222);
    gensymed_symbol = ISVREF(text_region,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)5L) : Nil;
    text_region_superblock = gensymed_symbol;
    gensymed_symbol = ISVREF(text_region_superblock,(SI_Long)1L);
    sub_class_bit_vector = ISVREF(gensymed_symbol,(SI_Long)19L);
    superior_class_bit_number = IFIX(ISVREF(Text_box_class_description,
	    (SI_Long)18L));
    sub_class_vector_index = superior_class_bit_number >>  -  - (SI_Long)3L;
    if (sub_class_vector_index < 
	    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		sub_class_vector_index);
	gensymed_symbol_2 = (SI_Long)1L;
	gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
	gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
	gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
	temp = (SI_Long)0L < gensymed_symbol_1;
    }
    else
	temp = TRUEP(Nil);
    if (temp) {
	gensymed_symbol = ISVREF(text_region_superblock,(SI_Long)1L);
	sub_class_bit_vector = ISVREF(gensymed_symbol,(SI_Long)19L);
	superior_class_bit_number = IFIX(ISVREF(Name_box_class_description,
		(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_2 = (SI_Long)1L;
	    gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
	    gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
	    temp = (SI_Long)0L < gensymed_symbol_1;
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    gensymed_symbol = ISVREF(text_region_superblock,(SI_Long)14L);
	    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		    (SI_Long)5L) : Nil;
	    name_qm = get_primary_name_for_frame_if_any(gensymed_symbol);
	    if (name_qm)
		return copy_symbol_name_parsably(name_qm,
			get_slot_value_function(Editor_parameters,
			Qobject_name_menus_in_upper_case_qm,Nil));
	    else
		return VALUES_1(Nil);
	}
	else
	    return convert_text_region_to_text_string(1,text_region);
    }
    else {
	sub_class_bit_vector = ISVREF(gensymed_symbol,(SI_Long)19L);
	superior_class_bit_number = IFIX(ISVREF(Table_class_description,
		(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_2 = (SI_Long)1L;
	    gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
	    gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
	    temp = (SI_Long)0L < gensymed_symbol_1;
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    text_cell_of_table = 
		    text_cell_of_table_blackboard_function(mouse_down_mouse_pointer);
	    if (text_cell_of_table) {
		gensymed_symbol = ISVREF(text_region_superblock,(SI_Long)1L);
		gensymed_symbol_4 = 
			lookup_global_or_kb_specific_property_value(Qtoken_menu,
			Class_description_gkbprop);
		if (gensymed_symbol_4) {
		    sub_class_bit_vector = ISVREF(gensymed_symbol,
			    (SI_Long)19L);
		    superior_class_bit_number = 
			    IFIX(ISVREF(gensymed_symbol_4,(SI_Long)18L));
		    sub_class_vector_index = superior_class_bit_number >>  
			    -  - (SI_Long)3L;
		    if (sub_class_vector_index < 
			    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				{
			gensymed_symbol_1 = 
				UBYTE_8_ISAREF_1(sub_class_bit_vector,
				sub_class_vector_index);
			gensymed_symbol_2 = (SI_Long)1L;
			gensymed_symbol_3 = superior_class_bit_number & 
				(SI_Long)7L;
			gensymed_symbol_2 = gensymed_symbol_2 << 
				gensymed_symbol_3;
			gensymed_symbol_1 = gensymed_symbol_1 & 
				gensymed_symbol_2;
			temp = (SI_Long)0L < gensymed_symbol_1;
		    }
		    else
			temp = TRUEP(Nil);
		}
		else
		    temp = TRUEP(Nil);
		if (temp);
		else {
		    sub_class_bit_vector = ISVREF(gensymed_symbol,
			    (SI_Long)19L);
		    superior_class_bit_number = 
			    IFIX(ISVREF(Kfep_conversion_choice_menu_class_description,
			    (SI_Long)18L));
		    sub_class_vector_index = superior_class_bit_number >>  
			    -  - (SI_Long)3L;
		    if (sub_class_vector_index < 
			    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				{
			gensymed_symbol_1 = 
				UBYTE_8_ISAREF_1(sub_class_bit_vector,
				sub_class_vector_index);
			gensymed_symbol_2 = (SI_Long)1L;
			gensymed_symbol_3 = superior_class_bit_number & 
				(SI_Long)7L;
			gensymed_symbol_2 = gensymed_symbol_2 << 
				gensymed_symbol_3;
			gensymed_symbol_1 = gensymed_symbol_1 & 
				gensymed_symbol_2;
			temp = (SI_Long)0L < gensymed_symbol_1;
		    }
		    else
			temp = TRUEP(Nil);
		}
		if (temp)
		    return text_to_insert_from_text_cell(text_cell_of_table);
		else {
		    sub_class_bit_vector = ISVREF(gensymed_symbol,
			    (SI_Long)19L);
		    superior_class_bit_number = 
			    IFIX(ISVREF(Table_class_description,(SI_Long)18L));
		    sub_class_vector_index = superior_class_bit_number >>  
			    -  - (SI_Long)3L;
		    if (sub_class_vector_index < 
			    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				{
			gensymed_symbol_1 = 
				UBYTE_8_ISAREF_1(sub_class_bit_vector,
				sub_class_vector_index);
			gensymed_symbol_2 = (SI_Long)1L;
			gensymed_symbol_3 = superior_class_bit_number & 
				(SI_Long)7L;
			gensymed_symbol_2 = gensymed_symbol_2 << 
				gensymed_symbol_3;
			gensymed_symbol_1 = gensymed_symbol_1 & 
				gensymed_symbol_2;
			temp = (SI_Long)0L < gensymed_symbol_1;
		    }
		    else
			temp = TRUEP(Nil);
		    if (temp) {
			type_description_of_desired_type = 
				getfq_function_no_default(INLINE_SYMBOL_PLIST(Qattribute_name_represented_by_table_spot),
				Qtype_description_of_type);
			spot = ISVREF(mouse_down_mouse_pointer,(SI_Long)5L);
		      next_loop:
			if ( !TRUEP(spot))
			    goto end_loop;
			if (subtype_p_using_type_descriptions(type_description_of(spot),
				type_description_of_desired_type)) {
			    temp = TRUEP(spot);
			    goto end_1;
			}
			spot = ISVREF(spot,(SI_Long)2L);
			goto next_loop;
		      end_loop:
			temp = TRUEP(Qnil);
		      end_1:;
			if (temp)
			    return get_attribute_table_row_alias_string(text_region_superblock,
				    ISVREF(text_region,(SI_Long)20L));
			else
			    return VALUES_1(Nil);
		    }
		    else
			return VALUES_1(Qnil);
		}
	    }
	    else
		return VALUES_1(Nil);
	}
	else
	    return VALUES_1(Qnil);
    }
}

/* TEXT-TO-INSERT-FROM-TEXT-CELL */
Object text_to_insert_from_text_cell(text_cell)
    Object text_cell;
{
    Object choice_qm;

    x_note_fn_call(126,223);
    choice_qm = getf(CADR(text_cell),Qchoice,_);
    if (choice_qm)
	return copy_text_string(choice_qm);
    else
	return convert_text_to_text_string(1,CDDDR(text_cell));
}

/* CONTINUE-EDITING-BY-DOING-INSERT-SELECTED-TEXT-COMMAND */
Object continue_editing_by_doing_insert_selected_text_command(editing_workstation_context)
    Object editing_workstation_context;
{
    Object status, mouse_pointer, edit_state, text_region, current_edit_state;
    Object current_edit_workspace, gensymed_symbol, x, y, xa, ya;
    char temp;
    Declare_special(2);
    Object result;

    x_note_fn_call(126,224);
    status = ISVREF(Current_workstation,(SI_Long)33L);
    mouse_pointer = ISVREF(Current_workstation,(SI_Long)34L);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    text_region = block_of_selection_focus_blackboard_function(mouse_pointer);
    if (edit_state && text_region) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	    gensymed_symbol = ISVREF(text_region,(SI_Long)3L);
	    temp = SIMPLE_VECTOR_P(text_region) ? EQ(ISVREF(text_region,
		    (SI_Long)1L),Qavailable_frame_vector) : TRUEP(Qnil);
	    if (temp);
	    else
		temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
			(SI_Long)-1L : TRUEP(Nil);
	    if (temp);
	    else {
		x = gensymed_symbol;
		y = ISVREF(edit_state,(SI_Long)2L);
		if (FIXNUMP(y))
		    temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
		else if (FIXNUMP(x))
		    temp = TRUEP(Nil);
		else {
		    xa = M_CAR(y);
		    ya = M_CAR(x);
		    temp = FIXNUM_LT(xa,ya);
		    if (temp);
		    else
			temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),
				M_CDR(x)) : TRUEP(Qnil);
		}
	    }
	    if ( ! !temp)
		result = deselect_current_text_region(Nil);
	    else if (EQ(Kabort,status) || empty_text_region_p(text_region))
		result = deselect_current_text_region(text_region);
	    else
		result = insert_text_within_editor_from_text_region(text_region);
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

static Object Qeditor_text_marking_menu;  /* editor-text-marking-menu */

static Object Qreturn_from_edit_menu;  /* return-from-edit-menu */

/* CONTINUE-EDITING-BY-POSTING-CUT-COPY-PASTE-MENU */
Object continue_editing_by_posting_cut_copy_paste_menu(editing_workstation_context)
    Object editing_workstation_context;
{
    Object status, mouse_pointer, x_in_window, y_in_window, edit_state;
    Object text_region, current_edit_state, current_edit_workspace;
    Object gensymed_symbol, x, y, xa, ya, menu_workspace_qm;
    char temp;
    Declare_special(2);
    Object result;

    x_note_fn_call(126,225);
    status = ISVREF(Current_workstation,(SI_Long)33L);
    mouse_pointer = ISVREF(Current_workstation,(SI_Long)34L);
    x_in_window = x_in_window_blackboard_function(mouse_pointer);
    y_in_window = y_in_window_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    text_region = block_of_selection_focus_blackboard_function(mouse_pointer);
    if (x_in_window && y_in_window && edit_state && text_region) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	    gensymed_symbol = ISVREF(text_region,(SI_Long)3L);
	    temp = SIMPLE_VECTOR_P(text_region) ? EQ(ISVREF(text_region,
		    (SI_Long)1L),Qavailable_frame_vector) : TRUEP(Qnil);
	    if (temp);
	    else
		temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
			(SI_Long)-1L : TRUEP(Nil);
	    if (temp);
	    else {
		x = gensymed_symbol;
		y = ISVREF(edit_state,(SI_Long)2L);
		if (FIXNUMP(y))
		    temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
		else if (FIXNUMP(x))
		    temp = TRUEP(Nil);
		else {
		    xa = M_CAR(y);
		    ya = M_CAR(x);
		    temp = FIXNUM_LT(xa,ya);
		    if (temp);
		    else
			temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),
				M_CDR(x)) : TRUEP(Qnil);
		}
	    }
	    if ( ! !temp)
		result = deselect_current_text_region(Nil);
	    else if (EQ(Kabort,status) || empty_text_region_p(text_region))
		result = deselect_current_text_region(text_region);
	    else if (ISVREF(Editor_parameters,(SI_Long)34L)) {
		menu_workspace_qm = post_command_menu(4,
			Qeditor_text_marking_menu,mouse_pointer,
			x_in_window,y_in_window);
		if ( !TRUEP(menu_workspace_qm))
		    result = deselect_current_text_region(text_region);
		else {
		    disable_text_region_operation_subcommands_in_current_editor();
		    establish_next_workstation_context_continuation(Qreturn_from_edit_menu,
			    Nil,Nil,Nil);
		    result = enter_edit_menu_state(menu_workspace_qm);
		}
	    }
	    else
		result = update_edit_operation_subcommands_in_current_editor();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

static Object Qpending_delete_type_in;  /* pending-delete-type-in */

/* RETURN-FROM-EDIT-MENU */
Object return_from_edit_menu(workstation_context)
    Object workstation_context;
{
    Object status, edit_state, current_edit_state, current_edit_workspace;
    Object text_region_qm;
    Declare_special(2);
    Object result;

    x_note_fn_call(126,226);
    status = ISVREF(Current_workstation,(SI_Long)33L);
    edit_state = ISVREF(workstation_context,(SI_Long)2L);
    current_edit_state = edit_state;
    PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
      current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
      PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	text_region_qm = get_selected_text_region_for_edit_box();
	if (EQ(status,Qpending_delete_type_in))
	    result = select_current_text_region(text_region_qm);
	else if (text_region_qm)
	    result = deselect_current_text_region(text_region_qm);
	else
	    result = update_edit_operation_subcommands_in_current_editor();
      POP_SPECIAL();
    POP_SPECIAL();
    return result;
}

/* WORD-LIKE-SEQUENCE-IN-TEXT-REGION-P */
Object word_like_sequence_in_text_region_p(text_region)
    Object text_region;
{
    Object temp, text_tail, beginning_line_index, beginning_character_index;
    Object end_line_index, end_character_index, temp_1, text;
    Object result;

    x_note_fn_call(126,227);
    result = get_text_region_position(1,text_region);
    MVS_7(result,text_tail,beginning_line_index,beginning_character_index,
	    end_line_index,end_character_index,temp_1,text);
    temp_1 = word_like_sequence_in_text_p(text,text_tail,
	    beginning_line_index,beginning_character_index,end_line_index,
	    end_character_index);
    return VALUES_1(temp_1);
}

static Object Qhandle_spaces_intelligently_qm;  /* handle-spaces-intelligently? */

/* HANDLE-SPACES-INTELLIGENTLY-P */
Object handle_spaces_intelligently_p(block)
    Object block;
{
    Object gensymed_symbol, gensymed_symbol_1, sub_class_bit_vector;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_2, gensymed_symbol_3, gensymed_symbol_4;
    char temp;

    x_note_fn_call(126,228);
    gensymed_symbol = ISVREF(block,(SI_Long)1L);
    gensymed_symbol_1 = 
	    lookup_global_or_kb_specific_property_value(Qtoken_menu,
	    Class_description_gkbprop);
    if (gensymed_symbol_1) {
	sub_class_bit_vector = ISVREF(gensymed_symbol,(SI_Long)19L);
	superior_class_bit_number = IFIX(ISVREF(gensymed_symbol_1,
		(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol_2 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_3 = (SI_Long)1L;
	    gensymed_symbol_4 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_3 = gensymed_symbol_3 << gensymed_symbol_4;
	    gensymed_symbol_2 = gensymed_symbol_2 & gensymed_symbol_3;
	    temp = (SI_Long)0L < gensymed_symbol_2;
	}
	else
	    temp = TRUEP(Nil);
    }
    else
	temp = TRUEP(Nil);
    if (temp);
    else {
	sub_class_bit_vector = ISVREF(gensymed_symbol,(SI_Long)19L);
	superior_class_bit_number = IFIX(ISVREF(Scrap_class_description,
		(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol_2 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_3 = (SI_Long)1L;
	    gensymed_symbol_4 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_3 = gensymed_symbol_3 << gensymed_symbol_4;
	    gensymed_symbol_2 = gensymed_symbol_2 & gensymed_symbol_3;
	    temp = (SI_Long)0L < gensymed_symbol_2;
	}
	else
	    temp = TRUEP(Nil);
    }
    if (temp)
	return get_slot_value_function(block,
		Qhandle_spaces_intelligently_qm,Nil);
    else {
	sub_class_bit_vector = ISVREF(gensymed_symbol,(SI_Long)19L);
	superior_class_bit_number = 
		IFIX(ISVREF(Text_region_class_description,(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol_2 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_3 = (SI_Long)1L;
	    gensymed_symbol_4 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_3 = gensymed_symbol_3 << gensymed_symbol_4;
	    gensymed_symbol_2 = gensymed_symbol_2 & gensymed_symbol_3;
	    temp = (SI_Long)0L < gensymed_symbol_2;
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    if (ISVREF(Editor_parameters,(SI_Long)37L))
		return word_like_sequence_in_text_region_p(block);
	    else
		return VALUES_1(Nil);
	}
	else
	    return VALUES_1(ISVREF(Editor_parameters,(SI_Long)37L));
    }
}

/* CLEAR-TEXT-REGION-FROM-EDIT-BOX */
Object clear_text_region_from_edit_box varargs_1(int, n)
{
    Object text_region;
    Object also_move_cursor_qm, text_tail, beginning_line_index;
    Object beginning_character_index, end_line_index, end_character_index;
    Declare_varargs_nonrelocating;
    Object result;

    x_note_fn_call(126,229);
    INIT_ARGS_nonrelocating();
    text_region = REQUIRED_ARG_nonrelocating();
    also_move_cursor_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    result = get_text_region_position(1,text_region);
    MVS_5(result,text_tail,beginning_line_index,beginning_character_index,
	    end_line_index,end_character_index);
    deselect_current_text_region(text_region);
    if (also_move_cursor_qm)
	change_edit_box(9,text_tail,beginning_line_index,
		beginning_character_index,Nil,Nil,Nil,Nil,Nil,T);
    return delete_intelligently_from_text_being_edited(5,text_tail,
	    beginning_line_index,beginning_character_index,end_line_index,
	    end_character_index);
}

static Object Qcut_within_editor;  /* cut-within-editor */

/* COM-CUT-WITHIN-EDITOR */
Object com_cut_within_editor(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,230);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      do_cut_within_editor(2,event,edit_state);
	      editor_post_command_hook(Qcut_within_editor,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* CUT-WITHIN-EDITOR-COMMAND-PURSUER */
Object cut_within_editor_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,231);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* CUT-WITHIN-EDITOR-COMMAND-TRANSLATOR */
Object cut_within_editor_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,232);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qcut_within_editor,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qui_command_named;   /* ui-command-named */

/* DO-CUT-WITHIN-EDITOR */
Object do_cut_within_editor varargs_1(int, n)
{
    Object event_if_kbd_command_qm, edit_state_if_kbd_command_qm;
    Object text_region_qm, ui_command, gensymed_symbol, temp;
    Declare_varargs_nonrelocating;

    x_note_fn_call(126,233);
    INIT_ARGS_nonrelocating();
    event_if_kbd_command_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    edit_state_if_kbd_command_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    text_region_qm = get_selected_text_region_for_edit_box();
    if (text_region_qm) {
	if ( !TRUEP(empty_text_region_p(text_region_qm)))
	    coerce_text_region_to_scrap(text_region_qm);
	return clear_text_region_from_edit_box(2,text_region_qm,T);
    }
    else if (event_if_kbd_command_qm && edit_state_if_kbd_command_qm) {
	ui_command = 
		getfq_function_no_default(INLINE_SYMBOL_PLIST(Qdelete_backward_to_beginning),
		Qui_command_named);
	if (ui_command) {
	    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
	    temp = SYMBOLP(gensymed_symbol) ? 
		    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
	    return FUNCALL_2(temp,event_if_kbd_command_qm,
		    edit_state_if_kbd_command_qm);
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Qnil);
}

static Object Qcopy_within_editor;  /* copy-within-editor */

/* COM-COPY-WITHIN-EDITOR */
Object com_copy_within_editor(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,234);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      do_copy_within_editor();
	      editor_post_command_hook(Qcopy_within_editor,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* COPY-WITHIN-EDITOR-COMMAND-PURSUER */
Object copy_within_editor_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,235);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* COPY-WITHIN-EDITOR-COMMAND-TRANSLATOR */
Object copy_within_editor_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,236);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qcopy_within_editor,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

Object Deselect_text_region_after_copy_p = UNBOUND;

/* DO-COPY-WITHIN-EDITOR */
Object do_copy_within_editor()
{
    Object text_region_qm;

    x_note_fn_call(126,237);
    text_region_qm = get_selected_text_region_for_edit_box();
    if (text_region_qm) {
	if ( !TRUEP(empty_text_region_p(text_region_qm)))
	    coerce_text_region_to_scrap(text_region_qm);
	if (Deselect_text_region_after_copy_p)
	    return deselect_current_text_region(text_region_qm);
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qpaste_within_editor;  /* paste-within-editor */

/* COM-PASTE-WITHIN-EDITOR */
Object com_paste_within_editor(event,edit_state,workspace,image_plane,
	    mouse_pointer)
    Object event, edit_state, workspace, image_plane, mouse_pointer;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, gensymed_symbol;
    Object sub_class_bit_vector;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    char temp_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,238);
    if (event && edit_state && of_class_p_function(workspace,Qworkspace) 
	    && valid_image_plane_p(image_plane) && mouse_pointer && 
	    SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
	    (SI_Long)0L),Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      gensymed_symbol = 
		      lookup_global_or_kb_specific_property_value(Qedit_workspace,
		      Class_description_gkbprop);
	      if (gensymed_symbol) {
		  sub_class_bit_vector = ISVREF(ISVREF(workspace,
			  (SI_Long)1L),(SI_Long)19L);
		  superior_class_bit_number = IFIX(ISVREF(gensymed_symbol,
			  (SI_Long)18L));
		  sub_class_vector_index = superior_class_bit_number >>  - 
			   - (SI_Long)3L;
		  if (sub_class_vector_index < 
			  IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
			      {
		      gensymed_symbol_1 = 
			      UBYTE_8_ISAREF_1(sub_class_bit_vector,
			      sub_class_vector_index);
		      gensymed_symbol_2 = (SI_Long)1L;
		      gensymed_symbol_3 = superior_class_bit_number & 
			      (SI_Long)7L;
		      gensymed_symbol_2 = gensymed_symbol_2 << 
			      gensymed_symbol_3;
		      gensymed_symbol_1 = gensymed_symbol_1 & 
			      gensymed_symbol_2;
		      temp_1 = (SI_Long)0L < gensymed_symbol_1;
		  }
		  else
		      temp_1 = TRUEP(Nil);
	      }
	      else
		  temp_1 = TRUEP(Nil);
	      if (temp_1) {
		  if (text_can_be_pasted_in_current_workstation_p())
		      do_paste_within_editor();
	      }
	      else
		  run_top_level_event_handler(mouse_pointer);
	      editor_post_command_hook(Qpaste_within_editor,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

static Object Qimage_plane;        /* image-plane */

/* PASTE-WITHIN-EDITOR-COMMAND-PURSUER */
Object paste_within_editor_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state, workspace, image_plane;
    Object mouse_pointer;

    x_note_fn_call(126,239);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    workspace = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    image_plane = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    mouse_pointer = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    workspace = command_argument_value(workspace);
    image_plane = command_argument_value(image_plane);
    mouse_pointer = command_argument_value(mouse_pointer);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else if (EQ(workspace,Plus_missing_argument_plus))
	return VALUES_3(Qworkspace,Qworkspace,FIX((SI_Long)2L));
    else if (EQ(image_plane,Plus_missing_argument_plus))
	return VALUES_3(Qimage_plane,Qimage_plane,FIX((SI_Long)3L));
    else if (EQ(mouse_pointer,Plus_missing_argument_plus))
	return VALUES_3(Qmouse_pointer,Qmouse_pointer,FIX((SI_Long)4L));
    else
	return VALUES_1(Qnil);
}

/* PASTE-WITHIN-EDITOR-COMMAND-TRANSLATOR */
Object paste_within_editor_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, workspace, image_plane, mouse_pointer_1;
    Object gensymed_symbol, gensymed_symbol_1, temp, car_new_value;

    x_note_fn_call(126,240);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    workspace = find_frame_of_class_in_mouse_pointer(mouse_pointer,Qworkspace);
    image_plane = image_plane_blackboard_function(mouse_pointer);
    mouse_pointer_1 = mouse_pointer_blackboard_function(mouse_pointer);
    if (event && edit_state && workspace && image_plane && mouse_pointer_1) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    gensymed_symbol = make_gensym_list_1(FIX((SI_Long)5L));
	    gensymed_symbol_1 = gensymed_symbol;
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    car_new_value = snapshot_command_argument(temp);
	    M_CAR(gensymed_symbol_1) = car_new_value;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    car_new_value = snapshot_command_argument(temp);
	    M_CAR(gensymed_symbol_1) = car_new_value;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    temp = workspace;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    car_new_value = snapshot_command_argument(temp);
	    M_CAR(gensymed_symbol_1) = car_new_value;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    temp = image_plane;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    car_new_value = snapshot_command_argument(temp);
	    M_CAR(gensymed_symbol_1) = car_new_value;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    temp = mouse_pointer_1;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    car_new_value = snapshot_command_argument(temp);
	    M_CAR(gensymed_symbol_1) = car_new_value;
	    return make_partial_command(Qpaste_within_editor,gensymed_symbol);
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* DO-PASTE-WITHIN-EDITOR */
Object do_paste_within_editor()
{
    x_note_fn_call(126,241);
    raise_image_plane_to_top(1,
	    find_image_plane_for_workspace_in_pane(Current_edit_workspace,
	    Current_workstation_detail_pane));
    if (FIXNUM_LT(Icp_window_protocol_supports_native_cut_and_paste,
	    ISVREF(Current_workstation_window,(SI_Long)11L)) &&  
	    !TRUEP(get_gensym_window_parameter(Current_workstation_window,
	    Qno_native_clipboard)))
	return request_paste_for_editor();
    else
	return paste_from_current_scrap_if_any();
}

/* DO-DELETE-WITHIN-EDITOR */
Object do_delete_within_editor()
{
    Object text_region_qm;

    x_note_fn_call(126,242);
    text_region_qm = get_selected_text_region_for_edit_box();
    if (text_region_qm)
	return clear_text_region_from_edit_box(2,text_region_qm,T);
    else
	return VALUES_1(Nil);
}

/* DO-INSERT-WITHIN-EDITOR */
Object do_insert_within_editor()
{
    Object text_region;

    x_note_fn_call(126,243);
    text_region = Nil;
    text_region = get_selected_text_region_for_edit_box();
    if (text_region)
	return insert_text_within_editor_from_text_region(text_region);
    else
	return VALUES_1(Nil);
}

/* INSERT-TEXT-WITHIN-EDITOR-FROM-TEXT-REGION */
Object insert_text_within_editor_from_text_region(text_region)
    Object text_region;
{
    Object replace_fragments_on_sides_qm, handle_spaces_intelligently_qm;
    Object text_string, frame_reference_serial_number, gensymed_symbol, xa, ya;
    char temp;

    x_note_fn_call(126,244);
    replace_fragments_on_sides_qm = Nil;
    handle_spaces_intelligently_qm = 
	    handle_spaces_intelligently_p(text_region);
    text_string = convert_text_region_to_text_string(1,text_region);
    frame_reference_serial_number = 
	    copy_frame_serial_number(Current_frame_serial_number);
    insert_text_string_at_cursor(3,text_string,
	    replace_fragments_on_sides_qm,handle_spaces_intelligently_qm);
    gensymed_symbol = ISVREF(text_region,(SI_Long)3L);
    temp = SIMPLE_VECTOR_P(text_region) ? EQ(ISVREF(text_region,
	    (SI_Long)1L),Qavailable_frame_vector) : TRUEP(Qnil);
    if (temp);
    else
	temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		(SI_Long)-1L : TRUEP(Nil);
    if (temp);
    else if (FIXNUMP(frame_reference_serial_number))
	temp = FIXNUMP(gensymed_symbol) ? 
		FIXNUM_LT(frame_reference_serial_number,gensymed_symbol) : 
		TRUEP(T);
    else if (FIXNUMP(gensymed_symbol))
	temp = TRUEP(Nil);
    else {
	xa = M_CAR(frame_reference_serial_number);
	ya = M_CAR(gensymed_symbol);
	temp = FIXNUM_LT(xa,ya);
	if (temp);
	else
	    temp = FIXNUM_EQ(xa,ya) ? 
		    FIXNUM_LT(M_CDR(frame_reference_serial_number),
		    M_CDR(gensymed_symbol)) : TRUEP(Qnil);
    }
    if ( !temp)
	delete_frame(text_region);
    reclaim_text_string(text_string);
    return reclaim_frame_serial_number(frame_reference_serial_number);
}

/* DO-COPY-AND-INSERT-WITHIN-EDITOR */
Object do_copy_and_insert_within_editor()
{
    Object text_region;

    x_note_fn_call(126,245);
    text_region = Nil;
    text_region = get_selected_text_region_for_edit_box();
    if (text_region) {
	coerce_text_region_to_scrap(text_region);
	delete_frame(text_region);
	return do_paste_within_editor();
    }
    else
	return VALUES_1(Nil);
}

/* DO-MOVE-WITHIN-EDITOR */
Object do_move_within_editor()
{
    Object text_region, text_string;

    x_note_fn_call(126,246);
    text_region = Nil;
    text_region = get_selected_text_region_for_edit_box();
    if (text_region) {
	text_string = convert_text_region_to_text_string(1,text_region);
	clear_text_region_from_edit_box(1,text_region);
	insert_text_string_at_cursor(3,text_string,Nil,Nil);
	return reclaim_text_string(text_string);
    }
    else
	return VALUES_1(Nil);
}

/* DO-CUT-AND-INSERT-WITHIN-EDITOR */
Object do_cut_and_insert_within_editor()
{
    Object text_region, text_string;

    x_note_fn_call(126,247);
    text_region = Nil;
    text_region = get_selected_text_region_for_edit_box();
    if (text_region) {
	coerce_text_region_to_scrap(text_region);
	text_string = convert_text_region_to_text_string(1,text_region);
	clear_text_region_from_edit_box(1,text_region);
	insert_text_string_at_cursor(3,text_string,Nil,Nil);
	return reclaim_text_string(text_string);
    }
    else
	return VALUES_1(Nil);
}

/* PROCEDURE-SIGNATURES-CAN-BE-SHOWN-P */
Object procedure_signatures_can_be_shown_p()
{
    Object workspace, classic_only_p, temp;

    x_note_fn_call(126,248);
    if (Current_edit_state && ISVREF(Editor_parameters,(SI_Long)36L) &&  
	    !TRUEP(Keep_edit_workspace_hidden_no_matter_what_qm)) {
	workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	classic_only_p = T;
	temp = ISVREF(workspace,(SI_Long)16L);
	if (temp);
	else
	    temp =  !TRUEP(classic_only_p) ? 
		    workspace_showing_on_ui_client_p(workspace) : Qnil;
    }
    else
	temp = Nil;
    return VALUES_1(temp);
}

Object Close_pending_procedure_signature_workspaces_on_close = UNBOUND;

Object Open_paren_token = UNBOUND;

Object Close_paren_token = UNBOUND;

/* PROCEDURE-SIGNATURE-HOOK */
Object procedure_signature_hook()
{
    Object accumulated_closes, sub_stack, token, token_before_that;
    Object ab_loop_list_, temp, has_one_p;

    x_note_fn_call(126,249);
    if (procedure_signatures_can_be_shown_p()) {
	accumulated_closes = FIX((SI_Long)0L);
	sub_stack = ISVREF(Current_edit_state,(SI_Long)54L);
	token = Nil;
	token_before_that = Nil;
	ab_loop_list_ = sub_stack;
      next_loop:
	if ( !TRUEP(sub_stack))
	    goto end_loop;
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	token = CAR(ab_loop_list_);
	temp = CDR(ab_loop_list_);
	token_before_that = CAR(temp);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	if (EQ(token,Close_paren_token))
	    accumulated_closes = FIXNUM_ADD1(accumulated_closes);
	if (EQ(token,Open_paren_token)) {
	    if (IFIX(accumulated_closes) == (SI_Long)0L) {
		has_one_p = show_signature_if_prior_token_has_one(sub_stack);
		if (has_one_p)
		    remove_any_other_visible_signatures(SECOND(sub_stack));
		else
		    runtime_reclaim_pending_procedure_signature_workspaces();
		return VALUES_1(Nil);
	    }
	    else
		accumulated_closes = FIXNUM_SUB1(accumulated_closes);
	}
	sub_stack = M_CDR(sub_stack);
	goto next_loop;
      end_loop:
	runtime_reclaim_pending_procedure_signature_workspaces();
	return VALUES_1(Qnil);
    }
    else
	return VALUES_1(Nil);
}

/* PROCEDURE-SIGNATURE-TOKEN-HOOK */
Object procedure_signature_token_hook(token)
    Object token;
{
    x_note_fn_call(126,250);
    if (EQ(token,Close_paren_token) && procedure_signatures_can_be_shown_p())
	close_signature_window_if_appropriate();
    return VALUES_1(Nil);
}

static Object Qcall;               /* call */

/* SHOW-SIGNATURE-IF-PRIOR-TOKEN-HAS-ONE */
Object show_signature_if_prior_token_has_one(stack)
    Object stack;
{
    Object token_before_open, list_or_list_of_lists, type;
    char call_p;
    Object result;

    x_note_fn_call(126,251);
    token_before_open = SECOND(stack);
    call_p = EQ(Qcall,THIRD(stack));
    if (SYMBOLP(token_before_open)) {
	result = parameters_for_token_if_any(token_before_open,call_p ? T :
		 Nil);
	MVS_2(result,list_or_list_of_lists,type);
	if (list_or_list_of_lists) {
	    create_or_revive_workspace_for_procedure_signature(token_before_open,
		    type,list_or_list_of_lists);
	    reclaim_gensym_tree_1(list_or_list_of_lists);
	    return VALUES_1(T);
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* CREATE-OR-REVIVE-WORKSPACE-FOR-PROCEDURE-SIGNATURE */
Object create_or_revive_workspace_for_procedure_signature(token,type,
	    list_or_list_of_lists)
    Object token, type, list_or_list_of_lists;
{
    Object entry, workspace, workspace_serial_number, gensymed_symbol, xa, ya;
    Object workspace_qm;
    char temp;

    x_note_fn_call(126,252);
    entry = assq_function(token,ISVREF(Current_edit_state,(SI_Long)91L));
    if (entry) {
	workspace = SECOND(entry);
	workspace_serial_number = THIRD(entry);
	gensymed_symbol = ISVREF(workspace,(SI_Long)3L);
	temp = SIMPLE_VECTOR_P(workspace) ? EQ(ISVREF(workspace,
		(SI_Long)1L),Qavailable_frame_vector) : TRUEP(Qnil);
	if (temp);
	else
	    temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		    (SI_Long)-1L : TRUEP(Nil);
	if (temp);
	else if (FIXNUMP(workspace_serial_number))
	    temp = FIXNUMP(gensymed_symbol) ? 
		    FIXNUM_LT(workspace_serial_number,gensymed_symbol) : 
		    TRUEP(T);
	else if (FIXNUMP(gensymed_symbol))
	    temp = TRUEP(Nil);
	else {
	    xa = M_CAR(workspace_serial_number);
	    ya = M_CAR(gensymed_symbol);
	    temp = FIXNUM_LT(xa,ya);
	    if (temp);
	    else
		temp = FIXNUM_EQ(xa,ya) ? 
			FIXNUM_LT(M_CDR(workspace_serial_number),
			M_CDR(gensymed_symbol)) : TRUEP(Qnil);
	}
	if ( !temp)
	    return VALUES_1(T);
	else {
	    remove_record_of_procedure_signature_workspace(token);
	    return create_or_revive_workspace_for_procedure_signature(token,
		    type,list_or_list_of_lists);
	}
    }
    else {
	workspace_qm = construct_workspace_for_signature(token,type,
		list_or_list_of_lists);
	if (workspace_qm) {
	    if ( 
		    !TRUEP(native_editor_workspace_p(ISVREF(Current_edit_state,
		    (SI_Long)12L)))) {
		put_workspace_on_pane_function(workspace_qm,
			Current_workstation_detail_pane,Qright,Qtop,T,
			FIX((SI_Long)11L),Nil,Nil,Nil,Nil,Nil,Nil,Nil);
		return record_procedure_signature_workspace(token,
			workspace_qm);
	    }
	    else
		return VALUES_1(Nil);
	}
	else
	    return VALUES_1(Nil);
    }
}

static Object Qtemporary_workspace;  /* temporary-workspace */

/* CONSTRUCT-WORKSPACE-FOR-SIGNATURE */
Object construct_workspace_for_signature(token,type,list_or_list_of_lists)
    Object token, type, list_or_list_of_lists;
{
    Object workspace, initial_delta_y, current_y, first_p, arg_list;
    Object ab_loop_list_;

    x_note_fn_call(126,253);
    workspace = make_workspace(6,Qtemporary_workspace,Nil,Nil,
	    FIX((SI_Long)10L),FIX((SI_Long)250L),Nil);
    initial_delta_y = add_title_of_signature_to_signature_workspace(token,
	    type,workspace);
    current_y = initial_delta_y;
    first_p = T;
    arg_list = Nil;
    ab_loop_list_ = list_or_list_of_lists;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    arg_list = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    current_y = add_signature_to_workspace(token,arg_list,workspace,current_y);
    first_p = Nil;
    goto next_loop;
  end_loop:;
    return VALUES_1(workspace);
}

static Object Qdo_not_use;         /* do-not-use */

/* ADD-SIGNATURE-TO-WORKSPACE */
Object add_signature_to_workspace(token,arg_list,workspace,current_y)
    Object token, arg_list, workspace, current_y;
{
    Object current_wide_string_list, wide_string_bv16, current_wide_string;
    Object fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object signature_string, block, gensymed_symbol;
    SI_Long bv16_length, aref_arg_2, aref_new_value, length_1;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    Declare_special(5);

    x_note_fn_call(126,254);
    current_wide_string_list = Qdo_not_use;
    PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
      wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)2048L + 
	      (SI_Long)3L));
      bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
      aref_arg_2 = bv16_length - (SI_Long)2L;
      aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
      UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
      aref_arg_2 = bv16_length - (SI_Long)1L;
      aref_new_value = (SI_Long)57344L | (SI_Long)0L;
      UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
      UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
      current_wide_string = wide_string_bv16;
      PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
	fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		2);
	  length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
	  total_length_of_current_wide_string = 
		  FIX(UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		  (SI_Long)2L) + ((UBYTE_16_ISAREF_1(Current_wide_string,
		  length_1 - (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
	  PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
		  1);
	    current_twriting_output_type = Qwide_string;
	    PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
		    0);
	      twrite_signature(token,arg_list);
	      signature_string = copy_out_current_wide_string();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
      POP_SPECIAL();
    POP_SPECIAL();
    block = make_box_for_signatures(signature_string);
    gensymed_symbol = ISVREF(workspace,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)0L) : FIX((SI_Long)0L);
    gensymed_symbol_1 = IFIX(gensymed_symbol);
    gensymed_symbol_2 = IFIX(ISVREF(workspace,(SI_Long)17L));
    add_to_workspace(4,block,workspace,FIX(gensymed_symbol_1 + 
	    gensymed_symbol_2),current_y);
    gensymed_symbol_1 = IFIX(current_y);
    gensymed_symbol = ISVREF(block,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)3L) : FIX((SI_Long)0L);
    gensymed_symbol_2 = IFIX(gensymed_symbol);
    gensymed_symbol = ISVREF(block,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)1L) : FIX((SI_Long)0L);
    gensymed_symbol_3 = IFIX(gensymed_symbol);
    gensymed_symbol_2 = gensymed_symbol_2 - gensymed_symbol_3;
    gensymed_symbol_3 = (SI_Long)10L;
    gensymed_symbol_2 = gensymed_symbol_2 + gensymed_symbol_3;
    return VALUES_1(FIX(gensymed_symbol_1 + gensymed_symbol_2));
}

/* MAKE-BOX-FOR-SIGNATURES */
Object make_box_for_signatures(string_1)
    Object string_1;
{
    Object box;
    SI_Long svref_new_value;

    x_note_fn_call(126,255);
    box = make_message(1,string_1);
    svref_new_value = IFIX(ISVREF(box,(SI_Long)5L)) | (SI_Long)524288L;
    ISVREF(box,(SI_Long)5L) = FIX(svref_new_value);
    return VALUES_1(box);
}

static Object Kreturn;             /* :return */

static Object string_constant_11;  /* "~(~a~) (" */

static Object string_constant_12;  /* ")" */

static Object string_constant_13;  /* " => (" */

/* TWRITE-SIGNATURE */
Object twrite_signature(token,arg_list)
    Object token, arg_list;
{
    Object temp, return_types_qm;

    x_note_fn_call(126,256);
    temp = memq_function(Kreturn,arg_list);
    return_types_qm = CDR(temp);
    tformat(2,string_constant_11,token);
    twrite_parameter_list(arg_list);
    twrite(string_constant_12);
    if (return_types_qm) {
	twrite(string_constant_13);
	twrite_return_types(return_types_qm);
	return twrite(string_constant_12);
    }
    else
	return VALUES_1(Nil);
}

static Object array_constant_2;    /* # */

static Object array_constant_3;    /* # */

/* TWRITE-PARAMETER-LIST */
Object twrite_parameter_list(arg_list)
    Object arg_list;
{
    Object name, type, first_p, cons_or_symbol, ab_loop_list_;

    x_note_fn_call(126,257);
    name = Nil;
    type = Nil;
    first_p = T;
    cons_or_symbol = Nil;
    ab_loop_list_ = arg_list;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    cons_or_symbol = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    if (EQ(cons_or_symbol,Kreturn))
	return VALUES_1(Nil);
    if (CONSP(cons_or_symbol)) {
	name = CAR(cons_or_symbol);
	type = CDR(cons_or_symbol);
    }
    else
	name = cons_or_symbol;
    if ( !TRUEP(first_p))
	twrite_beginning_of_wide_string(array_constant_2,FIX((SI_Long)2L));
    twrite_symbol(1,name);
    if (type) {
	twrite_beginning_of_wide_string(array_constant_3,FIX((SI_Long)2L));
	twrite_parameter_list_type_field(type);
    }
    first_p = Nil;
    goto next_loop;
  end_loop:
    return VALUES_1(Qnil);
}

/* TWRITE-RETURN-TYPES */
Object twrite_return_types(types)
    Object types;
{
    Object first_p, type, ab_loop_list_;

    x_note_fn_call(126,258);
    first_p = T;
    type = Nil;
    ab_loop_list_ = types;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    type = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    if ( !TRUEP(first_p))
	twrite_beginning_of_wide_string(array_constant_2,FIX((SI_Long)2L));
    twrite_parameter_list_type_field(type);
    first_p = Nil;
    goto next_loop;
  end_loop:
    return VALUES_1(Qnil);
}

static Object array_constant_4;    /* # */

/* TWRITE-PARAMETER-LIST-TYPE-FIELD */
Object twrite_parameter_list_type_field(type)
    Object type;
{
    x_note_fn_call(126,259);
    if (CONSP(type)) {
	twrite_beginning_of_wide_string(array_constant_4,FIX((SI_Long)6L));
	return twrite_symbol(1,SECOND(type));
    }
    else
	return twrite_data_type(type);
}

/* ADD-PARAMETER-STRING-TO-WORKSPACE */
Object add_parameter_string_to_workspace(string_1,workspace,current_y)
    Object string_1, workspace, current_y;
{
    Object block, gensymed_symbol;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;

    x_note_fn_call(126,260);
    block = make_description_box(string_1);
    gensymed_symbol = ISVREF(workspace,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)0L) : FIX((SI_Long)0L);
    gensymed_symbol_1 = IFIX(gensymed_symbol);
    gensymed_symbol_2 = IFIX(ISVREF(workspace,(SI_Long)17L));
    add_to_workspace(4,block,workspace,FIX(gensymed_symbol_1 + 
	    gensymed_symbol_2),current_y);
    gensymed_symbol_1 = IFIX(current_y);
    gensymed_symbol = ISVREF(block,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)3L) : FIX((SI_Long)0L);
    gensymed_symbol_2 = IFIX(gensymed_symbol);
    gensymed_symbol = ISVREF(block,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)1L) : FIX((SI_Long)0L);
    gensymed_symbol_3 = IFIX(gensymed_symbol);
    gensymed_symbol_2 = gensymed_symbol_2 - gensymed_symbol_3;
    gensymed_symbol_3 = (SI_Long)10L;
    gensymed_symbol_2 = gensymed_symbol_2 + gensymed_symbol_3;
    return VALUES_1(FIX(gensymed_symbol_1 + gensymed_symbol_2));
}

static Object string_constant_14;  /* "~(~L,-~) arguments" */

static Object Qstretch_new_image_planes_for_caption_p;  /* stretch-new-image-planes-for-caption-p */

/* ADD-TITLE-OF-SIGNATURE-TO-SIGNATURE-WORKSPACE */
Object add_title_of_signature_to_signature_workspace(token,type_or_types,
	    workspace)
    Object token, type_or_types, workspace;
{
    Object wide_string_bv16, new_wide_string, current_wide_string_list;
    Object current_wide_string, fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object temp, aref_arg_2_1, gensym_list_of_wide_strings, string_1;
    Object ab_loop_list_, ab_loopvar_, ab_loopvar__1, ab_loopvar__2, new_cons;
    Object gensymed_symbol, short_string, temp_1, title_text, block;
    SI_Long bv16_length, aref_arg_2, aref_new_value, length_1;
    SI_Long gensymed_symbol_1, gensymed_symbol_2;
    Declare_special(5);

    x_note_fn_call(126,261);
    wide_string_bv16 = 
	    allocate_byte_vector_16(FIX(IFIX(Wide_string_list_maximum_length) 
	    + (SI_Long)3L));
    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
    aref_arg_2 = bv16_length - (SI_Long)2L;
    aref_new_value = IFIX(Wide_string_list_maximum_length) & (SI_Long)65535L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    aref_arg_2 = bv16_length - (SI_Long)1L;
    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    UBYTE_16_ISASET_1(wide_string_bv16,
	    IFIX(Wide_string_list_maximum_length),(SI_Long)0L);
    new_wide_string = wide_string_bv16;
    current_wide_string_list = gensym_cons_1(new_wide_string,Nil);
    PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
      current_wide_string = new_wide_string;
      PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
	fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		2);
	  length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
	  total_length_of_current_wide_string = 
		  FIX(UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		  (SI_Long)2L) + ((UBYTE_16_ISAREF_1(Current_wide_string,
		  length_1 - (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
	  PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
		  1);
	    current_twriting_output_type = Qwide_string;
	    PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
		    0);
	      tformat(2,string_constant_14,type_or_types);
	      temp = Current_wide_string;
	      aref_arg_2_1 = Fill_pointer_for_current_wide_string;
	      bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(temp));
	      aref_arg_2 = bv16_length - (SI_Long)2L;
	      aref_new_value = IFIX(aref_arg_2_1) & (SI_Long)65535L;
	      UBYTE_16_ISASET_1(temp,aref_arg_2,aref_new_value);
	      aref_arg_2 = bv16_length - (SI_Long)1L;
	      aref_new_value = (SI_Long)57344L | IFIX(aref_arg_2_1) >>  -  
		      - (SI_Long)16L;
	      UBYTE_16_ISASET_1(temp,aref_arg_2,aref_new_value);
	      UBYTE_16_ISASET_1(temp,IFIX(aref_arg_2_1),(SI_Long)0L);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
      POP_SPECIAL();
      gensym_list_of_wide_strings = Current_wide_string_list;
    POP_SPECIAL();
    string_1 = Nil;
    ab_loop_list_ = gensym_list_of_wide_strings;
    ab_loopvar_ = Nil;
    ab_loopvar__1 = Nil;
    ab_loopvar__2 = Nil;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    string_1 = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    new_cons = Available_gensym_conses;
    if (new_cons) {
	Available_gensym_conses = M_CDR(new_cons);
	gensymed_symbol = new_cons;
    }
    else
	gensymed_symbol = Nil;
    if ( !TRUEP(gensymed_symbol))
	gensymed_symbol = replenish_gensym_cons_pool();
    temp = make_lost_spaces_text_element(FIX((SI_Long)0L));
    M_CAR(gensymed_symbol) = temp;
    M_CDR(gensymed_symbol) = Nil;
    inline_note_allocate_cons(gensymed_symbol,Qab_gensym);
    ab_loopvar__2 = gensymed_symbol;
    if (ab_loopvar__1)
	M_CDR(ab_loopvar__1) = ab_loopvar__2;
    else
	ab_loopvar_ = ab_loopvar__2;
    ab_loopvar__1 = ab_loopvar__2;
    new_cons = Available_gensym_conses;
    if (new_cons) {
	Available_gensym_conses = M_CDR(new_cons);
	gensymed_symbol = new_cons;
    }
    else
	gensymed_symbol = Nil;
    if ( !TRUEP(gensymed_symbol))
	gensymed_symbol = replenish_gensym_cons_pool();
    length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(string_1));
    if (FIXNUM_LT(FIX(UBYTE_16_ISAREF_1(string_1,length_1 - (SI_Long)2L) + 
	    ((UBYTE_16_ISAREF_1(string_1,length_1 - (SI_Long)1L) & 
	    (SI_Long)8191L) << (SI_Long)16L)),
	    Use_full_size_of_with_output_wide_string_cutoff)) {
	short_string = copy_text_string(string_1);
	reclaim_text_string(string_1);
	temp = short_string;
    }
    else
	temp = string_1;
    M_CAR(gensymed_symbol) = temp;
    M_CDR(gensymed_symbol) = Nil;
    inline_note_allocate_cons(gensymed_symbol,Qab_gensym);
    ab_loopvar__2 = gensymed_symbol;
    if (ab_loopvar__1)
	M_CDR(ab_loopvar__1) = ab_loopvar__2;
    else
	ab_loopvar_ = ab_loopvar__2;
    ab_loopvar__1 = ab_loopvar__2;
    goto next_loop;
  end_loop:
    temp_1 = ab_loopvar_;
    goto end_1;
    temp_1 = Qnil;
  end_1:;
    reclaim_gensym_list_1(gensym_list_of_wide_strings);
    title_text = temp_1;
    if ( !SYMBOLP(type_or_types))
	reclaim_gensym_list_1(type_or_types);
    if (New_g2_classic_ui_p) {
	if (Noting_changes_to_kb_p)
	    note_change_to_block_1(workspace,Qtitle_bar_caption_text);
	set_lookup_slot_value_1(workspace,Qtitle_bar_caption_text,title_text);
	if (Noting_changes_to_kb_p)
	    note_change_to_block_1(workspace,
		    Qstretch_new_image_planes_for_caption_p);
	set_lookup_slot_value_1(workspace,
		Qstretch_new_image_planes_for_caption_p,T);
	return VALUES_1(FIX((SI_Long)0L));
    }
    else {
	block = make_description_box_with_text(title_text);
	gensymed_symbol = ISVREF(workspace,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)0L) : FIX((SI_Long)0L);
	gensymed_symbol_1 = IFIX(gensymed_symbol);
	gensymed_symbol_2 = IFIX(ISVREF(workspace,(SI_Long)17L));
	add_to_workspace(4,block,workspace,FIX(gensymed_symbol_1 + 
		gensymed_symbol_2),FIX((SI_Long)0L));
	gensymed_symbol = ISVREF(block,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)3L) : FIX((SI_Long)0L);
	gensymed_symbol_1 = IFIX(gensymed_symbol);
	gensymed_symbol = ISVREF(block,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)1L) : FIX((SI_Long)0L);
	gensymed_symbol_2 = IFIX(gensymed_symbol);
	gensymed_symbol_1 = gensymed_symbol_1 - gensymed_symbol_2;
	gensymed_symbol_2 = (SI_Long)15L;
	return VALUES_1(FIX(gensymed_symbol_1 + gensymed_symbol_2));
    }
}

/* PARAMETERS-FOR-TOKEN-IF-ANY */
Object parameters_for_token_if_any(token,call_p)
    Object token, call_p;
{
    Object list_1, object, temp, all_signatures, all_the_same_type, types_seen;
    Object o, ab_loop_list_, signature, type, temp_1;
    Object result;

    x_note_fn_call(126,262);
    list_1 = INLINE_SYMBOL_PLIST(token);
  next_loop:
    if ( !TRUEP(list_1) || EQ(M_CAR(list_1),
	    Current_kb_specific_property_list_property_name))
	goto end_loop;
    list_1 = M_CDR(M_CDR(list_1));
    goto next_loop;
  end_loop:
    list_1 = list_1 ? M_CAR(M_CDR(list_1)) : Nil;
  next_loop_1:
    if ( !TRUEP(list_1) || EQ(M_CAR(list_1),
	    Frame_or_frames_with_this_name_kbprop))
	goto end_loop_1;
    list_1 = M_CDR(M_CDR(list_1));
    goto next_loop_1;
  end_loop_1:
    object = list_1 ? M_CAR(M_CDR(list_1)) : Nil;
    if ( !TRUEP(object)) {
	if ( !TRUEP(call_p)) {
	    temp = assemble_parameters_for_built_in_function(token);
	    return VALUES_2(temp,Qfunction);
	}
	else
	    return VALUES_1(Nil);
    }
    else if (ATOM(object))
	return parameters_for_token_if_any1(object,token);
    else {
	all_signatures = Nil;
	all_the_same_type = Nil;
	types_seen = Nil;
	o = Nil;
	ab_loop_list_ = object;
      next_loop_2:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop_2;
	o = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	result = parameters_for_token_if_any1(o,token);
	MVS_2(result,signature,type);
	all_signatures = nconc2(all_signatures,signature);
	if ( !( !TRUEP(type) || memq_function(type,types_seen)))
	    types_seen = nconc2(types_seen,gensym_cons_1(type,Nil));
	goto next_loop_2;
      end_loop_2:
	if (types_seen &&  !TRUEP(CDR(types_seen))) {
	    all_the_same_type = FIRST(types_seen);
	    reclaim_gensym_list_1(types_seen);
	}
	temp_1 = all_signatures;
	temp = all_the_same_type;
	if (temp);
	else
	    temp = types_seen;
	return VALUES_2(temp_1,temp);
	return VALUES_1(Qnil);
    }
}

static Object Qab_method;          /* method */

static Object Qprocedure;          /* procedure */

/* PARAMETERS-FOR-TOKEN-IF-ANY1 */
Object parameters_for_token_if_any1(object,token)
    Object object, token;
{
    Object gensymed_symbol, sub_class_bit_vector, temp_1;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    char temp;

    x_note_fn_call(126,263);
    gensymed_symbol = ISVREF(object,(SI_Long)1L);
    sub_class_bit_vector = ISVREF(gensymed_symbol,(SI_Long)19L);
    superior_class_bit_number = 
	    IFIX(ISVREF(Method_declaration_class_description,(SI_Long)18L));
    sub_class_vector_index = superior_class_bit_number >>  -  - (SI_Long)3L;
    if (sub_class_vector_index < 
	    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		sub_class_vector_index);
	gensymed_symbol_2 = (SI_Long)1L;
	gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
	gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
	gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
	temp = (SI_Long)0L < gensymed_symbol_1;
    }
    else
	temp = TRUEP(Nil);
    if (temp) {
	temp_1 = assemble_parameters_for_method(token);
	return VALUES_2(temp_1,Qab_method);
    }
    else {
	sub_class_bit_vector = ISVREF(gensymed_symbol,(SI_Long)19L);
	superior_class_bit_number = 
		IFIX(ISVREF(Procedure_class_description,(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_2 = (SI_Long)1L;
	    gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
	    gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
	    temp = (SI_Long)0L < gensymed_symbol_1;
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    temp_1 = assemble_parameters_for_procedure(object);
	    return VALUES_2(temp_1,Qprocedure);
	}
	else {
	    sub_class_bit_vector = ISVREF(gensymed_symbol,(SI_Long)19L);
	    superior_class_bit_number = 
		    IFIX(ISVREF(Remote_procedure_declaration_class_description,
		    (SI_Long)18L));
	    sub_class_vector_index = superior_class_bit_number >>  -  - 
		    (SI_Long)3L;
	    if (sub_class_vector_index < 
		    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
		gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
			sub_class_vector_index);
		gensymed_symbol_2 = (SI_Long)1L;
		gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
		gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
		gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
		temp = (SI_Long)0L < gensymed_symbol_1;
	    }
	    else
		temp = TRUEP(Nil);
	    if (temp) {
		temp_1 = 
			assemble_parameters_for_remote_procedure_declaration(object);
		return VALUES_2(temp_1,Qprocedure);
	    }
	    else {
		sub_class_bit_vector = ISVREF(gensymed_symbol,(SI_Long)19L);
		superior_class_bit_number = 
			IFIX(ISVREF(Function_definition_class_description,
			(SI_Long)18L));
		sub_class_vector_index = superior_class_bit_number >>  -  
			- (SI_Long)3L;
		if (sub_class_vector_index < 
			IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
			    {
		    gensymed_symbol_1 = 
			    UBYTE_8_ISAREF_1(sub_class_bit_vector,
			    sub_class_vector_index);
		    gensymed_symbol_2 = (SI_Long)1L;
		    gensymed_symbol_3 = superior_class_bit_number & 
			    (SI_Long)7L;
		    gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
		    gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
		    temp = (SI_Long)0L < gensymed_symbol_1;
		}
		else
		    temp = TRUEP(Nil);
		if (temp) {
		    temp_1 = assemble_parameters_for_function(object);
		    return VALUES_2(temp_1,Qfunction);
		}
		else {
		    sub_class_bit_vector = ISVREF(gensymed_symbol,
			    (SI_Long)19L);
		    superior_class_bit_number = 
			    IFIX(ISVREF(Tabular_function_of_1_arg_class_description,
			    (SI_Long)18L));
		    sub_class_vector_index = superior_class_bit_number >>  
			    -  - (SI_Long)3L;
		    if (sub_class_vector_index < 
			    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				{
			gensymed_symbol_1 = 
				UBYTE_8_ISAREF_1(sub_class_bit_vector,
				sub_class_vector_index);
			gensymed_symbol_2 = (SI_Long)1L;
			gensymed_symbol_3 = superior_class_bit_number & 
				(SI_Long)7L;
			gensymed_symbol_2 = gensymed_symbol_2 << 
				gensymed_symbol_3;
			gensymed_symbol_1 = gensymed_symbol_1 & 
				gensymed_symbol_2;
			temp = (SI_Long)0L < gensymed_symbol_1;
		    }
		    else
			temp = TRUEP(Nil);
		    if (temp) {
			temp_1 = 
				assemble_parameters_for_tabular_function_of_1_arg(object);
			return VALUES_2(temp_1,Qfunction);
		    }
		    else {
			sub_class_bit_vector = ISVREF(gensymed_symbol,
				(SI_Long)19L);
			superior_class_bit_number = 
				IFIX(ISVREF(Foreign_function_declaration_class_description,
				(SI_Long)18L));
			sub_class_vector_index = superior_class_bit_number 
				>>  -  - (SI_Long)3L;
			if (sub_class_vector_index < 
				IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
				    {
			    gensymed_symbol_1 = 
				    UBYTE_8_ISAREF_1(sub_class_bit_vector,
				    sub_class_vector_index);
			    gensymed_symbol_2 = (SI_Long)1L;
			    gensymed_symbol_3 = superior_class_bit_number 
				    & (SI_Long)7L;
			    gensymed_symbol_2 = gensymed_symbol_2 << 
				    gensymed_symbol_3;
			    gensymed_symbol_1 = gensymed_symbol_1 & 
				    gensymed_symbol_2;
			    temp = (SI_Long)0L < gensymed_symbol_1;
			}
			else
			    temp = TRUEP(Nil);
			if (temp) {
			    temp_1 = 
				    assemble_parameters_for_foreign_function_declaration(object);
			    return VALUES_2(temp_1,Qfunction);
			}
			else
			    return VALUES_1(Qnil);
		    }
		}
	    }
	}
    }
}

/* ASSEMBLE-PARAMETERS-FOR-PROCEDURE */
Object assemble_parameters_for_procedure(procedure)
    Object procedure;
{
    Object parameters_qm, name, type, ab_loopvar_, ab_loopvar__1;
    Object ab_loopvar__2, parameter_data_qm, data, return_data_qm, temp;
    SI_Long i, ab_loop_bind_, gensymed_symbol;

    x_note_fn_call(126,264);
    if ( !TRUEP(invisible_proprietary_procedure(procedure))) {
	parameters_qm = argument_list_description_function(procedure);
	i = (SI_Long)0L;
	ab_loop_bind_ = parameters_qm ? IFIX(ISVREF(parameters_qm,
		(SI_Long)1L)) : (SI_Long)0L;
	name = Nil;
	type = Nil;
	ab_loopvar_ = Nil;
	ab_loopvar__1 = Nil;
	ab_loopvar__2 = Nil;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	name = FIXNUM_LE(ISVREF(parameters_qm,(SI_Long)1L),
		Maximum_in_place_array_size) ? ISVREF(parameters_qm,i + 
		IFIX(Managed_array_index_offset)) : 
		ISVREF(ISVREF(parameters_qm,(i >>  -  - (SI_Long)10L) + 
		(SI_Long)2L),i & (SI_Long)1023L);
	gensymed_symbol = i + (SI_Long)1L;
	type = decode_procedure_type_field(FIXNUM_LE(ISVREF(parameters_qm,
		(SI_Long)1L),Maximum_in_place_array_size) ? 
		ISVREF(parameters_qm,gensymed_symbol + 
		IFIX(Managed_array_index_offset)) : 
		ISVREF(ISVREF(parameters_qm,(gensymed_symbol >>  -  - 
		(SI_Long)10L) + (SI_Long)2L),gensymed_symbol & 
		(SI_Long)1023L));
	ab_loopvar__2 = gensym_cons_1(gensym_cons_1(name,type),Nil);
	if (ab_loopvar__1)
	    M_CDR(ab_loopvar__1) = ab_loopvar__2;
	else
	    ab_loopvar_ = ab_loopvar__2;
	ab_loopvar__1 = ab_loopvar__2;
	i = i + (SI_Long)2L;
	goto next_loop;
      end_loop:
	parameter_data_qm = ab_loopvar_;
	goto end_1;
	parameter_data_qm = Qnil;
      end_1:;
	if (returned_values_description_function(procedure)) {
	    data = returned_values_description_function(procedure);
	    i = (SI_Long)0L;
	    ab_loop_bind_ = IFIX(ISVREF(data,(SI_Long)1L));
	    type = Nil;
	    ab_loopvar_ = Nil;
	    ab_loopvar__1 = Nil;
	    ab_loopvar__2 = Nil;
	  next_loop_1:
	    if (i >= ab_loop_bind_)
		goto end_loop_1;
	    gensymed_symbol = i + (SI_Long)1L;
	    type = decode_procedure_type_field(FIXNUM_LE(ISVREF(data,
		    (SI_Long)1L),Maximum_in_place_array_size) ? 
		    ISVREF(data,gensymed_symbol + 
		    IFIX(Managed_array_index_offset)) : ISVREF(ISVREF(data,
		    (gensymed_symbol >>  -  - (SI_Long)10L) + (SI_Long)2L),
		    gensymed_symbol & (SI_Long)1023L));
	    ab_loopvar__2 = gensym_cons_1(type,Nil);
	    if (ab_loopvar__1)
		M_CDR(ab_loopvar__1) = ab_loopvar__2;
	    else
		ab_loopvar_ = ab_loopvar__2;
	    ab_loopvar__1 = ab_loopvar__2;
	    i = i + (SI_Long)2L;
	    goto next_loop_1;
	  end_loop_1:
	    return_data_qm = ab_loopvar_;
	    goto end_2;
	    return_data_qm = Qnil;
	  end_2:;
	}
	else
	    return_data_qm = Nil;
	if (parameter_data_qm && return_data_qm)
	    temp = nconc2(parameter_data_qm,gensym_cons_1(Kreturn,
		    return_data_qm));
	else if (return_data_qm)
	    temp = gensym_cons_1(Kreturn,return_data_qm);
	else if (parameter_data_qm)
	    temp = parameter_data_qm;
	else
	    temp = Nil;
	return gensym_cons_1(temp,Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Kgeneral_description;  /* :general-description */

static Object Qab_class;           /* class */

static Object Ksequence;           /* :sequence */

static Object Qab_structure;       /* structure */

static Object Kstructure;          /* :structure */

static Object Qitem_or_datum;      /* item-or-datum */

static Object Qitem_or_value;      /* item-or-value */

/* DECODE-PROCEDURE-TYPE-FIELD */
Object decode_procedure_type_field(type_field)
    Object type_field;
{
    Object type, pruned_type;

    x_note_fn_call(126,265);
    type = CONSP(type_field) && EQ(CAR(type_field),Kgeneral_description) ? 
	    getfq_function_no_default(CDR(type_field),Ktype) : type_field;
    if (type) {
	if (CONSP(type)) {
	    if (EQ(CAR(type),Qab_class))
		pruned_type = copy_list_using_gensym_conses_1(type);
	    else if (EQ(CAR(type),Qsequence))
		pruned_type = Ksequence;
	    else if (EQ(CAR(type),Qab_structure))
		pruned_type = Kstructure;
	    else
		pruned_type = Qnil;
	}
	else if (EQ(type,Qitem_or_datum))
	    pruned_type = Qitem_or_value;
	else
	    pruned_type = type;
    }
    else
	pruned_type = Nil;
    return VALUES_1(pruned_type);
}

/* ASSEMBLE-PARAMETERS-FOR-METHOD */
Object assemble_parameters_for_method(method_name)
    Object method_name;
{
    Object scope_conses, ab_loopvar_, ab_loopvar__1, method, ab_loopvar__2;
    Object ab_loopvar__3, ab_loopvar__4;
    char temp;
    Declare_special(1);
    Object result;

    x_note_fn_call(126,266);
    scope_conses = Scope_conses;
    ab_loopvar_ = Nil;
    ab_loopvar__1 = Nil;
    method = Nil;
    PUSH_SPECIAL(Scope_conses,scope_conses,0);
      ab_loopvar__2 = Nil;
      ab_loopvar__3 = Nil;
      ab_loopvar__4 = Nil;
      ab_loopvar_ = collect_subclasses(Qab_method);
    next_loop:
      if ( !TRUEP(ab_loopvar__1)) {
	next_loop_1:
	  if ( !TRUEP(ab_loopvar_))
	      goto end_loop;
	  ab_loopvar__1 = 
		  lookup_kb_specific_property_value(M_CAR(ab_loopvar_),
		  Instances_specific_to_this_class_kbprop);
	  ab_loopvar_ = M_CDR(ab_loopvar_);
	  if (ab_loopvar__1)
	      goto end_loop;
	  goto next_loop_1;
	end_loop:
	  temp =  !TRUEP(ab_loopvar__1);
      }
      else
	  temp = TRUEP(Nil);
      if (temp)
	  goto end_loop_1;
      method = ab_loopvar__1;
      ab_loopvar__1 = ISVREF(ab_loopvar__1,(SI_Long)6L);
      if (EQ(method_name,procedure_method_name_function(method))) {
	  ab_loopvar__4 = assemble_parameters_for_procedure(method);
	  if (ab_loopvar__4) {
	      if (ab_loopvar__3)
		  M_CDR(ab_loopvar__3) = ab_loopvar__4;
	      else
		  ab_loopvar__2 = ab_loopvar__4;
	      ab_loopvar__3 = last(ab_loopvar__4,_);
	  }
      }
      goto next_loop;
    end_loop_1:
      result = VALUES_1(ab_loopvar__2);
      goto end_1;
      result = VALUES_1(Qnil);
    end_1:;
    POP_SPECIAL();
    return result;
}

/* ASSEMBLE-PARAMETERS-FOR-FUNCTION */
Object assemble_parameters_for_function(function)
    Object function;
{
    Object temp;

    x_note_fn_call(126,267);
    temp = ISVREF(function,(SI_Long)16L);
    temp = CAR(temp);
    return gensym_cons_1(copy_list_using_gensym_conses_1(SECOND(temp)),Nil);
}

/* ASSEMBLE-PARAMETERS-FOR-BUILT-IN-FUNCTION */
Object assemble_parameters_for_built_in_function(name)
    Object name;
{
    Object names_or_list_of_names, temp, name_list, ab_loop_list_, firstp;
    Object ab_loopvar_, ab_loopvar__1, ab_loopvar__2, ab_loop_iter_flag_;
    Object ab_loop_list__1, ab_loopvar__3, ab_loopvar__4;

    x_note_fn_call(126,268);
    names_or_list_of_names = get_built_in_function_argument_names(name);
    temp = CAR(names_or_list_of_names);
    if (LISTP(temp)) {
	name_list = Nil;
	ab_loop_list_ = names_or_list_of_names;
	firstp = T;
	ab_loopvar_ = Nil;
	ab_loopvar__1 = Nil;
	ab_loopvar__2 = Nil;
	ab_loop_iter_flag_ = T;
      next_loop:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	name_list = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	if ( !TRUEP(ab_loop_iter_flag_))
	    firstp = Nil;
	name = Nil;
	ab_loop_list__1 = name_list;
	ab_loopvar__2 = Nil;
	ab_loopvar__3 = Nil;
	ab_loopvar__4 = Nil;
      next_loop_1:
	if ( !TRUEP(ab_loop_list__1))
	    goto end_loop_1;
	name = M_CAR(ab_loop_list__1);
	ab_loop_list__1 = M_CDR(ab_loop_list__1);
	ab_loopvar__4 = gensym_cons_1(name,Nil);
	if (ab_loopvar__3)
	    M_CDR(ab_loopvar__3) = ab_loopvar__4;
	else
	    ab_loopvar__2 = ab_loopvar__4;
	ab_loopvar__3 = ab_loopvar__4;
	goto next_loop_1;
      end_loop_1:
	temp = ab_loopvar__2;
	goto end_1;
	temp = Qnil;
      end_1:;
	ab_loopvar__2 = gensym_cons_1(temp,Nil);
	if (ab_loopvar__1)
	    M_CDR(ab_loopvar__1) = ab_loopvar__2;
	else
	    ab_loopvar_ = ab_loopvar__2;
	ab_loopvar__1 = ab_loopvar__2;
	ab_loop_iter_flag_ = Nil;
	goto next_loop;
      end_loop:
	return VALUES_1(ab_loopvar_);
	return VALUES_1(Qnil);
    }
    else {
	name = Nil;
	ab_loop_list_ = names_or_list_of_names;
	ab_loopvar_ = Nil;
	ab_loopvar__1 = Nil;
	ab_loopvar__2 = Nil;
      next_loop_2:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop_2;
	name = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	ab_loopvar__2 = gensym_cons_1(name,Nil);
	if (ab_loopvar__1)
	    M_CDR(ab_loopvar__1) = ab_loopvar__2;
	else
	    ab_loopvar_ = ab_loopvar__2;
	ab_loopvar__1 = ab_loopvar__2;
	goto next_loop_2;
      end_loop_2:
	temp = ab_loopvar_;
	goto end_2;
	temp = Qnil;
      end_2:;
	return gensym_cons_1(temp,Nil);
    }
}

static Object Qx;                  /* x */

/* ASSEMBLE-PARAMETERS-FOR-TABULAR-FUNCTION-OF-1-ARG */
Object assemble_parameters_for_tabular_function_of_1_arg(function)
    Object function;
{
    x_note_fn_call(126,269);
    return gensym_cons_1(gensym_cons_1(Qx,Nil),Nil);
}

static Object Qremote_procedure_argument_description;  /* remote-procedure-argument-description */

/* ASSEMBLE-PARAMETERS-FOR-REMOTE-PROCEDURE-DECLARATION */
Object assemble_parameters_for_remote_procedure_declaration(rpd)
    Object rpd;
{
    Object temp, translation_qm, description_qm;

    x_note_fn_call(126,270);
    temp = ISVREF(rpd,(SI_Long)16L);
    translation_qm = CAR(temp);
    description_qm = get_slot_value_function(rpd,
	    Qremote_procedure_argument_description,Nil);
    if (translation_qm && SECOND(translation_qm) && description_qm) {
	temp = make_parameters_from_rpd_arg_description(description_qm);
	return gensym_cons_1(temp,Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Kall_remaining;      /* :all-remaining */

static Object string_constant_15;  /* "ARG-~d-AND-ALL-REMAINING" */

static Object string_constant_16;  /* "ARG-~d" */

/* MAKE-PARAMETERS-FROM-RPD-ARG-DESCRIPTION */
Object make_parameters_from_rpd_arg_description(description)
    Object description;
{
    Object type_description, plist, user_type, arglist_element, ab_loopvar_;
    Object ab_loopvar__1, ab_loopvar__2, ab_loop_iter_flag_, temp;
    SI_Long i, ab_loop_bind_, j;

    x_note_fn_call(126,271);
    i = (SI_Long)1L;
    ab_loop_bind_ = IFIX(ISVREF(description,(SI_Long)1L));
    j = (SI_Long)0L;
    type_description = Nil;
    plist = Nil;
    user_type = Nil;
    arglist_element = Nil;
    ab_loopvar_ = Nil;
    ab_loopvar__1 = Nil;
    ab_loopvar__2 = Nil;
    ab_loop_iter_flag_ = T;
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    if ( !TRUEP(ab_loop_iter_flag_))
	j = j + (SI_Long)1L;
    type_description = FIXNUM_LE(ISVREF(description,(SI_Long)1L),
	    Maximum_in_place_array_size) ? ISVREF(description,i + 
	    IFIX(Managed_array_index_offset)) : ISVREF(ISVREF(description,
	    (i >>  -  - (SI_Long)10L) + (SI_Long)2L),i & (SI_Long)1023L);
    plist = CONSP(type_description) && EQ(CAR(type_description),
	    Kgeneral_description) ? CDR(type_description) : Nil;
    user_type = decode_procedure_type_field(type_description);
    temp = intern_text_string(1,tformat_text_string(2,getf(plist,
	    Kall_remaining,_) ? string_constant_15 : string_constant_16,
	    FIX(j)));
    arglist_element = gensym_cons_1(temp,user_type);
    ab_loopvar__2 = gensym_cons_1(arglist_element,Nil);
    if (ab_loopvar__1)
	M_CDR(ab_loopvar__1) = ab_loopvar__2;
    else
	ab_loopvar_ = ab_loopvar__2;
    ab_loopvar__1 = ab_loopvar__2;
    ab_loop_iter_flag_ = Nil;
    i = i + (SI_Long)2L;
    goto next_loop;
  end_loop:
    return VALUES_1(ab_loopvar_);
    return VALUES_1(Qnil);
}

/* ASSEMBLE-PARAMETERS-FOR-FOREIGN-FUNCTION-DECLARATION */
Object assemble_parameters_for_foreign_function_declaration(ffd)
    Object ffd;
{
    Object temp, translation;

    x_note_fn_call(126,272);
    temp = ISVREF(ffd,(SI_Long)16L);
    translation = CAR(temp);
    return gensym_cons_1(nconc2(copy_list_using_gensym_conses_1(SIXTH(translation)),
	    gensym_list_2(Kreturn,THIRD(translation))),Nil);
}

Object Disable_parameter_strings_for_internal_proprietary_procedures = UNBOUND;

/* INVISIBLE-PROPRIETARY-PROCEDURE */
Object invisible_proprietary_procedure(procedure)
    Object procedure;
{
    Object name_string;

    x_note_fn_call(126,273);
    if (Disable_parameter_strings_for_internal_proprietary_procedures && 
	    in_order_p(procedure)) {
	name_string = stringw(get_primary_name_for_frame_if_any(procedure));
	if ((SI_Long)0L < IFIX(lengthw(name_string)))
	    return VALUES_1((SI_Long)95L == UBYTE_16_ISAREF_1(name_string,
		    (SI_Long)0L) ? T : Nil);
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* CLOSE-SIGNATURE-WINDOW-IF-APPROPRIATE */
Object close_signature_window_if_appropriate()
{
    Object pending_procedure_signature_workspaces, accumulated_closes, token;
    Object token_before_that, ab_loop_list_, temp, entry_qm;

    x_note_fn_call(126,274);
    if (Close_pending_procedure_signature_workspaces_on_close) {
	pending_procedure_signature_workspaces = ISVREF(Current_edit_state,
		(SI_Long)91L);
	if (pending_procedure_signature_workspaces) {
	    accumulated_closes = FIX((SI_Long)0L);
	    token = Nil;
	    token_before_that = Nil;
	    ab_loop_list_ = ISVREF(Current_edit_state,(SI_Long)54L);
	  next_loop:
	    if ( !TRUEP(ab_loop_list_))
		goto end_loop;
	    token = CAR(ab_loop_list_);
	    temp = CDR(ab_loop_list_);
	    token_before_that = CAR(temp);
	    ab_loop_list_ = M_CDR(ab_loop_list_);
	    if (EQ(token,Close_paren_token))
		accumulated_closes = FIXNUM_ADD1(accumulated_closes);
	    if (EQ(token,Open_paren_token)) {
		if (IFIX(accumulated_closes) == (SI_Long)0L) {
		    entry_qm = assq_function(token_before_that,
			    pending_procedure_signature_workspaces);
		    if (entry_qm)
			remove_record_of_procedure_signature_workspace(token_before_that);
		    return VALUES_1(Nil);
		}
		else
		    accumulated_closes = FIXNUM_SUB1(accumulated_closes);
	    }
	    goto next_loop;
	  end_loop:
	    return VALUES_1(Qnil);
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* REMOVE-ANY-OTHER-VISIBLE-SIGNATURES */
Object remove_any_other_visible_signatures(relevant_token)
    Object relevant_token;
{
    Object table, token, rest_1, ab_loop_list_, ab_loopvar_, ab_loopvar__1;
    Object ab_loopvar__2, ab_loop_desetq_, other_entry_tokens;

    x_note_fn_call(126,275);
    table = ISVREF(Current_edit_state,(SI_Long)91L);
    if (CDR(table)) {
	token = Nil;
	rest_1 = Nil;
	ab_loop_list_ = table;
	ab_loopvar_ = Nil;
	ab_loopvar__1 = Nil;
	ab_loopvar__2 = Nil;
	ab_loop_desetq_ = Nil;
      next_loop:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	ab_loop_desetq_ = M_CAR(ab_loop_list_);
	token = CAR(ab_loop_desetq_);
	rest_1 = CDR(ab_loop_desetq_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	if ( !EQ(token,relevant_token)) {
	    ab_loopvar__2 = gensym_cons_1(token,Nil);
	    if (ab_loopvar__1)
		M_CDR(ab_loopvar__1) = ab_loopvar__2;
	    else
		ab_loopvar_ = ab_loopvar__2;
	    ab_loopvar__1 = ab_loopvar__2;
	}
	goto next_loop;
      end_loop:
	other_entry_tokens = ab_loopvar_;
	goto end_1;
	other_entry_tokens = Qnil;
      end_1:;
	token = Nil;
	ab_loop_list_ = other_entry_tokens;
      next_loop_1:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop_1;
	token = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	remove_record_of_procedure_signature_workspace(token);
	goto next_loop_1;
      end_loop_1:;
	return reclaim_gensym_list_1(other_entry_tokens);
    }
    else
	return VALUES_1(Nil);
}

/* MAKE-PROCEDURE-SIGNATURE-WORKSPACE-ENTRY */
Object make_procedure_signature_workspace_entry(token,workspace)
    Object token, workspace;
{
    Object temp;

    x_note_fn_call(126,276);
    temp = gensym_list_3(token,workspace,
	    copy_frame_serial_number(ISVREF(workspace,(SI_Long)3L)));
    return VALUES_1(temp);
}

/* RECLAIM-PROCEDURE-SIGNATURE-WORKSPACE-ENTRY */
Object reclaim_procedure_signature_workspace_entry(entry)
    Object entry;
{
    Object gensymed_symbol, x, y, xa, ya;
    char temp;

    x_note_fn_call(126,277);
    gensymed_symbol = ISVREF(SECOND(entry),(SI_Long)3L);
    x = SECOND(entry);
    temp = SIMPLE_VECTOR_P(x) ? EQ(ISVREF(x,(SI_Long)1L),
	    Qavailable_frame_vector) : TRUEP(Qnil);
    if (temp);
    else
	temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		(SI_Long)-1L : TRUEP(Nil);
    if (temp);
    else {
	x = gensymed_symbol;
	y = THIRD(entry);
	if (FIXNUMP(y))
	    temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
	else if (FIXNUMP(x))
	    temp = TRUEP(Nil);
	else {
	    xa = M_CAR(y);
	    ya = M_CAR(x);
	    temp = FIXNUM_LT(xa,ya);
	    if (temp);
	    else
		temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),M_CDR(x)) : 
			TRUEP(Qnil);
	}
    }
    if ( !temp)
	delete_frame(SECOND(entry));
    reclaim_frame_serial_number(THIRD(entry));
    reclaim_gensym_list_1(entry);
    return VALUES_1(Nil);
}

/* RECORD-PROCEDURE-SIGNATURE-WORKSPACE */
Object record_procedure_signature_workspace(token,workspace)
    Object token, workspace;
{
    Object svref_arg_1, gensym_push_modify_macro_arg, car_1, cdr_1;
    Object svref_new_value;

    x_note_fn_call(126,278);
    svref_arg_1 = Current_edit_state;
    gensym_push_modify_macro_arg = 
	    make_procedure_signature_workspace_entry(token,workspace);
    car_1 = gensym_push_modify_macro_arg;
    cdr_1 = ISVREF(svref_arg_1,(SI_Long)91L);
    svref_new_value = gensym_cons_1(car_1,cdr_1);
    return VALUES_1(SVREF(svref_arg_1,FIX((SI_Long)91L)) = svref_new_value);
}

/* REMOVE-RECORD-OF-PROCEDURE-SIGNATURE-WORKSPACE */
Object remove_record_of_procedure_signature_workspace(token)
    Object token;
{
    Object pending_procedure_signature_workspaces, entry, svref_arg_1;
    Object svref_new_value;

    x_note_fn_call(126,279);
    pending_procedure_signature_workspaces = ISVREF(Current_edit_state,
	    (SI_Long)91L);
    entry = assq_function(token,pending_procedure_signature_workspaces);
    if (entry) {
	svref_arg_1 = Current_edit_state;
	svref_new_value = delete_gensym_element_1(entry,
		pending_procedure_signature_workspaces);
	SVREF(svref_arg_1,FIX((SI_Long)91L)) = svref_new_value;
	return reclaim_procedure_signature_workspace_entry(entry);
    }
    else
	return VALUES_1(Nil);
}

/* RECLAIM-PENDING-PROCEDURE-SIGNATURE-WORKSPACES */
Object reclaim_pending_procedure_signature_workspaces(pending_procedure_signature_workspaces)
    Object pending_procedure_signature_workspaces;
{
    Object entry, ab_loop_list_;

    x_note_fn_call(126,280);
    entry = Nil;
    ab_loop_list_ = pending_procedure_signature_workspaces;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    entry = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    reclaim_procedure_signature_workspace_entry(entry);
    goto next_loop;
  end_loop:;
    return reclaim_gensym_list_1(pending_procedure_signature_workspaces);
}

/* RUNTIME-RECLAIM-PENDING-PROCEDURE-SIGNATURE-WORKSPACES */
Object runtime_reclaim_pending_procedure_signature_workspaces()
{
    Object svref_arg_1;

    x_note_fn_call(126,281);
    if (ISVREF(Current_edit_state,(SI_Long)91L)) {
	reclaim_pending_procedure_signature_workspaces(ISVREF(Current_edit_state,
		(SI_Long)91L));
	svref_arg_1 = Current_edit_state;
	return VALUES_1(SVREF(svref_arg_1,FIX((SI_Long)91L)) = Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qsearch_forward_incrementally_for_text_in_editor;  /* search-forward-incrementally-for-text-in-editor */

/* COM-SEARCH-FOR-TEXT-IN-EDITOR */
Object com_search_for_text_in_editor(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, svref_arg_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,282);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if ( !TRUEP(edit_state_for_search_p(Current_edit_state)))
		  create_search_workspace(Qsearch_forward_incrementally_for_text_in_editor);
	      else {
		  svref_arg_1 = Current_edit_state;
		  SVREF(svref_arg_1,FIX((SI_Long)23L)) = 
			  Qsearch_forward_incrementally_for_text_in_editor;
		  find_next_instance_of_search_string(0);
	      }
	      editor_post_command_hook(Qsearch_for_text_in_editor,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* SEARCH-FOR-TEXT-IN-EDITOR-COMMAND-PURSUER */
Object search_for_text_in_editor_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,283);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* SEARCH-FOR-TEXT-IN-EDITOR-COMMAND-TRANSLATOR */
Object search_for_text_in_editor_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,284);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qsearch_for_text_in_editor,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qreturn_from_search_in_editor;  /* return-from-search-in-editor */

static Object string_constant_17;  /* "Search: " */

static Object Qsmall_borderless_free_text_format;  /* small-borderless-free-text-format */

/* CREATE-SEARCH-WORKSPACE */
Object create_search_workspace(search_function)
    Object search_function;
{
    Object svref_arg_1, left, top, right, bottom, temp, current_edit_state;
    Object current_edit_workspace, ip, caption_text_box, temp_1;
    Object gensymed_symbol;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    Declare_special(2);
    Object result;

    x_note_fn_call(126,285);
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)87L)) = Nil;
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)88L)) = Nil;
    result = compute_edit_search_box_location(Current_edit_state);
    MVS_4(result,left,top,right,bottom);
    establish_next_workstation_context_continuation(Qreturn_from_search_in_editor,
	    Nil,Nil,Nil);
    temp = find_image_plane_for_workspace_in_pane(Current_edit_workspace,
	    Current_workstation_detail_pane);
    enter_editing_context(18,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,temp,
	    ISVREF(Current_edit_state,(SI_Long)13L),left,top,right,bottom,
	    Nil,Qsearch_for_text_in_editor,search_function,T);
    current_edit_state = Specific_structure_for_current_workstation_context;
    PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
      current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
      PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	ip = ISVREF(Current_edit_state,(SI_Long)16L);
	SVREF(ip,FIX((SI_Long)3L)) = Nil;
	SVREF(ip,FIX((SI_Long)4L)) = Nil;
	caption_text_box = make_free_text_box(3,tformat_text_string(1,
		string_constant_17),Nil,Qsmall_borderless_free_text_format);
	temp_1 = ISVREF(Current_edit_state,(SI_Long)12L);
	gensymed_symbol = ISVREF(ISVREF(Current_edit_state,(SI_Long)13L),
		(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)0L) : FIX((SI_Long)0L);
	gensymed_symbol_1 = IFIX(gensymed_symbol);
	gensymed_symbol_2 = (SI_Long)4L;
	temp = FIX(gensymed_symbol_1 - gensymed_symbol_2);
	gensymed_symbol = ISVREF(ISVREF(Current_edit_state,(SI_Long)13L),
		(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)1L) : FIX((SI_Long)0L);
	gensymed_symbol_1 = IFIX(gensymed_symbol);
	gensymed_symbol = ISVREF(caption_text_box,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)3L) : FIX((SI_Long)0L);
	gensymed_symbol_2 = IFIX(gensymed_symbol);
	gensymed_symbol = ISVREF(caption_text_box,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)1L) : FIX((SI_Long)0L);
	gensymed_symbol_3 = IFIX(gensymed_symbol);
	gensymed_symbol_2 = gensymed_symbol_2 - gensymed_symbol_3;
	result = add_to_workspace(5,caption_text_box,temp_1,temp,
		FIX(gensymed_symbol_1 - gensymed_symbol_2),T);
      POP_SPECIAL();
    POP_SPECIAL();
    return result;
}

Object Relative_horizontal_displacement_for_search_workspace = UNBOUND;

Object Relative_vertical_displacement_for_search_workspace = UNBOUND;

/* COMPUTE-EDIT-SEARCH-BOX-LOCATION */
Object compute_edit_search_box_location(current_edit_state)
    Object current_edit_state;
{
    Object edit_box, gensymed_symbol, editor_bottom, editor_left_edge, left;
    Object top, right, bottom;
    Declare_special(1);
    Object result;

    x_note_fn_call(126,286);
    PUSH_SPECIAL(Current_edit_state,current_edit_state,0);
      edit_box = ISVREF(Current_edit_state,(SI_Long)13L);
      gensymed_symbol = ISVREF(edit_box,(SI_Long)14L);
      gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	      (SI_Long)3L) : FIX((SI_Long)0L);
      editor_bottom = gensymed_symbol;
      gensymed_symbol = ISVREF(edit_box,(SI_Long)14L);
      gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	      (SI_Long)0L) : FIX((SI_Long)0L);
      editor_left_edge = gensymed_symbol;
      left = FIXNUM_ADD(editor_left_edge,
	      Relative_horizontal_displacement_for_search_workspace);
      top = FIXNUM_ADD(editor_bottom,
	      Relative_vertical_displacement_for_search_workspace);
      right = left;
      bottom = top;
      result = VALUES_4(left,top,right,bottom);
    POP_SPECIAL();
    return result;
}

/* EDIT-STATE-FOR-SEARCH-P */
Object edit_state_for_search_p(edit_state)
    Object edit_state;
{
    x_note_fn_call(126,287);
    return VALUES_1(EQ(ISVREF(edit_state,(SI_Long)22L),
	    Qsearch_for_text_in_editor) ? T : Nil);
}

static Object Qfind_forward_instance_of_search_string;  /* find-forward-instance-of-search-string */

/* COM-FIND-FORWARD-INSTANCE-OF-SEARCH-STRING */
Object com_find_forward_instance_of_search_string(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, svref_arg_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,288);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (edit_state_for_search_p(Current_edit_state)) {
		  svref_arg_1 = Current_edit_state;
		  SVREF(svref_arg_1,FIX((SI_Long)23L)) = 
			  Qsearch_forward_incrementally_for_text_in_editor;
		  find_next_instance_of_search_string(0);
	      }
	      editor_post_command_hook(Qfind_forward_instance_of_search_string,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* FIND-FORWARD-INSTANCE-OF-SEARCH-STRING-COMMAND-PURSUER */
Object find_forward_instance_of_search_string_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,289);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* FIND-FORWARD-INSTANCE-OF-SEARCH-STRING-COMMAND-TRANSLATOR */
Object find_forward_instance_of_search_string_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,290);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qfind_forward_instance_of_search_string,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qsearch_backward_incrementally_for_text_in_editor;  /* search-backward-incrementally-for-text-in-editor */

static Object Qfind_backward_instance_of_search_string;  /* find-backward-instance-of-search-string */

/* COM-FIND-BACKWARD-INSTANCE-OF-SEARCH-STRING */
Object com_find_backward_instance_of_search_string(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, svref_arg_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,291);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if ( !TRUEP(edit_state_for_search_p(Current_edit_state)))
		  create_search_workspace(Qsearch_backward_incrementally_for_text_in_editor);
	      else {
		  svref_arg_1 = Current_edit_state;
		  SVREF(svref_arg_1,FIX((SI_Long)23L)) = 
			  Qsearch_backward_incrementally_for_text_in_editor;
		  find_next_instance_of_search_string(0);
	      }
	      editor_post_command_hook(Qfind_backward_instance_of_search_string,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* FIND-BACKWARD-INSTANCE-OF-SEARCH-STRING-COMMAND-PURSUER */
Object find_backward_instance_of_search_string_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,292);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* FIND-BACKWARD-INSTANCE-OF-SEARCH-STRING-COMMAND-TRANSLATOR */
Object find_backward_instance_of_search_string_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,293);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qfind_backward_instance_of_search_string,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* RETURN-FROM-SEARCH-IN-EDITOR */
Object return_from_search_in_editor(workstation_context)
    Object workstation_context;
{
    Object region_or_abort_flag_qm, edit_state, current_edit_state;
    Object current_edit_workspace, region, line_index, character_index;
    Declare_special(2);
    Object result;

    x_note_fn_call(126,294);
    region_or_abort_flag_qm = ISVREF(Current_workstation,(SI_Long)33L);
    edit_state = ISVREF(workstation_context,(SI_Long)2L);
    current_edit_state = edit_state;
    PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
      current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
      PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	if (EQ(region_or_abort_flag_qm,Kabort))
	    result = delete_any_text_regions(6,ISVREF(edit_state,
		    (SI_Long)13L),Nil,Nil,Nil,Nil,ISVREF(edit_state,
		    (SI_Long)46L));
	else if (region_or_abort_flag_qm) {
	    region = region_or_abort_flag_qm;
	    line_index = ISVREF(region,(SI_Long)18L);
	    character_index = ISVREF(region,(SI_Long)19L);
	    delete_frame(region);
	    result = change_edit_box(3,Nil,line_index,character_index);
	}
	else
	    result = VALUES_1(Qt);
      POP_SPECIAL();
    POP_SPECIAL();
    return result;
}

static Object Qtext_box;           /* text-box */

static Object Qline;               /* line */

/* SCROLL-LINE-DOWN */
Object scroll_line_down(mouse_pointer)
    Object mouse_pointer;
{
    Object text_box, image_plane, gensymed_symbol, gensymed_symbol_1;
    Object gensymed_symbol_2, gensymed_symbol_3, gensymed_symbol_4;

    x_note_fn_call(126,295);
    text_box = find_frame_of_class_in_mouse_pointer(mouse_pointer,Qtext_box);
    image_plane = image_plane_blackboard_function(mouse_pointer);
    if (text_box && image_plane) {
	if (find_frame_transform_if_any(text_box,image_plane)) {
	    gensymed_symbol = ISVREF(ISVREF(ISVREF(ISVREF(text_box,
		    (SI_Long)1L),(SI_Long)11L),(SI_Long)24L),(SI_Long)1L);
	    gensymed_symbol_1 = text_box;
	    gensymed_symbol_2 = image_plane;
	    gensymed_symbol_3 = Qline;
	    gensymed_symbol_4 = Qdown;
	    return inline_funcall_4(gensymed_symbol,gensymed_symbol_1,
		    gensymed_symbol_2,gensymed_symbol_3,gensymed_symbol_4);
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* SCROLL-LINE-UP */
Object scroll_line_up(mouse_pointer)
    Object mouse_pointer;
{
    Object text_box, image_plane, gensymed_symbol, gensymed_symbol_1;
    Object gensymed_symbol_2, gensymed_symbol_3, gensymed_symbol_4;

    x_note_fn_call(126,296);
    text_box = find_frame_of_class_in_mouse_pointer(mouse_pointer,Qtext_box);
    image_plane = image_plane_blackboard_function(mouse_pointer);
    if (text_box && image_plane) {
	if (find_frame_transform_if_any(text_box,image_plane)) {
	    gensymed_symbol = ISVREF(ISVREF(ISVREF(ISVREF(text_box,
		    (SI_Long)1L),(SI_Long)11L),(SI_Long)24L),(SI_Long)1L);
	    gensymed_symbol_1 = text_box;
	    gensymed_symbol_2 = image_plane;
	    gensymed_symbol_3 = Qline;
	    gensymed_symbol_4 = Qup;
	    return inline_funcall_4(gensymed_symbol,gensymed_symbol_1,
		    gensymed_symbol_2,gensymed_symbol_3,gensymed_symbol_4);
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qcurrent_workstation_context;  /* current-workstation-context */

/* NATIVE-EDITOR-COMMANDS-P */
Object native_editor_commands_p()
{
    Object state_1;

    x_note_fn_call(126,297);
    if (BOUNDP(Qcurrent_workstation_context) && Current_workstation_context) {
	state_1 = ISVREF(Current_workstation_context,(SI_Long)2L);
	if (SIMPLE_VECTOR_P(state_1) && EQ(ISVREF(state_1,(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct) && 
		ISVREF(state_1,(SI_Long)12L))
	    return native_editor_workspace_p(ISVREF(state_1,(SI_Long)12L));
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qpaste_into_editor;  /* paste-into-editor */

/* COM-PASTE-INTO-EDITOR */
Object com_paste_into_editor(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, event_detail_qm;
    Object request_id, text_string, temp_1, svref_arg_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,298);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      event_detail_qm = ISVREF(event,(SI_Long)10L);
	      if (event_detail_qm) {
		  request_id = CAR(event_detail_qm);
		  text_string = CADR(event_detail_qm);
		  temp_1 = 
			  ISVREF(Specific_structure_for_current_workstation_context,
			  (SI_Long)89L);
		  if (EQL(request_id,temp_1)) {
		      svref_arg_1 = Current_edit_state;
		      SVREF(svref_arg_1,FIX((SI_Long)89L)) = Nil;
		      if (text_string_matches_current_scrap_p(text_string))
			  paste_from_current_scrap_if_any();
		      else
			  paste_text_string(1,text_string);
		  }
	      }
	      editor_post_command_hook(Qpaste_into_editor,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* PASTE-INTO-EDITOR-COMMAND-PURSUER */
Object paste_into_editor_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,299);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* PASTE-INTO-EDITOR-COMMAND-TRANSLATOR */
Object paste_into_editor_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,300);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qpaste_into_editor,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qpaste;              /* paste */

static Object Qupdate_paste_status;  /* update-paste-status */

/* COM-UPDATE-PASTE-STATUS */
Object com_update_paste_status(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, temp_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,301);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      if (ISVREF(Current_edit_state,(SI_Long)43L)) {
		  temp_1 = ISVREF(Current_edit_state,(SI_Long)43L);
		  enable_or_disable_subcommand(3,temp_1,Qpaste, 
			  !TRUEP(text_can_be_pasted_in_current_workstation_p()) 
			  ? T : Nil);
	      }
	      editor_post_command_hook(Qupdate_paste_status,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* UPDATE-PASTE-STATUS-COMMAND-PURSUER */
Object update_paste_status_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,302);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* UPDATE-PASTE-STATUS-COMMAND-TRANSLATOR */
Object update_paste_status_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,303);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qupdate_paste_status,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* AUTO-INSERT-TEXT-IN-EDITOR */
Object auto_insert_text_in_editor(mouse_pointer)
    Object mouse_pointer;
{
    Object text_cell, frame, text_string_qm;

    x_note_fn_call(126,304);
    text_cell = text_cell_of_table_blackboard_function(mouse_pointer);
    frame = frame_blackboard_function(mouse_pointer);
    if (text_cell && frame) {
	text_string_qm = text_to_insert_from_text_cell(text_cell);
	if (text_string_qm)
	    return auto_insert_text_from_block(text_string_qm,frame);
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* HANDLE-CHARACTER-IN-TEXT-EVENT */
Object handle_character_in_text_event(event)
    Object event;
{
    Object unicode_qm;

    x_note_fn_call(126,305);
    unicode_qm = convert_key_code_to_unicode(ISVREF(event,(SI_Long)1L));
    if (unicode_qm)
	return insert_typed_in_character_at_cursor(unicode_qm);
    else
	return VALUES_1(Nil);
}

static Object Qcyrillic_character_in_text;  /* cyrillic-character-in-text */

/* COM-CYRILLIC-CHARACTER-IN-TEXT */
Object com_cyrillic_character_in_text(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,306);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      handle_cyrillic_character_in_text_event(event);
	      editor_post_command_hook(Qcyrillic_character_in_text,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* CYRILLIC-CHARACTER-IN-TEXT-COMMAND-PURSUER */
Object cyrillic_character_in_text_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,307);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* CYRILLIC-CHARACTER-IN-TEXT-COMMAND-TRANSLATOR */
Object cyrillic_character_in_text_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,308);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qcyrillic_character_in_text,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* HANDLE-CYRILLIC-CHARACTER-IN-TEXT-EVENT */
Object handle_cyrillic_character_in_text_event(event)
    Object event;
{
    Object unicode, cyrillic_alternative_character_qm, initial_element;
    Object wide_string_bv16, text_string_to_insert;
    SI_Long bv16_length, aref_arg_2, aref_new_value;

    x_note_fn_call(126,309);
    unicode = convert_key_code_to_unicode(ISVREF(event,(SI_Long)1L));
    cyrillic_alternative_character_qm = 
	    map_gensym_keyboard_character_to_cyrillic_alternate(unicode);
    initial_element = cyrillic_alternative_character_qm;
    if (initial_element);
    else
	initial_element = unicode;
    wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)3L + (SI_Long)1L));
    fill_wide_string_1(wide_string_bv16,initial_element,FIX((SI_Long)0L),
	    FIX((SI_Long)1L));
    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
    aref_arg_2 = bv16_length - (SI_Long)2L;
    aref_new_value = (SI_Long)1L & (SI_Long)65535L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    aref_arg_2 = bv16_length - (SI_Long)1L;
    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)1L,(SI_Long)0L);
    text_string_to_insert = wide_string_bv16;
    insert_text_string_at_cursor(5,text_string_to_insert,Nil,Nil,Nil,T);
    return reclaim_text_string(text_string_to_insert);
}

/* MAP-GENSYM-KEYBOARD-CHARACTER-TO-CYRILLIC-ALTERNATE */
Object map_gensym_keyboard_character_to_cyrillic_alternate(unicode)
    Object unicode;
{
    x_note_fn_call(126,310);
    if ((SI_Long)32L <= IFIX(unicode) && IFIX(unicode) <= (SI_Long)126L)
	return VALUES_1(ISVREF(Key_cap_to_gensym_cyrillic_character_code_map,
		IFIX(unicode)));
    else
	return VALUES_1(Nil);
}

/* EXIT-CYRILLIC-INPUT-MODE */
Object exit_cyrillic_input_mode()
{
    Object svref_arg_1;

    x_note_fn_call(126,311);
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)66L)) = Nil;
    return update_cyrillic_input_buttons();
}

/* ENTER-CYRILLIC-INPUT-MODE */
Object enter_cyrillic_input_mode()
{
    Object svref_arg_1;

    x_note_fn_call(126,312);
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)66L)) = T;
    return update_cyrillic_input_buttons();
}

static Object Qcyrillic;           /* cyrillic */

static Object Qenglish;            /* english */

/* UPDATE-CYRILLIC-INPUT-BUTTONS */
Object update_cyrillic_input_buttons()
{
    Object edit_subcommand_menu_qm, cyrillic_input_mode_qm;

    x_note_fn_call(126,313);
    edit_subcommand_menu_qm = ISVREF(Current_edit_state,(SI_Long)43L);
    cyrillic_input_mode_qm = ISVREF(Current_edit_state,(SI_Long)66L);
    if (EQ(ISVREF(Current_edit_state,(SI_Long)45L),Qrussian) && 
	    edit_subcommand_menu_qm) {
	enable_or_disable_radio_button_subcommand(edit_subcommand_menu_qm,
		Qcyrillic, !TRUEP(cyrillic_input_mode_qm) ? T : Nil);
	return enable_or_disable_radio_button_subcommand(edit_subcommand_menu_qm,
		Qenglish,cyrillic_input_mode_qm);
    }
    else
	return VALUES_1(Nil);
}

static Object Qhangul_character_in_text;  /* hangul-character-in-text */

/* COM-HANGUL-CHARACTER-IN-TEXT */
Object com_hangul_character_in_text(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,314);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      handle_hangul_character_in_text_event(event);
	      editor_post_command_hook(Qhangul_character_in_text,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* HANGUL-CHARACTER-IN-TEXT-COMMAND-PURSUER */
Object hangul_character_in_text_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,315);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* HANGUL-CHARACTER-IN-TEXT-COMMAND-TRANSLATOR */
Object hangul_character_in_text_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,316);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qhangul_character_in_text,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qunbound_in_protected_let;  /* unbound-in-protected-let */

static Object string_constant_18;  /* "I~c" */

/* HANDLE-HANGUL-CHARACTER-IN-TEXT-EVENT */
Object handle_hangul_character_in_text_event(event)
    Object event;
{
    Object character_or_character_code, escape_character_qm;
    volatile Object input;
    volatile Object output;
    Object length_1, current_hfep_cchar, current_hfep_nchar;
    Object current_hfep_c_state, current_hfep_c_act, temp, svref_arg_1;
    Object svref_new_value;
    Declare_stack_pointer;
    Declare_catch(1);
    Declare_special(4);
    Object result;

    x_note_fn_call(126,317);
    SAVE_STACK();
    result = convert_key_code_to_gensym_character(ISVREF(event,(SI_Long)1L));
    MVS_2(result,character_or_character_code,escape_character_qm);
    if ( !TRUEP(escape_character_qm)) {
	if ( !EQ(ISVREF(Current_edit_state,(SI_Long)56L),
		Qhangul_character_in_text))
	    reset_hangul_input_automaton();
	input = Qunbound_in_protected_let;
	output = Qunbound_in_protected_let;
	length_1 = Qunbound_in_protected_let;
	if (PUSH_UNWIND_PROTECT(0)) {
	    input = tformat_text_string(2,string_constant_18,
		    character_or_character_code);
	    current_hfep_cchar = ISVREF(Current_edit_state,(SI_Long)62L);
	    PUSH_SPECIAL(Current_hfep_cchar,current_hfep_cchar,3);
	      current_hfep_nchar = ISVREF(Current_edit_state,(SI_Long)63L);
	      PUSH_SPECIAL(Current_hfep_nchar,current_hfep_nchar,2);
		current_hfep_c_state = ISVREF(Current_edit_state,(SI_Long)64L);
		PUSH_SPECIAL(Current_hfep_c_state,current_hfep_c_state,1);
		  current_hfep_c_act = ISVREF(Current_edit_state,(SI_Long)65L);
		  PUSH_SPECIAL(Current_hfep_c_act,current_hfep_c_act,0);
		    temp = run_hfep_automaton(input);
		    svref_arg_1 = Current_edit_state;
		    svref_new_value = Current_hfep_c_state;
		    SVREF(svref_arg_1,FIX((SI_Long)64L)) = svref_new_value;
		    svref_arg_1 = Current_edit_state;
		    svref_new_value = Current_hfep_c_act;
		    SVREF(svref_arg_1,FIX((SI_Long)65L)) = svref_new_value;
		    output = temp;
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	    length_1 = text_string_length(output);
	    process_hfep_output(output,length_1);
	}
	POP_UNWIND_PROTECT(0);
	if (output) {
	    if ( !EQ(output,Qunbound_in_protected_let))
		reclaim_text_string(output);
	}
	if (input) {
	    if ( !EQ(input,Qunbound_in_protected_let))
		reclaim_text_string(input);
	}
	CONTINUE_UNWINDING(0);
	Name_of_current_editor_command_qm = Qhangul_character_in_text;
	RESTORE_STACK();
	return VALUES_1(Name_of_current_editor_command_qm);
    }
    else {
	RESTORE_STACK();
	return VALUES_1(Nil);
    }
}

static Object list_constant_9;     /* # */

static Object string_constant_19;  /* "~c" */

/* PROCESS-HFEP-OUTPUT */
Object process_hfep_output(output_text_string,number_of_characters_to_process)
    Object output_text_string, number_of_characters_to_process;
{
    Object line, flag, char1, char2, ab_loop_iter_flag_;
    Object current_wide_string_list, wide_string_bv16, current_wide_string;
    Object fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object ks_c_5601, gensym_ks_c_5601, contiguous_code_qm, temp;
    Object hangul_character_sequence_text_string, cursor_line_index;
    Object cursor_character_index, text_tail_for_cursor;
    Object line_index_away_from_cursor_qm, character_index_away_from_cursor_qm;
    Object text_tail_qm, svref_arg_1, char_string;
    SI_Long substring_start_index, ab_loop_bind_, bv16_length, aref_arg_2;
    SI_Long aref_new_value, length_1;
    Declare_special(5);
    Object result;

    x_note_fn_call(126,318);
    substring_start_index = (SI_Long)0L;
    ab_loop_bind_ = IFIX(number_of_characters_to_process);
    line = Nil;
    flag = Nil;
    char1 = Nil;
    char2 = Nil;
    ab_loop_iter_flag_ = T;
  next_loop:
    if ( !(IFIX(number_of_characters_to_process) >= (SI_Long)4L))
	goto end_loop;
    if ( !TRUEP(ab_loop_iter_flag_))
	substring_start_index = substring_start_index + (SI_Long)4L;
    if (substring_start_index >= ab_loop_bind_)
	goto end_loop;
    line = text_string_substring(output_text_string,
	    FIX(substring_start_index),FIX(substring_start_index + 
	    (SI_Long)4L));
    flag = FIX(UBYTE_16_ISAREF_1(line,(SI_Long)1L));
    char1 = FIX(UBYTE_16_ISAREF_1(line,(SI_Long)2L));
    char2 = FIX(UBYTE_16_ISAREF_1(line,(SI_Long)3L));
    if (IFIX(char1) > (SI_Long)127L) {
	if (!(IFIX(char2) > (SI_Long)127L && IFIX(char1) < (SI_Long)201L)) {
	    char1 = FIX((SI_Long)161L);
	    char2 = FIX((SI_Long)224L);
	}
	current_wide_string_list = Qdo_not_use;
	PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
	  wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)2048L + 
		  (SI_Long)3L));
	  bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	  aref_arg_2 = bv16_length - (SI_Long)2L;
	  aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  aref_arg_2 = bv16_length - (SI_Long)1L;
	  aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
	  current_wide_string = wide_string_bv16;
	  PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
	    fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	    PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		    2);
	      length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
	      total_length_of_current_wide_string = 
		      FIX(UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		      (SI_Long)2L) + 
		      ((UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		      (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
	      PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
		      1);
		current_twriting_output_type = Qwide_string;
		PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
			0);
		  ks_c_5601 = ks2_bytes_to_ksc5601(char1,char2);
		  gensym_ks_c_5601 = ksc_to_gensym_ksc(ks_c_5601);
		  contiguous_code_qm = 
			  gensym_ksc_code_to_contiguous(gensym_ks_c_5601);
		  temp = contiguous_code_qm ? 
			  FIX(UBYTE_16_ISAREF_1(Ks_c_5601_to_unicode_map,
			  IFIX(contiguous_code_qm))) : Nil;
		  if (temp);
		  else
		      temp = FIX((SI_Long)65535L);
		  twrite_character(temp);
		  hangul_character_sequence_text_string = 
			  copy_out_current_wide_string();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	if (wide_character_member(ISVREF(Current_edit_state,(SI_Long)67L),
		list_constant_9)) {
	    cursor_line_index = ISVREF(Current_edit_state,(SI_Long)24L);
	    cursor_character_index = ISVREF(Current_edit_state,(SI_Long)25L);
	    text_tail_for_cursor = 
		    find_text_tail_for_line(ISVREF(Current_edit_state,
		    (SI_Long)15L),cursor_line_index);
	    result = find_previous_character_if_any(cursor_line_index,
		    cursor_character_index,text_tail_for_cursor,
		    ISVREF(Current_edit_state,(SI_Long)15L));
	    MVS_3(result,line_index_away_from_cursor_qm,
		    character_index_away_from_cursor_qm,text_tail_qm);
	    if (line_index_away_from_cursor_qm)
		change_edit_box(6,text_tail_qm,
			line_index_away_from_cursor_qm,
			character_index_away_from_cursor_qm,
			cursor_line_index,cursor_character_index,
			hangul_character_sequence_text_string);
	}
	else
	    insert_text_string_at_cursor(5,
		    hangul_character_sequence_text_string,Nil,Nil,Nil,T);
	reclaim_text_string(hangul_character_sequence_text_string);
	svref_arg_1 = Current_edit_state;
	SVREF(svref_arg_1,FIX((SI_Long)67L)) = flag;
    }
    else {
	char_string = tformat_text_string(2,string_constant_19,char2);
	insert_text_string_at_cursor(5,char_string,Nil,Nil,Nil,T);
	reclaim_text_string(char_string);
	reset_hangul_input_automaton();
    }
    reclaim_text_string(line);
    ab_loop_iter_flag_ = Nil;
    goto next_loop;
  end_loop:
    return VALUES_1(Qnil);
}

static Object array_constant_5;    /* # */

/* RESET-HANGUL-INPUT-AUTOMATON */
Object reset_hangul_input_automaton()
{
    Object current_hfep_cchar, current_hfep_nchar, current_hfep_c_state;
    Object current_hfep_c_act, svref_arg_1, temp, svref_new_value;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,319);
    if (ISVREF(Current_edit_state,(SI_Long)61L)) {
	current_hfep_cchar = ISVREF(Current_edit_state,(SI_Long)62L);
	PUSH_SPECIAL(Current_hfep_cchar,current_hfep_cchar,3);
	  current_hfep_nchar = ISVREF(Current_edit_state,(SI_Long)63L);
	  PUSH_SPECIAL(Current_hfep_nchar,current_hfep_nchar,2);
	    current_hfep_c_state = ISVREF(Current_edit_state,(SI_Long)64L);
	    PUSH_SPECIAL(Current_hfep_c_state,current_hfep_c_state,1);
	      current_hfep_c_act = ISVREF(Current_edit_state,(SI_Long)65L);
	      PUSH_SPECIAL(Current_hfep_c_act,current_hfep_c_act,0);
		run_hfep_automaton(array_constant_5);
		svref_arg_1 = Current_edit_state;
		temp = ISVREF(svref_arg_1,(SI_Long)67L) = FIX((SI_Long)82L);
		svref_arg_1 = Current_edit_state;
		svref_new_value = Current_hfep_c_state;
		SVREF(svref_arg_1,FIX((SI_Long)64L)) = svref_new_value;
		svref_arg_1 = Current_edit_state;
		svref_new_value = Current_hfep_c_act;
		SVREF(svref_arg_1,FIX((SI_Long)65L)) = svref_new_value;
		result = VALUES_1(temp);
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* EXIT-HANGUL-INPUT-MODE */
Object exit_hangul_input_mode()
{
    Object svref_arg_1;

    x_note_fn_call(126,320);
    reset_hangul_input_automaton();
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)61L)) = Nil;
    return update_hangul_input_buttons();
}

/* ENTER-HANGUL-INPUT-MODE */
Object enter_hangul_input_mode()
{
    Object svref_arg_1;

    x_note_fn_call(126,321);
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)61L)) = T;
    reset_hangul_input_automaton();
    return update_hangul_input_buttons();
}

static Object Qhangul;             /* hangul */

/* UPDATE-HANGUL-INPUT-BUTTONS */
Object update_hangul_input_buttons()
{
    Object edit_subcommand_menu_qm, hangul_input_mode_qm;

    x_note_fn_call(126,322);
    edit_subcommand_menu_qm = ISVREF(Current_edit_state,(SI_Long)43L);
    hangul_input_mode_qm = ISVREF(Current_edit_state,(SI_Long)61L);
    if (EQ(ISVREF(Current_edit_state,(SI_Long)45L),Qkorean) && 
	    edit_subcommand_menu_qm) {
	enable_or_disable_radio_button_subcommand(edit_subcommand_menu_qm,
		Qhangul, !TRUEP(hangul_input_mode_qm) ? T : Nil);
	return enable_or_disable_radio_button_subcommand(edit_subcommand_menu_qm,
		Qenglish,hangul_input_mode_qm);
    }
    else
	return VALUES_1(Nil);
}

Object Shift_variant_for_cursor_movement_p = UNBOUND;

/* REPLACE-PENDING-DELETE-TEXT-REGION */
Object replace_pending_delete_text_region(text_region,text_string_to_insert)
    Object text_region, text_string_to_insert;
{
    Object temp, temp_1, line_index, character_index, text_tail;
    Object line_index_past, character_index_past;

    x_note_fn_call(126,323);
    temp = ISVREF(text_region,(SI_Long)16L);
    temp_1 = ISVREF(text_region,(SI_Long)18L);
    line_index = FIXNUM_MIN(temp,temp_1);
    character_index = text_region_oriented_forward_p(text_region) ? 
	    ISVREF(text_region,(SI_Long)17L) : ISVREF(text_region,
	    (SI_Long)19L);
    text_tail = find_text_tail_for_line(ISVREF(Current_edit_state,
	    (SI_Long)15L),line_index);
    temp = ISVREF(text_region,(SI_Long)16L);
    temp_1 = ISVREF(text_region,(SI_Long)18L);
    line_index_past = FIXNUM_MAX(temp,temp_1);
    character_index_past = text_region_oriented_forward_p(text_region) ? 
	    ISVREF(text_region,(SI_Long)19L) : ISVREF(text_region,
	    (SI_Long)17L);
    deselect_current_text_region(text_region);
    change_edit_box(3,Nil,line_index,character_index);
    return insert_text_string_in_text_being_edited(11,
	    text_string_to_insert,Nil,Nil,line_index,character_index,
	    text_tail,line_index_past,character_index_past,Nil,Nil,T);
}

static Object Qtyped_in_space_or_at;  /* typed-in-space-or-@ */

static Object Qdo_not_add_space_after;  /* do-not-add-space-after */

/* INSERT-TYPED-IN-CHARACTER-AT-CURSOR */
Object insert_typed_in_character_at_cursor(unicode_wide_character)
    Object unicode_wide_character;
{
    Object text_string, text_region_qm, temp;
    char temp_1;

    x_note_fn_call(126,324);
    text_string = stringw(unicode_wide_character);
    text_region_qm = get_selected_text_region_for_edit_box();
    if (text_region_qm)
	replace_pending_delete_text_region(text_region_qm,text_string);
    else {
	if (ISVREF(Current_edit_state,(SI_Long)34L)) {
	    temp = ISVREF(Current_edit_state,(SI_Long)34L);
	    temp_1 = EQ(ISVREF(FIRST(temp),(SI_Long)1L),Qtyped_in_space_or_at);
	}
	else
	    temp_1 = TRUEP(Nil);
	temp = ( !temp_1 ? 
		TRUEP(dont_space_before_character_p(unicode_wide_character)) 
		: TRUEP(Nil)) ? Qdo_not_add_space_after : Nil;
	insert_text_string_at_cursor(5,text_string,Nil,temp,
		IFIX(unicode_wide_character) == (SI_Long)32L || 
		IFIX(unicode_wide_character) == (SI_Long)64L ? 
		Qtyped_in_space_or_at : Nil,T);
    }
    reclaim_text_string(text_string);
    return VALUES_1(Nil);
}

/* INSERT-TEXT-STRING-AT-CURSOR */
Object insert_text_string_at_cursor varargs_1(int, n)
{
    Object text_string, replace_fragments_on_sides_qm;
    Object handle_spaces_intelligently_qm;
    Object special_type_of_edit_box_change_qm, typed_in_qm;
    Object replace_entire_text_qm, cursor_line_index, cursor_character_index;
    Declare_varargs_nonrelocating;

    x_note_fn_call(126,325);
    INIT_ARGS_nonrelocating();
    text_string = REQUIRED_ARG_nonrelocating();
    replace_fragments_on_sides_qm = REQUIRED_ARG_nonrelocating();
    handle_spaces_intelligently_qm = REQUIRED_ARG_nonrelocating();
    special_type_of_edit_box_change_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    typed_in_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    replace_entire_text_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    if (replace_entire_text_qm)
	return replace_entire_edit_box_text(text_string);
    else {
	cursor_line_index = ISVREF(Current_edit_state,(SI_Long)24L);
	cursor_character_index = ISVREF(Current_edit_state,(SI_Long)25L);
	return insert_text_string_in_text_being_edited(11,text_string,
		replace_fragments_on_sides_qm,
		handle_spaces_intelligently_qm,cursor_line_index,
		cursor_character_index,
		find_text_tail_for_line(ISVREF(Current_edit_state,
		(SI_Long)15L),cursor_line_index),Nil,Nil,Nil,
		special_type_of_edit_box_change_qm,typed_in_qm);
    }
}

/* REPLACE-ENTIRE-EDIT-BOX-TEXT */
Object replace_entire_edit_box_text(text_string)
    Object text_string;
{
    Object text_tail, line_index_at_end, character_index_at_end;
    SI_Long line_index, character_index;
    Object result;

    x_note_fn_call(126,326);
    text_tail = ISVREF(Current_edit_state,(SI_Long)15L);
    line_index = (SI_Long)1L;
    character_index = (SI_Long)0L;
    result = find_end_of_text(2,text_tail,FIX(line_index));
    MVS_2(result,line_index_at_end,character_index_at_end);
    return insert_text_string_in_text_being_edited(8,text_string,Nil,Nil,
	    FIX(line_index),FIX(character_index),text_tail,
	    line_index_at_end,character_index_at_end);
}

/* INSERT-TEXT-STRING-AT-CURSOR-FROM-OUTSIDE */
Object insert_text_string_at_cursor_from_outside varargs_1(int, n)
{
    Object text_string;
    Object replace_fragments_on_sides_qm, handle_spaces_intelligently_qm;
    Object replace_entire_text_qm, special_type_of_edit_box_change_qm;
    Object current_edit_state, current_edit_workspace;
    Declare_varargs_nonrelocating;
    Declare_special(2);
    Object result;

    x_note_fn_call(126,327);
    INIT_ARGS_nonrelocating();
    text_string = REQUIRED_ARG_nonrelocating();
    replace_fragments_on_sides_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    handle_spaces_intelligently_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    replace_entire_text_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    special_type_of_edit_box_change_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    current_edit_state = Specific_structure_for_current_workstation_context;
    PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
      current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
      PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	result = insert_text_string_at_cursor(6,text_string,
		replace_fragments_on_sides_qm,
		handle_spaces_intelligently_qm,
		special_type_of_edit_box_change_qm,Nil,replace_entire_text_qm);
      POP_SPECIAL();
    POP_SPECIAL();
    return result;
}

/* INSERT-CHARACTER-AT-CURSOR-FROM-OUTSIDE */
Object insert_character_at_cursor_from_outside varargs_1(int, n)
{
    Object character_1;
    Object replace_fragments_on_sides_qm, handle_spaces_intelligently_qm;
    Object replace_entire_text_qm, special_type_of_edit_box_change_qm;
    Object current_edit_state, current_edit_workspace;
    Object current_wide_string_list, wide_string_bv16, current_wide_string;
    Object fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object thing, temp, schar_arg_2, schar_new_value, gensymed_symbol;
    Object gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    Object gensymed_symbol_4, gensymed_symbol_5;
    SI_Long bv16_length, aref_arg_2, aref_new_value, length_1;
    Declare_varargs_nonrelocating;
    Declare_special(7);
    Object result;

    x_note_fn_call(126,328);
    INIT_ARGS_nonrelocating();
    character_1 = REQUIRED_ARG_nonrelocating();
    replace_fragments_on_sides_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    handle_spaces_intelligently_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    replace_entire_text_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    special_type_of_edit_box_change_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    current_edit_state = Specific_structure_for_current_workstation_context;
    PUSH_SPECIAL(Current_edit_state,current_edit_state,6);
      current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
      PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,5);
	current_wide_string_list = Qdo_not_use;
	PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
	  wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)2048L + 
		  (SI_Long)3L));
	  bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	  aref_arg_2 = bv16_length - (SI_Long)2L;
	  aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  aref_arg_2 = bv16_length - (SI_Long)1L;
	  aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
	  current_wide_string = wide_string_bv16;
	  PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
	    fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	    PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		    2);
	      length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
	      total_length_of_current_wide_string = 
		      FIX(UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		      (SI_Long)2L) + 
		      ((UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		      (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
	      PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
		      1);
		current_twriting_output_type = Qwide_string;
		PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
			0);
		  if (EQ(Current_twriting_output_type,Qwide_string)) {
		      thing = character_1;
		      twrite_wide_character(CHARACTERP(thing) ? 
			      CHAR_CODE(thing) : thing);
		  }
		  else {
		      if ( 
			      !FIXNUM_LT(Fill_pointer_for_current_gensym_string,
			      Total_length_of_current_gensym_string))
			  extend_current_gensym_string(0);
		      temp = Current_gensym_string;
		      schar_arg_2 = Fill_pointer_for_current_gensym_string;
		      thing = character_1;
		      schar_new_value = CODE_CHAR(CHARACTERP(thing) ? 
			      CHAR_CODE(thing) : thing);
		      SET_SCHAR(temp,schar_arg_2,schar_new_value);
		      temp = 
			      FIXNUM_ADD1(Fill_pointer_for_current_gensym_string);
		      Fill_pointer_for_current_gensym_string = temp;
		  }
		  temp = Current_wide_string;
		  bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(temp));
		  aref_arg_2 = bv16_length - (SI_Long)2L;
		  aref_new_value = (SI_Long)1L & (SI_Long)65535L;
		  UBYTE_16_ISASET_1(temp,aref_arg_2,aref_new_value);
		  aref_arg_2 = bv16_length - (SI_Long)1L;
		  aref_new_value = (SI_Long)57344L | (SI_Long)1L >>  -  - 
			  (SI_Long)16L;
		  UBYTE_16_ISASET_1(temp,aref_arg_2,aref_new_value);
		  aref_arg_2 = (SI_Long)1L;
		  UBYTE_16_ISASET_1(temp,aref_arg_2,(SI_Long)0L);
		  result = insert_text_string_at_cursor(6,
			  Current_wide_string,
			  replace_fragments_on_sides_qm,
			  handle_spaces_intelligently_qm,
			  special_type_of_edit_box_change_qm,Nil,
			  replace_entire_text_qm);
		  MVS_6(result,gensymed_symbol,gensymed_symbol_1,
			  gensymed_symbol_2,gensymed_symbol_3,
			  gensymed_symbol_4,gensymed_symbol_5);
		  reclaim_wide_string(Current_wide_string);
		  result = VALUES_6(gensymed_symbol,gensymed_symbol_1,
			  gensymed_symbol_2,gensymed_symbol_3,
			  gensymed_symbol_4,gensymed_symbol_5);
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
      POP_SPECIAL();
    POP_SPECIAL();
    return result;
}

Object Native_editor_already_updated = UNBOUND;

static Object Qautomatic;          /* automatic */

/* INSERT-TEXT-STRING-IN-TEXT-BEING-EDITED */
Object insert_text_string_in_text_being_edited varargs_1(int, n)
{
    Object text_string, replace_fragments_on_sides_qm;
    Object handle_spaces_intelligently_qm, line_index, character_index;
    Object text_tail;
    Object line_index_past_deletion_qm, character_index_past_deletion_qm;
    Object no_parsing_or_ellipsis_deletion_qm;
    Object special_type_of_edit_box_change_qm, typed_in_qm;
    Object length_of_text_string, kfep_conversion_text_region_qm;
    Object text_string_qm, start, character_qm, string_character_qm;
    Object backward_line_index_qm, backward_character_index_qm;
    Object backward_text_tail_qm, forward_line_index_qm;
    Object forward_character_index_qm, forward_text_tail_qm;
    Object backward_line_index_1_qm, backward_character_index_1_qm;
    Object backward_text_tail_1_qm, forward_line_index_1_qm;
    Object forward_character_index_1_qm, forward_text_tail_1_qm, temp, temp_1;
    Object temp_2, text_string_should_not_follow_a_space_qm;
    Object previous_character_qm, next_character_qm, add_space_after_qm;
    Object add_space_before_qm, current_wide_string_list, wide_string_bv16;
    Object current_wide_string, fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object temp_4, schar_arg_2, schar_new_value, character_1, gensymed_symbol;
    Object backward_character_index_2_qm, text_line, extended_text_string_qm;
    Object i_1, j, ab_loop_iter_flag_, incff_1_arg, reduced_text_string;
    Object temp_6, temp_7, temp_8;
    SI_Long temp_3, char_1, bv16_length, aref_arg_2, aref_new_value, length_1;
    SI_Long thing, i, ab_loop_bind_, arg, arg_1, arg_2, k;
    SI_Long backward_character_index_1_qm_1;
    char temp_5, replacing_qm;
    Declare_varargs_nonrelocating;
    Declare_special(5);
    Object result;

    x_note_fn_call(126,329);
    INIT_ARGS_nonrelocating();
    text_string = REQUIRED_ARG_nonrelocating();
    replace_fragments_on_sides_qm = REQUIRED_ARG_nonrelocating();
    handle_spaces_intelligently_qm = REQUIRED_ARG_nonrelocating();
    line_index = REQUIRED_ARG_nonrelocating();
    character_index = REQUIRED_ARG_nonrelocating();
    text_tail = REQUIRED_ARG_nonrelocating();
    line_index_past_deletion_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    character_index_past_deletion_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    no_parsing_or_ellipsis_deletion_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    special_type_of_edit_box_change_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    typed_in_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    length_of_text_string = text_string_length(text_string);
    kfep_conversion_text_region_qm = ISVREF(Current_edit_state,(SI_Long)46L);
    text_string_qm = Nil;
    start = replace_fragments_on_sides_qm ? length_of_text_string : 
	    FIX((SI_Long)0L);
    character_qm = Nil;
    string_character_qm = Nil;
    backward_line_index_qm = Nil;
    backward_character_index_qm = Nil;
    backward_text_tail_qm = Nil;
    forward_line_index_qm = Nil;
    forward_character_index_qm = Nil;
    forward_text_tail_qm = Nil;
    backward_line_index_1_qm = Nil;
    backward_character_index_1_qm = Nil;
    backward_text_tail_1_qm = Nil;
    forward_line_index_1_qm = Nil;
    forward_character_index_1_qm = Nil;
    forward_text_tail_1_qm = Nil;
    result = match_adjacent_symbol_boundary(9,text_string,start,
	    FIX((SI_Long)0L),length_of_text_string,line_index,
	    character_index,text_tail,T,ISVREF(Current_edit_state,
	    (SI_Long)15L));
    MVS_4(result,backward_line_index_qm,backward_character_index_qm,
	    backward_text_tail_qm,start);
    temp = replace_fragments_on_sides_qm ? start : length_of_text_string;
    temp_1 = line_index_past_deletion_qm;
    if (temp_1);
    else
	temp_1 = line_index;
    temp_2 = character_index_past_deletion_qm;
    if (temp_2);
    else
	temp_2 = character_index;
    result = match_adjacent_symbol_boundary(7,text_string,temp,
	    FIX((SI_Long)0L),length_of_text_string,temp_1,temp_2,text_tail);
    MVS_3(result,forward_line_index_qm,forward_character_index_qm,
	    forward_text_tail_qm);
    if (handle_spaces_intelligently_qm && IFIX(length_of_text_string) > 
	    (SI_Long)0L) {
	temp_3 = UBYTE_16_ISAREF_1(text_string,(SI_Long)0L);
	char_1 = temp_3;
	text_string_should_not_follow_a_space_qm = 
		dont_space_before_character_p(FIX(char_1));
	if (text_string_should_not_follow_a_space_qm);
	else
	    text_string_should_not_follow_a_space_qm = char_1 == 
		    (SI_Long)32L ? T : Nil;
	previous_character_qm = Nil;
	next_character_qm = Nil;
	result = find_previous_character_if_any(backward_line_index_qm,
		backward_character_index_qm,backward_text_tail_qm,
		ISVREF(Current_edit_state,(SI_Long)15L));
	MVS_4(result,backward_line_index_1_qm,
		backward_character_index_1_qm,backward_text_tail_1_qm,
		previous_character_qm);
	if (previous_character_qm && newline_p(previous_character_qm))
	    previous_character_qm = FIX((SI_Long)40L);
	result = find_next_character_if_any(forward_line_index_qm,
		forward_character_index_qm,forward_text_tail_qm);
	MVS_4(result,forward_line_index_1_qm,forward_character_index_1_qm,
		forward_text_tail_1_qm,next_character_qm);
	if (Nil)
	    next_character_qm = FIX((SI_Long)41L);
	if (EQ(next_character_qm,FIX((SI_Long)32L))) {
	    forward_text_tail_qm = forward_text_tail_1_qm;
	    forward_line_index_qm = forward_line_index_1_qm;
	    forward_character_index_qm = forward_character_index_1_qm;
	}
	if (EQ(previous_character_qm,FIX((SI_Long)32L)) && 
		text_string_should_not_follow_a_space_qm) {
	    backward_text_tail_qm = backward_text_tail_1_qm;
	    backward_line_index_qm = backward_line_index_1_qm;
	    backward_character_index_qm = backward_character_index_1_qm;
	}
	if ( !EQ(handle_spaces_intelligently_qm,Qdo_not_add_space_after)) {
	    temp_2 = FIX(UBYTE_16_ISAREF_1(text_string,
		    IFIX(FIXNUM_SUB1(length_of_text_string))));
	    string_character_qm = temp_2;
	    add_space_after_qm =  !(EQ(string_character_qm,
		    FIX((SI_Long)32L)) || 
		    EQ(bracket_open_or_close_qm(string_character_qm),
		    Qopen)) ? T : Nil;
	}
	else
	    add_space_after_qm = Nil;
	add_space_before_qm =  
		!TRUEP(text_string_should_not_follow_a_space_qm) && 
		previous_character_qm ? ( !(EQ(previous_character_qm,
		FIX((SI_Long)32L)) || 
		EQ(bracket_open_or_close_qm(previous_character_qm),Qopen)) 
		? T : Nil) : Qnil;
	if (add_space_after_qm || add_space_before_qm) {
	    current_wide_string_list = Qdo_not_use;
	    PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
	      wide_string_bv16 = 
		      allocate_byte_vector_16(FIX((SI_Long)2048L + 
		      (SI_Long)3L));
	      bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	      aref_arg_2 = bv16_length - (SI_Long)2L;
	      aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
	      UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	      aref_arg_2 = bv16_length - (SI_Long)1L;
	      aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	      UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	      UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
	      current_wide_string = wide_string_bv16;
	      PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
		fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
		PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
			2);
		  length_1 = 
			  IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
		  total_length_of_current_wide_string = 
			  FIX(UBYTE_16_ISAREF_1(Current_wide_string,
			  length_1 - (SI_Long)2L) + 
			  ((UBYTE_16_ISAREF_1(Current_wide_string,length_1 
			  - (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
		  PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
			  1);
		    current_twriting_output_type = Qwide_string;
		    PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
			    0);
		      if (add_space_before_qm) {
			  if (EQ(Current_twriting_output_type,Qwide_string)) {
			      thing = (SI_Long)32L;
			      twrite_wide_character(CHARACTERP(FIX(thing)) 
				      ? CHAR_CODE(FIX(thing)) : FIX(thing));
			  }
			  else {
			      if ( 
				      !FIXNUM_LT(Fill_pointer_for_current_gensym_string,
				      Total_length_of_current_gensym_string))
				  extend_current_gensym_string(0);
			      temp_4 = Current_gensym_string;
			      schar_arg_2 = 
				      Fill_pointer_for_current_gensym_string;
			      thing = (SI_Long)32L;
			      schar_new_value = 
				      CODE_CHAR(CHARACTERP(FIX(thing)) ? 
				      CHAR_CODE(FIX(thing)) : FIX(thing));
			      SET_SCHAR(temp_4,schar_arg_2,schar_new_value);
			      temp_4 = 
				      FIXNUM_ADD1(Fill_pointer_for_current_gensym_string);
			      Fill_pointer_for_current_gensym_string = temp_4;
			  }
		      }
		      twrite_general_string(text_string);
		      if (add_space_after_qm) {
			  if (EQ(Current_twriting_output_type,Qwide_string)) {
			      thing = (SI_Long)32L;
			      twrite_wide_character(CHARACTERP(FIX(thing)) 
				      ? CHAR_CODE(FIX(thing)) : FIX(thing));
			  }
			  else {
			      if ( 
				      !FIXNUM_LT(Fill_pointer_for_current_gensym_string,
				      Total_length_of_current_gensym_string))
				  extend_current_gensym_string(0);
			      temp_4 = Current_gensym_string;
			      schar_arg_2 = 
				      Fill_pointer_for_current_gensym_string;
			      thing = (SI_Long)32L;
			      schar_new_value = 
				      CODE_CHAR(CHARACTERP(FIX(thing)) ? 
				      CHAR_CODE(FIX(thing)) : FIX(thing));
			      SET_SCHAR(temp_4,schar_arg_2,schar_new_value);
			      temp_4 = 
				      FIXNUM_ADD1(Fill_pointer_for_current_gensym_string);
			      Fill_pointer_for_current_gensym_string = temp_4;
			  }
		      }
		      text_string_qm = copy_out_current_wide_string();
		    POP_SPECIAL();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	}
    }
    if (kfep_conversion_text_region_qm && typed_in_qm) {
	i = (SI_Long)0L;
	ab_loop_bind_ = IFIX(length_of_text_string);
	character_1 = Nil;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	character_1 = FIX(UBYTE_16_ISAREF_1(text_string,i));
	gensymed_symbol = character_1;
	temp_5 = (SI_Long)97L <= IFIX(gensymed_symbol) ? 
		IFIX(gensymed_symbol) <= (SI_Long)122L : TRUEP(Qnil);
	if (temp_5);
	else
	    temp_5 = (SI_Long)65L <= IFIX(gensymed_symbol) ? 
		    IFIX(gensymed_symbol) <= (SI_Long)90L : TRUEP(Qnil);
	if (temp_5);
	else
	    temp_5 = TRUEP(wide_character_member(character_1,
		    Allowable_non_alpha_characters_in_kfep_conversions));
	if ( !temp_5) {
	    temp_5 = TRUEP(Nil);
	    goto end_1;
	}
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:
	temp_5 = TRUEP(T);
	goto end_1;
	temp_5 = TRUEP(Qnil);
      end_1:;
    }
    else
	temp_5 = TRUEP(Nil);
    if (temp_5) {
	backward_character_index_2_qm = backward_character_index_qm;
      next_loop_1:
	result = find_previous_character_if_any(backward_line_index_qm,
		backward_character_index_2_qm,backward_text_tail_qm,
		ISVREF(Current_edit_state,(SI_Long)15L));
	MVS_4(result,backward_line_index_1_qm,
		backward_character_index_1_qm,backward_text_tail_1_qm,
		character_qm);
	if ((backward_line_index_1_qm ? FIXNUM_EQ(backward_line_index_1_qm,
		backward_line_index_qm) : TRUEP(Nil)) ?  
		!(FIXNUM_LT(backward_line_index_1_qm,
		ISVREF(kfep_conversion_text_region_qm,(SI_Long)16L)) || 
		FIXNUM_EQ(backward_line_index_1_qm,
		ISVREF(kfep_conversion_text_region_qm,(SI_Long)16L)) && 
		FIXNUM_LT(backward_character_index_1_qm,
		ISVREF(kfep_conversion_text_region_qm,(SI_Long)17L))) : 
		TRUEP(Nil)) {
	    gensymed_symbol = character_qm;
	    temp_5 = (SI_Long)97L <= IFIX(gensymed_symbol) ? 
		    IFIX(gensymed_symbol) <= (SI_Long)122L : TRUEP(Qnil);
	    if (temp_5);
	    else
		temp_5 = (SI_Long)65L <= IFIX(gensymed_symbol) ? 
			IFIX(gensymed_symbol) <= (SI_Long)90L : TRUEP(Qnil);
	    if (temp_5);
	    else
		temp_5 = TRUEP(wide_character_member(character_qm,
			Allowable_non_alpha_characters_in_kfep_conversions));
	    if (temp_5);
	    else {
		temp_2 = ISVREF(Current_edit_state,(SI_Long)50L);
		if (EQ(temp_2,Qkatakana)) {
		    arg = (SI_Long)12449L;
		    arg_1 = IFIX(character_qm);
		    arg_2 = (SI_Long)12534L;
		    temp_5 = arg <= arg_1 ? arg_1 <= arg_2 : TRUEP(Qnil);
		}
		else if (EQ(temp_2,Qhiragana) || EQ(temp_2,Qnil)) {
		    arg = (SI_Long)12353L;
		    arg_1 = IFIX(character_qm);
		    arg_2 = (SI_Long)12435L;
		    temp_5 = arg <= arg_1 ? arg_1 <= arg_2 : TRUEP(Qnil);
		}
		else
		    temp_5 = TRUEP(Qnil);
	    }
	}
	else
	    temp_5 = TRUEP(Nil);
	if ( !temp_5)
	    goto end_loop_1;
	backward_character_index_2_qm = backward_character_index_1_qm;
	goto next_loop_1;
      end_loop_1:
	if ( !FIXNUM_EQ(backward_character_index_2_qm,
		backward_character_index_qm)) {
	    text_line = get_next_text_line(backward_text_tail_qm);
	    current_wide_string_list = Qdo_not_use;
	    PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
	      wide_string_bv16 = 
		      allocate_byte_vector_16(FIX((SI_Long)2048L + 
		      (SI_Long)3L));
	      bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	      aref_arg_2 = bv16_length - (SI_Long)2L;
	      aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
	      UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	      aref_arg_2 = bv16_length - (SI_Long)1L;
	      aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	      UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	      UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
	      current_wide_string = wide_string_bv16;
	      PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
		fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
		PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
			2);
		  length_1 = 
			  IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
		  total_length_of_current_wide_string = 
			  FIX(UBYTE_16_ISAREF_1(Current_wide_string,
			  length_1 - (SI_Long)2L) + 
			  ((UBYTE_16_ISAREF_1(Current_wide_string,length_1 
			  - (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
		  PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
			  1);
		    current_twriting_output_type = Qwide_string;
		    PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
			    0);
		      twrite_portion_of_string_unparsably(text_line,
			      backward_character_index_2_qm,
			      backward_character_index_qm);
		      twrite_portion_of_string_unparsably(text_string,Nil,Nil);
		      extended_text_string_qm = copy_out_current_wide_string();
		    POP_SPECIAL();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	}
	else
	    extended_text_string_qm = Nil;
	temp_2 = ISVREF(Current_edit_state,(SI_Long)50L);
	if (EQ(temp_2,Qkatakana)) {
	    temp_2 = extended_text_string_qm;
	    if (temp_2);
	    else
		temp_2 = text_string;
	    text_string_qm = convert_to_katakana_if_possible(temp_2);
	}
	else if (EQ(temp_2,Qnil) || EQ(temp_2,Qhiragana)) {
	    temp_2 = extended_text_string_qm;
	    if (temp_2);
	    else
		temp_2 = text_string;
	    text_string_qm = convert_to_hiragana_if_possible(temp_2);
	}
	else
	    text_string_qm = Qnil;
	if (text_string_qm) {
	    text_line = get_next_text_line(backward_text_tail_qm);
	    i_1 = FIX((SI_Long)0L);
	    j = Nil;
	  next_loop_2:
	    j = i_1;
	    if ( !FIXNUM_LT(backward_character_index_2_qm,
		    backward_character_index_qm))
		goto end_loop_2;
	    j = FIXNUM_ADD1(j);
	    k = IFIX(i_1);
	    ab_loop_bind_ = IFIX(j);
	    backward_character_index_1_qm_1 = 
		    IFIX(backward_character_index_2_qm);
	    ab_loop_iter_flag_ = T;
	  next_loop_3:
	    if (k >= ab_loop_bind_)
		goto end_loop_3;
	    if ( !TRUEP(ab_loop_iter_flag_))
		backward_character_index_1_qm_1 = 
			backward_character_index_1_qm_1 + (SI_Long)1L;
	    temp_2 = FIX(UBYTE_16_ISAREF_1(text_string_qm,k));
	    temp = FIX(UBYTE_16_ISAREF_1(text_line,
		    backward_character_index_1_qm_1));
	    if ( !EQ(temp_2,temp)) {
		temp_5 = TRUEP(Nil);
		goto end_2;
	    }
	    ab_loop_iter_flag_ = Nil;
	    k = k + (SI_Long)1L;
	    goto next_loop_3;
	  end_loop_3:
	    temp_5 = TRUEP(T);
	    goto end_2;
	    temp_5 = TRUEP(Qnil);
	  end_2:;
	    if ( !temp_5)
		goto end_loop_2;
	    incff_1_arg = FIXNUM_MINUS(j,i_1);
	    backward_character_index_2_qm = 
		    FIXNUM_ADD(backward_character_index_2_qm,incff_1_arg);
	    i_1 = j;
	    goto next_loop_2;
	  end_loop_2:
	    if (IFIX(i_1) > (SI_Long)0L) {
		reduced_text_string = text_string_substring(text_string_qm,
			i_1,Nil);
		reclaim_text_string(text_string_qm);
		text_string_qm = reduced_text_string;
	    }
	    backward_character_index_qm = backward_character_index_2_qm;
	}
	if (extended_text_string_qm)
	    reclaim_text_string(extended_text_string_qm);
    }
    replacing_qm =  !(FIXNUM_EQ(forward_line_index_qm,
	    backward_line_index_qm) && 
	    FIXNUM_EQ(forward_character_index_qm,backward_character_index_qm));
    if (native_editor_workspace_p(Current_edit_workspace) &&  
	    !TRUEP(Native_editor_already_updated)) {
	temp_2 = Current_edit_state;
	temp = text_string_qm;
	if (temp);
	else
	    temp = text_string;
	native_editor_replace_text(temp_2,temp,backward_line_index_qm,
		backward_character_index_qm,replacing_qm ? 
		forward_line_index_qm : Nil,replacing_qm ? 
		forward_character_index_qm : Nil);
    }
    temp_2 = backward_text_tail_qm;
    temp = backward_line_index_qm;
    temp_1 = backward_character_index_qm;
    temp_6 = replacing_qm ? forward_line_index_qm : Nil;
    temp_7 = replacing_qm ? forward_character_index_qm : Nil;
    temp_8 = text_string_qm;
    if (temp_8);
    else
	temp_8 = text_string;
    change_edit_box(13,temp_2,temp,temp_1,temp_6,temp_7,temp_8,Nil,Nil,
	    no_parsing_or_ellipsis_deletion_qm,
	    special_type_of_edit_box_change_qm,Nil,Nil,T);
    if (kfep_conversion_text_region_qm &&  !TRUEP(typed_in_qm) &&  
	    !EQ(special_type_of_edit_box_change_qm,Qautomatic))
	enter_kana_conversion_mode(ISVREF(Current_edit_state,(SI_Long)50L));
    if (text_string_qm)
	return reclaim_text_string(text_string_qm);
    else
	return VALUES_1(Nil);
}

/* MATCH-ADJACENT-SYMBOL-BOUNDARY */
Object match_adjacent_symbol_boundary varargs_1(int, n)
{
    Object text_line, string_index, string_start, string_end, line_index;
    Object character_index, text_tail;
    Object backwards_qm, text, adjacent_line_index_qm;
    Object adjacent_character_index_qm, adjacent_text_tail_qm, character_qm;
    Object adjacent_line_index_1_qm, adjacent_character_index_1_qm;
    Object adjacent_text_tail_1_qm, string_character_qm, i, adjacent_start_qm;
    Object temp_1, temp_2, code;
    char temp;
    Declare_varargs_nonrelocating;
    Object result;

    x_note_fn_call(126,330);
    INIT_ARGS_nonrelocating();
    text_line = REQUIRED_ARG_nonrelocating();
    string_index = REQUIRED_ARG_nonrelocating();
    string_start = REQUIRED_ARG_nonrelocating();
    string_end = REQUIRED_ARG_nonrelocating();
    line_index = REQUIRED_ARG_nonrelocating();
    character_index = REQUIRED_ARG_nonrelocating();
    text_tail = REQUIRED_ARG_nonrelocating();
    backwards_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    text = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    adjacent_line_index_qm = Nil;
    adjacent_character_index_qm = Nil;
    adjacent_text_tail_qm = Nil;
    character_qm = Nil;
    adjacent_line_index_1_qm = Nil;
    adjacent_character_index_1_qm = Nil;
    adjacent_text_tail_1_qm = Nil;
    string_character_qm = Nil;
    i = Nil;
    adjacent_start_qm = Nil;
  next_loop:
    i = string_index;
    adjacent_start_qm = Nil;
    adjacent_line_index_qm = line_index;
    adjacent_character_index_qm = character_index;
    adjacent_text_tail_qm = text_tail;
  next_loop_1:
    if (backwards_qm ? FIXNUM_LE(i,string_start) : FIXNUM_GE(i,string_end)) {
	if ((backwards_qm ? FIXNUM_GT(string_index,string_start) : 
		FIXNUM_LT(string_index,string_end)) && 
		alpha_numeric_p(character_qm)) {
	    if (backwards_qm)
		result = find_previous_character_if_any(adjacent_line_index_qm,
			adjacent_character_index_qm,adjacent_text_tail_qm,
			text);
	    else
		result = find_next_character_if_any(adjacent_line_index_qm,
			adjacent_character_index_qm,adjacent_text_tail_qm);
	    MVS_4(result,adjacent_line_index_1_qm,
		    adjacent_character_index_1_qm,adjacent_text_tail_1_qm,
		    character_qm);
	    temp = character_qm ? TRUEP(alpha_numeric_p(character_qm)) : 
		    TRUEP(Nil);
	}
	else
	    temp = TRUEP(Nil);
	temp =  !temp;
	goto end_1;
    }
    if (backwards_qm)
	result = find_previous_character_if_any(adjacent_line_index_qm,
		adjacent_character_index_qm,adjacent_text_tail_qm,text);
    else
	result = find_next_character_if_any(adjacent_line_index_qm,
		adjacent_character_index_qm,adjacent_text_tail_qm);
    MVS_4(result,adjacent_line_index_qm,adjacent_character_index_qm,
	    adjacent_text_tail_qm,character_qm);
    if (backwards_qm) {
	temp_1 = FIX(UBYTE_16_ISAREF_1(text_line,IFIX(FIXNUM_SUB1(i))));
	temp_2 = FIXNUM_SUB1(i);
	result = VALUES_2(temp_1,temp_2);
    }
    else {
	temp_1 = FIX(UBYTE_16_ISAREF_1(text_line,IFIX(i)));
	temp_2 = FIXNUM_ADD1(i);
	result = VALUES_2(temp_1,temp_2);
    }
    MVS_2(result,string_character_qm,i);
    if ( !TRUEP(adjacent_start_qm))
	adjacent_start_qm = i;
    if (adjacent_line_index_qm) {
	code = character_qm;
	if (IFIX(code) < (SI_Long)127L)
	    temp_1 = (SI_Long)65L <= IFIX(code) && IFIX(code) <= 
		    (SI_Long)90L ? FIX(IFIX(code) + (SI_Long)32L) : code;
	else {
	    temp_1 = unicode_lowercase_if_uppercase(code);
	    if (temp_1);
	    else
		temp_1 = code;
	}
	code = string_character_qm;
	if (IFIX(code) < (SI_Long)127L)
	    temp_2 = (SI_Long)65L <= IFIX(code) && IFIX(code) <= 
		    (SI_Long)90L ? FIX(IFIX(code) + (SI_Long)32L) : code;
	else {
	    temp_2 = unicode_lowercase_if_uppercase(code);
	    if (temp_2);
	    else
		temp_2 = code;
	}
	temp = NUM_EQ(temp_1,temp_2);
    }
    else
	temp = TRUEP(Nil);
    if ( !temp)
	goto end_loop;
    goto next_loop_1;
  end_loop:
    temp = TRUEP(Qnil);
  end_1:
    if (temp)
	goto end_loop_1;
    string_index = adjacent_start_qm;
    goto next_loop;
  end_loop_1:
    return VALUES_4(adjacent_line_index_qm,adjacent_character_index_qm,
	    adjacent_text_tail_qm,string_index);
    return VALUES_1(Qnil);
}

/* DELETE-INTELLIGENTLY-FROM-TEXT-BEING-EDITED */
Object delete_intelligently_from_text_being_edited varargs_1(int, n)
{
    Object text_tail_qm, line_index_of_change, character_index_of_change;
    Object line_index_past_deletion, character_index_past_deletion;
    Object no_parsing_or_ellipsis_deletion_qm;
    Object special_type_of_edit_box_change_qm, text_being_edited, text_tail;
    Object text_tail_past_deletion, backward_line_index_qm;
    Object backward_character_index_qm, backward_text_tail_qm;
    Object previous_character_qm, forward_line_index_qm;
    Object forward_character_index_qm, temp, next_character_qm, temp_2;
    Object gensymed_symbol, gensymed_symbol_1, gensymed_symbol_2;
    char temp_1;
    Declare_varargs_nonrelocating;
    Object result;

    x_note_fn_call(126,331);
    INIT_ARGS_nonrelocating();
    text_tail_qm = REQUIRED_ARG_nonrelocating();
    line_index_of_change = REQUIRED_ARG_nonrelocating();
    character_index_of_change = REQUIRED_ARG_nonrelocating();
    line_index_past_deletion = REQUIRED_ARG_nonrelocating();
    character_index_past_deletion = REQUIRED_ARG_nonrelocating();
    no_parsing_or_ellipsis_deletion_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    special_type_of_edit_box_change_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    text_being_edited = ISVREF(Current_edit_state,(SI_Long)15L);
    text_tail = text_tail_qm;
    if (text_tail);
    else
	text_tail = find_text_tail_for_line(text_being_edited,
		line_index_of_change);
    text_tail_past_deletion = find_text_tail_for_line(text_being_edited,
	    line_index_past_deletion);
    result = find_previous_character_if_any(line_index_of_change,
	    character_index_of_change,text_tail,text_being_edited);
    MVS_4(result,backward_line_index_qm,backward_character_index_qm,
	    backward_text_tail_qm,previous_character_qm);
    if (previous_character_qm && newline_p(previous_character_qm))
	previous_character_qm = FIX((SI_Long)120L);
    result = find_next_character_if_any(line_index_past_deletion,
	    character_index_past_deletion,text_tail_past_deletion);
    MVS_4(result,forward_line_index_qm,forward_character_index_qm,temp,
	    next_character_qm);
    if (next_character_qm && newline_p(next_character_qm))
	next_character_qm = FIX((SI_Long)120L);
    if (EQ(next_character_qm,FIX((SI_Long)32L))) {
	if ( !TRUEP(previous_character_qm) || EQ(previous_character_qm,
		FIX((SI_Long)32L)) || 
		EQ(bracket_open_or_close_qm(previous_character_qm),Qopen)) {
	    line_index_past_deletion = forward_line_index_qm;
	    character_index_past_deletion = forward_character_index_qm;
	}
    }
    else {
	if (EQ(previous_character_qm,FIX((SI_Long)32L)))
	    temp_1 = TRUEP(dont_space_before_character_p(next_character_qm));
	else {
	    result = find_next_character_if_any(line_index_of_change,
		    character_index_of_change,text_tail);
	    MVS_4(result,backward_line_index_qm,
		    backward_character_index_qm,backward_text_tail_qm,
		    previous_character_qm);
	    if ((backward_line_index_qm ?  !(previous_character_qm && 
		    newline_p(previous_character_qm)) : TRUEP(Nil)) ? 
		    EQ(previous_character_qm,FIX((SI_Long)32L)) : TRUEP(Nil)) {
		result = find_previous_character_if_any(line_index_past_deletion,
			character_index_past_deletion,
			text_tail_past_deletion,text_being_edited);
		MVS_4(result,gensymed_symbol,gensymed_symbol_1,temp,
			gensymed_symbol_2);
		next_character_qm = gensymed_symbol_2;
		forward_character_index_qm = gensymed_symbol_1;
		forward_line_index_qm = gensymed_symbol;
		temp_1 = TRUEP(forward_line_index_qm);
	    }
	    else
		temp_1 = TRUEP(Nil);
	    temp_1 = ((temp_1 ?  !(next_character_qm && 
		    newline_p(next_character_qm)) : TRUEP(Nil)) ? 
		    EQ(next_character_qm,FIX((SI_Long)32L)) : TRUEP(Nil)) ?
		     FIXNUM_LT(backward_line_index_qm,
		    forward_line_index_qm) || 
		    FIXNUM_EQ(backward_line_index_qm,
		    forward_line_index_qm) && 
		    FIXNUM_LT(backward_character_index_qm,
		    forward_character_index_qm) : TRUEP(Nil);
	}
	if (temp_1) {
	    line_index_of_change = backward_line_index_qm;
	    character_index_of_change = backward_character_index_qm;
	    text_tail = backward_text_tail_qm;
	}
    }
    return change_edit_box(10,text_tail,line_index_of_change,
	    character_index_of_change,line_index_past_deletion,
	    character_index_past_deletion,Nil,Nil,Nil,
	    no_parsing_or_ellipsis_deletion_qm,
	    special_type_of_edit_box_change_qm);
}

/* WORD-LIKE-SEQUENCE-IN-TEXT-P */
Object word_like_sequence_in_text_p(text,beginning_text_tail,
	    beginning_line_index,beginning_character_index,end_line_index,
	    character_index_past_deletion)
    Object text, beginning_text_tail, beginning_line_index;
    Object beginning_character_index, end_line_index;
    Object character_index_past_deletion;
{
    Object end_text_tail, beginning_character_qm, end_character_qm;
    Object backward_line_index_qm, backward_character_index_qm;
    Object backward_text_tail_qm, previous_character_qm, forward_line_index_qm;
    Object forward_character_index_qm, temp, next_character_qm, temp_1;
    Object gensymed_symbol, gensymed_symbol_1, gensymed_symbol_2;
    Object result;

    x_note_fn_call(126,332);
    end_text_tail = find_text_tail_for_line(text,end_line_index);
    beginning_character_qm = Nil;
    end_character_qm = Nil;
    result = find_previous_character_if_any(beginning_line_index,
	    beginning_character_index,beginning_text_tail,text);
    MVS_4(result,backward_line_index_qm,backward_character_index_qm,
	    backward_text_tail_qm,previous_character_qm);
    result = find_next_character_if_any(end_line_index,
	    character_index_past_deletion,end_text_tail);
    MVS_4(result,forward_line_index_qm,forward_character_index_qm,temp,
	    next_character_qm);
    result = find_next_character_if_any(beginning_line_index,
	    beginning_character_index,text);
    MVS_4(result,backward_line_index_qm,backward_character_index_qm,
	    backward_text_tail_qm,beginning_character_qm);
    result = find_previous_character_if_any(end_line_index,
	    character_index_past_deletion,end_text_tail,text);
    MVS_4(result,gensymed_symbol,gensymed_symbol_1,temp,gensymed_symbol_2);
    end_character_qm = gensymed_symbol_2;
    forward_character_index_qm = gensymed_symbol_1;
    forward_line_index_qm = gensymed_symbol;
    if ( !TRUEP(next_character_qm) || 
	    word_delimiting_character_p(next_character_qm) || 
	    word_delimiting_character_p(end_character_qm)) {
	temp =  !TRUEP(previous_character_qm) ? T : Nil;
	if (temp);
	else
	    temp = word_delimiting_character_p(previous_character_qm);
	if (temp)
	    return VALUES_1(temp);
	else
	    return word_delimiting_character_p(beginning_character_qm);
    }
    else
	return VALUES_1(Nil);
}

static Object list_constant_10;    /* # */

/* MOVE-DOWN-LINE */
Object move_down_line varargs_1(int, n)
{
    Object number_of_lines;
    Object to_end_ok_qm, cursor_line_index, cursor_character_index, line_index;
    Object temp, text_tail, x_in_workspace, last_line_index;
    Object goal_x_in_workspace, gensymed_symbol, svref_arg_1;
    SI_Long temp_1, goal_line_index, gensymed_symbol_1, gensymed_symbol_2;
    SI_Long goal_y_in_workspace;
    char backwards_qm;
    Declare_varargs_nonrelocating;
    Object result;

    x_note_fn_call(126,333);
    INIT_ARGS_nonrelocating();
    number_of_lines = REQUIRED_ARG_nonrelocating();
    to_end_ok_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    backwards_qm =  !FIXNUM_PLUSP(number_of_lines);
    cursor_line_index = get_selected_edit_cursor_line_index();
    cursor_character_index = get_selected_edit_cursor_character_index();
    result = find_position_in_text(10,ISVREF(Current_edit_state,
	    (SI_Long)13L),Nil,Nil,Nil,T,Nil,Nil,cursor_line_index,
	    cursor_character_index,Nil);
    MVS_4(result,line_index,temp,text_tail,x_in_workspace);
    last_line_index = find_end_of_text(2,text_tail,line_index);
    cursor_line_index = ISVREF(Current_edit_state,(SI_Long)24L);
    if ((to_end_ok_qm || Shift_variant_for_cursor_movement_p) &&  
	    !backwards_qm && FIXNUM_GT(FIXNUM_ADD(cursor_line_index,
	    number_of_lines),last_line_index))
	return move_or_delete_from_cursor(3,Nil,Nil,T);
    else if ((to_end_ok_qm || Shift_variant_for_cursor_movement_p) && 
	    backwards_qm && IFIX(FIXNUM_ADD(cursor_line_index,
	    number_of_lines)) < (SI_Long)1L)
	return move_or_delete_from_cursor(3,Nil,T,T);
    else {
	if (IFIX(number_of_lines) < (SI_Long)0L) {
	    temp_1 = IFIX(FIXNUM_ADD(line_index,number_of_lines));
	    goal_line_index = MAX(temp_1,(SI_Long)1L);
	}
	else {
	    temp = FIXNUM_ADD(line_index,number_of_lines);
	    goal_line_index = IFIX(FIXNUM_MIN(temp,last_line_index));
	}
	goal_x_in_workspace = memq_function(ISVREF(Current_edit_state,
		(SI_Long)56L),list_constant_10) ? 
		ISVREF(Current_edit_state,(SI_Long)55L) : Nil;
	if (goal_x_in_workspace);
	else
	    goal_x_in_workspace = x_in_workspace;
	gensymed_symbol = ISVREF(ISVREF(Current_edit_state,(SI_Long)13L),
		(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)1L) : FIX((SI_Long)0L);
	gensymed_symbol_1 = IFIX(gensymed_symbol);
	temp = compute_distance_of_text_line_from_top(FIX(goal_line_index),
		ISVREF(ISVREF(Current_edit_state,(SI_Long)13L),(SI_Long)17L));
	gensymed_symbol_2 = IFIX(FIXNUM_ADD(temp,
		ISVREF(ISVREF(ISVREF(Current_edit_state,(SI_Long)13L),
		(SI_Long)17L),(SI_Long)31L)));
	goal_y_in_workspace = gensymed_symbol_1 + gensymed_symbol_2;
	svref_arg_1 = Current_edit_state;
	SVREF(svref_arg_1,FIX((SI_Long)55L)) = goal_x_in_workspace;
	return move_cursor_handling_shift_variant(Nil,Nil,Nil,
		goal_x_in_workspace,FIX(goal_y_in_workspace),Nil);
    }
}

/* MOVE-OR-DELETE-FROM-CURSOR */
Object move_or_delete_from_cursor varargs_1(int, n)
{
    Object delete_case_qm, backwards_qm, to_end_qm;
    Object line_wise_qm, cursor_line_index, cursor_character_index;
    Object text_tail_for_cursor, temp, temp_1, line_index_away_from_cursor_qm;
    Object character_index_away_from_cursor_qm, text_tail_qm;
    Declare_varargs_nonrelocating;
    Object result;

    x_note_fn_call(126,334);
    INIT_ARGS_nonrelocating();
    delete_case_qm = REQUIRED_ARG_nonrelocating();
    backwards_qm = REQUIRED_ARG_nonrelocating();
    to_end_qm = REQUIRED_ARG_nonrelocating();
    line_wise_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    cursor_line_index = get_selected_edit_cursor_line_index();
    cursor_character_index = get_selected_edit_cursor_character_index();
    text_tail_for_cursor = 
	    find_text_tail_for_line(ISVREF(Current_edit_state,
	    (SI_Long)15L),cursor_line_index);
    if (backwards_qm) {
	if (to_end_qm) {
	    if (line_wise_qm) {
		temp = 
			get_character_index_past_separator(text_tail_for_cursor);
		temp_1 = ISVREF(Current_edit_state,(SI_Long)15L);
		result = VALUES_4(cursor_line_index,temp,
			text_tail_for_cursor,temp_1);
	    }
	    else {
		temp_1 = ISVREF(Current_edit_state,(SI_Long)15L);
		result = VALUES_4(FIX((SI_Long)1L),FIX((SI_Long)0L),temp_1,
			Nil);
	    }
	}
	else
	    result = find_previous_character_if_any(cursor_line_index,
		    cursor_character_index,text_tail_for_cursor,
		    ISVREF(Current_edit_state,(SI_Long)15L));
    }
    else if (to_end_qm) {
	if (line_wise_qm) {
	    temp = find_end_of_line_of_text(text_tail_for_cursor,Nil);
	    temp_1 = ISVREF(Current_edit_state,(SI_Long)15L);
	    result = VALUES_4(cursor_line_index,temp,text_tail_for_cursor,
		    temp_1);
	}
	else
	    result = find_end_of_text(2,text_tail_for_cursor,
		    cursor_line_index);
    }
    else
	result = find_next_character_if_any(cursor_line_index,
		cursor_character_index,text_tail_for_cursor);
    MVS_3(result,line_index_away_from_cursor_qm,
	    character_index_away_from_cursor_qm,text_tail_qm);
    if (delete_case_qm) {
	if (line_index_away_from_cursor_qm) {
	    if (backwards_qm)
		return change_edit_box(5,text_tail_qm,
			line_index_away_from_cursor_qm,
			character_index_away_from_cursor_qm,
			cursor_line_index,cursor_character_index);
	    else
		return change_edit_box(5,text_tail_for_cursor,
			cursor_line_index,cursor_character_index,
			line_index_away_from_cursor_qm,
			character_index_away_from_cursor_qm);
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return move_cursor_handling_shift_variant(text_tail_qm,
		line_index_away_from_cursor_qm,
		character_index_away_from_cursor_qm,Nil,Nil, 
		!TRUEP(to_end_qm) &&  !TRUEP(line_wise_qm) ? (backwards_qm 
		? Qbackward : Qforward) : Nil);
}

/* MOVE-OR-DELETE-FROM-CURSOR-TO-NEXT-ADJACENT-WORD */
Object move_or_delete_from_cursor_to_next_adjacent_word(delete_case_qm,
	    backwards_qm)
    Object delete_case_qm, backwards_qm;
{
    Object cursor_line_index, cursor_character_index, text_tail_for_cursor;
    Object text, wide_character_qm, line_index_away_from_cursor_qm;
    Object character_index_away_from_cursor_qm, text_tail_qm, in_space_qm;
    Object not_in_alphanumeric_qm, started_qm, line_index, character_index;
    Object text_tail;
    Object result;

    x_note_fn_call(126,335);
    cursor_line_index = get_selected_edit_cursor_line_index();
    cursor_character_index = get_selected_edit_cursor_character_index();
    text_tail_for_cursor = 
	    find_text_tail_for_line(ISVREF(Current_edit_state,
	    (SI_Long)15L),cursor_line_index);
    text = ISVREF(Current_edit_state,(SI_Long)15L);
    wide_character_qm = Nil;
    line_index_away_from_cursor_qm = Nil;
    character_index_away_from_cursor_qm = Nil;
    text_tail_qm = Nil;
    in_space_qm = Nil;
    not_in_alphanumeric_qm = Nil;
    started_qm = Nil;
    line_index = cursor_line_index;
    character_index = cursor_character_index;
    text_tail = text_tail_for_cursor;
  next_loop:
    if (backwards_qm)
	result = find_previous_character_if_any(line_index,character_index,
		text_tail,text);
    else
	result = find_next_character_if_any(line_index,character_index,
		text_tail);
    MVS_4(result,line_index_away_from_cursor_qm,
	    character_index_away_from_cursor_qm,text_tail_qm,
	    wide_character_qm);
    if ( !TRUEP(line_index_away_from_cursor_qm)) {
	if ( !TRUEP(started_qm) &&  
		!TRUEP(get_selected_text_region_for_edit_box()))
	    return VALUES_1(Nil);
	else
	    goto end_loop;
    }
    else if (wide_character_qm && blank_p(wide_character_qm)) {
	if (started_qm) {
	    if ( !TRUEP(in_space_qm))
		goto end_loop;
	}
	in_space_qm = T;
    }
    else {
	in_space_qm = Nil;
	if (word_delimiting_character_p(wide_character_qm)) {
	    if (started_qm)
		goto end_loop;
	    else
		not_in_alphanumeric_qm = T;
	}
	else if (not_in_alphanumeric_qm)
	    goto end_loop;
    }
    started_qm = T;
    line_index = line_index_away_from_cursor_qm;
    character_index = character_index_away_from_cursor_qm;
    text_tail = text_tail_qm;
    goto next_loop;
  end_loop:
    if (delete_case_qm) {
	if (backwards_qm)
	    delete_intelligently_from_text_being_edited(5,text_tail,
		    line_index,character_index,cursor_line_index,
		    cursor_character_index);
	else
	    delete_intelligently_from_text_being_edited(5,
		    text_tail_for_cursor,cursor_line_index,
		    cursor_character_index,line_index,character_index);
    }
    else
	move_cursor_handling_shift_variant(text_tail,line_index,
		character_index,Nil,Nil,Nil);
    return VALUES_1(Qnil);
}

static Object Qgo_forward_character_extending_region;  /* go-forward-character-extending-region */

/* COM-GO-FORWARD-CHARACTER-EXTENDING-REGION */
Object com_go_forward_character_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,336);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_forward_character),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_forward_character_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-FORWARD-CHARACTER-EXTENDING-REGION-COMMAND-PURSUER */
Object go_forward_character_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,337);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-FORWARD-CHARACTER-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_forward_character_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,338);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_forward_character_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_backward_character_extending_region;  /* go-backward-character-extending-region */

/* COM-GO-BACKWARD-CHARACTER-EXTENDING-REGION */
Object com_go_backward_character_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,339);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_backward_character),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_backward_character_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-BACKWARD-CHARACTER-EXTENDING-REGION-COMMAND-PURSUER */
Object go_backward_character_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,340);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-BACKWARD-CHARACTER-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_backward_character_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,341);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_backward_character_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_up_line_extending_region;  /* go-up-line-extending-region */

/* COM-GO-UP-LINE-EXTENDING-REGION */
Object com_go_up_line_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,342);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_up_line),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_up_line_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-UP-LINE-EXTENDING-REGION-COMMAND-PURSUER */
Object go_up_line_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,343);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-UP-LINE-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_up_line_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,344);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_up_line_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_down_line_extending_region;  /* go-down-line-extending-region */

/* COM-GO-DOWN-LINE-EXTENDING-REGION */
Object com_go_down_line_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,345);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_down_line),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_down_line_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-DOWN-LINE-EXTENDING-REGION-COMMAND-PURSUER */
Object go_down_line_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,346);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-DOWN-LINE-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_down_line_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,347);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_down_line_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_down_page_extending_region;  /* go-down-page-extending-region */

/* COM-GO-DOWN-PAGE-EXTENDING-REGION */
Object com_go_down_page_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,348);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_down_page),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_down_page_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-DOWN-PAGE-EXTENDING-REGION-COMMAND-PURSUER */
Object go_down_page_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,349);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-DOWN-PAGE-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_down_page_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,350);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_down_page_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_up_page_extending_region;  /* go-up-page-extending-region */

/* COM-GO-UP-PAGE-EXTENDING-REGION */
Object com_go_up_page_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,351);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_up_page),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_up_page_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-UP-PAGE-EXTENDING-REGION-COMMAND-PURSUER */
Object go_up_page_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,352);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-UP-PAGE-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_up_page_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,353);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_up_page_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_backward_word_extending_region;  /* go-backward-word-extending-region */

/* COM-GO-BACKWARD-WORD-EXTENDING-REGION */
Object com_go_backward_word_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,354);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_backward_word),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_backward_word_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-BACKWARD-WORD-EXTENDING-REGION-COMMAND-PURSUER */
Object go_backward_word_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,355);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-BACKWARD-WORD-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_backward_word_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,356);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_backward_word_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_forward_word_extending_region;  /* go-forward-word-extending-region */

/* COM-GO-FORWARD-WORD-EXTENDING-REGION */
Object com_go_forward_word_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,357);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_forward_word),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_forward_word_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-FORWARD-WORD-EXTENDING-REGION-COMMAND-PURSUER */
Object go_forward_word_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,358);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-FORWARD-WORD-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_forward_word_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,359);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_forward_word_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_to_end_of_line_extending_region;  /* go-to-end-of-line-extending-region */

/* COM-GO-TO-END-OF-LINE-EXTENDING-REGION */
Object com_go_to_end_of_line_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,360);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_to_end_of_line),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_to_end_of_line_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-TO-END-OF-LINE-EXTENDING-REGION-COMMAND-PURSUER */
Object go_to_end_of_line_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,361);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-TO-END-OF-LINE-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_to_end_of_line_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,362);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_to_end_of_line_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_to_beginning_of_line_extending_region;  /* go-to-beginning-of-line-extending-region */

/* COM-GO-TO-BEGINNING-OF-LINE-EXTENDING-REGION */
Object com_go_to_beginning_of_line_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,363);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_to_beginning_of_line),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_to_beginning_of_line_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-TO-BEGINNING-OF-LINE-EXTENDING-REGION-COMMAND-PURSUER */
Object go_to_beginning_of_line_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,364);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-TO-BEGINNING-OF-LINE-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_to_beginning_of_line_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,365);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_to_beginning_of_line_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_to_end_extending_region;  /* go-to-end-extending-region */

/* COM-GO-TO-END-EXTENDING-REGION */
Object com_go_to_end_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,366);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_to_end),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_to_end_extending_region,edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-TO-END-EXTENDING-REGION-COMMAND-PURSUER */
Object go_to_end_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,367);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-TO-END-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_to_end_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,368);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_to_end_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qgo_to_beginning_extending_region;  /* go-to-beginning-extending-region */

/* COM-GO-TO-BEGINNING-EXTENDING-REGION */
Object com_go_to_beginning_extending_region(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Object shift_variant_for_cursor_movement_p, ui_command, gensymed_symbol;
    Object temp_1;
    Declare_special(4);
    Object result;

    x_note_fn_call(126,369);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,3);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,2);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    1);
	      temp = Nil;
	      shift_variant_for_cursor_movement_p = T;
	      PUSH_SPECIAL(Shift_variant_for_cursor_movement_p,shift_variant_for_cursor_movement_p,
		      0);
		ui_command = 
			getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgo_to_beginning),
			Qui_command_named);
		if (ui_command) {
		    gensymed_symbol = ISVREF(ui_command,(SI_Long)4L);
		    temp_1 = SYMBOLP(gensymed_symbol) ? 
			    SYMBOL_FUNCTION(gensymed_symbol) : gensymed_symbol;
		    FUNCALL_2(temp_1,event,edit_state);
		}
	      POP_SPECIAL();
	      editor_post_command_hook(Qgo_to_beginning_extending_region,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* GO-TO-BEGINNING-EXTENDING-REGION-COMMAND-PURSUER */
Object go_to_beginning_extending_region_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,370);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* GO-TO-BEGINNING-EXTENDING-REGION-COMMAND-TRANSLATOR */
Object go_to_beginning_extending_region_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,371);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qgo_to_beginning_extending_region,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* MOVE-CURSOR-HANDLING-SHIFT-VARIANT */
Object move_cursor_handling_shift_variant(text_tail_qm,line_index_qm,
	    character_index_qm,x_in_workspace_qm,y_in_workspace_qm,
	    single_char_movement_direction_qm)
    Object text_tail_qm, line_index_qm, character_index_qm, x_in_workspace_qm;
    Object y_in_workspace_qm, single_char_movement_direction_qm;
{
    Object text_region_qm, temp, temp_1;
    Object result;

    x_note_fn_call(126,372);
    result = set_up_args_for_move_cursor_handling_shift_variant(text_tail_qm,
	    line_index_qm,character_index_qm,x_in_workspace_qm,
	    y_in_workspace_qm);
    MVS_3(result,text_tail_qm,line_index_qm,character_index_qm);
    text_region_qm = get_selected_text_region_for_edit_box();
    if (text_region_qm) {
	if (Shift_variant_for_cursor_movement_p) {
	    if (line_index_qm) {
		update_text_region(3,text_region_qm,line_index_qm,
			character_index_qm);
		empty_text_region_p(text_region_qm);
		update_edit_operation_subcommands_in_current_editor();
	    }
	}
	else {
	    if (single_char_movement_direction_qm) {
		text_tail_qm = Nil;
		if (EQ(single_char_movement_direction_qm,Qbackward)) {
		    temp = ISVREF(text_region_qm,(SI_Long)16L);
		    temp_1 = ISVREF(text_region_qm,(SI_Long)18L);
		    line_index_qm = FIXNUM_MIN(temp,temp_1);
		    character_index_qm = 
			    text_region_oriented_forward_p(text_region_qm) 
			    ? ISVREF(text_region_qm,(SI_Long)17L) : 
			    ISVREF(text_region_qm,(SI_Long)19L);
		}
		else {
		    temp = ISVREF(text_region_qm,(SI_Long)16L);
		    temp_1 = ISVREF(text_region_qm,(SI_Long)18L);
		    line_index_qm = FIXNUM_MAX(temp,temp_1);
		    character_index_qm = 
			    text_region_oriented_forward_p(text_region_qm) 
			    ? ISVREF(text_region_qm,(SI_Long)19L) : 
			    ISVREF(text_region_qm,(SI_Long)17L);
		}
	    }
	    deselect_current_text_region(text_region_qm);
	}
    }
    else if (line_index_qm && Shift_variant_for_cursor_movement_p)
	select_current_text_region(make_text_region(6,
		ISVREF(Current_edit_state,(SI_Long)13L),Nil,
		ISVREF(Current_edit_state,(SI_Long)24L),
		ISVREF(Current_edit_state,(SI_Long)25L),line_index_qm,
		character_index_qm));
    if ( !TRUEP(Shift_variant_for_cursor_movement_p)) {
	if (line_index_qm)
	    return change_edit_box(3,text_tail_qm,line_index_qm,
		    character_index_qm);
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* SET-UP-ARGS-FOR-MOVE-CURSOR-HANDLING-SHIFT-VARIANT */
Object set_up_args_for_move_cursor_handling_shift_variant(text_tail_qm,
	    line_index_qm,character_index_qm,x_in_workspace_qm,
	    y_in_workspace_qm)
    Object text_tail_qm, line_index_qm, character_index_qm, x_in_workspace_qm;
    Object y_in_workspace_qm;
{
    Object result;

    x_note_fn_call(126,373);
    if (x_in_workspace_qm) {
	result = find_position_in_text(10,ISVREF(Current_edit_state,
		(SI_Long)13L),Nil,Nil,Nil,T,x_in_workspace_qm,
		y_in_workspace_qm,Nil,Nil,Nil);
	MVS_5(result,line_index_qm,character_index_qm,text_tail_qm,
		x_in_workspace_qm,y_in_workspace_qm);
    }
    return VALUES_3(text_tail_qm,line_index_qm,character_index_qm);
}

/* GET-SELECTED-EDIT-CURSOR-LINE-INDEX */
Object get_selected_edit_cursor_line_index()
{
    Object text_region_qm, temp;

    x_note_fn_call(126,374);
    text_region_qm = get_selected_text_region_for_edit_box();
    temp = text_region_qm ? ISVREF(text_region_qm,(SI_Long)18L) : 
	    ISVREF(Current_edit_state,(SI_Long)24L);
    return VALUES_1(temp);
}

/* GET-SELECTED-EDIT-CURSOR-CHARACTER-INDEX */
Object get_selected_edit_cursor_character_index()
{
    Object text_region_qm, temp;

    x_note_fn_call(126,375);
    text_region_qm = get_selected_text_region_for_edit_box();
    temp = text_region_qm ? ISVREF(text_region_qm,(SI_Long)19L) : 
	    ISVREF(Current_edit_state,(SI_Long)25L);
    return VALUES_1(temp);
}

/* SELECT-CURRENT-TEXT-REGION */
Object select_current_text_region(text_region)
    Object text_region;
{
    Object svref_arg_1;

    x_note_fn_call(126,376);
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)86L)) = text_region;
    return update_edit_operation_subcommands_in_current_editor();
}

/* DESELECT-CURRENT-TEXT-REGION */
Object deselect_current_text_region(text_region_to_delete_qm)
    Object text_region_to_delete_qm;
{
    Object svref_arg_1;

    x_note_fn_call(126,377);
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)86L)) = Nil;
    if (text_region_to_delete_qm)
	delete_frame(text_region_to_delete_qm);
    return update_edit_operation_subcommands_in_current_editor();
}

Object Current_line_index_for_end_of_token = UNBOUND;

Object Current_character_index_after_token = UNBOUND;

/* ENCODE-CURRENT-SOURCE-POSITION */
Object encode_current_source_position()
{
    Object line_index, character_index;

    x_note_fn_call(126,378);
    line_index = Current_line_index_for_end_of_token;
    character_index = Current_character_index_after_token;
    if (IFIX(line_index) < (SI_Long)1024L && IFIX(character_index) < 
	    (SI_Long)256L)
	return VALUES_1(FIX((IFIX(line_index) << (SI_Long)8L) + 
		IFIX(character_index)));
    else
	return phrase_cons(line_index,character_index);
}

/* LINE-INDEX-OF-SOURCE-POSITION */
Object line_index_of_source_position(source_position)
    Object source_position;
{
    x_note_fn_call(126,379);
    if (CONSP(source_position))
	return VALUES_1(CAR(source_position));
    else
	return VALUES_1(FIX(IFIX(source_position) >>  -  - (SI_Long)8L));
}

/* CHARACTER-INDEX-OF-SOURCE-POSITION */
Object character_index_of_source_position(source_position)
    Object source_position;
{
    SI_Long gensymed_symbol;

    x_note_fn_call(126,380);
    if (CONSP(source_position))
	return VALUES_1(CDR(source_position));
    else {
	gensymed_symbol = (SI_Long)255L & IFIX(source_position);
	return VALUES_1(FIX(gensymed_symbol));
    }
}

/* TEXT-STRING-FROM-CURRENT-SOURCE */
Object text_string_from_current_source(start_source_position_qm,
	    end_source_position_qm)
    Object start_source_position_qm, end_source_position_qm;
{
    Object start_line_index_qm, start_character_index_qm, end_line_index_qm;
    Object end_character_index_qm;

    x_note_fn_call(126,381);
    start_line_index_qm = Nil;
    start_character_index_qm = Nil;
    end_line_index_qm = Nil;
    end_character_index_qm = Nil;
    if (start_source_position_qm) {
	start_line_index_qm = 
		line_index_of_source_position(start_source_position_qm);
	start_character_index_qm = 
		character_index_of_source_position(start_source_position_qm);
    }
    if (end_source_position_qm) {
	end_line_index_qm = 
		line_index_of_source_position(end_source_position_qm);
	end_character_index_qm = 
		character_index_of_source_position(end_source_position_qm);
    }
    return convert_text_to_text_string(7,ISVREF(Current_edit_state,
	    (SI_Long)15L),Nil,start_line_index_qm,start_character_index_qm,
	    end_line_index_qm,end_character_index_qm,T);
}

static Object Qsource_position;    /* source-position */

/* REDUCE-NOTING-SOURCE-POSITION */
Object reduce_noting_source_position(parse)
    Object parse;
{
    x_note_fn_call(126,382);
    return phrase_cons(Qsource_position,phrase_cons(parse,
	    encode_current_source_position()));
}

Object In_recompile_item_p = UNBOUND;

static Object string_constant_20;  /* "Edit this item?  (It is in ~
				    *              a part of the KB ~
				    *              declared as stable. This edit could cause dependent ~
				    *              parts of the KB to become incomplete, and to ~
				    *              require recompilation.)"
				    */

static Object Qallow_continuation_of_editing_context_upon_confirmation;  /* allow-continuation-of-editing-context-upon-confirmation */

static Object Qexit_editing_context_upon_denial_of_confirmation;  /* exit-editing-context-upon-denial-of-confirmation */

/* PUT-BARRIER-ON-DESTABILIZATION-VIA-EDITING */
Object put_barrier_on_destabilization_via_editing(frame,slot_description)
    Object frame, slot_description;
{
    x_note_fn_call(126,383);
    if (restrict_destabilization_p(frame,slot_description)) {
	if ( !(In_recompile_item_p || 
		Keep_edit_workspace_hidden_no_matter_what_qm))
	    return enter_dialog(9,tformat_text_string(1,
		    string_constant_20),Nil,Nil,
		    Qallow_continuation_of_editing_context_upon_confirmation,
		    Nil,Qexit_editing_context_upon_denial_of_confirmation,
		    Nil,Nil,Nil);
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* EXIT-EDITING-CONTEXT-UPON-DENIAL-OF-CONFIRMATION */
Object exit_editing_context_upon_denial_of_confirmation()
{
    x_note_fn_call(126,384);
    return return_from_current_workstation_context(1,Qediting);
}

/* ALLOW-CONTINUATION-OF-EDITING-CONTEXT-UPON-CONFIRMATION */
Object allow_continuation_of_editing_context_upon_confirmation()
{
    x_note_fn_call(126,385);
    return VALUES_1(Nil);
}

Object Recording_items_made_incomplete_qm = UNBOUND;

Object Items_made_incomplete_were_recorded_qm = UNBOUND;

Object Operation_around_record_of_items_made_incomplete = UNBOUND;

Object Items_made_incomplete = UNBOUND;

/* RECLAIM-ITEMS-MADE-INCOMPLETE-LIST */
Object reclaim_items_made_incomplete_list()
{
    x_note_fn_call(126,386);
    reclaim_item_and_fsn_list(Items_made_incomplete);
    Items_made_incomplete = Nil;
    return VALUES_1(Nil);
}

/* RECORD-ITEM-MADE-INCOMPLETE-IF-APPROPRIATE */
Object record_item_made_incomplete_if_appropriate(item)
    Object item;
{
    Object temp;

    x_note_fn_call(126,387);
    if (Recording_items_made_incomplete_qm) {
	Items_made_incomplete_were_recorded_qm = T;
	temp = gensym_cons_1(item,copy_frame_serial_number(ISVREF(item,
		(SI_Long)3L)));
	Items_made_incomplete = gensym_cons_1(temp,Items_made_incomplete);
	return VALUES_1(Items_made_incomplete);
    }
    else
	return VALUES_1(Nil);
}

/* RECORD-ITEMS-MADE-INCOMPLETE-AND-DELETE */
Object record_items_made_incomplete_and_delete(item_to_delete,g2_window_qm)
    Object item_to_delete, g2_window_qm;
{
    Object operation_around_record_of_items_made_incomplete;
    Object recording_items_made_incomplete_qm;
    Object items_made_incomplete_were_recorded_qm, workstation_qm;
    Object current_workstation_1, current_workstation_window;
    Object current_g2_window_for_this_workstation_qm;
    Object type_of_current_workstation_window;
    Object current_workstation_native_window_qm, temp;
    Object current_workstation_context, type_of_current_workstation_context;
    Object specific_structure_for_current_workstation_context;
    Object current_workstation_detail_pane, current_g2_user_mode_qm;
    Object new_g2_classic_ui_p, servicing_workstation_qm;
    Declare_special(15);
    Object result;

    x_note_fn_call(126,388);
    operation_around_record_of_items_made_incomplete = Qdelete;
    PUSH_SPECIAL(Operation_around_record_of_items_made_incomplete,operation_around_record_of_items_made_incomplete,
	    14);
      recording_items_made_incomplete_qm = 
	      EQ(Operation_around_record_of_items_made_incomplete,Qedit) ? 
	      ( !TRUEP(ISVREF(Current_edit_state,(SI_Long)57L)) ? T : Nil) : T;
      PUSH_SPECIAL(Recording_items_made_incomplete_qm,recording_items_made_incomplete_qm,
	      13);
	items_made_incomplete_were_recorded_qm = Nil;
	PUSH_SPECIAL(Items_made_incomplete_were_recorded_qm,items_made_incomplete_were_recorded_qm,
		12);
	  reclaim_items_made_incomplete_list();
	  delete_item(item_to_delete);
	  workstation_qm = ISVREF(g2_window_qm,(SI_Long)20L);
	  if (workstation_qm) {
	      current_workstation_1 = workstation_qm;
	      PUSH_SPECIAL(Current_workstation,current_workstation_1,11);
		current_workstation_window = ISVREF(Current_workstation,
			(SI_Long)1L);
		PUSH_SPECIAL(Current_workstation_window,current_workstation_window,
			10);
		  current_g2_window_for_this_workstation_qm = 
			  ISVREF(Current_workstation,(SI_Long)25L);
		  PUSH_SPECIAL(Current_g2_window_for_this_workstation_qm,current_g2_window_for_this_workstation_qm,
			  9);
		    type_of_current_workstation_window = 
			    ISVREF(Current_workstation_window,(SI_Long)1L);
		    PUSH_SPECIAL(Type_of_current_workstation_window,type_of_current_workstation_window,
			    8);
		      current_workstation_native_window_qm = 
			      ISVREF(Current_workstation_window,(SI_Long)17L);
		      PUSH_SPECIAL(Current_workstation_native_window_qm,current_workstation_native_window_qm,
			      7);
			temp = ISVREF(Current_workstation,(SI_Long)17L);
			current_workstation_context = CAR(temp);
			PUSH_SPECIAL(Current_workstation_context,current_workstation_context,
				6);
			  type_of_current_workstation_context = 
				  ISVREF(Current_workstation_context,
				  (SI_Long)1L);
			  PUSH_SPECIAL(Type_of_current_workstation_context,type_of_current_workstation_context,
				  5);
			    specific_structure_for_current_workstation_context 
				    = ISVREF(Current_workstation_context,
				    (SI_Long)2L);
			    PUSH_SPECIAL(Specific_structure_for_current_workstation_context,specific_structure_for_current_workstation_context,
				    4);
			      current_workstation_detail_pane = 
				      detail_pane(Current_workstation_window);
			      PUSH_SPECIAL(Current_workstation_detail_pane,current_workstation_detail_pane,
				      3);
				current_g2_user_mode_qm = 
					ISVREF(Current_workstation,
					(SI_Long)19L);
				PUSH_SPECIAL(Current_g2_user_mode_qm,current_g2_user_mode_qm,
					2);
				  new_g2_classic_ui_p = 
					  get_value_for_current_workstation_new_g2_classic_ui_p();
				  PUSH_SPECIAL(New_g2_classic_ui_p,new_g2_classic_ui_p,
					  1);
				    servicing_workstation_qm = T;
				    PUSH_SPECIAL(Servicing_workstation_qm,servicing_workstation_qm,
					    0);
				      temp = 
					      offer_to_recompile_items_made_incomplete_if_appropriate();
				    POP_SPECIAL();
				  POP_SPECIAL();
				POP_SPECIAL();
			      POP_SPECIAL();
			    POP_SPECIAL();
			  POP_SPECIAL();
			POP_SPECIAL();
		      POP_SPECIAL();
		    POP_SPECIAL();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  else
	      temp = Nil;
	  reclaim_items_made_incomplete_list();
	  result = VALUES_1(temp);
	POP_SPECIAL();
      POP_SPECIAL();
    POP_SPECIAL();
    return result;
}

static Object Qtransfer;           /* transfer */

static Object string_constant_21;  /* "A transfer was made in" */

static Object string_constant_22;  /* "An edit was made to" */

static Object Qchoose_existing_class;  /* choose-existing-class */

static Object string_constant_23;  /* "A new superior class was chosen for" */

static Object string_constant_24;  /* "Deleting" */

static Object string_constant_25;  /* "~A a part of the KB declared as stable or dependent, which has caused ~
				    *       dependent parts of the KB to become incomplete, and to require ~
				    *       recompilation."
				    */

/* MAKE-DESCRIPTION-OF-BARRIER-TO-DESTABILIZATION */
Object make_description_of_barrier_to_destabilization()
{
    Object temp;

    x_note_fn_call(126,389);
    if (EQ(Operation_around_record_of_items_made_incomplete,Qtransfer))
	temp = string_constant_21;
    else if (EQ(Operation_around_record_of_items_made_incomplete,Qedit))
	temp = string_constant_22;
    else if (EQ(Operation_around_record_of_items_made_incomplete,
	    Qchoose_existing_class))
	temp = string_constant_23;
    else if (EQ(Operation_around_record_of_items_made_incomplete,Qdelete))
	temp = string_constant_24;
    else
	temp = Qnil;
    return tformat_text_string(2,string_constant_25,temp);
}

/* OFFER-TO-RECOMPILE-ITEMS-MADE-INCOMPLETE-IF-APPROPRIATE */
Object offer_to_recompile_items_made_incomplete_if_appropriate()
{
    x_note_fn_call(126,390);
    if (Recording_items_made_incomplete_qm && 
	    Items_made_incomplete_were_recorded_qm) {
	Items_made_incomplete_were_recorded_qm = Nil;
	offer_to_recompile_now_after_edit();
	return VALUES_1(T);
    }
    else
	return VALUES_1(Nil);
}

static Object string_constant_26;  /* "Recompile the KB?  (~A)" */

static Object Qlaunch_compile_to_bring_kb_up_to_date;  /* launch-compile-to-bring-kb-up-to-date */

/* OFFER-TO-RECOMPILE-NOW-AFTER-EDIT */
Object offer_to_recompile_now_after_edit()
{
    Object inner_text_string, temp;

    x_note_fn_call(126,391);
    if ( !(In_recompile_item_p || 
	    Keep_edit_workspace_hidden_no_matter_what_qm)) {
	inner_text_string = make_description_of_barrier_to_destabilization();
	temp = tformat_text_string(2,string_constant_26,inner_text_string);
	return enter_dialog(7,temp,Nil,Nil,
		Qlaunch_compile_to_bring_kb_up_to_date,
		gensym_cons_1(inner_text_string,Nil),
		Qallow_continuation_of_editing_context_upon_confirmation,Nil);
    }
    else
	return VALUES_1(Nil);
}

/* DELETE-FRAME-AFTER-CHECKING-SERIAL-NUMBER */
Object delete_frame_after_checking_serial_number(frame,reference_serial_number)
    Object frame, reference_serial_number;
{
    Object gensymed_symbol, xa, ya;
    Object operation_around_record_of_items_made_incomplete;
    Object recording_items_made_incomplete_qm;
    Object items_made_incomplete_were_recorded_qm, temp_1;
    char temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,392);
    gensymed_symbol = ISVREF(frame,(SI_Long)3L);
    temp = SIMPLE_VECTOR_P(frame) ? EQ(ISVREF(frame,(SI_Long)1L),
	    Qavailable_frame_vector) : TRUEP(Qnil);
    if (temp);
    else
	temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		(SI_Long)-1L : TRUEP(Nil);
    if (temp);
    else if (FIXNUMP(reference_serial_number))
	temp = FIXNUMP(gensymed_symbol) ? 
		FIXNUM_LT(reference_serial_number,gensymed_symbol) : TRUEP(T);
    else if (FIXNUMP(gensymed_symbol))
	temp = TRUEP(Nil);
    else {
	xa = M_CAR(reference_serial_number);
	ya = M_CAR(gensymed_symbol);
	temp = FIXNUM_LT(xa,ya);
	if (temp);
	else
	    temp = FIXNUM_EQ(xa,ya) ? 
		    FIXNUM_LT(M_CDR(reference_serial_number),
		    M_CDR(gensymed_symbol)) : TRUEP(Qnil);
    }
    if ( !temp) {
	operation_around_record_of_items_made_incomplete = Qdelete;
	PUSH_SPECIAL(Operation_around_record_of_items_made_incomplete,operation_around_record_of_items_made_incomplete,
		2);
	  recording_items_made_incomplete_qm = 
		  EQ(Operation_around_record_of_items_made_incomplete,
		  Qedit) ? ( !TRUEP(ISVREF(Current_edit_state,
		  (SI_Long)57L)) ? T : Nil) : T;
	  PUSH_SPECIAL(Recording_items_made_incomplete_qm,recording_items_made_incomplete_qm,
		  1);
	    items_made_incomplete_were_recorded_qm = Nil;
	    PUSH_SPECIAL(Items_made_incomplete_were_recorded_qm,items_made_incomplete_were_recorded_qm,
		    0);
	      reclaim_items_made_incomplete_list();
	      delete_frame(frame);
	      temp_1 = 
		      offer_to_recompile_items_made_incomplete_if_appropriate();
	      reclaim_items_made_incomplete_list();
	      result = VALUES_1(temp_1);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* DELETE-FRAME-AFTER-CHECKING-SERIAL-NUMBER-WITH-LIST */
Object delete_frame_after_checking_serial_number_with_list(gensym_listed_frame_and_reference_serial_number_copy)
    Object gensym_listed_frame_and_reference_serial_number_copy;
{
    Object frame, reference_serial_number;

    x_note_fn_call(126,393);
    frame = FIRST(gensym_listed_frame_and_reference_serial_number_copy);
    reference_serial_number = 
	    SECOND(gensym_listed_frame_and_reference_serial_number_copy);
    delete_frame_after_checking_serial_number(frame,reference_serial_number);
    reclaim_frame_serial_number(reference_serial_number);
    return reclaim_gensym_list_1(gensym_listed_frame_and_reference_serial_number_copy);
}

/* FINISH-PARSING-INSOFAR-AS-POSSIBLE */
Object finish_parsing_insofar_as_possible()
{
    Object current_edit_state, current_edit_workspace, edit_workspace;
    Object frame_serial_number_for_edit_workspace, result_1, gensymed_symbol;
    Object temp, xa, ya;
    Declare_special(2);
    Object result;

    x_note_fn_call(126,394);
    current_edit_state = Specific_structure_for_current_workstation_context;
    PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
      current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
      PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	edit_workspace = Current_edit_workspace;
	frame_serial_number_for_edit_workspace = 
		copy_frame_serial_number(ISVREF(edit_workspace,(SI_Long)3L));
	result_1 = Nil;
	extend_parsing_as_appropriate(2,Qend,T);
	gensymed_symbol = ISVREF(edit_workspace,(SI_Long)3L);
	temp = SIMPLE_VECTOR_P(edit_workspace) ? (EQ(ISVREF(edit_workspace,
		(SI_Long)1L),Qavailable_frame_vector) ? T : Nil) : Qnil;
	if (temp);
	else
	    temp = FIXNUMP(gensymed_symbol) ? (IFIX(gensymed_symbol) == 
		    (SI_Long)-1L ? T : Nil) : Nil;
	if (temp);
	else if (FIXNUMP(frame_serial_number_for_edit_workspace))
	    temp = FIXNUMP(gensymed_symbol) ? 
		    (FIXNUM_LT(frame_serial_number_for_edit_workspace,
		    gensymed_symbol) ? T : Nil) : T;
	else if (FIXNUMP(gensymed_symbol))
	    temp = Nil;
	else {
	    xa = M_CAR(frame_serial_number_for_edit_workspace);
	    ya = M_CAR(gensymed_symbol);
	    temp = FIXNUM_LT(xa,ya) ? T : Nil;
	    if (temp);
	    else
		temp = FIXNUM_EQ(xa,ya) ? 
			(FIXNUM_LT(M_CDR(frame_serial_number_for_edit_workspace),
			M_CDR(gensymed_symbol)) ? T : Nil) : Qnil;
	}
	result_1 = temp;
	reclaim_frame_serial_number(frame_serial_number_for_edit_workspace);
	result = VALUES_1(result_1);
      POP_SPECIAL();
    POP_SPECIAL();
    return result;
}

/* EXTEND-PARSING-OR-EXIT-EDITOR-AS-APPROPRIATE */
Object extend_parsing_or_exit_editor_as_appropriate()
{
    Object current_edit_state, current_edit_workspace, gensymed_symbol, x, y;
    Object xa, ya, temp_1;
    char temp;
    Declare_special(2);

    x_note_fn_call(126,395);
    current_edit_state = Specific_structure_for_current_workstation_context;
    PUSH_SPECIAL(Current_edit_state,current_edit_state,1);
      current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
      PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,0);
	gensymed_symbol = ISVREF(ISVREF(Current_edit_state,(SI_Long)12L),
		(SI_Long)3L);
	x = ISVREF(Current_edit_state,(SI_Long)12L);
	temp = SIMPLE_VECTOR_P(x) ? EQ(ISVREF(x,(SI_Long)1L),
		Qavailable_frame_vector) : TRUEP(Qnil);
	if (temp);
	else
	    temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		    (SI_Long)-1L : TRUEP(Nil);
	if (temp);
	else {
	    x = gensymed_symbol;
	    y = ISVREF(Current_edit_state,(SI_Long)2L);
	    if (FIXNUMP(y))
		temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
	    else if (FIXNUMP(x))
		temp = TRUEP(Nil);
	    else {
		xa = M_CAR(y);
		ya = M_CAR(x);
		temp = FIXNUM_LT(xa,ya);
		if (temp);
		else
		    temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),M_CDR(x)) 
			    : TRUEP(Qnil);
	    }
	}
	if ( ! !temp) {
	    abort_current_workstation_context(Qediting);
	    temp_1 = T;
	}
	else if (ISVREF(Current_edit_state,(SI_Long)27L) &&  
		!TRUEP(has_text_regions_p(2,ISVREF(Current_edit_state,
		(SI_Long)13L),ISVREF(Current_edit_state,(SI_Long)46L)))) {
	    extend_parsing_as_appropriate(1,ISVREF(Current_edit_state,
		    (SI_Long)27L));
	    temp_1 = T;
	}
	else
	    temp_1 = Qnil;
      POP_SPECIAL();
    POP_SPECIAL();
    return VALUES_1(temp_1);
}

static Object Qsingle_line_comment;  /* single-line-comment */

static Object Kdisplay_notification;  /* :display-notification */

static Object list_constant_11;    /* # */

static Object Qillegal_character;  /* illegal-character */

static Object string_constant_27;  /* "This cannot be parsed" */

static Object list_constant_12;    /* # */

static Object string_constant_28;  /* "This does not form a valid character literal in Java" */

static Object string_constant_29;  /* "This is incomplete" */

static Object Qcomment;            /* comment */

static Object list_constant_13;    /* # */

static Object Qtext;               /* text */

static Object string_constant_30;  /* "within a Java comment" */

static Object string_constant_31;  /* "Hit enter to terminate comment." */

static Object string_constant_32;  /* "Hit Control+J to terminate comment." */

static Object string_constant_33;  /* "Use } to terminate comment." */

static Object string_constant_34;  /* "Use } to terminate comment.  NOTE: This comment will not be preserved!" */

static Object Qquoted_character;   /* quoted-character */

static Object string_constant_35;  /* "This is missing a character after @" */

static Object Qellipsis;           /* ellipsis */

static Object string_constant_36;  /* "This contains an ellipsis" */

/* EXTEND-PARSING-AS-APPROPRIATE */
Object extend_parsing_as_appropriate varargs_1(int, n)
{
    Object parsing_extension_mode;
    Object do_not_suspend_qm, just_update_qm, change_text_qm;
    Object parsed_successfully_qm, svref_arg_1, kb_serial_number, frame;
    Object sub_vector_qm, function_qm, current_grammar;
    Object current_indicator_for_category_of_this_name;
    Object current_indicator_for_category_of_symbol_token, token_value;
    Object token_type_or_partial_types, current_line_index_for_end_of_token;
    Object current_character_index_after_token, text_tail_for_end_of_token_qm;
    Object token_self_terminating_qm, starting_time;
    Object incomplete_phrases_after_token, temp_1, temp_2, temp_3, temp_4;
    Object temp_5, temp_6, temp_7, result_of_custom_handling_qm;
    Object svref_new_value, line_index, character_index, problem_string;
    Object text_region, text_type_p;
    SI_Long method_index;
    char temp, try_to_end_editing_qm;
    Declare_varargs_nonrelocating;
    Declare_special(5);
    Object result;

    x_note_fn_call(126,396);
    INIT_ARGS_nonrelocating();
    parsing_extension_mode = REQUIRED_ARG_nonrelocating();
    do_not_suspend_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    just_update_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    change_text_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    parsed_successfully_qm = T;
    END_ARGS_nonrelocating();
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)27L)) = Nil;
    if (ISVREF(Current_edit_state,(SI_Long)11L)) {
	if (EQ(parsing_extension_mode,Qend)) {
	    kb_serial_number = Current_kb_serial_number;
	    temp =  !TRUEP(ISVREF(Current_edit_state,(SI_Long)3L));
	    if (temp);
	    else {
		method_index = (SI_Long)41L;
		frame = ISVREF(Current_edit_state,(SI_Long)3L);
		sub_vector_qm = ISVREF(ISVREF(ISVREF(frame,(SI_Long)1L),
			(SI_Long)11L),method_index);
		function_qm = sub_vector_qm ? ISVREF(sub_vector_qm,
			(SI_Long)1L) : Nil;
		temp =  !(function_qm ? TRUEP(inline_funcall_2(function_qm,
			frame,Current_workstation_context)) : TRUEP(Nil));
	    }
	    if (temp) {
		if (! !TRUEP(edit_context_remains_valid_p(kb_serial_number)))
		    parsed_successfully_qm = try_to_end_editing(1,
			    just_update_qm);
	    }
	}
	else
	    erase_any_temporary_information_on_edit_workspace(1,Nil);
    }
    else {
	current_grammar = Global_grammar;
	PUSH_SPECIAL(Current_grammar,current_grammar,4);
	  current_indicator_for_category_of_this_name = 
		  ISVREF(Current_grammar,(SI_Long)3L);
	  PUSH_SPECIAL(Current_indicator_for_category_of_this_name,current_indicator_for_category_of_this_name,
		  3);
	    current_indicator_for_category_of_symbol_token = 
		    ISVREF(Current_grammar,(SI_Long)4L);
	    PUSH_SPECIAL(Current_indicator_for_category_of_symbol_token,current_indicator_for_category_of_symbol_token,
		    2);
	      try_to_end_editing_qm = EQ(parsing_extension_mode,Qend);
	      token_value = Nil;
	      token_type_or_partial_types = Nil;
	      current_line_index_for_end_of_token = Nil;
	      PUSH_SPECIAL(Current_line_index_for_end_of_token,current_line_index_for_end_of_token,
		      1);
		current_character_index_after_token = Nil;
		PUSH_SPECIAL(Current_character_index_after_token,current_character_index_after_token,
			0);
		  text_tail_for_end_of_token_qm = Nil;
		  token_self_terminating_qm = Nil;
		  starting_time = FIX((SI_Long)0L);
		  incomplete_phrases_after_token = Nil;
		next_loop:
		  temp_1 = determine_appropriate_tokenizer();
		  temp_2 =  !try_to_end_editing_qm ? 
			  ISVREF(Current_edit_state,(SI_Long)24L) : Nil;
		  temp_3 =  !try_to_end_editing_qm ? 
			  ISVREF(Current_edit_state,(SI_Long)25L) : Nil;
		  temp_4 = ISVREF(Current_edit_state,(SI_Long)29L);
		  temp_4 = CAR(temp_4);
		  temp_5 = CAR(temp_4);
		  temp_4 = ISVREF(Current_edit_state,(SI_Long)29L);
		  temp_4 = CAR(temp_4);
		  temp_6 = CADR(temp_4);
		  temp_7 = ISVREF(Current_edit_state,(SI_Long)28L);
		  temp_4 = ISVREF(Current_edit_state,(SI_Long)31L);
		  result = get_next_token_from_text_if_available(7,temp_1,
			  temp_2,temp_3,temp_5,temp_6,temp_7,CAR(temp_4));
		  MVS_6(result,token_value,token_type_or_partial_types,
			  Current_line_index_for_end_of_token,
			  Current_character_index_after_token,
			  text_tail_for_end_of_token_qm,
			  token_self_terminating_qm);
		  if ( !TRUEP(token_type_or_partial_types) ||  
			  !SYMBOLP(token_type_or_partial_types))
		      goto end_loop;
		  procedure_signature_token_hook(token_value);
		  temp_4 = ISVREF(Current_edit_state,(SI_Long)31L);
		  incomplete_phrases_after_token = 
			  advance_parsing_for_token(token_value,
			  token_type_or_partial_types,FIRST(temp_4));
		  if ( !TRUEP(incomplete_phrases_after_token))
		      goto end_loop;
		  erase_any_temporary_information_on_edit_workspace(1,Nil);
		  push_for_token(Current_line_index_for_end_of_token,
			  Current_character_index_after_token,
			  token_self_terminating_qm,
			  text_tail_for_end_of_token_qm,
			  incomplete_phrases_after_token,token_value,
			  token_type_or_partial_types);
		  starting_time = FIXNUM_ADD1(starting_time);
		  temp = IFIX(starting_time) >= (SI_Long)5L;
		  if (temp);
		  else
		      temp =  !try_to_end_editing_qm ? 
			      TRUEP(current_workstation_has_pending_events_p()) 
			      : TRUEP(Qnil);
		  if (temp ?  !TRUEP(do_not_suspend_qm) : TRUEP(Nil)) {
		      svref_arg_1 = Current_edit_state;
		      SVREF(svref_arg_1,FIX((SI_Long)27L)) = 
			      parsing_extension_mode;
		      goto end_1;
		  }
		  goto next_loop;
		end_loop:
		  if (( !TRUEP(token_type_or_partial_types) || 
			  EQ(token_type_or_partial_types,
			  Qsingle_line_comment) && 
			  EQ(parsing_extension_mode,Qend)) &&  
			  !TRUEP(token_value)) {
		      kb_serial_number = Current_kb_serial_number;
		      if (try_to_end_editing_qm && 
			      ISVREF(Current_edit_state,(SI_Long)3L)) {
			  method_index = (SI_Long)41L;
			  frame = ISVREF(Current_edit_state,(SI_Long)3L);
			  sub_vector_qm = ISVREF(ISVREF(ISVREF(frame,
				  (SI_Long)1L),(SI_Long)11L),method_index);
			  function_qm = sub_vector_qm ? 
				  ISVREF(sub_vector_qm,(SI_Long)1L) : Nil;
			  result_of_custom_handling_qm = function_qm ? 
				  inline_funcall_2(function_qm,frame,
				  Current_workstation_context) : Nil;
		      }
		      else
			  result_of_custom_handling_qm = Nil;
		      if ( 
			      !TRUEP(edit_context_remains_valid_p(kb_serial_number)))
			  goto end_1;
		      else if (try_to_end_editing_qm &&  
			      !TRUEP(result_of_custom_handling_qm))
			  parsed_successfully_qm = try_to_end_editing(1,
				  just_update_qm);
		      else if (EQ(result_of_custom_handling_qm,
			      Kdisplay_notification));
		      else
			  update_edit_menus_or_autocomplete_as_appropriate(Nil,
				  Nil,parsing_extension_mode);
		  }
		  else {
		      enable_or_disable_edit_end_and_update_buttons(T);
		      if (token_type_or_partial_types && change_text_qm && 
			       
			      !TRUEP(memq_function(token_type_or_partial_types,
			      list_constant_11)) &&  
			      !SYMBOLP(token_type_or_partial_types)) {
			  svref_arg_1 = Current_edit_state;
			  svref_new_value = 
				  Current_line_index_for_end_of_token;
			  SVREF(svref_arg_1,FIX((SI_Long)82L)) = 
				  svref_new_value;
			  svref_arg_1 = Current_edit_state;
			  svref_new_value = 
				  Current_character_index_after_token;
			  SVREF(svref_arg_1,FIX((SI_Long)83L)) = 
				  svref_new_value;
		      }
		      if ( !TRUEP(token_type_or_partial_types) && 
			      text_string_p(token_value) || 
			      token_type_or_partial_types && 
			      SYMBOLP(token_type_or_partial_types) &&  
			      !TRUEP(memq_function(token_type_or_partial_types,
			      list_constant_11)) || 
			      CONSP(token_type_or_partial_types) && 
			      EQ(M_CAR(token_type_or_partial_types),
			      Qillegal_character)) {
			  erase_any_temporary_information_on_edit_workspace(1,
				  Nil);
			  if (try_to_end_editing_qm && 
				  ISVREF(Current_edit_state,(SI_Long)35L)) {
			      reclaim_edit_undo_or_redo_stack(ISVREF(Current_edit_state,
				      (SI_Long)35L));
			      svref_arg_1 = Current_edit_state;
			      SVREF(svref_arg_1,FIX((SI_Long)35L)) = Nil;
			  }
			  line_index = Current_line_index_for_end_of_token;
			  character_index = 
				  Current_character_index_after_token;
			  if (line_index && character_index)
			      insert_ellipsis_as_appropriate(2,line_index,
				      character_index);
			  temp_4 = ISVREF(Current_edit_state,(SI_Long)42L);
			  if (temp_4);
			  else {
			      svref_arg_1 = Current_edit_state;
			      temp_4 = gensym_list_4(Nil,Nil,Nil,Nil);
			      SVREF(svref_arg_1,FIX((SI_Long)42L)) = temp_4;
			  }
			  if (CAR(temp_4)) {
			      temp_4 = ISVREF(Current_edit_state,(SI_Long)42L);
			      if (temp_4);
			      else {
				  svref_arg_1 = Current_edit_state;
				  temp_4 = gensym_list_4(Nil,Nil,Nil,Nil);
				  SVREF(svref_arg_1,FIX((SI_Long)42L)) = 
					  temp_4;
			      }
			      temp_4 = 
				      reason_for_bad_parse_as_string(CAR(temp_4));
			  }
			  else
			      temp_4 = string_constant_27;
			  problem_string = copy_text_string(temp_4);
			  handle_parsing_or_compilation_problem(3,
				  problem_string,
				  Current_line_index_for_end_of_token,
				  Current_character_index_after_token);
			  parsed_successfully_qm = Nil;
			  reclaim_text_string(problem_string);
			  if (try_to_end_editing_qm)
			      maybe_offer_to_save_incomplete_statement();
		      }
		      else if (EQUAL(token_type_or_partial_types,
			      list_constant_12)) {
			  insert_ellipsis_as_appropriate(2,
				  Current_line_index_for_end_of_token,
				  Current_character_index_after_token);
			  if ( !EQ(ISVREF(Current_edit_state,(SI_Long)33L),
				  Qeditor_notification))
			      display_editor_notification_1(tformat_text_string(1,
				      string_constant_28));
		      }
		      else if (text_string_p(token_value)) {
			  if (try_to_end_editing_qm) {
			      home_down_cursor();
			      handle_parsing_or_compilation_problem(3,
				      string_constant_29,
				      Current_line_index_for_end_of_token,
				      Current_character_index_after_token);
			      maybe_offer_to_save_incomplete_statement();
			  }
			  else if (CONSP(token_type_or_partial_types) && 
				  (memq_function(Qcomment,
				  token_type_or_partial_types) || 
				  memq_function(Qsingle_line_comment,
				  token_type_or_partial_types)))
			      update_edit_menus_or_autocomplete_as_appropriate(token_type_or_partial_types,
				      token_value,parsing_extension_mode);
			  else {
			      if ( 
				      !TRUEP(update_edit_menus_or_autocomplete_as_appropriate(token_type_or_partial_types,
				      token_value,parsing_extension_mode))) {
				  temp =  !TRUEP(ISVREF(Current_edit_state,
					  (SI_Long)46L));
				  if (temp);
				  else {
				      text_region = 
					      ISVREF(Current_edit_state,
					      (SI_Long)46L);
				      temp = 
					      FIXNUM_LT(Current_line_index_for_end_of_token,
					      ISVREF(text_region,
					      (SI_Long)16L));
				      if (temp);
				      else
					  temp = 
						  FIXNUM_EQ(Current_line_index_for_end_of_token,
						  ISVREF(text_region,
						  (SI_Long)16L)) ? 
						  FIXNUM_LT(Current_character_index_after_token,
						  ISVREF(text_region,
						  (SI_Long)17L)) : TRUEP(Qnil);
				  }
			      }
			      else
				  temp = TRUEP(Nil);
			      if (temp)
				  insert_ellipsis_as_appropriate(3,
					  Current_line_index_for_end_of_token,
					  Current_character_index_after_token,
					  T);
			  }
			  reclaim_text_string(token_value);
		      }
		      else if (memq_function(token_type_or_partial_types,
			      list_constant_13)) {
			  if ( !EQ(ISVREF(Current_edit_state,(SI_Long)33L),
				  Qeditor_notification)) {
			      temp_4 = ISVREF(Current_edit_state,(SI_Long)9L);
			      text_type_p = memq_function(Qtext,CDDR(temp_4));
			      if (text_type_p) {
				  temp_4 = ISVREF(Current_edit_state,
					  (SI_Long)9L);
				  temp = 
					  TRUEP(java_editing_category_p(CADR(temp_4)));
			      }
			      else
				  temp = TRUEP(Nil);
			      if (temp)
				  temp_4 = string_constant_30;
			      else if (EQ(token_type_or_partial_types,
				      Qsingle_line_comment))
				  temp_4 = ISVREF(Current_edit_state,
					  (SI_Long)68L) || 
					  native_editor_workspace_p(Current_edit_workspace) 
					  ? string_constant_31 : 
					  string_constant_32;
			      else
				  temp_4 = text_type_p ? 
					  string_constant_33 : 
					  string_constant_34;
			      display_editor_notification_1(tformat_text_string(1,
				      temp_4));
			  }
		      }
		      else if (EQ(token_type_or_partial_types,
			      Qquoted_character)) {
			  if (try_to_end_editing_qm)
			      handle_parsing_or_compilation_problem(3,
				      string_constant_35,
				      Current_line_index_for_end_of_token,
				      Current_character_index_after_token);
		      }
		      else if (EQ(token_type_or_partial_types,Qellipsis)) {
			  erase_any_temporary_information_on_edit_workspace(1,
				  Nil);
			  if (try_to_end_editing_qm) {
			      mark_occurrences_of_string_in_text(ISVREF(Current_edit_state,
				      (SI_Long)13L),Nil,
				      Ellipsis_text_string,Nil);
			      handle_parsing_or_compilation_problem(3,
				      string_constant_36,
				      Current_line_index_for_end_of_token,
				      Current_character_index_after_token);
			      maybe_offer_to_save_incomplete_statement();
			  }
		      }
		  }
		end_1:;
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
    }
    return VALUES_1(parsed_successfully_qm);
}

static Object Qreserved_word_p;    /* reserved-word-p */

static Object Qunreserved_symbol;  /* unreserved-symbol */

/* ADVANCE-PARSING-FOR-TOKEN */
Object advance_parsing_for_token(token,type_of_token,
	    incomplete_phrases_for_token)
    Object token, type_of_token, incomplete_phrases_for_token;
{
    Object incomplete_phrases_at_frontier, specific_category_for_token_qm;
    Object general_category_for_token_qm, category_symbol, ab_loop_list_;
    Declare_special(1);
    Object result;

    x_note_fn_call(126,397);
    incomplete_phrases_at_frontier = Nil;
    PUSH_SPECIAL(Incomplete_phrases_at_frontier,incomplete_phrases_at_frontier,
	    0);
      specific_category_for_token_qm = get_category_of_token(token);
      general_category_for_token_qm = get(type_of_token,
	      Current_indicator_for_category_of_this_name,_);
      if (specific_category_for_token_qm)
	  add_constituent_to_incomplete_phrases(token,
		  specific_category_for_token_qm,incomplete_phrases_for_token);
      if (general_category_for_token_qm) {
	  if ( !(specific_category_for_token_qm && 
		  subcategoryp(specific_category_for_token_qm,
		  general_category_for_token_qm)))
	      add_constituent_to_incomplete_phrases(token,
		      general_category_for_token_qm,
		      incomplete_phrases_for_token);
      }
      if (EQ(type_of_token,Qsymbol)) {
	  if ( !TRUEP(getfq_function_no_default(INLINE_SYMBOL_PLIST(token),
		  Qreserved_word_p)))
	      add_constituent_to_incomplete_phrases(token,
		      get(Qunreserved_symbol,
		      Current_indicator_for_category_of_this_name,_),
		      incomplete_phrases_for_token);
	  if (lookup_kb_specific_property_value(token,
		  Category_symbols_for_symbol_token_kbprop)) {
	      category_symbol = Nil;
	      ab_loop_list_ = lookup_kb_specific_property_value(token,
		      Category_symbols_for_symbol_token_kbprop);
	    next_loop:
	      if ( !TRUEP(ab_loop_list_))
		  goto end_loop;
	      category_symbol = M_CAR(ab_loop_list_);
	      ab_loop_list_ = M_CDR(ab_loop_list_);
	      add_constituent_to_incomplete_phrases(token,
		      get_or_make_category_for_category_symbol(category_symbol),
		      incomplete_phrases_for_token);
	      goto next_loop;
	    end_loop:;
	  }
      }
      result = VALUES_1(Incomplete_phrases_at_frontier);
    POP_SPECIAL();
    return result;
}

static Object array_constant_6;    /* # */

/* INSERT-ELLIPSIS-AS-APPROPRIATE */
Object insert_ellipsis_as_appropriate varargs_1(int, n)
{
    Object line_index_for_end_of_prefix_token_string;
    Object character_index_for_end_of_prefix_token_string;
    Object note_syntax_error_p, token_value, token_type_or_partial_types;
    Object text_tail_for_end_of_prefix_token_string, temp, temp_1, temp_2;
    Object temp_3, temp_4, temp_5, temp_6;
    Object menu_content_structure_for_character_position, svref_new_value;
    Object temp_8;
    char temp_7;
    Declare_varargs_nonrelocating;
    Object result;

    x_note_fn_call(126,398);
    INIT_ARGS_nonrelocating();
    line_index_for_end_of_prefix_token_string = REQUIRED_ARG_nonrelocating();
    character_index_for_end_of_prefix_token_string = REQUIRED_ARG_nonrelocating();
    note_syntax_error_p = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    token_value = Nil;
    token_type_or_partial_types = Nil;
    text_tail_for_end_of_prefix_token_string = 
	    find_text_tail_for_line(ISVREF(Current_edit_state,
	    (SI_Long)15L),line_index_for_end_of_prefix_token_string);
  next_loop:
    temp = determine_appropriate_tokenizer();
    temp_1 = line_index_for_end_of_prefix_token_string;
    temp_2 = character_index_for_end_of_prefix_token_string;
    temp_3 = ISVREF(Current_edit_state,(SI_Long)29L);
    temp_3 = CAR(temp_3);
    temp_4 = CAR(temp_3);
    temp_3 = ISVREF(Current_edit_state,(SI_Long)29L);
    temp_3 = CAR(temp_3);
    temp_5 = CADR(temp_3);
    temp_6 = ISVREF(Current_edit_state,(SI_Long)28L);
    temp_3 = ISVREF(Current_edit_state,(SI_Long)31L);
    result = get_next_token_from_text_if_available(7,temp,temp_1,temp_2,
	    temp_4,temp_5,temp_6,CAR(temp_3));
    MVS_2(result,token_value,token_type_or_partial_types);
    temp_7 =  !TRUEP(token_type_or_partial_types) ?  !TRUEP(token_value) : 
	    TRUEP(Qnil);
    if (temp_7);
    else if (text_string_p(token_value) && 
		CONSP(token_type_or_partial_types)) {
	temp_3 = 
		get_or_make_menu_content_structure_for_current_token_position();
	menu_content_structure_for_character_position = 
		make_menu_content_structure_for_character_position(temp_3,
		token_type_or_partial_types,token_value);
	temp_3 = CAR(menu_content_structure_for_character_position);
	if (temp_3);
	else
	    temp_3 = CDR(menu_content_structure_for_character_position);
	reclaim_menu_content_structure(menu_content_structure_for_character_position);
	reclaim_simple_text_string(token_value);
	temp_7 = TRUEP(temp_3);
    }
    else
	temp_7 = TRUEP(Nil);
    if (temp_7)
	goto end_loop;
    result = find_previous_character_if_any(line_index_for_end_of_prefix_token_string,
	    character_index_for_end_of_prefix_token_string,
	    text_tail_for_end_of_prefix_token_string,
	    ISVREF(Current_edit_state,(SI_Long)15L));
    MVS_3(result,line_index_for_end_of_prefix_token_string,
	    character_index_for_end_of_prefix_token_string,
	    text_tail_for_end_of_prefix_token_string);
    goto next_loop;
  end_loop:
    if (native_editor_workspace_p(Current_edit_workspace)) {
	if (note_syntax_error_p) {
	    svref_new_value = ISVREF(Current_edit_state,(SI_Long)42L);
	    if (svref_new_value);
	    else {
		temp_8 = Current_edit_state;
		svref_new_value = gensym_list_4(Nil,Nil,Nil,Nil);
		SVREF(temp_8,FIX((SI_Long)42L)) = svref_new_value;
	    }
	    temp_8 = copy_text_string(array_constant_6);
	    M_CADDDR(svref_new_value) = temp_8;
	    svref_new_value = ISVREF(Current_edit_state,(SI_Long)42L);
	    if (svref_new_value);
	    else {
		temp_8 = Current_edit_state;
		svref_new_value = gensym_list_4(Nil,Nil,Nil,Nil);
		SVREF(temp_8,FIX((SI_Long)42L)) = svref_new_value;
	    }
	    M_CADR(svref_new_value) = 
		    line_index_for_end_of_prefix_token_string;
	    svref_new_value = ISVREF(Current_edit_state,(SI_Long)42L);
	    if (svref_new_value);
	    else {
		temp_8 = Current_edit_state;
		svref_new_value = gensym_list_4(Nil,Nil,Nil,Nil);
		SVREF(temp_8,FIX((SI_Long)42L)) = svref_new_value;
	    }
	    M_CADDR(svref_new_value) = 
		    character_index_for_end_of_prefix_token_string;
	}
    }
    else if (FIXNUM_EQ(line_index_for_end_of_prefix_token_string,
	    ISVREF(Current_edit_state,(SI_Long)24L)) && 
	    FIXNUM_EQ(character_index_for_end_of_prefix_token_string,
	    ISVREF(Current_edit_state,(SI_Long)25L)));
    else if ( !TRUEP(ISVREF(Current_edit_state,(SI_Long)35L)))
	insert_text_string_in_text_being_edited(10,Ellipsis_text_string,T,
		Nil,line_index_for_end_of_prefix_token_string,
		character_index_for_end_of_prefix_token_string,
		text_tail_for_end_of_prefix_token_string,Nil,Nil,T,Qautomatic);
    return VALUES_1(Qnil);
}

Object Text_of_definition_being_compiled = UNBOUND;

static Object Kpaint_infered_from_xor;  /* :paint-infered-from-xor */

static Object Kdraw_as_late_as_possible;  /* :draw-as-late-as-possible */

static Object Qforce;              /* force */

/* TRY-TO-END-EDITING */
Object try_to_end_editing varargs_1(int, n)
{
    Object just_update_qm, gensymed_symbol, x, y, xa, ya;
    Object parse_or_bad_phrase_qm, parsing_completed_qm;
    Object operation_around_record_of_items_made_incomplete;
    Object recording_items_made_incomplete_qm;
    Object items_made_incomplete_were_recorded_qm, current_drawing_priority;
    Object drawing_is_locked_qm, text_of_definition_being_compiled;
    Object new_value_or_bad_phrase, explanatory_text_string_if_bad_phrase_qm;
    Object temp_1;
    char temp;
    Declare_varargs_nonrelocating;
    Declare_special(6);
    Object result;

    x_note_fn_call(126,399);
    INIT_ARGS_nonrelocating();
    just_update_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    temp =  !TRUEP(ISVREF(Current_edit_state,(SI_Long)3L));
    if (temp);
    else {
	gensymed_symbol = ISVREF(ISVREF(Current_edit_state,(SI_Long)3L),
		(SI_Long)3L);
	x = ISVREF(Current_edit_state,(SI_Long)3L);
	temp = SIMPLE_VECTOR_P(x) ? EQ(ISVREF(x,(SI_Long)1L),
		Qavailable_frame_vector) : TRUEP(Qnil);
	if (temp);
	else
	    temp = FIXNUMP(gensymed_symbol) ? IFIX(gensymed_symbol) == 
		    (SI_Long)-1L : TRUEP(Nil);
	if (temp);
	else {
	    x = gensymed_symbol;
	    y = ISVREF(Current_edit_state,(SI_Long)4L);
	    if (FIXNUMP(y))
		temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
	    else if (FIXNUMP(x))
		temp = TRUEP(Nil);
	    else {
		xa = M_CAR(y);
		ya = M_CAR(x);
		temp = FIXNUM_LT(xa,ya);
		if (temp);
		else
		    temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),M_CDR(x)) 
			    : TRUEP(Qnil);
	    }
	}
    }
    if (temp)
	return abort_current_workstation_context(Qediting);
    else if (ISVREF(Current_edit_state,(SI_Long)94L) || 
	    ISVREF(Current_edit_state,(SI_Long)95L))
	return try_to_conclude_exported_attribute_for_current_edit_state(just_update_qm);
    else {
	parse_or_bad_phrase_qm = get_current_edit_state_parse_if_any();
	parsing_completed_qm = Nil;
	operation_around_record_of_items_made_incomplete = Qedit;
	PUSH_SPECIAL(Operation_around_record_of_items_made_incomplete,operation_around_record_of_items_made_incomplete,
		5);
	  recording_items_made_incomplete_qm = 
		  EQ(Operation_around_record_of_items_made_incomplete,
		  Qedit) ? ( !TRUEP(ISVREF(Current_edit_state,
		  (SI_Long)57L)) ? T : Nil) : T;
	  PUSH_SPECIAL(Recording_items_made_incomplete_qm,recording_items_made_incomplete_qm,
		  4);
	    items_made_incomplete_were_recorded_qm = Nil;
	    PUSH_SPECIAL(Items_made_incomplete_were_recorded_qm,items_made_incomplete_were_recorded_qm,
		    3);
	      reclaim_items_made_incomplete_list();
	      current_drawing_priority = EQ(Current_drawing_transfer_mode,
		      Kpaint_infered_from_xor) ? Kdraw_as_late_as_possible 
		      : Current_drawing_priority;
	      drawing_is_locked_qm = EQ(Current_drawing_transfer_mode,
		      Kpaint_infered_from_xor) ? T : Drawing_is_locked_qm;
	      PUSH_SPECIAL(Drawing_is_locked_qm,drawing_is_locked_qm,2);
		PUSH_SPECIAL(Current_drawing_priority,current_drawing_priority,
			1);
		  text_of_definition_being_compiled = 
			  ISVREF(Current_edit_state,(SI_Long)15L);
		  PUSH_SPECIAL(Text_of_definition_being_compiled,text_of_definition_being_compiled,
			  0);
		    result = compile_for_current_edit_state(parse_or_bad_phrase_qm,
			    get_slot_value_compiler_for_current_edit_state_if_any(),
			    just_update_qm);
		    MVS_2(result,new_value_or_bad_phrase,
			    explanatory_text_string_if_bad_phrase_qm);
		    if (EQ(new_value_or_bad_phrase,Bad_phrase) &&  
			    !TRUEP(text_being_edited_may_have_no_value_p()))
			handle_uncompilable_edit_state_result( 
				!EQ(parse_or_bad_phrase_qm,Bad_phrase) ? T 
				: Nil,
				explanatory_text_string_if_bad_phrase_qm,T);
		    else {
			parsing_completed_qm = T;
			if (EQ(new_value_or_bad_phrase,Bad_phrase) || 
				ISVREF(Current_edit_state,(SI_Long)11L)) {
			    temp_1 = ISVREF(Current_edit_state,(SI_Long)9L);
			    temp_1 = memq_function(Qtext,CDDR(temp_1)) ? 
				    No_value : 
				    convert_text_to_text_string(1,
				    ISVREF(Current_edit_state,(SI_Long)15L));
			}
			else
			    temp_1 = 
				    copy_for_slot_value(new_value_or_bad_phrase);
			install_current_edit_state_compiled_result(temp_1,
				just_update_qm,Nil);
		    }
		  POP_SPECIAL();
		  if (EQ(Drawing_is_locked_qm,Qforce)) {
		      drawing_is_locked_qm = Nil;
		      PUSH_SPECIAL(Drawing_is_locked_qm,drawing_is_locked_qm,
			      0);
			force_process_drawing();
		      POP_SPECIAL();
		  }
		POP_SPECIAL();
	      POP_SPECIAL();
	      reclaim_items_made_incomplete_list();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return VALUES_1(parsing_completed_qm);
    }
}

static Object Qcategory_evaluator_interface;  /* category-evaluator-interface */

static Object string_constant_37;  /* "Unable to conclude the ~A because " */

static Object string_constant_38;  /* " was not found." */

/* TRY-TO-CONCLUDE-EXPORTED-ATTRIBUTE-FOR-CURRENT-EDIT-STATE */
Object try_to_conclude_exported_attribute_for_current_edit_state(just_update_qm)
    Object just_update_qm;
{
    Object parse_or_bad_phrase_qm, e, frame, name, virtual_attribute_qm;
    Object type_qm, category_qm, reason_not_editable_qm, do_not_change_p;
    Object category_evaluator_interface, compiled_value;
    Object collecting_denotation_errors_p, denotation_error_list;
    Object compiled_value_as_slot_value, evaluation_value, error_string_qm;
    Object error_text_qm, aliased_name, current_wide_string_list;
    Object wide_string_bv16, current_wide_string;
    Object fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object gensymed_symbol, x, y, xa, ya;
    SI_Long bv16_length, aref_arg_2, aref_new_value, length_1;
    char temp;
    Declare_special(7);
    Object result;

    x_note_fn_call(126,400);
    parse_or_bad_phrase_qm = get_current_edit_state_parse_if_any();
    e = Current_edit_state;
    frame = ISVREF(e,(SI_Long)3L);
    name = ISVREF(e,(SI_Long)5L);
    virtual_attribute_qm = ISVREF(e,(SI_Long)94L) ? 
	    get_property_value_function(3,
	    get_symbol_properties_function(name),Qvirtual_attribute,Nil) : Nil;
    type_qm =  !TRUEP(virtual_attribute_qm) ? (ISVREF(e,(SI_Long)7L) ? 
	    get_type_of_slot_component_if_any(ISVREF(e,(SI_Long)3L),
	    ISVREF(e,(SI_Long)5L),ISVREF(e,(SI_Long)6L),ISVREF(e,
	    (SI_Long)7L),ISVREF(e,(SI_Long)8L)) : 
	    get_type_of_slot_if_any(3,ISVREF(e,(SI_Long)3L),ISVREF(e,
	    (SI_Long)5L),ISVREF(e,(SI_Long)6L))) : Nil;
    category_qm = type_qm ? SECOND(type_qm) : Nil;
    reason_not_editable_qm = 
	    reason_permanent_items_module_is_not_editable(1,frame);
    do_not_change_p = EQ(parse_or_bad_phrase_qm,Bad_phrase) ? T : Nil;
    if (do_not_change_p);
    else
	do_not_change_p = reason_not_editable_qm;
    if (do_not_change_p);
    else {
	temp = virtual_attribute_qm ? TRUEP(ISVREF(virtual_attribute_qm,
		(SI_Long)7L)) : TRUEP(Qnil);
	if (temp);
	else if (category_qm) {
	    category_evaluator_interface = 
		    getfq_function_no_default(INLINE_SYMBOL_PLIST(category_qm),
		    Qcategory_evaluator_interface);
	    temp = category_evaluator_interface ? 
		    TRUEP(ISVREF(category_evaluator_interface,
		    (SI_Long)3L)) : TRUEP(Qnil);
	}
	else
	    temp = TRUEP(Nil);
	do_not_change_p =  !temp ? T : Nil;
    }
    compiled_value = do_not_change_p ? Nil : 
	    compile_item_or_datum_or_no_item_attribute_for_slot(4,
	    parse_or_bad_phrase_qm,frame,Nil,Nil);
    collecting_denotation_errors_p = T;
    PUSH_SPECIAL(Collecting_denotation_errors_p,collecting_denotation_errors_p,
	    6);
      denotation_error_list = Nil;
      PUSH_SPECIAL(Denotation_error_list,denotation_error_list,5);
	compiled_value_as_slot_value = copy_for_slot_value(compiled_value);
	evaluation_value = compiled_value &&  
		!TRUEP(Denotation_error_list) ? 
		get_evaluation_value_for_attribute(compiled_value_as_slot_value,
		Nil) : Nil;
	if ( !(do_not_change_p || Denotation_error_list)) {
	    if (virtual_attribute_qm) {
		error_string_qm = 
			conclude_into_virtual_attribute_component(frame,
			name,virtual_attribute_qm,evaluation_value,Nil,Nil);
		if ( !TRUEP(error_string_qm)) {
		    if ( !(FIXNUMP(evaluation_value) || 
			    SYMBOLP(evaluation_value) || 
			    SIMPLE_VECTOR_P(evaluation_value)))
			reclaim_if_evaluation_value_1(evaluation_value);
		}
		error_text_qm = error_string_qm;
	    }
	    else
		error_text_qm = conclude_into_attribute_component(6,frame,
			name,Nil,evaluation_value,Nil,Nil);
	}
	else
	    error_text_qm = Nil;
	reclaim_slot_value(compiled_value_as_slot_value);
	if (Denotation_error_list &&  !TRUEP(error_text_qm)) {
	    aliased_name =  !TRUEP(virtual_attribute_qm) ? 
		    get_alias_for_slot_name_if_any(name,frame) : Nil;
	    if (aliased_name);
	    else
		aliased_name = name;
	    current_wide_string_list = Qdo_not_use;
	    PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
	      wide_string_bv16 = 
		      allocate_byte_vector_16(FIX((SI_Long)2048L + 
		      (SI_Long)3L));
	      bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	      aref_arg_2 = bv16_length - (SI_Long)2L;
	      aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
	      UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	      aref_arg_2 = bv16_length - (SI_Long)1L;
	      aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	      UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	      UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
	      current_wide_string = wide_string_bv16;
	      PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
		fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
		PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
			2);
		  length_1 = 
			  IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
		  total_length_of_current_wide_string = 
			  FIX(UBYTE_16_ISAREF_1(Current_wide_string,
			  length_1 - (SI_Long)2L) + 
			  ((UBYTE_16_ISAREF_1(Current_wide_string,length_1 
			  - (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
		  PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
			  1);
		    current_twriting_output_type = Qwide_string;
		    PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
			    0);
		      tformat(2,string_constant_37,aliased_name);
		      twrite_denotation_for_item(FIRST(Denotation_error_list));
		      tformat(1,string_constant_38);
		      error_text_qm = copy_out_current_wide_string();
		    POP_SPECIAL();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	}
	if (error_text_qm) {
	    if ( !(FIXNUMP(evaluation_value) || SYMBOLP(evaluation_value) 
		    || SIMPLE_VECTOR_P(evaluation_value)))
		reclaim_if_evaluation_value_1(evaluation_value);
	}
	else {
	    if ( !TRUEP(do_not_change_p) && ISVREF(Current_edit_state,
		    (SI_Long)92L)) {
		gensymed_symbol = ISVREF(ISVREF(Current_edit_state,
			(SI_Long)92L),(SI_Long)3L);
		x = ISVREF(Current_edit_state,(SI_Long)92L);
		temp = SIMPLE_VECTOR_P(x) ? EQ(ISVREF(x,(SI_Long)1L),
			Qavailable_frame_vector) : TRUEP(Qnil);
		if (temp);
		else
		    temp = FIXNUMP(gensymed_symbol) ? 
			    IFIX(gensymed_symbol) == (SI_Long)-1L : TRUEP(Nil);
		if (temp);
		else {
		    x = gensymed_symbol;
		    y = ISVREF(Current_edit_state,(SI_Long)93L);
		    if (FIXNUMP(y))
			temp = FIXNUMP(x) ? FIXNUM_LT(y,x) : TRUEP(T);
		    else if (FIXNUMP(x))
			temp = TRUEP(Nil);
		    else {
			xa = M_CAR(y);
			ya = M_CAR(x);
			temp = FIXNUM_LT(xa,ya);
			if (temp);
			else
			    temp = FIXNUM_EQ(xa,ya) ? FIXNUM_LT(M_CDR(y),
				    M_CDR(x)) : TRUEP(Qnil);
		    }
		}
		temp =  !temp;
	    }
	    else
		temp = TRUEP(Nil);
	    if (temp)
		update_all_representations_in_table(ISVREF(Current_edit_state,
			(SI_Long)92L),frame);
	}
	if (error_text_qm)
	    result = handle_uncompilable_edit_state_result(T,error_text_qm,
		    Nil);
	else if (just_update_qm)
	    result = enable_or_disable_edit_end_and_update_buttons(Nil);
	else
	    result = return_from_current_workstation_context(1,Qediting);
      POP_SPECIAL();
    POP_SPECIAL();
    return result;
}

Object Maximum_proglem_length_to_show_in_the_editor = UNBOUND;

static Object array_constant_7;    /* # */

static Object string_constant_39;  /* "~A" */

static Object string_constant_40;  /* "There was a problem.  See the logbook for the message." */

/* HANDLE-UNCOMPILABLE-EDIT-STATE-RESULT */
Object handle_uncompilable_edit_state_result(report_problem_p,
	    explanatory_text_string_qm,compile_problem_p)
    Object report_problem_p, explanatory_text_string_qm, compile_problem_p;
{
    Object current_wide_string_list, wide_string_bv16, current_wide_string;
    Object fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object problem_string, temp;
    SI_Long bv16_length, aref_arg_2, aref_new_value, length_1;
    Declare_special(5);

    x_note_fn_call(126,401);
    if (report_problem_p) {
	current_wide_string_list = Qdo_not_use;
	PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
	  wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)2048L + 
		  (SI_Long)3L));
	  bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	  aref_arg_2 = bv16_length - (SI_Long)2L;
	  aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  aref_arg_2 = bv16_length - (SI_Long)1L;
	  aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
	  current_wide_string = wide_string_bv16;
	  PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
	    fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	    PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		    2);
	      length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
	      total_length_of_current_wide_string = 
		      FIX(UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		      (SI_Long)2L) + 
		      ((UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		      (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
	      PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
		      1);
		current_twriting_output_type = Qwide_string;
		PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
			0);
		  if (compile_problem_p)
		      twrite_beginning_of_wide_string(array_constant_7,
			      FIX((SI_Long)23L));
		  if (explanatory_text_string_qm)
		      tformat(2,string_constant_39,explanatory_text_string_qm);
		  problem_string = copy_out_current_wide_string();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	if (explanatory_text_string_qm)
	    reclaim_text_string(explanatory_text_string_qm);
	temp = Maximum_proglem_length_to_show_in_the_editor;
	if (FIXNUM_LT(temp,lengthw(problem_string))) {
	    notify_user(2,string_constant_39,problem_string);
	    problem_string = tformat_text_string(1,string_constant_40);
	}
	handle_parsing_or_compilation_problem(1,problem_string);
	reclaim_text_string(problem_string);
    }
    enable_or_disable_edit_end_and_update_buttons(Nil);
    return maybe_offer_to_save_incomplete_statement();
}

static Object Qprocedure_definition;  /* procedure-definition */

/* COMPILE-FOR-CURRENT-EDIT-STATE */
Object compile_for_current_edit_state(parse_or_bad_phrase_qm,
	    slot_value_compiler_qm,just_update_qm)
    Object parse_or_bad_phrase_qm, slot_value_compiler_qm, just_update_qm;
{
    Object frame, slot_name, defining_class_qm, slot_component_name_qm;
    Object slot_component_indicator_qm, index_of_top_of_backtrace_stack;
    Object old_top_of_stack, elements_to_push_qm, temp;
    Object stored_elements_to_push, index_1, elements_to_push_qm_old_value;
    Object temp_1, info_symbol, twrite_function_qm, number_of_args;
    Object svref_arg_2, frame_qm, phrase_copying_needs_annotation_rehashing;
    Declare_special(2);
    Object result;

    x_note_fn_call(126,402);
    frame = ISVREF(Current_edit_state,(SI_Long)3L);
    slot_name = ISVREF(Current_edit_state,(SI_Long)5L);
    defining_class_qm = ISVREF(Current_edit_state,(SI_Long)6L);
    slot_component_name_qm = ISVREF(Current_edit_state,(SI_Long)7L);
    slot_component_indicator_qm = ISVREF(Current_edit_state,(SI_Long)8L);
    if ( !TRUEP(slot_value_compiler_qm) || EQ(parse_or_bad_phrase_qm,
	    Bad_phrase))
	return VALUES_1(parse_or_bad_phrase_qm);
    else {
	index_of_top_of_backtrace_stack = Index_of_top_of_backtrace_stack;
	PUSH_SPECIAL(Index_of_top_of_backtrace_stack,index_of_top_of_backtrace_stack,
		1);
	  if (FIXNUM_LE(FIXNUM_ADD(Index_of_top_of_backtrace_stack,
		  Size_of_basic_backtrace_information),
		  Maximum_index_in_backtrace_stack_for_internal_error)) {
	      old_top_of_stack = Index_of_top_of_backtrace_stack;
	      elements_to_push_qm = Nil;
	      temp = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
	      Index_of_top_of_backtrace_stack = temp;
	      elements_to_push_qm = gensym_cons_1(slot_name,
		      elements_to_push_qm);
	      if (FIXNUM_LE(FIXNUM_ADD(Index_of_top_of_backtrace_stack,
		      Size_of_basic_backtrace_information),
		      Maximum_index_in_backtrace_stack_for_internal_error)) {
		  stored_elements_to_push = elements_to_push_qm;
		  index_1 = Index_of_top_of_backtrace_stack;
		next_loop:
		  if ( !TRUEP(elements_to_push_qm))
		      goto end_loop;
		  temp = Backtrace_stack_for_internal_error;
		  elements_to_push_qm_old_value = elements_to_push_qm;
		  temp_1 = FIRST(elements_to_push_qm_old_value);
		  elements_to_push_qm = REST(elements_to_push_qm_old_value);
		  SVREF(temp,index_1) = temp_1;
		  index_1 = FIXNUM_SUB1(index_1);
		  goto next_loop;
		end_loop:;
		  reclaim_gensym_list_1(stored_elements_to_push);
		  info_symbol = Qcompile;
		  twrite_function_qm = Qtwrite_edit_backtrace_info;
		  number_of_args = 
			  FIXNUM_MINUS(Index_of_top_of_backtrace_stack,
			  old_top_of_stack);
		  temp = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
		  Index_of_top_of_backtrace_stack = temp;
		  temp = Backtrace_stack_for_internal_error;
		  svref_arg_2 = Index_of_top_of_backtrace_stack;
		  SVREF(temp,svref_arg_2) = number_of_args;
		  temp = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
		  Index_of_top_of_backtrace_stack = temp;
		  temp = Backtrace_stack_for_internal_error;
		  svref_arg_2 = Index_of_top_of_backtrace_stack;
		  SVREF(temp,svref_arg_2) = twrite_function_qm;
		  temp = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
		  Index_of_top_of_backtrace_stack = temp;
		  temp = Backtrace_stack_for_internal_error;
		  svref_arg_2 = Index_of_top_of_backtrace_stack;
		  SVREF(temp,svref_arg_2) = info_symbol;
	      }
	      else {
		  Index_of_top_of_backtrace_stack = old_top_of_stack;
		  temp = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
		  Index_of_top_of_backtrace_stack = temp;
		  temp = Backtrace_stack_for_internal_error;
		  svref_arg_2 = Index_of_top_of_backtrace_stack;
		  SVREF(temp,svref_arg_2) = FIX((SI_Long)0L);
		  temp = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
		  Index_of_top_of_backtrace_stack = temp;
		  temp = Backtrace_stack_for_internal_error;
		  svref_arg_2 = Index_of_top_of_backtrace_stack;
		  SVREF(temp,svref_arg_2) = Nil;
		  temp = FIXNUM_ADD1(Index_of_top_of_backtrace_stack);
		  Index_of_top_of_backtrace_stack = temp;
		  temp = Backtrace_stack_for_internal_error;
		  svref_arg_2 = Index_of_top_of_backtrace_stack;
		  SVREF(temp,svref_arg_2) = Qcompile;
	      }
	  }
	  if (just_update_qm) {
	      if (EQ(ISVREF(Current_edit_state,(SI_Long)5L),
		      Qprocedure_definition)) {
		  frame_qm = ISVREF(Current_edit_state,(SI_Long)3L);
		  phrase_copying_needs_annotation_rehashing = frame_qm &&  
			  !TRUEP(frame_has_been_reprocessed_p_function(frame_qm,
			  ISVREF(Current_edit_state,(SI_Long)4L))) ? 
			  of_class_p_function(frame_qm,Qprocedure) : Qnil;
	      }
	      else
		  phrase_copying_needs_annotation_rehashing = Nil;
	      PUSH_SPECIAL(Phrase_copying_needs_annotation_rehashing,phrase_copying_needs_annotation_rehashing,
		      0);
		temp_1 = copy_for_phrase(parse_or_bad_phrase_qm);
	      POP_SPECIAL();
	  }
	  else
	      temp_1 = parse_or_bad_phrase_qm;
	  result = funcall(7,slot_value_compiler_qm,temp_1,frame,slot_name,
		  defining_class_qm,slot_component_name_qm,
		  slot_component_name_qm ? get_slot_component_group(3,
		  frame,slot_name,slot_component_indicator_qm) : Nil);
	POP_SPECIAL();
	return result;
    }
}

static Object string_constant_41;  /* "Error: could not accept edit.  The attribute ~NQ of ~NF is no longer defined." */

static Object Qslot_value_compiler;  /* slot-value-compiler */

static Object string_constant_42;  /* "Error:  Could not accept the edit for ~NF.  The new value for the attribute ~NQ ~
				    *           does not conform to its changed attribute type specification."
				    */

static Object string_constant_43;  /* "Cannot edit ~NF, because ~A.  See the saving-parameters." */

/* INSTALL-CURRENT-EDIT-STATE-COMPILED-RESULT */
Object install_current_edit_state_compiled_result(new_value,just_update_qm,
	    no_editor)
    Object new_value, just_update_qm, no_editor;
{
    Object frame, slot_name, defining_class_qm, slot_description_qm;
    Object type_of_slot_qm, slot_component_name_qm;
    Object slot_component_indicator_qm, reason_not_editable_qm, temp;
    Object sub_class_bit_vector, gensymed_symbol_3, runtime_change_p;
    Object do_not_note_permanent_changes_p;
    SI_Long superior_class_bit_number, sub_class_vector_index, gensymed_symbol;
    SI_Long gensymed_symbol_1, gensymed_symbol_2;
    char temp_1;
    Declare_special(1);

    x_note_fn_call(126,403);
    frame = ISVREF(Current_edit_state,(SI_Long)3L);
    slot_name = ISVREF(Current_edit_state,(SI_Long)5L);
    defining_class_qm = ISVREF(Current_edit_state,(SI_Long)6L);
    slot_description_qm = 
	    get_slot_description_of_class_description_function(slot_name,
	    ISVREF(frame,(SI_Long)1L),defining_class_qm);
    type_of_slot_qm = slot_description_qm ? assq_function(Qtype,
	    ISVREF(slot_description_qm,(SI_Long)9L)) : Qnil;
    slot_component_name_qm = ISVREF(Current_edit_state,(SI_Long)7L);
    slot_component_indicator_qm = ISVREF(Current_edit_state,(SI_Long)8L);
    reason_not_editable_qm = slot_description_qm ? 
	    reason_permanent_items_attribute_is_not_editable(4,frame,
	    slot_name,Nil,slot_description_qm) : Nil;
    temp = ISVREF(Current_edit_state,(SI_Long)9L);
    if (memq_function(Qtext,CDDR(temp)) && EQ(ISVREF(Current_edit_state,
	    (SI_Long)5L),Qbox_translation_and_text) &&  
	    !TRUEP(just_update_qm) && 
	    text_blank_p(ISVREF(Current_edit_state,(SI_Long)15L)) && frame) {
	sub_class_bit_vector = ISVREF(ISVREF(frame,(SI_Long)1L),(SI_Long)19L);
	superior_class_bit_number = 
		IFIX(ISVREF(Type_in_box_class_description,(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_1 = (SI_Long)1L;
	    gensymed_symbol_2 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_1 = gensymed_symbol_1 << gensymed_symbol_2;
	    gensymed_symbol = gensymed_symbol & gensymed_symbol_1;
	    temp_1 = (SI_Long)0L < gensymed_symbol;
	}
	else
	    temp_1 = TRUEP(Nil);
	temp_1 =  !temp_1;
    }
    else
	temp_1 = TRUEP(Nil);
    if (temp_1) {
	sub_class_bit_vector = ISVREF(ISVREF(frame,(SI_Long)1L),(SI_Long)19L);
	superior_class_bit_number = IFIX(ISVREF(Message_class_description,
		(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_1 = (SI_Long)1L;
	    gensymed_symbol_2 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_1 = gensymed_symbol_1 << gensymed_symbol_2;
	    gensymed_symbol = gensymed_symbol & gensymed_symbol_1;
	    temp_1 = (SI_Long)0L < gensymed_symbol;
	}
	else
	    temp_1 = TRUEP(Nil);
	temp_1 =  !temp_1;
    }
    else
	temp_1 = TRUEP(Nil);
    if (temp_1 ?  !TRUEP(ISVREF(Current_edit_state,(SI_Long)57L)) : 
		TRUEP(Nil)) {
	delete_frame(frame);
	temp = Nil;
    }
    else if ( !TRUEP(slot_description_qm)) {
	handle_uncompilable_edit_state_result(T,tformat_text_string(4,
		string_constant_41,slot_name,defining_class_qm,frame),Nil);
	return VALUES_1(Nil);
    }
    else {
	if (ISVREF(slot_description_qm,(SI_Long)8L)) {
	    temp = ISVREF(Current_edit_state,(SI_Long)9L);
	    temp_1 =  !EQUAL(temp,type_of_slot_qm);
	}
	else
	    temp_1 = TRUEP(Nil);
	if (temp_1) {
	    gensymed_symbol_3 = SECOND(type_of_slot_qm);
	    temp = 
		    getfq_function_no_default(INLINE_SYMBOL_PLIST(gensymed_symbol_3),
		    Qslot_value_compiler);
	    temp = FUNCALL_3(temp,new_value,frame,Nil);
	    temp_1 = EQ(temp,Bad_phrase);
	}
	else
	    temp_1 = TRUEP(Nil);
	if (temp_1) {
	    handle_uncompilable_edit_state_result(T,tformat_text_string(4,
		    string_constant_42,frame,slot_name,defining_class_qm),Nil);
	    return VALUES_1(Nil);
	}
	else if (reason_not_editable_qm) {
	    handle_uncompilable_edit_state_result(T,tformat_text_string(3,
		    string_constant_43,frame,reason_not_editable_qm),Nil);
	    return VALUES_1(Nil);
	}
	else {
	    runtime_change_p = ISVREF(Current_edit_state,(SI_Long)57L);
	    temp = Do_not_note_permanent_changes_p;
	    if (temp);
	    else
		temp = runtime_change_p;
	    do_not_note_permanent_changes_p = temp;
	    PUSH_SPECIAL(Do_not_note_permanent_changes_p,do_not_note_permanent_changes_p,
		    0);
	      if (runtime_change_p)
		  note_kb_state_change_to_slot_by_saving_text(frame,
			  slot_description_qm);
	      else
		  update_authors_and_time_of_frame_edit(frame,
			  slot_description_qm);
	      temp = ISVREF(Current_edit_state,(SI_Long)9L);
	      change_slot_description_value_function(frame,
		      slot_description_qm,memq_function(Qtext,CDDR(temp)) ?
		       (no_editor ? gensym_cons_1(new_value,
		      ISVREF(Current_edit_state,(SI_Long)15L)) : 
		      make_text_value_using_current_edit_state(new_value,
		      just_update_qm)) : new_value,slot_component_name_qm,
		      slot_component_indicator_qm);
	      update_change_log_attribute(frame,slot_description_qm,
		      runtime_change_p);
	      temp = Nil;
	    POP_SPECIAL();
	}
    }
    if ( !TRUEP(no_editor)) {
	if (just_update_qm)
	    enable_or_disable_edit_end_and_update_buttons(Nil);
	else
	    return_from_current_workstation_context(1,Qediting);
	offer_to_recompile_items_made_incomplete_if_appropriate();
    }
    return VALUES_1(temp);
}

/* MAKE-TEXT-VALUE-USING-CURRENT-EDIT-STATE */
Object make_text_value_using_current_edit_state(new_value,just_update_qm)
    Object new_value, just_update_qm;
{
    Object temp, cdr_arg;

    x_note_fn_call(126,404);
    if (just_update_qm)
	temp = copy_text(ISVREF(Current_edit_state,(SI_Long)15L));
    else {
	cdr_arg = ISVREF(ISVREF(Current_edit_state,(SI_Long)13L),(SI_Long)16L);
	M_CDR(cdr_arg) = Nil;
	temp = ISVREF(Current_edit_state,(SI_Long)15L);
    }
    temp = gensym_cons_1(new_value,temp);
    return VALUES_1(temp);
}

static Object Qallow_text_slot_to_have_no_value;  /* allow-text-slot-to-have-no-value */

/* TEXT-BEING-EDITED-MAY-HAVE-NO-VALUE-P */
Object text_being_edited_may_have_no_value_p()
{
    Object e, temp;

    x_note_fn_call(126,405);
    e = Current_edit_state;
    temp = ISVREF(e,(SI_Long)9L);
    if (memq_function(Qtext,CDDR(temp)))
	return assq_function(Qallow_text_slot_to_have_no_value,ISVREF(e,
		(SI_Long)7L) ? get_slot_component_features(ISVREF(e,
		(SI_Long)5L),ISVREF(e,(SI_Long)6L),ISVREF(e,(SI_Long)7L)) :
		 
		ISVREF(get_slot_description_of_class_description_function(ISVREF(e,
		(SI_Long)5L),ISVREF(ISVREF(e,(SI_Long)3L),(SI_Long)1L),
		ISVREF(e,(SI_Long)6L)),(SI_Long)9L));
    else
	return VALUES_1(Nil);
}

static Object Qtype_in_box_input_value;  /* type-in-box-input-value */

/* GET-SLOT-VALUE-COMPILER-FOR-CURRENT-EDIT-STATE-IF-ANY */
Object get_slot_value_compiler_for_current_edit_state_if_any()
{
    Object e, frame, slot_name, sub_class_bit_vector, temp_1, temp_2;
    Object gensymed_symbol_3;
    SI_Long superior_class_bit_number, sub_class_vector_index, gensymed_symbol;
    SI_Long gensymed_symbol_1, gensymed_symbol_2;
    char temp;

    x_note_fn_call(126,406);
    e = Current_edit_state;
    frame = ISVREF(e,(SI_Long)3L);
    slot_name = ISVREF(e,(SI_Long)5L);
    if ( !TRUEP(ISVREF(e,(SI_Long)11L))) {
	sub_class_bit_vector = ISVREF(ISVREF(frame,(SI_Long)1L),(SI_Long)19L);
	superior_class_bit_number = 
		IFIX(ISVREF(Type_in_box_class_description,(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_1 = (SI_Long)1L;
	    gensymed_symbol_2 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_1 = gensymed_symbol_1 << gensymed_symbol_2;
	    gensymed_symbol = gensymed_symbol & gensymed_symbol_1;
	    temp = (SI_Long)0L < gensymed_symbol;
	}
	else
	    temp = TRUEP(Nil);
	temp = temp ? EQ(slot_name,Qtype_in_box_input_value) : TRUEP(Nil);
	if (temp);
	else {
	    temp_1 = ISVREF(e,(SI_Long)9L);
	    temp_2 = ISVREF(e,(SI_Long)7L) ? 
		    get_type_of_slot_component_if_any(frame,slot_name,
		    ISVREF(e,(SI_Long)6L),ISVREF(e,(SI_Long)7L),ISVREF(e,
		    (SI_Long)8L)) : get_type_of_slot_if_any(3,frame,
		    slot_name,ISVREF(e,(SI_Long)6L));
	    temp = EQUAL(temp_1,temp_2);
	}
    }
    else
	temp = TRUEP(Nil);
    if (temp) {
	temp_2 = ISVREF(e,(SI_Long)9L);
	gensymed_symbol_3 = SECOND(temp_2);
	temp_2 = 
		getfq_function_no_default(INLINE_SYMBOL_PLIST(gensymed_symbol_3),
		Qslot_value_compiler);
    }
    else
	temp_2 = Nil;
    return VALUES_1(temp_2);
}

/* GET-CURRENT-EDIT-STATE-PARSE-IF-ANY */
Object get_current_edit_state_parse_if_any()
{
    Object incomplete_phrase, temp, ab_loop_list_, instances_of_category;
    Object ab_loopvar_, ab_loopvar__1;

    x_note_fn_call(126,407);
    if ( !TRUEP(ISVREF(Current_edit_state,(SI_Long)11L))) {
	incomplete_phrase = Nil;
	temp = ISVREF(Current_edit_state,(SI_Long)31L);
	ab_loop_list_ = CAR(temp);
	instances_of_category = Nil;
	ab_loopvar_ = Nil;
	ab_loopvar__1 = Nil;
      next_loop:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	incomplete_phrase = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	if (EQ(ISVREF(incomplete_phrase,(SI_Long)1L),
		ISVREF(Current_edit_state,(SI_Long)30L))) {
	    temp = ISVREF(incomplete_phrase,(SI_Long)2L);
	    ab_loopvar__1 = phrase_cons(CAR(temp),Nil);
	    if (ab_loopvar_)
		M_CDR(ab_loopvar_) = ab_loopvar__1;
	    else
		instances_of_category = ab_loopvar__1;
	    ab_loopvar_ = ab_loopvar__1;
	}
	goto next_loop;
      end_loop:
	if ( !TRUEP(instances_of_category)) {
	    home_down_cursor();
	    handle_parsing_or_compilation_problem(1,string_constant_29);
	    temp = Bad_phrase;
	}
	else if (CDR(instances_of_category)) {
	    handle_parsing_ambiguity(instances_of_category);
	    temp = Bad_phrase;
	}
	else
	    temp = CAR(instances_of_category);
	goto end_1;
	temp = Qnil;
      end_1:;
    }
    else
	temp = Nil;
    return VALUES_1(temp);
}

static Object string_constant_44;  /* "This is ambiguous in G2" */

/* HANDLE-PARSING-AMBIGUITY */
Object handle_parsing_ambiguity(instances_of_category)
    Object instances_of_category;
{
    x_note_fn_call(126,408);
    return handle_parsing_or_compilation_problem(1,string_constant_44);
}

/* MAYBE-OFFER-TO-SAVE-INCOMPLETE-STATEMENT */
Object maybe_offer_to_save_incomplete_statement()
{
    x_note_fn_call(126,409);
    return VALUES_1(Nil);
}

/* EXCLUDE-EDITOR-PROMPT-P */
Object exclude_editor_prompt_p(prompt)
    Object prompt;
{
    Object exclusions, exclusion, ab_loop_list_, ab_loop_it_;

    x_note_fn_call(126,410);
    exclusions = ISVREF(Current_edit_state,(SI_Long)99L);
    if ( !TRUEP(exclusions))
	return VALUES_1(Nil);
    else if (ATOM(prompt)) {
	exclusion = Nil;
	ab_loop_list_ = exclusions;
	ab_loop_it_ = Nil;
      next_loop:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	exclusion = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	ab_loop_it_ = EQ(prompt,CAR(exclusion)) ? T : Nil;
	if (ab_loop_it_)
	    return VALUES_1(ab_loop_it_);
	goto next_loop;
      end_loop:
	return VALUES_1(Qnil);
    }
    else {
	exclusion = Nil;
	ab_loop_list_ = exclusions;
	ab_loop_it_ = Nil;
      next_loop_1:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop_1;
	exclusion = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	ab_loop_it_ = list_prefix_p(exclusion,prompt);
	if (ab_loop_it_)
	    return VALUES_1(ab_loop_it_);
	goto next_loop_1;
      end_loop_1:
	return VALUES_1(Qnil);
    }
}

/* FILTER-EDITOR-MENUS */
Object filter_editor_menus(menus)
    Object menus;
{
    Object category_symbols, submenus, category, ab_loop_list_, ab_loopvar_;
    Object ab_loopvar__1, ab_loopvar__2, filtered_categories, submenu;
    Object upcase_qm, filtered, phrase, ab_loop_list__1, ab_loopvar__3;
    Object ab_loopvar__4, filtered_submenus, temp;
    char end_qm;

    x_note_fn_call(126,411);
    end_qm = EQ(CAR(menus),Qend);
    category_symbols = end_qm ? CADR(menus) : CAR(menus);
    submenus = end_qm ? CDDR(menus) : CDR(menus);
    category = Nil;
    ab_loop_list_ = category_symbols;
    ab_loopvar_ = Nil;
    ab_loopvar__1 = Nil;
    ab_loopvar__2 = Nil;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    category = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    if ( !TRUEP(exclude_editor_prompt_p(category))) {
	ab_loopvar__2 = gensym_cons_1(category,Nil);
	if (ab_loopvar__1)
	    M_CDR(ab_loopvar__1) = ab_loopvar__2;
	else
	    ab_loopvar_ = ab_loopvar__2;
	ab_loopvar__1 = ab_loopvar__2;
    }
    goto next_loop;
  end_loop:
    filtered_categories = ab_loopvar_;
    goto end_1;
    filtered_categories = Qnil;
  end_1:;
    submenu = Nil;
    ab_loop_list_ = submenus;
    upcase_qm = Nil;
    filtered = Nil;
    ab_loopvar_ = Nil;
    ab_loopvar__1 = Nil;
    ab_loopvar__2 = Nil;
  next_loop_1:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop_1;
    submenu = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    upcase_qm = EQ(CAR(submenu),Kupcase) ? T : Nil;
    phrase = Nil;
    ab_loop_list__1 = upcase_qm ? CDR(submenu) : submenu;
    ab_loopvar__2 = Nil;
    ab_loopvar__3 = Nil;
    ab_loopvar__4 = Nil;
  next_loop_2:
    if ( !TRUEP(ab_loop_list__1))
	goto end_loop_2;
    phrase = M_CAR(ab_loop_list__1);
    ab_loop_list__1 = M_CDR(ab_loop_list__1);
    if ( !TRUEP(exclude_editor_prompt_p(phrase))) {
	ab_loopvar__4 = 
		gensym_cons_1(copy_tree_using_gensym_conses_1(phrase),Nil);
	if (ab_loopvar__3)
	    M_CDR(ab_loopvar__3) = ab_loopvar__4;
	else
	    ab_loopvar__2 = ab_loopvar__4;
	ab_loopvar__3 = ab_loopvar__4;
    }
    goto next_loop_2;
  end_loop_2:
    filtered = ab_loopvar__2;
    goto end_2;
    filtered = Qnil;
  end_2:;
    if (filtered) {
	ab_loopvar__2 = gensym_cons_1(upcase_qm ? gensym_cons_1(Kupcase,
		filtered) : filtered,Nil);
	if (ab_loopvar__1)
	    M_CDR(ab_loopvar__1) = ab_loopvar__2;
	else
	    ab_loopvar_ = ab_loopvar__2;
	ab_loopvar__1 = ab_loopvar__2;
    }
    goto next_loop_1;
  end_loop_1:
    filtered_submenus = ab_loopvar_;
    goto end_3;
    filtered_submenus = Qnil;
  end_3:;
    temp = end_qm ? gensym_cons_1(Qend,Nil) : Nil;
    return VALUES_1(nconc2(temp,nconc2(gensym_cons_1(filtered_categories,
	    Nil),filtered_submenus)));
}

static Object string_constant_45;  /* "~A~A" */

static Object string_constant_46;  /* "~A~A~A" */

/* UPDATE-EDIT-MENUS-OR-AUTOCOMPLETE-AS-APPROPRIATE */
Object update_edit_menus_or_autocomplete_as_appropriate(potential_token_types_qm,
	    prefix_simple_string_qm,parsing_extension_mode)
    Object potential_token_types_qm, prefix_simple_string_qm;
    Object parsing_extension_mode;
{
    Object temp, temporary_information_on_edit_workspace_qm;
    Object menu_content_structure_for_token_position, munge_colons_p;
    Object string_for_make_category_instance_menus, temp_1, temp_2;
    Object category_instance_menus;
    Object menu_content_structure_for_character_position, menus, frame;
    Object sub_vector_qm, function_qm, gensymed_symbol, gensymed_symbol_1;
    Object gensymed_symbol_2, gensymed_symbol_3, gensymed_symbol_4;
    Object token_or_token_sequence, current_wide_string_list, wide_string_bv16;
    Object current_wide_string, fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object write_symbols_parsably_qm, write_symbols_in_lower_case_qm;
    Object schar_arg_2, schar_new_value, token, ab_loop_list_, text_string;
    Object keep_category_menu_qm;
    SI_Long method_index, bv16_length, aref_arg_2, aref_new_value, length_1;
    SI_Long thing;
    char endable_here_qm, temp_3;
    Declare_special(7);

    x_note_fn_call(126,412);
    if (current_workstation_has_pending_events_p() || 
	    Keep_edit_workspace_hidden_no_matter_what_qm) {
	temp = Current_edit_state;
	return VALUES_1(SVREF(temp,FIX((SI_Long)27L)) = 
		parsing_extension_mode);
    }
    else {
	temporary_information_on_edit_workspace_qm = 
		ISVREF(Current_edit_state,(SI_Long)33L);
	menu_content_structure_for_token_position = 
		get_or_make_menu_content_structure_for_current_token_position();
	if (colon_content_p(menu_content_structure_for_token_position))
	    munge_colons_p = FIX((SI_Long)1L);
	else if (colon_content_p(get_menu_content_structure_for_last_token_position(FIX((SI_Long)1L))))
	    munge_colons_p = FIX((SI_Long)2L);
	else
	    munge_colons_p = Qnil;
	if ( !TRUEP(munge_colons_p))
	    string_for_make_category_instance_menus = prefix_simple_string_qm;
	else if (EQ(FIX((SI_Long)1L),munge_colons_p)) {
	    temp_1 = ISVREF(Current_edit_state,(SI_Long)54L);
	    string_for_make_category_instance_menus = 
		    tformat_text_string(3,string_constant_45,CAR(temp_1),
		    prefix_simple_string_qm);
	}
	else if (EQ(FIX((SI_Long)2L),munge_colons_p)) {
	    temp_2 = ISVREF(Current_edit_state,(SI_Long)54L);
	    temp_1 = ISVREF(Current_edit_state,(SI_Long)54L);
	    string_for_make_category_instance_menus = 
		    tformat_text_string(4,string_constant_46,CADR(temp_2),
		    CAR(temp_1),prefix_simple_string_qm);
	}
	else
	    string_for_make_category_instance_menus = Qnil;
	if ( !EQ(Qend,CAR(menu_content_structure_for_token_position)))
	    temp_2 = CAR(menu_content_structure_for_token_position);
	else if ( !TRUEP(munge_colons_p))
	    temp_2 = CADR(menu_content_structure_for_token_position);
	else {
	    temp_1 = 
		    get_menu_content_structure_for_last_token_position(munge_colons_p);
	    temp_2 = CAR(temp_1);
	}
	temp_1 = ISVREF(Current_edit_state,(SI_Long)71L);
	if (temp_1);
	else
	    temp_1 = ISVREF(Editor_parameters,(SI_Long)22L);
	category_instance_menus = make_category_instance_menus(temp_2,
		string_for_make_category_instance_menus,temp_1);
	if (potential_token_types_qm)
	    temp_1 = 
		    make_menu_content_structure_for_character_position(menu_content_structure_for_token_position,
		    potential_token_types_qm,prefix_simple_string_qm);
	else if (category_instance_menus)
	    temp_1 = 
		    copy_list_using_gensym_conses_1(menu_content_structure_for_token_position);
	else
	    temp_1 = menu_content_structure_for_token_position;
	menu_content_structure_for_character_position = nconc2(temp_1,
		category_instance_menus);
	endable_here_qm = 
		EQ(CAR(menu_content_structure_for_character_position),Qend);
	menus = endable_here_qm ? 
		CDR(menu_content_structure_for_character_position) : 
		menu_content_structure_for_character_position;
	enable_or_disable_edit_end_and_update_buttons( !endable_here_qm ? 
		T : Nil);
	if (ISVREF(Current_edit_state,(SI_Long)3L)) {
	    method_index = (SI_Long)42L;
	    frame = ISVREF(Current_edit_state,(SI_Long)3L);
	    sub_vector_qm = ISVREF(ISVREF(ISVREF(frame,(SI_Long)1L),
		    (SI_Long)11L),method_index);
	    function_qm = sub_vector_qm ? ISVREF(sub_vector_qm,
		    (SI_Long)1L) : Nil;
	    if (function_qm) {
		gensymed_symbol = function_qm;
		gensymed_symbol_1 = frame;
		gensymed_symbol_2 = Current_edit_workspace;
		gensymed_symbol_3 = ISVREF(Current_edit_state,(SI_Long)13L);
		gensymed_symbol_4 = T;
		inline_funcall_4(gensymed_symbol,gensymed_symbol_1,
			gensymed_symbol_2,gensymed_symbol_3,gensymed_symbol_4);
	    }
	}
	if (munge_colons_p)
	    reclaim_text_string(string_for_make_category_instance_menus);
	procedure_signature_hook();
	if (ISVREF(Current_edit_state,(SI_Long)58L)) {
	    delete_subblocks_of_class(Current_edit_workspace,
		    Qeditor_notification);
	    shrink_wrap_workspace(Current_edit_workspace);
	    if ( !EQ(menu_content_structure_for_token_position,
		    menu_content_structure_for_character_position))
		reclaim_menu_content_structure_for_character_position(menu_content_structure_for_character_position);
	    return VALUES_1(T);
	}
	else {
	    if ( !endable_here_qm &&  !TRUEP(FIRST(menus)) && CDR(menus) 
		    &&  !TRUEP(CDDR(menus))) {
		temp_1 = SECOND(menus);
		temp_3 =  !TRUEP(CDR(temp_1));
	    }
	    else
		temp_3 = TRUEP(Nil);
	    if ((temp_3 ? TRUEP(Nil) : TRUEP(Nil)) ?  
		    !EQ(parsing_extension_mode,Qno_autocompletion) : 
		    TRUEP(Nil)) {
		temp_1 = SECOND(menus);
		token_or_token_sequence = FIRST(temp_1);
		current_wide_string_list = Qdo_not_use;
		PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,
			6);
		  wide_string_bv16 = 
			  allocate_byte_vector_16(FIX((SI_Long)2048L + 
			  (SI_Long)3L));
		  bv16_length = 
			  IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
		  aref_arg_2 = bv16_length - (SI_Long)2L;
		  aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
		  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,
			  aref_new_value);
		  aref_arg_2 = bv16_length - (SI_Long)1L;
		  aref_new_value = (SI_Long)57344L | (SI_Long)0L;
		  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,
			  aref_new_value);
		  UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,
			  (SI_Long)0L);
		  current_wide_string = wide_string_bv16;
		  PUSH_SPECIAL(Current_wide_string,current_wide_string,5);
		    fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
		    PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
			    4);
		      length_1 = 
			      IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
		      total_length_of_current_wide_string = 
			      FIX(UBYTE_16_ISAREF_1(Current_wide_string,
			      length_1 - (SI_Long)2L) + 
			      ((UBYTE_16_ISAREF_1(Current_wide_string,
			      length_1 - (SI_Long)1L) & (SI_Long)8191L) << 
			      (SI_Long)16L));
		      PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
			      3);
			current_twriting_output_type = Qwide_string;
			PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
				2);
			  write_symbols_parsably_qm = T;
			  write_symbols_in_lower_case_qm = T;
			  PUSH_SPECIAL(Write_symbols_in_lower_case_qm,write_symbols_in_lower_case_qm,
				  1);
			    PUSH_SPECIAL(Write_symbols_parsably_qm,write_symbols_parsably_qm,
				    0);
			      if (ATOM(token_or_token_sequence)) {
				  twrite(token_or_token_sequence);
				  if (EQ(Current_twriting_output_type,
					  Qwide_string)) {
				      thing = (SI_Long)32L;
				      twrite_wide_character(CHARACTERP(FIX(thing)) 
					      ? CHAR_CODE(FIX(thing)) : 
					      FIX(thing));
				  }
				  else {
				      if ( 
					      !FIXNUM_LT(Fill_pointer_for_current_gensym_string,
					      Total_length_of_current_gensym_string))
					  extend_current_gensym_string(0);
				      temp = Current_gensym_string;
				      schar_arg_2 = 
					      Fill_pointer_for_current_gensym_string;
				      thing = (SI_Long)32L;
				      schar_new_value = 
					      CODE_CHAR(CHARACTERP(FIX(thing)) 
					      ? CHAR_CODE(FIX(thing)) : 
					      FIX(thing));
				      SET_SCHAR(temp,schar_arg_2,
					      schar_new_value);
				      temp = 
					      FIXNUM_ADD1(Fill_pointer_for_current_gensym_string);
				      Fill_pointer_for_current_gensym_string 
					      = temp;
				  }
			      }
			      else {
				  token = Nil;
				  ab_loop_list_ = token_or_token_sequence;
				next_loop:
				  if ( !TRUEP(ab_loop_list_))
				      goto end_loop;
				  token = M_CAR(ab_loop_list_);
				  ab_loop_list_ = M_CDR(ab_loop_list_);
				  twrite(token);
				  if (EQ(Current_twriting_output_type,
					  Qwide_string)) {
				      thing = (SI_Long)32L;
				      twrite_wide_character(CHARACTERP(FIX(thing)) 
					      ? CHAR_CODE(FIX(thing)) : 
					      FIX(thing));
				  }
				  else {
				      if ( 
					      !FIXNUM_LT(Fill_pointer_for_current_gensym_string,
					      Total_length_of_current_gensym_string))
					  extend_current_gensym_string(0);
				      temp = Current_gensym_string;
				      schar_arg_2 = 
					      Fill_pointer_for_current_gensym_string;
				      thing = (SI_Long)32L;
				      schar_new_value = 
					      CODE_CHAR(CHARACTERP(FIX(thing)) 
					      ? CHAR_CODE(FIX(thing)) : 
					      FIX(thing));
				      SET_SCHAR(temp,schar_arg_2,
					      schar_new_value);
				      temp = 
					      FIXNUM_ADD1(Fill_pointer_for_current_gensym_string);
				      Fill_pointer_for_current_gensym_string 
					      = temp;
				  }
				  goto next_loop;
				end_loop:;
			      }
			    POP_SPECIAL();
			  POP_SPECIAL();
			  text_string = copy_out_current_wide_string();
			POP_SPECIAL();
		      POP_SPECIAL();
		    POP_SPECIAL();
		  POP_SPECIAL();
		POP_SPECIAL();
		if ( !EQ(menu_content_structure_for_character_position,
			temporary_information_on_edit_workspace_qm))
		    reclaim_menu_content_structure_for_character_position(menu_content_structure_for_character_position);
		insert_text_string_at_cursor(3,text_string,T,T);
		reclaim_text_string(text_string);
		return VALUES_1(T);
	    }
	    else {
		if (EQUAL(menu_content_structure_for_character_position,
			temporary_information_on_edit_workspace_qm)) {
		    if ( !EQ(menu_content_structure_for_character_position,
			    temporary_information_on_edit_workspace_qm))
			reclaim_menu_content_structure_for_character_position(menu_content_structure_for_character_position);
		}
		else {
		    if (CONSP(temporary_information_on_edit_workspace_qm) 
			    &&  
			    !EQ(CAR(temporary_information_on_edit_workspace_qm),
			    Qend)) {
			temp_2 = 
				CAR(menu_content_structure_for_character_position);
			temp_1 = 
				CAR(temporary_information_on_edit_workspace_qm);
			keep_category_menu_qm = EQUAL(temp_2,temp_1) ? T : Nil;
		    }
		    else
			keep_category_menu_qm = Nil;
		    erase_any_temporary_information_on_edit_workspace(1,
			    keep_category_menu_qm);
		    put_up_menus(menus,endable_here_qm ? T : Nil,
			    keep_category_menu_qm);
		    temp = Current_edit_state;
		    SVREF(temp,FIX((SI_Long)33L)) = 
			    menu_content_structure_for_character_position;
		}
		temp_1 = CAR(menus);
		if (temp_1)
		    return VALUES_1(temp_1);
		else
		    return VALUES_1(CDR(menus));
	    }
	}
    }
}

static Object list_constant_14;    /* # */

/* COLON-CONTENT-P */
Object colon_content_p(content)
    Object content;
{
    Object temp;

    x_note_fn_call(126,413);
    if (EQ(Qend,CAR(content))) {
	temp = CADDR(content);
	return VALUES_1(EQUAL(list_constant_14,temp) ? T : Nil);
    }
    else
	return VALUES_1(Nil);
}

/* GET-OR-MAKE-MENU-CONTENT-STRUCTURE-FOR-CURRENT-TOKEN-POSITION */
Object get_or_make_menu_content_structure_for_current_token_position()
{
    Object temp, car_arg, car_new_value;

    x_note_fn_call(126,414);
    temp = ISVREF(Current_edit_state,(SI_Long)32L);
    temp = CAR(temp);
    if (temp)
	return VALUES_1(temp);
    else {
	car_arg = ISVREF(Current_edit_state,(SI_Long)32L);
	temp = ISVREF(Current_edit_state,(SI_Long)31L);
	car_new_value = 
		make_menu_content_structure_for_token_position(CAR(temp),
		ISVREF(Current_edit_state,(SI_Long)30L));
	return VALUES_1(M_CAR(car_arg) = car_new_value);
    }
}

/* GET-MENU-CONTENT-STRUCTURE-FOR-LAST-TOKEN-POSITION */
Object get_menu_content_structure_for_last_token_position(n_1)
    Object n_1;
{
    x_note_fn_call(126,415);
    return nth(n_1,ISVREF(Current_edit_state,(SI_Long)32L));
}

/* RECLAIM-MENU-CONTENT-STRUCTURE-FOR-CHARACTER-POSITION */
Object reclaim_menu_content_structure_for_character_position(menu_content_structure_for_character_position)
    Object menu_content_structure_for_character_position;
{
    Object temp, menu_content_structure_for_current_token_position;
    Object menu_content_element, ab_loop_list_, last_1, next_qm, cdr_new_value;

    x_note_fn_call(126,416);
    temp = ISVREF(Current_edit_state,(SI_Long)32L);
    menu_content_structure_for_current_token_position = CAR(temp);
    if ( !EQ(menu_content_structure_for_character_position,
	    menu_content_structure_for_current_token_position)) {
	menu_content_element = Nil;
	ab_loop_list_ = menu_content_structure_for_character_position;
      next_loop:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	menu_content_element = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	if ( !TRUEP(memq_function(menu_content_element,
		menu_content_structure_for_current_token_position)))
	    reclaim_gensym_tree_1(menu_content_element);
	goto next_loop;
      end_loop:
	if (menu_content_structure_for_character_position) {
	    last_1 = menu_content_structure_for_character_position;
	    next_qm = Nil;
	  next_loop_1:
	    next_qm = M_CDR(last_1);
	    if ( !TRUEP(next_qm))
		goto end_loop_1;
	    inline_note_reclaim_cons(last_1,Qab_gensym);
	    last_1 = next_qm;
	    goto next_loop_1;
	  end_loop_1:
	    inline_note_reclaim_cons(last_1,Qab_gensym);
	    cdr_new_value = Available_gensym_conses;
	    M_CDR(last_1) = cdr_new_value;
	    Available_gensym_conses = 
		    menu_content_structure_for_character_position;
	}
	return VALUES_1(Qnil);
    }
    else
	return VALUES_1(Nil);
}

/* PUT-UP-MENUS */
Object put_up_menus(menu_content_structure,endable_here_qm,
	    category_menu_is_already_there_qm)
    Object menu_content_structure, endable_here_qm;
    Object category_menu_is_already_there_qm;
{
    Object filtered_menus, temp;

    x_note_fn_call(126,417);
    if (Current_edit_state && ISVREF(Current_edit_state,(SI_Long)99L)) {
	filtered_menus = filter_editor_menus(menu_content_structure);
	temp = put_up_menus_1(filtered_menus,endable_here_qm,
		category_menu_is_already_there_qm);
	reclaim_gensym_tree_1(filtered_menus);
	return VALUES_1(temp);
    }
    else
	return put_up_menus_1(menu_content_structure,endable_here_qm,
		category_menu_is_already_there_qm);
}

/* PUT-UP-MENUS-1 */
Object put_up_menus_1(menu_content_structure,endable_here_qm,
	    category_menu_is_already_there_qm)
    Object menu_content_structure, endable_here_qm;
    Object category_menu_is_already_there_qm;
{
    Object category_menu, existing_category_menu_qm, l, menu_1, ab_loopvar_;
    Object ab_loopvar__1, ab_loopvar__2, l_old_value, new_cons;
    Object gensymed_symbol, gensymed_symbol_1, ab_queue_form_;
    Object ab_next_queue_element_, subblock, sub_class_bit_vector, temp_1;
    Object temp_2, ab_loopvar__3, ab_loopvar__4, list_of_onesies, last_1;
    Object next_qm, menus, workspace_margin, edit_box, left_edge_of_menu_area;
    Object current_left_edge_of_menu_area, current_top_edge_of_menu_area;
    Object current_right_edge_of_menu_area, current_bottom_edge_of_menu_area;
    Object ab_loop_list_, left_edge_of_menu, top_edge_of_menu;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_2, gensymed_symbol_3, gensymed_symbol_4;
    SI_Long amount_by_which_width_can_exceed_height, intermenu_spacing;
    SI_Long top_edge_of_menu_area;
    char temp;

    x_note_fn_call(126,418);
    if (native_editor_workspace_p(Current_edit_workspace))
	native_editor_show_completions(Current_edit_state,
		menu_content_structure);
    category_menu = CAR(menu_content_structure);
    existing_category_menu_qm = Nil;
    l = menu_content_structure;
    menu_1 = Nil;
    ab_loopvar_ = Nil;
    ab_loopvar__1 = Nil;
    ab_loopvar__2 = Nil;
  next_loop:
    menu_1 = CAR(l);
    if (endable_here_qm) {
	endable_here_qm = Nil;
	ab_loopvar__2 = Nil;
    }
    else if (EQ(menu_1,category_menu)) {
	l_old_value = l;
	l = REST(l_old_value);
	if (category_menu &&  !EQUAL(category_menu,list_constant_12)) {
	    new_cons = Available_gensym_conses;
	    if (new_cons) {
		Available_gensym_conses = M_CDR(new_cons);
		gensymed_symbol = new_cons;
	    }
	    else
		gensymed_symbol = Nil;
	    if ( !TRUEP(gensymed_symbol))
		gensymed_symbol = replenish_gensym_cons_pool();
	    if (category_menu_is_already_there_qm) {
		gensymed_symbol_1 = ISVREF(Current_edit_workspace,
			(SI_Long)14L);
		gensymed_symbol_1 = gensymed_symbol_1 ? 
			ISVREF(gensymed_symbol_1,(SI_Long)4L) : Nil;
		ab_queue_form_ = gensymed_symbol_1;
		ab_next_queue_element_ = Nil;
		subblock = Nil;
		if (ab_queue_form_)
		    ab_next_queue_element_ = ISVREF(ab_queue_form_,
			    (SI_Long)0L);
	      next_loop_1:
		if (EQ(ab_next_queue_element_,ab_queue_form_))
		    goto end_loop;
		subblock = ISVREF(ab_next_queue_element_,(SI_Long)2L);
		ab_next_queue_element_ = ISVREF(ab_next_queue_element_,
			(SI_Long)0L);
		sub_class_bit_vector = ISVREF(ISVREF(subblock,(SI_Long)1L),
			(SI_Long)19L);
		superior_class_bit_number = 
			IFIX(ISVREF(Category_menu_class_description,
			(SI_Long)18L));
		sub_class_vector_index = superior_class_bit_number >>  -  
			- (SI_Long)3L;
		if (sub_class_vector_index < 
			IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) 
			    {
		    gensymed_symbol_2 = 
			    UBYTE_8_ISAREF_1(sub_class_bit_vector,
			    sub_class_vector_index);
		    gensymed_symbol_3 = (SI_Long)1L;
		    gensymed_symbol_4 = superior_class_bit_number & 
			    (SI_Long)7L;
		    gensymed_symbol_3 = gensymed_symbol_3 << gensymed_symbol_4;
		    gensymed_symbol_2 = gensymed_symbol_2 & gensymed_symbol_3;
		    temp = (SI_Long)0L < gensymed_symbol_2;
		}
		else
		    temp = TRUEP(Nil);
		if (temp) {
		    existing_category_menu_qm = subblock;
		    temp_1 = existing_category_menu_qm;
		    goto end_1;
		}
		goto next_loop_1;
	      end_loop:
		temp_1 = Qnil;
	      end_1:;
	    }
	    else
		temp_1 = Nil;
	    if (temp_1);
	    else
		temp_1 = make_category_menu_table(menu_1);
	    M_CAR(gensymed_symbol) = temp_1;
	    M_CDR(gensymed_symbol) = Nil;
	    inline_note_allocate_cons(gensymed_symbol,Qab_gensym);
	    ab_loopvar__2 = gensymed_symbol;
	}
	else
	    ab_loopvar__2 = Nil;
    }
    else {
	if ( !TRUEP(CDR(menu_1))) {
	    if (CDR(l)) {
		temp_2 = CDR(l);
		temp_2 = CAR(temp_2);
		temp =  !TRUEP(CDR(temp_2));
	    }
	    else
		temp = TRUEP(Nil);
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    new_cons = Available_gensym_conses;
	    if (new_cons) {
		Available_gensym_conses = M_CDR(new_cons);
		gensymed_symbol = new_cons;
	    }
	    else
		gensymed_symbol = Nil;
	    if ( !TRUEP(gensymed_symbol))
		gensymed_symbol = replenish_gensym_cons_pool();
	    ab_loopvar__2 = Nil;
	    ab_loopvar__3 = Nil;
	    ab_loopvar__4 = Nil;
	  next_loop_2:
	    new_cons = Available_gensym_conses;
	    if (new_cons) {
		Available_gensym_conses = M_CDR(new_cons);
		gensymed_symbol_1 = new_cons;
	    }
	    else
		gensymed_symbol_1 = Nil;
	    if ( !TRUEP(gensymed_symbol_1))
		gensymed_symbol_1 = replenish_gensym_cons_pool();
	    l_old_value = l;
	    temp_2 = FIRST(l_old_value);
	    l = REST(l_old_value);
	    temp_1 = CAR(temp_2);
	    M_CAR(gensymed_symbol_1) = temp_1;
	    M_CDR(gensymed_symbol_1) = Nil;
	    inline_note_allocate_cons(gensymed_symbol_1,Qab_gensym);
	    ab_loopvar__4 = gensymed_symbol_1;
	    if (ab_loopvar__4) {
		if (ab_loopvar__3)
		    M_CDR(ab_loopvar__3) = ab_loopvar__4;
		else
		    ab_loopvar__2 = ab_loopvar__4;
		ab_loopvar__3 = last(ab_loopvar__4,_);
	    }
	    temp =  !TRUEP(l);
	    if (temp);
	    else {
		temp_2 = CAR(l);
		temp = TRUEP(CDR(temp_2));
	    }
	    if (temp)
		goto end_loop_1;
	    goto next_loop_2;
	  end_loop_1:
	    list_of_onesies = ab_loopvar__2;
	    goto end_2;
	    list_of_onesies = Qnil;
	  end_2:;
	    temp_2 = make_token_menu_table(2,list_of_onesies,Nil);
	    if (list_of_onesies) {
		last_1 = list_of_onesies;
		next_qm = Nil;
	      next_loop_3:
		next_qm = M_CDR(last_1);
		if ( !TRUEP(next_qm))
		    goto end_loop_2;
		inline_note_reclaim_cons(last_1,Qab_gensym);
		last_1 = next_qm;
		goto next_loop_3;
	      end_loop_2:
		inline_note_reclaim_cons(last_1,Qab_gensym);
		temp_1 = Available_gensym_conses;
		M_CDR(last_1) = temp_1;
		Available_gensym_conses = list_of_onesies;
	    }
	    M_CAR(gensymed_symbol) = temp_2;
	    M_CDR(gensymed_symbol) = Nil;
	    inline_note_allocate_cons(gensymed_symbol,Qab_gensym);
	    ab_loopvar__2 = gensymed_symbol;
	}
	else {
	    l_old_value = l;
	    l = REST(l_old_value);
	    new_cons = Available_gensym_conses;
	    if (new_cons) {
		Available_gensym_conses = M_CDR(new_cons);
		gensymed_symbol = new_cons;
	    }
	    else
		gensymed_symbol = Nil;
	    if ( !TRUEP(gensymed_symbol))
		gensymed_symbol = replenish_gensym_cons_pool();
	    temp_1 = EQ(CAR(menu_1),Kupcase) ? make_token_menu_table(2,
		    CDR(menu_1),T) : make_token_menu_table(2,menu_1,Nil);
	    M_CAR(gensymed_symbol) = temp_1;
	    M_CDR(gensymed_symbol) = Nil;
	    inline_note_allocate_cons(gensymed_symbol,Qab_gensym);
	    ab_loopvar__2 = gensymed_symbol;
	}
    }
    if (ab_loopvar__2) {
	if (ab_loopvar__1)
	    M_CDR(ab_loopvar__1) = ab_loopvar__2;
	else
	    ab_loopvar_ = ab_loopvar__2;
	ab_loopvar__1 = last(ab_loopvar__2,_);
    }
    if ( !TRUEP(l))
	goto end_loop_3;
    goto next_loop;
  end_loop_3:
    menus = ab_loopvar_;
    goto end_3;
    menus = Qnil;
  end_3:;
    workspace_margin = ISVREF(Current_edit_workspace,(SI_Long)17L);
    amount_by_which_width_can_exceed_height = (SI_Long)0L;
    temp_2 = ISVREF(Current_edit_state,(SI_Long)84L);
    if (temp_2);
    else
	temp_2 = New_g2_classic_ui_p ? get_ui_parameter(1,
		Qfont_for_editing) : ISVREF(Fonts,(SI_Long)25L);
    intermenu_spacing = EQ(temp_2,Qsmall) ? (SI_Long)18L : (SI_Long)25L;
    edit_box = ISVREF(Current_edit_state,(SI_Long)13L);
    gensymed_symbol = ISVREF(edit_box,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)0L) : FIX((SI_Long)0L);
    left_edge_of_menu_area = gensymed_symbol;
    gensymed_symbol = ISVREF(edit_box,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)3L) : FIX((SI_Long)0L);
    gensymed_symbol_2 = IFIX(gensymed_symbol);
    gensymed_symbol_3 = IFIX(workspace_margin);
    if (ISVREF(Current_edit_state,(SI_Long)46L) && 
	    ISVREF(Current_edit_state,(SI_Long)47L))
	gensymed_symbol_4 = IFIX(ISVREF(Current_edit_state,(SI_Long)51L));
    else {
	temp_2 = ISVREF(Current_edit_state,(SI_Long)70L);
	if (temp_2);
	else
	    temp_2 = FIX((SI_Long)0L);
	gensymed_symbol_4 = IFIX(temp_2);
    }
    top_edge_of_menu_area = gensymed_symbol_2 + gensymed_symbol_3 + 
	    gensymed_symbol_4;
    current_left_edge_of_menu_area = left_edge_of_menu_area;
    current_top_edge_of_menu_area = FIX(top_edge_of_menu_area);
    current_right_edge_of_menu_area = left_edge_of_menu_area;
    current_bottom_edge_of_menu_area = FIX(top_edge_of_menu_area);
    menu_1 = Nil;
    ab_loop_list_ = menus;
    left_edge_of_menu = Nil;
    top_edge_of_menu = Nil;
  next_loop_4:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop_4;
    menu_1 = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    gensymed_symbol = ISVREF(menu_1,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)0L) : FIX((SI_Long)0L);
    left_edge_of_menu = gensymed_symbol;
    gensymed_symbol = ISVREF(menu_1,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)1L) : FIX((SI_Long)0L);
    top_edge_of_menu = gensymed_symbol;
    if (IFIX(FIXNUM_MINUS(current_left_edge_of_menu_area,
	    left_edge_of_menu_area)) - 
	    (IFIX(current_top_edge_of_menu_area) - top_edge_of_menu_area) 
	    > amount_by_which_width_can_exceed_height) {
	current_left_edge_of_menu_area = left_edge_of_menu_area;
	if ( !EQ(menu_1,existing_category_menu_qm))
	    shift_block(menu_1,FIXNUM_MINUS(current_left_edge_of_menu_area,
		    left_edge_of_menu),
		    FIXNUM_MINUS(current_bottom_edge_of_menu_area,
		    top_edge_of_menu));
	gensymed_symbol_2 = IFIX(current_right_edge_of_menu_area);
	gensymed_symbol = ISVREF(menu_1,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)2L) : FIX((SI_Long)0L);
	gensymed_symbol_3 = IFIX(gensymed_symbol);
	gensymed_symbol_4 = intermenu_spacing;
	gensymed_symbol_3 = gensymed_symbol_3 + gensymed_symbol_4;
	current_right_edge_of_menu_area = FIX(MAX(gensymed_symbol_2,
		gensymed_symbol_3));
	gensymed_symbol = ISVREF(menu_1,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)3L) : FIX((SI_Long)0L);
	gensymed_symbol_2 = IFIX(gensymed_symbol);
	gensymed_symbol_3 = intermenu_spacing;
	current_top_edge_of_menu_area = FIX(gensymed_symbol_2 + 
		gensymed_symbol_3);
	current_bottom_edge_of_menu_area = current_top_edge_of_menu_area;
    }
    else if (IFIX(FIXNUM_MINUS(current_left_edge_of_menu_area,
	    left_edge_of_menu_area)) - 
	    (IFIX(current_top_edge_of_menu_area) - top_edge_of_menu_area) 
	    < amount_by_which_width_can_exceed_height) {
	if ( !EQ(menu_1,existing_category_menu_qm))
	    shift_block(menu_1,
		    FIXNUM_MINUS(current_right_edge_of_menu_area,
		    left_edge_of_menu),FIX(top_edge_of_menu_area - 
		    IFIX(top_edge_of_menu)));
	gensymed_symbol_2 = IFIX(current_right_edge_of_menu_area);
	gensymed_symbol = ISVREF(menu_1,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)2L) : FIX((SI_Long)0L);
	gensymed_symbol_3 = IFIX(gensymed_symbol);
	gensymed_symbol_4 = intermenu_spacing;
	gensymed_symbol_3 = gensymed_symbol_3 + gensymed_symbol_4;
	current_right_edge_of_menu_area = FIX(MAX(gensymed_symbol_2,
		gensymed_symbol_3));
	gensymed_symbol_2 = IFIX(current_bottom_edge_of_menu_area);
	gensymed_symbol = ISVREF(menu_1,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)3L) : FIX((SI_Long)0L);
	gensymed_symbol_3 = IFIX(gensymed_symbol);
	gensymed_symbol_4 = intermenu_spacing;
	gensymed_symbol_3 = gensymed_symbol_3 + gensymed_symbol_4;
	current_top_edge_of_menu_area = FIX(MAX(gensymed_symbol_2,
		gensymed_symbol_3));
	current_bottom_edge_of_menu_area = current_top_edge_of_menu_area;
	current_left_edge_of_menu_area = left_edge_of_menu_area;
    }
    else {
	if ( !EQ(menu_1,existing_category_menu_qm))
	    shift_block(menu_1,FIXNUM_MINUS(current_left_edge_of_menu_area,
		    left_edge_of_menu),
		    FIXNUM_MINUS(current_top_edge_of_menu_area,
		    top_edge_of_menu));
	temp_2 = current_right_edge_of_menu_area;
	gensymed_symbol = ISVREF(menu_1,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)2L) : FIX((SI_Long)0L);
	gensymed_symbol_2 = IFIX(gensymed_symbol);
	gensymed_symbol_3 = intermenu_spacing;
	current_left_edge_of_menu_area = FIX(gensymed_symbol_2 + 
		gensymed_symbol_3);
	current_right_edge_of_menu_area = FIXNUM_MAX(temp_2,
		current_left_edge_of_menu_area);
	gensymed_symbol_2 = IFIX(current_bottom_edge_of_menu_area);
	gensymed_symbol = ISVREF(menu_1,(SI_Long)14L);
	gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
		(SI_Long)3L) : FIX((SI_Long)0L);
	gensymed_symbol_3 = IFIX(gensymed_symbol);
	gensymed_symbol_4 = intermenu_spacing;
	gensymed_symbol_3 = gensymed_symbol_3 + gensymed_symbol_4;
	current_bottom_edge_of_menu_area = FIX(MAX(gensymed_symbol_2,
		gensymed_symbol_3));
    }
    goto next_loop_4;
  end_loop_4:
    enlarge_workspace_if_necessary(5,Current_edit_workspace,
	    left_edge_of_menu_area,FIX(top_edge_of_menu_area),
	    FIX(IFIX(current_right_edge_of_menu_area) - intermenu_spacing 
	    + IFIX(workspace_margin)),
	    FIX(IFIX(current_bottom_edge_of_menu_area) - intermenu_spacing 
	    + IFIX(workspace_margin)));
    menus = nreverse_canonically(menus);
    menu_1 = Nil;
    ab_loop_list_ = menus;
  next_loop_5:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop_5;
    menu_1 = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    if ( !EQ(menu_1,existing_category_menu_qm)) {
	add_subblock(menu_1,Current_edit_workspace);
	update_images_of_block(menu_1,Nil,T);
    }
    goto next_loop_5;
  end_loop_5:;
    if (ISVREF(Current_edit_state,(SI_Long)69L))
	highlight_or_unhighlight_selected_token_menu_choice(Nil);
    if (menus) {
	last_1 = menus;
	next_qm = Nil;
      next_loop_6:
	next_qm = M_CDR(last_1);
	if ( !TRUEP(next_qm))
	    goto end_loop_6;
	inline_note_reclaim_cons(last_1,Qab_gensym);
	last_1 = next_qm;
	goto next_loop_6;
      end_loop_6:
	inline_note_reclaim_cons(last_1,Qab_gensym);
	temp_1 = Available_gensym_conses;
	M_CDR(last_1) = temp_1;
	Available_gensym_conses = menus;
    }
    return VALUES_1(Qnil);
}

static Object Qneeds_refreshing;   /* needs-refreshing */

/* ERASE-ANY-TEMPORARY-INFORMATION-ON-EDIT-WORKSPACE */
Object erase_any_temporary_information_on_edit_workspace varargs_1(int, n)
{
    Object keep_category_menu_qm;
    Object shrink_wrap_too_qm, temporary_information_on_edit_workspace_qm;
    Object svref_arg_1;
    Declare_varargs_nonrelocating;

    x_note_fn_call(126,419);
    INIT_ARGS_nonrelocating();
    keep_category_menu_qm = REQUIRED_ARG_nonrelocating();
    shrink_wrap_too_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    temporary_information_on_edit_workspace_qm = ISVREF(Current_edit_state,
	    (SI_Long)33L);
    if (temporary_information_on_edit_workspace_qm) {
	if (EQ(temporary_information_on_edit_workspace_qm,
		Qeditor_notification) || 
		EQ(temporary_information_on_edit_workspace_qm,
		Qneeds_refreshing))
	    delete_subblocks_of_class(Current_edit_workspace,
		    Qeditor_notification);
	else {
	    delete_subblocks_of_class(Current_edit_workspace,Qtoken_menu);
	    if ( !TRUEP(keep_category_menu_qm))
		delete_subblocks_of_class(Current_edit_workspace,
			Qcategory_menu);
	    reclaim_menu_content_structure_for_character_position(temporary_information_on_edit_workspace_qm);
	}
	if (shrink_wrap_too_qm)
	    shrink_wrap_workspace(Current_edit_workspace);
	svref_arg_1 = Current_edit_state;
	return VALUES_1(SVREF(svref_arg_1,FIX((SI_Long)33L)) = Nil);
    }
    else
	return VALUES_1(Nil);
}

/* GENERATE-SPOT-FOR-CATEGORY-MENU */
Object generate_spot_for_category_menu(category_menu,mouse_pointer)
    Object category_menu, mouse_pointer;
{
    x_note_fn_call(126,420);
    return generate_spot_for_button_menu(make_category_menu_button_spot_1(),
	    category_menu,mouse_pointer);
}

/* GENERATE-SPOT-FOR-TOKEN-MENU */
Object generate_spot_for_token_menu(token_menu,mouse_pointer)
    Object token_menu, mouse_pointer;
{
    x_note_fn_call(126,421);
    return generate_spot_for_button_menu(make_token_menu_button_spot_1(),
	    token_menu,mouse_pointer);
}

/* GENERATE-SPOT-FOR-REPLACEMENT-TOKEN-MENU */
Object generate_spot_for_replacement_token_menu(replacement_token_menu,
	    mouse_pointer)
    Object replacement_token_menu, mouse_pointer;
{
    x_note_fn_call(126,422);
    return generate_spot_for_button_menu(make_replacement_token_menu_button_spot_1(),
	    replacement_token_menu,mouse_pointer);
}

/* GENERATE-SPOT-FOR-CHARACTER-SEQUENCE-TOKEN-MENU */
Object generate_spot_for_character_sequence_token_menu(character_sequence_token_menu,
	    mouse_pointer)
    Object character_sequence_token_menu, mouse_pointer;
{
    x_note_fn_call(126,423);
    return generate_spot_for_button_menu(make_character_sequence_token_menu_button_spot_1(),
	    character_sequence_token_menu,mouse_pointer);
}

/* GENERATE-SPOT-FOR-PATHNAME-COMPONENT-TOKEN-MENU */
Object generate_spot_for_pathname_component_token_menu(pathname_component_token_menu,
	    mouse_pointer)
    Object pathname_component_token_menu, mouse_pointer;
{
    x_note_fn_call(126,424);
    return generate_spot_for_button_menu(make_pathname_component_token_menu_button_spot_1(),
	    pathname_component_token_menu,mouse_pointer);
}

/* GENERATE-SPOT-FOR-KFEP-CONVERSION-CHOICE-MENU */
Object generate_spot_for_kfep_conversion_choice_menu(kfep_conversion_choice_menu,
	    mouse_pointer)
    Object kfep_conversion_choice_menu, mouse_pointer;
{
    x_note_fn_call(126,425);
    return generate_spot_for_button_menu(make_kfep_conversion_choice_menu_button_spot_1(),
	    kfep_conversion_choice_menu,mouse_pointer);
}

static Object Qleft_aligned_category_menu_item_format;  /* left-aligned-category-menu-item-format */

static Object Qleft_aligned_token_menu_item_format;  /* left-aligned-token-menu-item-format */

static Object Qcenter;             /* center */

static Object Qcenter_aligned_category_menu_item_format;  /* center-aligned-category-menu-item-format */

static Object Qcenter_aligned_token_menu_item_format;  /* center-aligned-token-menu-item-format */

static Object Qright_aligned_category_menu_item_format;  /* right-aligned-category-menu-item-format */

static Object Qright_aligned_token_menu_item_format;  /* right-aligned-token-menu-item-format */

/* CHOOSE-TOKEN-MENU-ITEM-FORMAT-PER-SYSTEM-TABLES */
Object choose_token_menu_item_format_per_system_tables varargs_1(int, n)
{
    Object category_menu_case_qm, temp, temp_1;
    Declare_varargs_nonrelocating;

    x_note_fn_call(126,426);
    INIT_ARGS_nonrelocating();
    category_menu_case_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    temp = ISVREF(Menu_parameters,(SI_Long)22L);
    if (EQ(temp,Qleft))
	temp_1 = category_menu_case_qm ? 
		Qleft_aligned_category_menu_item_format : 
		Qleft_aligned_token_menu_item_format;
    else if (EQ(temp,Qcenter))
	temp_1 = category_menu_case_qm ? 
		Qcenter_aligned_category_menu_item_format : 
		Qcenter_aligned_token_menu_item_format;
    else if (EQ(temp,Qright))
	temp_1 = category_menu_case_qm ? 
		Qright_aligned_category_menu_item_format : 
		Qright_aligned_token_menu_item_format;
    else
	temp_1 = Qnil;
    temp = ISVREF(Current_edit_state,(SI_Long)84L);
    if (temp);
    else
	temp = New_g2_classic_ui_p ? get_ui_parameter(1,Qfont_for_editing) 
		: ISVREF(Fonts,(SI_Long)25L);
    return choose_font_format_per_font_size(temp_1,temp);
}

static Object Qnon_negative_integer;  /* non-negative-integer */

static Object Qwhole_string;       /* whole-string */

static Object Qleft_string;        /* left-string */

static Object Qquoted_message;     /* quoted-message */

static Object Qmiddle_string;      /* middle-string */

static Object Qright_string;       /* right-string */

static Object Qend_of_message;     /* end-of-message */

static Object Qneutral_unit_of_measure;  /* neutral-unit-of-measure */

static Object Qsingular_unit_of_measure;  /* singular-unit-of-measure */

static Object Qplural_unit_of_measure;  /* plural-unit-of-measure */

static Object Qunit_of_measure;    /* unit-of-measure */

static Object Qbad_java_character_literal;  /* bad-java-character-literal */

static Object Kall_category;       /* :all-category */

static Object Qtoken_menu_format;  /* token-menu-format */

/* MAKE-CATEGORY-MENU-TABLE */
Object make_category_menu_table(category_menu)
    Object category_menu;
{
    Object reversed_rows, number_category_symbol_qm, string_category_symbol_qm;
    Object unit_of_measure_category_symbol_qm, category_symbol, ab_loop_list_;
    Object new_cons, gensymed_symbol, car_new_value, temp, temp_1;

    x_note_fn_call(126,427);
    reversed_rows = Nil;
    number_category_symbol_qm = Nil;
    string_category_symbol_qm = Nil;
    unit_of_measure_category_symbol_qm = Nil;
    category_symbol = Nil;
    ab_loop_list_ = category_menu;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    category_symbol = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    if (EQ(category_symbol,Qnumber))
	number_category_symbol_qm = Qnumber;
    else if (EQ(category_symbol,Qinteger) || EQ(category_symbol,
	    Qnon_negative_integer)) {
	if ( !TRUEP(number_category_symbol_qm))
	    number_category_symbol_qm = Qinteger;
    }
    else if (EQ(category_symbol,Qwhole_string)) {
	if ( !TRUEP(string_category_symbol_qm))
	    string_category_symbol_qm = Qstring;
    }
    else if (EQ(category_symbol,Qleft_string))
	string_category_symbol_qm = Qquoted_message;
    else if (EQ(category_symbol,Qmiddle_string) || EQ(category_symbol,
	    Qright_string))
	string_category_symbol_qm = Qend_of_message;
    else if (EQ(category_symbol,Qneutral_unit_of_measure) || 
	    EQ(category_symbol,Qsingular_unit_of_measure) || 
	    EQ(category_symbol,Qplural_unit_of_measure))
	unit_of_measure_category_symbol_qm = Qunit_of_measure;
    else if (EQ(category_symbol,Qbad_java_character_literal));
    else {
	new_cons = Available_gensym_conses;
	if (new_cons) {
	    Available_gensym_conses = M_CDR(new_cons);
	    gensymed_symbol = new_cons;
	}
	else
	    gensymed_symbol = Nil;
	if ( !TRUEP(gensymed_symbol))
	    gensymed_symbol = replenish_gensym_cons_pool();
	car_new_value = make_category_menu_table_row(category_symbol);
	M_CAR(gensymed_symbol) = car_new_value;
	M_CDR(gensymed_symbol) = reversed_rows;
	inline_note_allocate_cons(gensymed_symbol,Qab_gensym);
	reversed_rows = gensymed_symbol;
    }
    goto next_loop;
  end_loop:
    if (unit_of_measure_category_symbol_qm) {
	temp = 
		make_category_menu_table_row(unit_of_measure_category_symbol_qm);
	reversed_rows = gensym_cons_1(temp,reversed_rows);
    }
    if (string_category_symbol_qm) {
	temp = make_category_menu_table_row(string_category_symbol_qm);
	reversed_rows = gensym_cons_1(temp,reversed_rows);
    }
    if (number_category_symbol_qm) {
	temp = make_category_menu_table_row(number_category_symbol_qm);
	reversed_rows = gensym_cons_1(temp,reversed_rows);
    }
    temp_1 = nreverse(reversed_rows);
    goto end_1;
    temp_1 = Qnil;
  end_1:;
    temp = assq_function(Kall_category,ISVREF(Current_edit_state,
	    (SI_Long)74L));
    temp = CDR(temp);
    if (temp);
    else
	temp = Qcategory_menu;
    return make_or_reformat_table(5,temp_1,Qtoken_menu_format,Nil,temp,T);
}

static Object array_constant_8;    /* # */

static Object Qspecial_case_qm;    /* special-case? */

static Object Qany_instance;       /* any-instance */

/* MAKE-CATEGORY-MENU-TABLE-ROW */
Object make_category_menu_table_row(category_symbol)
    Object category_symbol;
{
    Object new_cons, gensymed_symbol, current_wide_string_list;
    Object wide_string_bv16, current_wide_string;
    Object fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object car_new_value, temp, text_cell;
    SI_Long bv16_length, aref_arg_2, aref_new_value, length_1;
    Declare_special(5);

    x_note_fn_call(126,428);
    new_cons = Available_gensym_conses;
    if (new_cons) {
	Available_gensym_conses = M_CDR(new_cons);
	gensymed_symbol = new_cons;
    }
    else
	gensymed_symbol = Nil;
    if ( !TRUEP(gensymed_symbol))
	gensymed_symbol = replenish_gensym_cons_pool();
    current_wide_string_list = Qdo_not_use;
    PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
      wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)2048L + 
	      (SI_Long)3L));
      bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
      aref_arg_2 = bv16_length - (SI_Long)2L;
      aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
      UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
      aref_arg_2 = bv16_length - (SI_Long)1L;
      aref_new_value = (SI_Long)57344L | (SI_Long)0L;
      UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
      UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
      current_wide_string = wide_string_bv16;
      PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
	fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		2);
	  length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
	  total_length_of_current_wide_string = 
		  FIX(UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		  (SI_Long)2L) + ((UBYTE_16_ISAREF_1(Current_wide_string,
		  length_1 - (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
	  PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
		  1);
	    current_twriting_output_type = Qwide_string;
	    PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
		    0);
	      twrite_beginning_of_wide_string(array_constant_8,
		      FIX((SI_Long)4L));
	      twrite_symbol(1,category_symbol);
	      car_new_value = copy_out_current_wide_string();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
      POP_SPECIAL();
    POP_SPECIAL();
    M_CAR(gensymed_symbol) = car_new_value;
    M_CDR(gensymed_symbol) = Nil;
    inline_note_allocate_cons(gensymed_symbol,Qab_gensym);
    temp = gensymed_symbol;
    text_cell = make_text_cell(2,temp,
	    choose_token_menu_item_format_per_system_tables(1,T));
    change_text_cell_property(text_cell,Qspecial_case_qm,Qany_instance);
    change_text_cell_property(text_cell,Qchoice,category_symbol);
    new_cons = Available_gensym_conses;
    if (new_cons) {
	Available_gensym_conses = M_CDR(new_cons);
	gensymed_symbol = new_cons;
    }
    else
	gensymed_symbol = Nil;
    if ( !TRUEP(gensymed_symbol))
	gensymed_symbol = replenish_gensym_cons_pool();
    M_CAR(gensymed_symbol) = text_cell;
    M_CDR(gensymed_symbol) = Nil;
    inline_note_allocate_cons(gensymed_symbol,Qab_gensym);
    return VALUES_1(gensymed_symbol);
}

Object Token_menu_string_to_display_function_prop = UNBOUND;

static Object Qtoken_menu_string_to_display_function;  /* token-menu-string-to-display-function */

/* SET-TOKEN-MENU-STRING-TO-DISPLAY-FUNCTION */
Object set_token_menu_string_to_display_function(category,function_qm)
    Object category, function_qm;
{
    x_note_fn_call(126,429);
    return mutate_global_property(category,function_qm,
	    Qtoken_menu_string_to_display_function);
}

/* TOKEN-MENU-STRING-TO-DISPLAY */
Object token_menu_string_to_display(category_symbol_qm,symbol,
	    do_not_downcase_qm)
    Object category_symbol_qm, symbol, do_not_downcase_qm;
{
    Object gensymed_symbol, gensymed_symbol_1, gensymed_symbol_2;

    x_note_fn_call(126,430);
    if (category_symbol_qm && 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(category_symbol_qm),
	    Qtoken_menu_string_to_display_function)) {
	gensymed_symbol = 
		getfq_function_no_default(INLINE_SYMBOL_PLIST(category_symbol_qm),
		Qtoken_menu_string_to_display_function);
	gensymed_symbol_1 = symbol;
	gensymed_symbol_2 = do_not_downcase_qm;
	return VALUES_1(inline_funcall_2(gensymed_symbol,gensymed_symbol_1,
		gensymed_symbol_2));
    }
    else if (getfq_function_no_default(INLINE_SYMBOL_PLIST(symbol),
	    Qtoken_menu_string_to_display_function)) {
	gensymed_symbol = 
		getfq_function_no_default(INLINE_SYMBOL_PLIST(symbol),
		Qtoken_menu_string_to_display_function);
	gensymed_symbol_1 = symbol;
	gensymed_symbol_2 = do_not_downcase_qm;
	return VALUES_1(inline_funcall_2(gensymed_symbol,gensymed_symbol_1,
		gensymed_symbol_2));
    }
    else
	return copy_symbol_name_parsably(symbol,do_not_downcase_qm);
}

Object Token_menu_string_to_insert_function_prop = UNBOUND;

static Object Qtoken_menu_string_to_insert_function;  /* token-menu-string-to-insert-function */

/* SET-TOKEN-MENU-STRING-TO-INSERT-FUNCTION */
Object set_token_menu_string_to_insert_function(category,function_qm)
    Object category, function_qm;
{
    x_note_fn_call(126,431);
    return mutate_global_property(category,function_qm,
	    Qtoken_menu_string_to_insert_function);
}

/* TOKEN-MENU-STRING-TO-INSERT? */
Object token_menu_string_to_insert_qm(category_symbol_qm,symbol)
    Object category_symbol_qm, symbol;
{
    Object gensymed_symbol, gensymed_symbol_1;

    x_note_fn_call(126,432);
    if (category_symbol_qm && 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(category_symbol_qm),
	    Qtoken_menu_string_to_insert_function)) {
	gensymed_symbol = 
		getfq_function_no_default(INLINE_SYMBOL_PLIST(category_symbol_qm),
		Qtoken_menu_string_to_insert_function);
	gensymed_symbol_1 = symbol;
	return VALUES_1(inline_funcall_1(gensymed_symbol,gensymed_symbol_1));
    }
    else
	return VALUES_1(Nil);
}

static Object Qcolor;              /* color */

static Object Kall_token;          /* :all-token */

/* MAKE-TOKEN-MENU-TABLE */
Object make_token_menu_table varargs_1(int, n)
{
    Object strings_and_tokens_and_token_sequences;
    Object do_not_downcase_lone_symbols_qm;
    Object category_symbol_qm, menu_class_qm;
    Object maximum_number_of_choices_to_include_in_menu_qm;
    Object landscape_style_menus_qm, format_name, token_menu_item_format;
    Object string_or_token_or_token_sequence, ab_loop_list_, choice_string_qm;
    Object display_string, table_rows, ab_loopvar_, ab_loopvar__1;
    Object ab_loop_iter_flag_, temp, temp_2, row, cells;
    SI_Long i;
    char temp_1;
    Declare_varargs_nonrelocating;

    x_note_fn_call(126,433);
    INIT_ARGS_nonrelocating();
    strings_and_tokens_and_token_sequences = REQUIRED_ARG_nonrelocating();
    do_not_downcase_lone_symbols_qm = REQUIRED_ARG_nonrelocating();
    category_symbol_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    menu_class_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    maximum_number_of_choices_to_include_in_menu_qm = 
	    OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() :
	     Nil;
    landscape_style_menus_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    format_name = choose_token_menu_item_format_per_system_tables(0);
    token_menu_item_format = get_instance_with_name_if_any(Qformat_frame,
	    format_name);
    if (token_menu_item_format);
    else
	token_menu_item_format = make_format_frame(format_name);
    string_or_token_or_token_sequence = Nil;
    ab_loop_list_ = strings_and_tokens_and_token_sequences;
    choice_string_qm = Nil;
    i = (SI_Long)1L;
    display_string = Nil;
    table_rows = Nil;
    ab_loopvar_ = Nil;
    ab_loopvar__1 = Nil;
    ab_loop_iter_flag_ = T;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    string_or_token_or_token_sequence = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    if (CONSP(string_or_token_or_token_sequence)) {
	temp = FIRST(string_or_token_or_token_sequence);
	temp_1 = CONSP(temp);
    }
    else
	temp_1 = TRUEP(Nil);
    if (temp_1) {
	temp = FIRST(string_or_token_or_token_sequence);
	temp = FIRST(temp);
	temp_2 = SECOND(string_or_token_or_token_sequence);
	reclaim_gensym_list_1(string_or_token_or_token_sequence);
	string_or_token_or_token_sequence = temp_2;
	choice_string_qm = temp;
    }
    else
	choice_string_qm = 
		token_menu_string_to_insert_qm(category_symbol_qm,
		string_or_token_or_token_sequence);
    if ( !TRUEP(ab_loop_iter_flag_))
	i = i + (SI_Long)1L;
    display_string = token_menu_string_to_display_for_entry(3,
	    string_or_token_or_token_sequence,category_symbol_qm,
	    do_not_downcase_lone_symbols_qm);
    temp = make_lost_spaces_text_element(FIX((SI_Long)0L));
    temp_2 = gensym_list_2(temp,display_string);
    temp = EQ(category_symbol_qm,Qcolor) ? 
	    make_text_cell_plist_for_color_background(string_or_token_or_token_sequence) 
	    : Nil;
    ab_loopvar__1 = gensym_cons_1(gensym_cons_1(make_text_cell(3,temp_2,
	    token_menu_item_format,nconc2(temp,choice_string_qm ? 
	    gensym_list_2(Qchoice,choice_string_qm) : Nil)),Nil),Nil);
    if (ab_loopvar_)
	M_CDR(ab_loopvar_) = ab_loopvar__1;
    else
	table_rows = ab_loopvar__1;
    ab_loopvar_ = ab_loopvar__1;
    if (maximum_number_of_choices_to_include_in_menu_qm && i >= 
	    IFIX(maximum_number_of_choices_to_include_in_menu_qm))
	goto end_loop;
    ab_loop_iter_flag_ = Nil;
    goto next_loop;
  end_loop:
    if (landscape_style_menus_qm && table_rows) {
	row = Nil;
	ab_loop_list_ = table_rows;
	cells = Nil;
	ab_loopvar_ = Nil;
	ab_loopvar__1 = Nil;
      next_loop_1:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop_1;
	row = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	ab_loopvar__1 = row;
	if (ab_loopvar__1) {
	    if (ab_loopvar_)
		M_CDR(ab_loopvar_) = ab_loopvar__1;
	    else
		cells = ab_loopvar__1;
	    ab_loopvar_ = last(ab_loopvar__1,_);
	}
	goto next_loop_1;
      end_loop_1:
	M_CAR(table_rows) = cells;
	reclaim_gensym_list_1(CDR(table_rows));
	M_CDR(table_rows) = Nil;
	temp_2 = table_rows;
	goto end_1;
	temp_2 = Qnil;
      end_1:;
    }
    else
	temp_2 = table_rows;
    goto end_2;
    temp_2 = Qnil;
  end_2:;
    temp = menu_class_qm;
    if (temp);
    else {
	temp = assq_function(Kall_token,ISVREF(Current_edit_state,
		(SI_Long)74L));
	temp = CDR(temp);
    }
    if (temp);
    else
	temp = Qtoken_menu;
    return make_or_reformat_table(5,temp_2,Qtoken_menu_format,Nil,temp,T);
}

/* TOKEN-MENU-STRING-TO-DISPLAY-FOR-ENTRY */
Object token_menu_string_to_display_for_entry varargs_1(int, n)
{
    Object string_or_token_or_token_sequence;
    Object category_symbol_qm, do_not_downcase_lone_symbols_qm;
    Object current_wide_string_list, wide_string_bv16, current_wide_string;
    Object fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object write_symbols_parsably_qm, write_symbols_in_lower_case_qm, l, token;
    Object display_function_qm, text_string_to_display_instead_qm, temp;
    Object schar_arg_2, schar_new_value;
    SI_Long bv16_length, aref_arg_2, aref_new_value, length_1, thing;
    Declare_varargs_nonrelocating;
    Declare_special(7);
    Object result;

    x_note_fn_call(126,434);
    INIT_ARGS_nonrelocating();
    string_or_token_or_token_sequence = REQUIRED_ARG_nonrelocating();
    category_symbol_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    do_not_downcase_lone_symbols_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    if (SYMBOLP(string_or_token_or_token_sequence))
	return token_menu_string_to_display(category_symbol_qm,
		string_or_token_or_token_sequence,
		do_not_downcase_lone_symbols_qm);
    else if (text_string_p(string_or_token_or_token_sequence))
	return copy_text_string(string_or_token_or_token_sequence);
    else if (ATOM(string_or_token_or_token_sequence)) {
	current_wide_string_list = Qdo_not_use;
	PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,6);
	  wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)2048L + 
		  (SI_Long)3L));
	  bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	  aref_arg_2 = bv16_length - (SI_Long)2L;
	  aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  aref_arg_2 = bv16_length - (SI_Long)1L;
	  aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
	  current_wide_string = wide_string_bv16;
	  PUSH_SPECIAL(Current_wide_string,current_wide_string,5);
	    fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	    PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		    4);
	      length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
	      total_length_of_current_wide_string = 
		      FIX(UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		      (SI_Long)2L) + 
		      ((UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		      (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
	      PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
		      3);
		current_twriting_output_type = Qwide_string;
		PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
			2);
		  write_symbols_parsably_qm = T;
		  write_symbols_in_lower_case_qm = T;
		  PUSH_SPECIAL(Write_symbols_in_lower_case_qm,write_symbols_in_lower_case_qm,
			  1);
		    PUSH_SPECIAL(Write_symbols_parsably_qm,write_symbols_parsably_qm,
			    0);
		      twrite(string_or_token_or_token_sequence);
		    POP_SPECIAL();
		  POP_SPECIAL();
		  result = copy_out_current_wide_string();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else {
	current_wide_string_list = Qdo_not_use;
	PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,6);
	  wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)2048L + 
		  (SI_Long)3L));
	  bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	  aref_arg_2 = bv16_length - (SI_Long)2L;
	  aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  aref_arg_2 = bv16_length - (SI_Long)1L;
	  aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
	  current_wide_string = wide_string_bv16;
	  PUSH_SPECIAL(Current_wide_string,current_wide_string,5);
	    fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	    PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		    4);
	      length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
	      total_length_of_current_wide_string = 
		      FIX(UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		      (SI_Long)2L) + 
		      ((UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		      (SI_Long)1L) & (SI_Long)8191L) << (SI_Long)16L));
	      PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
		      3);
		current_twriting_output_type = Qwide_string;
		PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
			2);
		  write_symbols_parsably_qm = T;
		  write_symbols_in_lower_case_qm = T;
		  PUSH_SPECIAL(Write_symbols_in_lower_case_qm,write_symbols_in_lower_case_qm,
			  1);
		    PUSH_SPECIAL(Write_symbols_parsably_qm,write_symbols_parsably_qm,
			    0);
		      l = string_or_token_or_token_sequence;
		    next_loop:
		      if ( !TRUEP(l))
			  goto end_loop;
		      token = CAR(l);
		      display_function_qm = SYMBOLP(token) ? 
			      getfq_function_no_default(INLINE_SYMBOL_PLIST(token),
			      Qtoken_menu_string_to_display_function) : Qnil;
		      text_string_to_display_instead_qm = 
			      display_function_qm ? 
			      inline_funcall_2(display_function_qm,token,
			      do_not_downcase_lone_symbols_qm) : Qnil;
		      if (text_string_to_display_instead_qm) {
			  twrite(text_string_to_display_instead_qm);
			  reclaim_text_string(text_string_to_display_instead_qm);
		      }
		      else
			  twrite(token);
		      if (CDR(l)) {
			  if (EQ(Current_twriting_output_type,Qwide_string)) {
			      thing = (SI_Long)32L;
			      twrite_wide_character(CHARACTERP(FIX(thing)) 
				      ? CHAR_CODE(FIX(thing)) : FIX(thing));
			  }
			  else {
			      if ( 
				      !FIXNUM_LT(Fill_pointer_for_current_gensym_string,
				      Total_length_of_current_gensym_string))
				  extend_current_gensym_string(0);
			      temp = Current_gensym_string;
			      schar_arg_2 = 
				      Fill_pointer_for_current_gensym_string;
			      thing = (SI_Long)32L;
			      schar_new_value = 
				      CODE_CHAR(CHARACTERP(FIX(thing)) ? 
				      CHAR_CODE(FIX(thing)) : FIX(thing));
			      SET_SCHAR(temp,schar_arg_2,schar_new_value);
			      temp = 
				      FIXNUM_ADD1(Fill_pointer_for_current_gensym_string);
			      Fill_pointer_for_current_gensym_string = temp;
			  }
		      }
		      l = M_CDR(l);
		      goto next_loop;
		    end_loop:;
		    POP_SPECIAL();
		  POP_SPECIAL();
		  result = copy_out_current_wide_string();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
}

static Object Qinsert_first_token_menu_choice;  /* insert-first-token-menu-choice */

/* COM-INSERT-FIRST-TOKEN-MENU-CHOICE */
Object com_insert_first_token_menu_choice(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, svref_arg_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,435);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      svref_arg_1 = Current_edit_state;
	      ISVREF(svref_arg_1,(SI_Long)69L) = FIX((SI_Long)0L);
	      convert_current_menu_choice();
	      editor_post_command_hook(Qinsert_first_token_menu_choice,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* INSERT-FIRST-TOKEN-MENU-CHOICE-COMMAND-PURSUER */
Object insert_first_token_menu_choice_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,436);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* INSERT-FIRST-TOKEN-MENU-CHOICE-COMMAND-TRANSLATOR */
Object insert_first_token_menu_choice_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,437);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qinsert_first_token_menu_choice,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qinsert_last_token_menu_choice;  /* insert-last-token-menu-choice */

/* COM-INSERT-LAST-TOKEN-MENU-CHOICE */
Object com_insert_last_token_menu_choice(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp, svref_arg_1;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,438);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      svref_arg_1 = Current_edit_state;
	      ISVREF(svref_arg_1,(SI_Long)69L) = FIX((SI_Long)-1L);
	      convert_current_menu_choice();
	      editor_post_command_hook(Qinsert_last_token_menu_choice,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* INSERT-LAST-TOKEN-MENU-CHOICE-COMMAND-PURSUER */
Object insert_last_token_menu_choice_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,439);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* INSERT-LAST-TOKEN-MENU-CHOICE-COMMAND-TRANSLATOR */
Object insert_last_token_menu_choice_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,440);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qinsert_last_token_menu_choice,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qnext;               /* next */

static Object Qselect_next_editor_component_group;  /* select-next-editor-component-group */

/* COM-SELECT-NEXT-EDITOR-COMPONENT-GROUP */
Object com_select_next_editor_component_group(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,441);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      select_next_or_previous_editor_component_group(Qnext);
	      editor_post_command_hook(Qselect_next_editor_component_group,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* SELECT-NEXT-EDITOR-COMPONENT-GROUP-COMMAND-PURSUER */
Object select_next_editor_component_group_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,442);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* SELECT-NEXT-EDITOR-COMPONENT-GROUP-COMMAND-TRANSLATOR */
Object select_next_editor_component_group_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,443);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qselect_next_editor_component_group,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qprevious;           /* previous */

static Object Qselect_previous_editor_component_group;  /* select-previous-editor-component-group */

/* COM-SELECT-PREVIOUS-EDITOR-COMPONENT-GROUP */
Object com_select_previous_editor_component_group(event,edit_state)
    Object event, edit_state;
{
    Object current_edit_state, current_edit_workspace;
    Object name_of_current_editor_command_qm, temp;
    Declare_special(3);
    Object result;

    x_note_fn_call(126,444);
    if (event && edit_state && SIMPLE_VECTOR_P(edit_state) && 
	    EQ(ISVREF(edit_state,(SI_Long)0L),
	    Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	current_edit_state = edit_state;
	PUSH_SPECIAL(Current_edit_state,current_edit_state,2);
	  current_edit_workspace = ISVREF(Current_edit_state,(SI_Long)12L);
	  PUSH_SPECIAL(Current_edit_workspace,current_edit_workspace,1);
	    name_of_current_editor_command_qm = Nil;
	    PUSH_SPECIAL(Name_of_current_editor_command_qm,name_of_current_editor_command_qm,
		    0);
	      temp = Nil;
	      select_next_or_previous_editor_component_group(Qprevious);
	      editor_post_command_hook(Qselect_previous_editor_component_group,
		      edit_state);
	      result = VALUES_1(temp);
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* SELECT-PREVIOUS-EDITOR-COMPONENT-GROUP-COMMAND-PURSUER */
Object select_previous_editor_component_group_command_pursuer(partial_command)
    Object partial_command;
{
    Object gensymed_symbol, event, edit_state;

    x_note_fn_call(126,445);
    gensymed_symbol = ISVREF(partial_command,(SI_Long)2L);
    event = CAR(gensymed_symbol);
    gensymed_symbol = CDR(gensymed_symbol);
    edit_state = CAR(gensymed_symbol);
    event = command_argument_value(event);
    edit_state = command_argument_value(edit_state);
    if (EQ(event,Plus_missing_argument_plus))
	return VALUES_3(Qevent,Qevent,FIX((SI_Long)0L));
    else if (EQ(edit_state,Plus_missing_argument_plus))
	return VALUES_3(Qedit_state,Qworkstation_context_specifics,
		FIX((SI_Long)1L));
    else
	return VALUES_1(Qnil);
}

/* SELECT-PREVIOUS-EDITOR-COMPONENT-GROUP-COMMAND-TRANSLATOR */
Object select_previous_editor_component_group_command_translator(mouse_pointer)
    Object mouse_pointer;
{
    Object event, edit_state, temp, temp_1;

    x_note_fn_call(126,446);
    event = event_blackboard_function(mouse_pointer);
    edit_state = 
	    workstation_context_specifics_blackboard_function(mouse_pointer);
    if (event && edit_state) {
	if (SIMPLE_VECTOR_P(edit_state) && EQ(ISVREF(edit_state,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_edit_state_g2_struct)) {
	    temp = event;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    temp_1 = snapshot_command_argument(temp);
	    temp = edit_state;
	    if (temp);
	    else
		temp = Plus_missing_argument_plus;
	    return make_partial_command(Qselect_previous_editor_component_group,
		    gensym_list_2(temp_1,snapshot_command_argument(temp)));
	}
	else
	    return VALUES_1(Nil);
    }
    else
	return VALUES_1(Nil);
}

/* TOKEN-MENU-CHOICES-EXIST-P */
Object token_menu_choices_exist_p()
{
    Object gensymed_symbol, ab_queue_form_, ab_next_queue_element_, token_menu;
    Object sub_class_bit_vector, row, ab_loop_list_, text_cell;
    Object ab_loop_list__1;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    char temp;

    x_note_fn_call(126,447);
    gensymed_symbol = ISVREF(Current_edit_workspace,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)4L) : Nil;
    ab_queue_form_ = gensymed_symbol;
    ab_next_queue_element_ = Nil;
    token_menu = Nil;
    if (ab_queue_form_)
	ab_next_queue_element_ = ISVREF(ab_queue_form_,(SI_Long)0L);
  next_loop:
    if (EQ(ab_next_queue_element_,ab_queue_form_))
	goto end_loop;
    token_menu = ISVREF(ab_next_queue_element_,(SI_Long)2L);
    ab_next_queue_element_ = ISVREF(ab_next_queue_element_,(SI_Long)0L);
    gensymed_symbol = 
	    lookup_global_or_kb_specific_property_value(Qtoken_menu,
	    Class_description_gkbprop);
    if (gensymed_symbol) {
	sub_class_bit_vector = ISVREF(ISVREF(token_menu,(SI_Long)1L),
		(SI_Long)19L);
	superior_class_bit_number = IFIX(ISVREF(gensymed_symbol,(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_2 = (SI_Long)1L;
	    gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
	    gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
	    temp = (SI_Long)0L < gensymed_symbol_1;
	}
	else
	    temp = TRUEP(Nil);
    }
    else
	temp = TRUEP(Nil);
    if (temp) {
	row = Nil;
	ab_loop_list_ = ISVREF(token_menu,(SI_Long)19L);
      next_loop_1:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop_1;
	row = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	text_cell = Nil;
	ab_loop_list__1 = row;
      next_loop_2:
	if ( !TRUEP(ab_loop_list__1))
	    goto end_loop_2;
	text_cell = M_CAR(ab_loop_list__1);
	ab_loop_list__1 = M_CDR(ab_loop_list__1);
	if (text_cell && CONSP(text_cell))
	    return VALUES_1(T);
	goto next_loop_2;
      end_loop_2:;
	goto next_loop_1;
      end_loop_1:;
    }
    goto next_loop;
  end_loop:;
    return VALUES_1(Nil);
}

/* COUNT-CURRENT-NUMBER-OF-TOKEN-MENU-CHOICES */
Object count_current_number_of_token_menu_choices()
{
    Object count_1, gensymed_symbol, ab_queue_form_, ab_next_queue_element_;
    Object token_menu, sub_class_bit_vector, row, ab_loop_list_, text_cell;
    Object ab_loop_list__1;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    char temp;

    x_note_fn_call(126,448);
    count_1 = FIX((SI_Long)0L);
    gensymed_symbol = ISVREF(Current_edit_workspace,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)4L) : Nil;
    ab_queue_form_ = gensymed_symbol;
    ab_next_queue_element_ = Nil;
    token_menu = Nil;
    if (ab_queue_form_)
	ab_next_queue_element_ = ISVREF(ab_queue_form_,(SI_Long)0L);
  next_loop:
    if (EQ(ab_next_queue_element_,ab_queue_form_))
	goto end_loop;
    token_menu = ISVREF(ab_next_queue_element_,(SI_Long)2L);
    ab_next_queue_element_ = ISVREF(ab_next_queue_element_,(SI_Long)0L);
    gensymed_symbol = 
	    lookup_global_or_kb_specific_property_value(Qtoken_menu,
	    Class_description_gkbprop);
    if (gensymed_symbol) {
	sub_class_bit_vector = ISVREF(ISVREF(token_menu,(SI_Long)1L),
		(SI_Long)19L);
	superior_class_bit_number = IFIX(ISVREF(gensymed_symbol,(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_2 = (SI_Long)1L;
	    gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
	    gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
	    temp = (SI_Long)0L < gensymed_symbol_1;
	}
	else
	    temp = TRUEP(Nil);
    }
    else
	temp = TRUEP(Nil);
    if (temp) {
	row = Nil;
	ab_loop_list_ = ISVREF(token_menu,(SI_Long)19L);
      next_loop_1:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop_1;
	row = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	text_cell = Nil;
	ab_loop_list__1 = row;
      next_loop_2:
	if ( !TRUEP(ab_loop_list__1))
	    goto end_loop_2;
	text_cell = M_CAR(ab_loop_list__1);
	ab_loop_list__1 = M_CDR(ab_loop_list__1);
	if (text_cell && CONSP(text_cell))
	    count_1 = FIXNUM_ADD1(count_1);
	goto next_loop_2;
      end_loop_2:;
	goto next_loop_1;
      end_loop_1:;
    }
    goto next_loop;
  end_loop:;
    return VALUES_1(count_1);
}

/* CONVERT-CURRENT-MENU-CHOICE */
Object convert_current_menu_choice()
{
    Object total_count, index_1, count_1, svref_arg_1, gensymed_symbol;
    Object ab_queue_form_, ab_next_queue_element_, token_menu;
    Object sub_class_bit_vector, row, ab_loop_list_, text_cell;
    Object ab_loop_list__1, temp_1;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    char temp;

    x_note_fn_call(126,449);
    total_count = count_current_number_of_token_menu_choices();
    index_1 = IFIX(ISVREF(Current_edit_state,(SI_Long)69L)) < (SI_Long)0L ?
	     FIXNUM_ADD(total_count,ISVREF(Current_edit_state,
	    (SI_Long)69L)) : ISVREF(Current_edit_state,(SI_Long)69L);
    count_1 = FIX((SI_Long)0L);
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)69L)) = Nil;
    gensymed_symbol = ISVREF(Current_edit_workspace,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)4L) : Nil;
    ab_queue_form_ = gensymed_symbol;
    ab_next_queue_element_ = Nil;
    token_menu = Nil;
    if (ab_queue_form_)
	ab_next_queue_element_ = ISVREF(ab_queue_form_,(SI_Long)0L);
  next_loop:
    if (EQ(ab_next_queue_element_,ab_queue_form_))
	goto end_loop;
    token_menu = ISVREF(ab_next_queue_element_,(SI_Long)2L);
    ab_next_queue_element_ = ISVREF(ab_next_queue_element_,(SI_Long)0L);
    gensymed_symbol = 
	    lookup_global_or_kb_specific_property_value(Qtoken_menu,
	    Class_description_gkbprop);
    if (gensymed_symbol) {
	sub_class_bit_vector = ISVREF(ISVREF(token_menu,(SI_Long)1L),
		(SI_Long)19L);
	superior_class_bit_number = IFIX(ISVREF(gensymed_symbol,(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_2 = (SI_Long)1L;
	    gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
	    gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
	    temp = (SI_Long)0L < gensymed_symbol_1;
	}
	else
	    temp = TRUEP(Nil);
    }
    else
	temp = TRUEP(Nil);
    if (temp) {
	row = Nil;
	ab_loop_list_ = ISVREF(token_menu,(SI_Long)19L);
      next_loop_1:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop_1;
	row = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	text_cell = Nil;
	ab_loop_list__1 = row;
      next_loop_2:
	if ( !TRUEP(ab_loop_list__1))
	    goto end_loop_2;
	text_cell = M_CAR(ab_loop_list__1);
	ab_loop_list__1 = M_CDR(ab_loop_list__1);
	if (text_cell && CONSP(text_cell)) {
	    temp_1 = chestnut_modf_function(index_1,total_count);
	    if (NUM_EQ(temp_1,count_1)) {
		insert_token_menu_text_cell_text_at_cursor(text_cell,
			token_menu);
		return VALUES_1(Nil);
	    }
	    count_1 = FIXNUM_ADD1(count_1);
	}
	goto next_loop_2;
      end_loop_2:;
	goto next_loop_1;
      end_loop_1:;
    }
    goto next_loop;
  end_loop:
    return VALUES_1(Qnil);
}

/* HIGHLIGHT-OR-UNHIGHLIGHT-SELECTED-TOKEN-MENU-CHOICE */
Object highlight_or_unhighlight_selected_token_menu_choice(unhighlight_case_qm)
    Object unhighlight_case_qm;
{
    Object total_count, index_1, count_1, gensymed_symbol, ab_queue_form_;
    Object ab_next_queue_element_, token_menu, sub_class_bit_vector, row;
    Object ab_loop_list_, text_cell, ab_loop_list__1, temp_1;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    char temp;

    x_note_fn_call(126,450);
    total_count = count_current_number_of_token_menu_choices();
    index_1 = IFIX(ISVREF(Current_edit_state,(SI_Long)69L)) < (SI_Long)0L ?
	     FIXNUM_ADD(total_count,ISVREF(Current_edit_state,
	    (SI_Long)69L)) : ISVREF(Current_edit_state,(SI_Long)69L);
    count_1 = FIX((SI_Long)0L);
    gensymed_symbol = ISVREF(Current_edit_workspace,(SI_Long)14L);
    gensymed_symbol = gensymed_symbol ? ISVREF(gensymed_symbol,
	    (SI_Long)4L) : Nil;
    ab_queue_form_ = gensymed_symbol;
    ab_next_queue_element_ = Nil;
    token_menu = Nil;
    if (ab_queue_form_)
	ab_next_queue_element_ = ISVREF(ab_queue_form_,(SI_Long)0L);
  next_loop:
    if (EQ(ab_next_queue_element_,ab_queue_form_))
	goto end_loop;
    token_menu = ISVREF(ab_next_queue_element_,(SI_Long)2L);
    ab_next_queue_element_ = ISVREF(ab_next_queue_element_,(SI_Long)0L);
    gensymed_symbol = 
	    lookup_global_or_kb_specific_property_value(Qtoken_menu,
	    Class_description_gkbprop);
    if (gensymed_symbol) {
	sub_class_bit_vector = ISVREF(ISVREF(token_menu,(SI_Long)1L),
		(SI_Long)19L);
	superior_class_bit_number = IFIX(ISVREF(gensymed_symbol,(SI_Long)18L));
	sub_class_vector_index = superior_class_bit_number >>  -  - 
		(SI_Long)3L;
	if (sub_class_vector_index < 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
	    gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
		    sub_class_vector_index);
	    gensymed_symbol_2 = (SI_Long)1L;
	    gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
	    gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
	    gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
	    temp = (SI_Long)0L < gensymed_symbol_1;
	}
	else
	    temp = TRUEP(Nil);
    }
    else
	temp = TRUEP(Nil);
    if (temp) {
	row = Nil;
	ab_loop_list_ = ISVREF(token_menu,(SI_Long)19L);
      next_loop_1:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop_1;
	row = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	text_cell = Nil;
	ab_loop_list__1 = row;
      next_loop_2:
	if ( !TRUEP(ab_loop_list__1))
	    goto end_loop_2;
	text_cell = M_CAR(ab_loop_list__1);
	ab_loop_list__1 = M_CDR(ab_loop_list__1);
	if (text_cell && CONSP(text_cell)) {
	    temp_1 = chestnut_modf_function(index_1,total_count);
	    if (NUM_EQ(temp_1,count_1)) {
		highlight_or_unhighlight_token_menu_text_cell(token_menu,
			text_cell,unhighlight_case_qm);
		return VALUES_1(T);
	    }
	    count_1 = FIXNUM_ADD1(count_1);
	}
	goto next_loop_2;
      end_loop_2:;
	goto next_loop_1;
      end_loop_1:;
    }
    goto next_loop;
  end_loop:
    return VALUES_1(Qnil);
}

static Object Qreplace_fragments_on_sides_qm;  /* replace-fragments-on-sides? */

static Object Qreplace_entire_text_qm;  /* replace-entire-text? */

/* INSERT-TOKEN-MENU-TEXT-CELL-TEXT-AT-CURSOR */
Object insert_token_menu_text_cell_text_at_cursor(cell,token_menu)
    Object cell, token_menu;
{
    Object choice_qm, text_string, svref_arg_1;

    x_note_fn_call(126,451);
    choice_qm = getf(CADR(cell),Qchoice,_);
    text_string = choice_qm ? copy_text_string(choice_qm) : Nil;
    if (text_string);
    else
	text_string = convert_text_to_text_string(1,CDDDR(cell));
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)69L)) = Nil;
    insert_text_string_at_cursor(6,text_string,
	    get_slot_value_function(token_menu,
	    Qreplace_fragments_on_sides_qm,Nil),
	    get_slot_value_function(token_menu,
	    Qhandle_spaces_intelligently_qm,Nil),Nil,Nil,
	    get_slot_value_function(token_menu,Qreplace_entire_text_qm,Nil));
    return reclaim_text_string(text_string);
}

static Object Qlight_gray;         /* light-gray */

/* HIGHLIGHT-OR-UNHIGHLIGHT-TOKEN-MENU-TEXT-CELL */
Object highlight_or_unhighlight_token_menu_text_cell(token_menu,cell,
	    unhighlight_case_qm)
    Object token_menu, cell, unhighlight_case_qm;
{
    x_note_fn_call(126,452);
    return highlight_or_unhighlight_cell(4,cell,token_menu,Qlight_gray,
	    unhighlight_case_qm);
}

/* SELECT-NEXT-TOKEN-MENU-CHOICE */
Object select_next_token_menu_choice(left_or_right)
    Object left_or_right;
{
    Object svref_arg_1;
    SI_Long incff_1_arg, svref_new_value;

    x_note_fn_call(126,453);
    highlight_or_unhighlight_selected_token_menu_choice(T);
    svref_arg_1 = Current_edit_state;
    incff_1_arg = EQ(left_or_right,Qleft) ? (SI_Long)-1L : (SI_Long)1L;
    svref_new_value = IFIX(ISVREF(svref_arg_1,(SI_Long)69L)) + incff_1_arg;
    ISVREF(svref_arg_1,(SI_Long)69L) = FIX(svref_new_value);
    return highlight_or_unhighlight_selected_token_menu_choice(Nil);
}

/* SELECT-NEXT-OR-PREVIOUS-EDITOR-COMPONENT-GROUP */
Object select_next_or_previous_editor_component_group(next_or_previous)
    Object next_or_previous;
{
    Object svref_arg_1;

    x_note_fn_call(126,454);
    if (ISVREF(Current_edit_state,(SI_Long)69L)) {
	highlight_or_unhighlight_selected_token_menu_choice(T);
	svref_arg_1 = Current_edit_state;
	return VALUES_1(SVREF(svref_arg_1,FIX((SI_Long)69L)) = Nil);
    }
    else {
	svref_arg_1 = Current_edit_state;
	ISVREF(svref_arg_1,(SI_Long)69L) = FIX((SI_Long)0L);
	return highlight_or_unhighlight_selected_token_menu_choice(Nil);
    }
}

static Object Qclass_qualified_name;  /* class-qualified-name */

static Object Qof;                 /* of */

/* PARSE-CONSTANT-DESIGNATION */
Object parse_constant_designation(possible_designation_text_string,start_index)
    Object possible_designation_text_string, start_index;
{
    Object parse_qm, class_qm, symbol_qm, end_index_qm, subparse_qm;
    Object result;

    x_note_fn_call(126,455);
    parse_qm = Nil;
    class_qm = Nil;
    result = read_symbol_from_text_string(2,
	    possible_designation_text_string,start_index);
    MVS_2(result,symbol_qm,end_index_qm);
    if ( !TRUEP(symbol_qm))
	return VALUES_1(Nil);
    else if ( !TRUEP(end_index_qm))
	return VALUES_1(symbol_qm);
    else {
	parse_qm = symbol_qm;
	result = read_attribute_name_from_text_string_1(possible_designation_text_string,
		end_index_qm,Nil);
	MVS_3(result,symbol_qm,end_index_qm,class_qm);
	if ( !TRUEP(symbol_qm))
	    return VALUES_1(parse_qm);
	else if ( !TRUEP(end_index_qm))
	    return VALUES_1(Nil);
	else if ( !EQ(parse_qm,Qthe))
	    return VALUES_1(Nil);
	else {
	    if (class_qm)
		symbol_qm = gensym_list_3(Qclass_qualified_name,class_qm,
			symbol_qm);
	    parse_qm = gensym_list_2(parse_qm,symbol_qm);
	    result = read_symbol_from_text_string(2,
		    possible_designation_text_string,end_index_qm);
	    MVS_2(result,symbol_qm,end_index_qm);
	    if ( !TRUEP(end_index_qm))
		return VALUES_1(Nil);
	    else if ( !EQ(symbol_qm,Qof))
		return VALUES_1(Nil);
	    else {
		subparse_qm = 
			parse_constant_designation(possible_designation_text_string,
			end_index_qm);
		if ( !TRUEP(subparse_qm))
		    return VALUES_1(Nil);
		else
		    return VALUES_1(nconc2(parse_qm,
			    gensym_cons_1(subparse_qm,Nil)));
	    }
	}
    }
}

Object Most_lefthand_float_digits = UNBOUND;

Object Most_righthand_float_zeros = UNBOUND;

/* INITIALIZE-MOST-FIXNUM-DIGITS */
Object initialize_most_fixnum_digits()
{
    x_note_fn_call(126,456);
    return ceiling(llog(Most_positive_fixnum,FIX((SI_Long)10L)),_);
}

Object Most_fixnum_digits = UNBOUND;

static Object string_constant_47;  /* "~d" */

/* INITIALIZE-DIGITS-OF-EXTREMAL-FIXNUM-AS-STRING */
Object initialize_digits_of_extremal_fixnum_as_string()
{
    x_note_fn_call(126,457);
    return tformat_text_string(2,string_constant_47,Most_positive_fixnum);
}

Object Digits_of_extremal_fixnum_as_string = UNBOUND;

/* INITIALIZE-DIGITS-OF-MOST-POSITIVE-FIXNUM-AS-STRING */
Object initialize_digits_of_most_positive_fixnum_as_string()
{
    x_note_fn_call(126,458);
    return VALUES_1(Digits_of_extremal_fixnum_as_string);
}

Object Digits_of_most_positive_fixnum_as_string = UNBOUND;

/* INITIALIZE-DIGITS-OF-MOST-NEGATIVE-FIXNUM-AS-STRING */
Object initialize_digits_of_most_negative_fixnum_as_string()
{
    x_note_fn_call(126,459);
    return stringw(format((SI_Long)3L,Nil,"~d",
	    FIXNUM_NEGATE(Most_negative_fixnum)));
}

Object Digits_of_most_negative_fixnum_as_string = UNBOUND;

Object Digits_of_largest_float_as_string = UNBOUND;

Object Digits_of_smallest_normalized_float_as_string = UNBOUND;

static Object list_constant_15;    /* # */

static Object list_constant_16;    /* # */

static Object list_constant_17;    /* # */

static Object list_constant_18;    /* # */

/* TOKENIZE-NUMBER-FROM-USER */
Object tokenize_number_from_user(string_1,start_index,final_index)
    Object string_1, start_index, final_index;
{
    Object sign, nonzero, digit, exponent, sign_of_fraction;
    Object number_of_lefthand_digits, lefthand_digits, decimal_point_present_p;
    Object number_of_righthand_leading_zeros, righthand_digits;
    Object exponent_present_p, sign_of_exponent, exponent_integer;
    Object read_as_long_qm, this_char, this_index, previous_char, new_index;
    Object last_cons, new_cons, first_cons, collected_list, temp, number_qm;
    Object type_qm;
    SI_Long zero, point, long_suffix, gensymed_symbol, gensymed_symbol_1;
    char inner_index_p;
    Object result;

    x_note_fn_call(126,460);
    sign = list_constant_15;
    zero = (SI_Long)48L;
    nonzero = list_constant_16;
    digit = list_constant_17;
    point = (SI_Long)46L;
    exponent = list_constant_18;
    long_suffix = (SI_Long)76L;
    sign_of_fraction = Nil;
    number_of_lefthand_digits = FIX((SI_Long)0L);
    lefthand_digits = Nil;
    decimal_point_present_p = Nil;
    number_of_righthand_leading_zeros = FIX((SI_Long)0L);
    righthand_digits = Nil;
    exponent_present_p = Nil;
    sign_of_exponent = Nil;
    exponent_integer = FIX((SI_Long)0L);
    read_as_long_qm = Nil;
    this_char = FIX(UBYTE_16_ISAREF_1(string_1,IFIX(start_index)));
    this_index = start_index;
    previous_char = Nil;
  start_tokenizing:
    if (wide_character_member(this_char,sign)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto sign_of_fraction_1;
	}
	else
	    goto finish;
    }
    if (EQ(this_char,FIX(zero))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto leading_lefthand_zeros;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,nonzero)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto number_of_lefthand_digits_1;
	}
	else
	    goto finish;
    }
    if (EQ(this_char,FIX(point))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto decimal_point_present_p_1;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,exponent)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_present_p_1;
	}
	else
	    goto finish;
    }
    goto finish;
  sign_of_fraction_1:
    sign_of_fraction = previous_char;
    if (EQ(this_char,FIX(zero))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto leading_lefthand_zeros;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,nonzero)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto number_of_lefthand_digits_1;
	}
	else
	    goto finish;
    }
    if (EQ(this_char,FIX(point))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto decimal_point_present_p_1;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,exponent)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_present_p_1;
	}
	else
	    goto finish;
    }
    goto finish;
  leading_lefthand_zeros:
    if (EQ(this_char,FIX(zero))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto leading_lefthand_zeros;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,nonzero)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto number_of_lefthand_digits_1;
	}
	else
	    goto finish;
    }
    if (EQ(this_char,FIX(point))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto decimal_point_present_p_1;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,exponent)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_present_p_1;
	}
	else
	    goto finish;
    }
    goto finish;
  number_of_lefthand_digits_1:
    number_of_lefthand_digits = FIXNUM_ADD1(number_of_lefthand_digits);
  lefthand_digits_1:
    if (lefthand_digits) {
	last_cons = FIRST(lefthand_digits);
	new_cons = gensym_cons_1(previous_char,Nil);
	M_CDR(last_cons) = new_cons;
	M_FIRST(lefthand_digits) = new_cons;
    }
    else {
	first_cons = gensym_cons_1(previous_char,Nil);
	lefthand_digits = gensym_list_3(first_cons,first_cons,Nil);
    }
    if (wide_character_member(this_char,digit)) {
	if (FIXNUM_EQ(this_index,final_index)) {
	    if (lefthand_digits) {
		collected_list = SECOND(lefthand_digits);
		reclaim_gensym_list_1(lefthand_digits);
		lefthand_digits = collected_list;
	    }
	}
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto number_of_lefthand_digits_1;
	}
	else
	    goto finish;
    }
    if (EQ(this_char,FIX(point))) {
	if (lefthand_digits) {
	    collected_list = SECOND(lefthand_digits);
	    reclaim_gensym_list_1(lefthand_digits);
	    lefthand_digits = collected_list;
	}
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto decimal_point_present_p_1;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,exponent)) {
	if (lefthand_digits) {
	    collected_list = SECOND(lefthand_digits);
	    reclaim_gensym_list_1(lefthand_digits);
	    lefthand_digits = collected_list;
	}
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_present_p_1;
	}
	else
	    goto finish;
    }
    if (EQ(this_char,FIX(long_suffix))) {
	if (lefthand_digits) {
	    collected_list = SECOND(lefthand_digits);
	    reclaim_gensym_list_1(lefthand_digits);
	    lefthand_digits = collected_list;
	}
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto read_as_long_qm_1;
	}
	else
	    goto finish;
    }
    if (lefthand_digits) {
	collected_list = SECOND(lefthand_digits);
	reclaim_gensym_list_1(lefthand_digits);
	lefthand_digits = collected_list;
    }
    goto finish;
  decimal_point_present_p_1:
    decimal_point_present_p = T;
    if (EQ(this_char,FIX(zero))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto number_of_righthand_leading_zeros_1;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,nonzero)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto righthand_digits_1;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,exponent)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_present_p_1;
	}
	else
	    goto finish;
    }
    goto finish;
  number_of_righthand_leading_zeros_1:
    number_of_righthand_leading_zeros = 
	    FIXNUM_ADD1(number_of_righthand_leading_zeros);
    if (EQ(this_char,FIX(zero))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto number_of_righthand_leading_zeros_1;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,nonzero)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto righthand_digits_1;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,exponent)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_present_p_1;
	}
	else
	    goto finish;
    }
    goto finish;
  righthand_digits_1:
    if (righthand_digits) {
	last_cons = FIRST(righthand_digits);
	new_cons = gensym_cons_1(previous_char,Nil);
	M_CDR(last_cons) = new_cons;
	M_FIRST(righthand_digits) = new_cons;
    }
    else {
	first_cons = gensym_cons_1(previous_char,Nil);
	righthand_digits = gensym_list_3(first_cons,first_cons,Nil);
    }
    if (wide_character_member(this_char,digit)) {
	if (FIXNUM_EQ(this_index,final_index)) {
	    if (righthand_digits) {
		collected_list = SECOND(righthand_digits);
		reclaim_gensym_list_1(righthand_digits);
		righthand_digits = collected_list;
	    }
	}
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto righthand_digits_1;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,exponent)) {
	if (righthand_digits) {
	    collected_list = SECOND(righthand_digits);
	    reclaim_gensym_list_1(righthand_digits);
	    righthand_digits = collected_list;
	}
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_present_p_1;
	}
	else
	    goto finish;
    }
    if (righthand_digits) {
	collected_list = SECOND(righthand_digits);
	reclaim_gensym_list_1(righthand_digits);
	righthand_digits = collected_list;
    }
    goto finish;
  exponent_present_p_1:
    exponent_present_p = T;
    if (wide_character_member(this_char,sign)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto sign_of_exponent_1;
	}
	else
	    goto finish;
    }
    if (EQ(this_char,FIX(zero))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto leading_zeros_of_exponent;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,nonzero)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_integer_1;
	}
	else
	    goto finish;
    }
    goto finish;
  sign_of_exponent_1:
    sign_of_exponent = previous_char;
    if (EQ(this_char,FIX(zero))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto leading_zeros_of_exponent;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,nonzero)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_integer_1;
	}
	else
	    goto finish;
    }
    goto finish;
  leading_zeros_of_exponent:
    if (EQ(this_char,FIX(zero))) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto leading_zeros_of_exponent;
	}
	else
	    goto finish;
    }
    if (wide_character_member(this_char,nonzero)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_integer_1;
	}
	else
	    goto finish;
    }
    goto finish;
  exponent_integer_1:
    gensymed_symbol = IFIX(exponent_integer) * (SI_Long)10L;
    gensymed_symbol_1 = IFIX(previous_char);
    temp = (SI_Long)48L <= gensymed_symbol_1 && gensymed_symbol_1 <= 
	    (SI_Long)57L ? FIX(gensymed_symbol_1 - (SI_Long)48L) : Nil;
    if (temp);
    else
	temp = FIX((SI_Long)0L);
    gensymed_symbol_1 = IFIX(temp);
    exponent_integer = FIX(gensymed_symbol + gensymed_symbol_1);
    if (wide_character_member(this_char,digit)) {
	new_index = FIXNUM_ADD1(this_index);
	inner_index_p = FIXNUM_LT(new_index,final_index);
	if (inner_index_p || FIXNUM_EQ(new_index,final_index)) {
	    this_index = new_index;
	    previous_char = this_char;
	    this_char = inner_index_p ? FIX(UBYTE_16_ISAREF_1(string_1,
		    IFIX(this_index))) : Qnil;
	    goto exponent_integer_1;
	}
	else
	    goto finish;
    }
    goto finish;
  read_as_long_qm_1:
    read_as_long_qm = T;
    goto finish;
  unread_and_finish:
  finish:
    final_index = this_index;
    result = read_possibly_out_of_bounds_numeric_token(string_1,
	    start_index,final_index,sign_of_fraction,
	    number_of_lefthand_digits,lefthand_digits,
	    decimal_point_present_p,number_of_righthand_leading_zeros,
	    righthand_digits,exponent_present_p,sign_of_exponent,
	    exponent_integer,read_as_long_qm);
    MVS_2(result,number_qm,type_qm);
    if (lefthand_digits)
	reclaim_gensym_list_1(lefthand_digits);
    if (righthand_digits)
	reclaim_gensym_list_1(righthand_digits);
    return VALUES_2(number_qm,type_qm);
    return VALUES_1(Qnil);
}

/* DIGIT-STRING-OVERFLOWED-BY-DIGIT-CHAR-LISTS */
Object digit_string_overflowed_by_digit_char_lists(digit_string,
	    lefthand_digit_char_list,righthand_digit_char_list)
    Object digit_string, lefthand_digit_char_list, righthand_digit_char_list;
{
    Object last_index_in_digit_string, index_1, digit_char_cons;
    Object char_list_element, temp;
    char temp_1;

    x_note_fn_call(126,461);
    last_index_in_digit_string = FIXNUM_SUB1(lengthw(digit_string));
    index_1 = FIX((SI_Long)-1L);
    digit_char_cons = lefthand_digit_char_list;
    char_list_element = Nil;
  next_loop:
    if ( !TRUEP(digit_char_cons))
	goto end_loop;
    char_list_element = CAR(digit_char_cons);
    index_1 = FIXNUM_ADD1(index_1);
    if (UBYTE_16_ISAREF_1(digit_string,IFIX(index_1)) > 
	    IFIX(char_list_element))
	return VALUES_1(Nil);
    if (UBYTE_16_ISAREF_1(digit_string,IFIX(index_1)) < 
	    IFIX(char_list_element))
	return VALUES_1(T);
    if (FIXNUM_EQ(index_1,last_index_in_digit_string)) {
	temp = CDR(digit_char_cons);
	if (temp)
	    return VALUES_1(temp);
	else
	    return VALUES_1(righthand_digit_char_list);
    }
    digit_char_cons = M_CDR(digit_char_cons);
    goto next_loop;
  end_loop:
    temp_1 = TRUEP(T);
    goto end_1;
    temp_1 = TRUEP(Qnil);
  end_1:;
    if (temp_1) {
	digit_char_cons = righthand_digit_char_list;
	char_list_element = Nil;
      next_loop_1:
	if ( !TRUEP(digit_char_cons))
	    goto end_loop_1;
	char_list_element = CAR(digit_char_cons);
	index_1 = FIXNUM_ADD1(index_1);
	if (UBYTE_16_ISAREF_1(digit_string,IFIX(index_1)) > 
		IFIX(char_list_element))
	    return VALUES_1(Nil);
	if (UBYTE_16_ISAREF_1(digit_string,IFIX(index_1)) < 
		IFIX(char_list_element))
	    return VALUES_1(T);
	if (FIXNUM_EQ(index_1,last_index_in_digit_string))
	    return VALUES_1(CDR(digit_char_cons));
	digit_char_cons = M_CDR(digit_char_cons);
	goto next_loop_1;
      end_loop_1:
	return VALUES_1(Nil);
	return VALUES_1(Qnil);
    }
    else
	return VALUES_1(Nil);
}

/* DIGIT-STRING-UNDERFLOWED-BY-DIGIT-CHAR-LISTS */
Object digit_string_underflowed_by_digit_char_lists(digit_string,
	    lefthand_digit_char_list,righthand_digit_char_list)
    Object digit_string, lefthand_digit_char_list, righthand_digit_char_list;
{
    Object last_index_in_digit_string, index_1, char_list_element;
    Object ab_loop_list_;
    char temp;

    x_note_fn_call(126,462);
    last_index_in_digit_string = FIXNUM_SUB1(lengthw(digit_string));
    index_1 = FIX((SI_Long)-1L);
    char_list_element = Nil;
    ab_loop_list_ = lefthand_digit_char_list;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    char_list_element = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    index_1 = FIXNUM_ADD1(index_1);
    if (UBYTE_16_ISAREF_1(digit_string,IFIX(index_1)) > 
	    IFIX(char_list_element))
	return VALUES_1(T);
    if (UBYTE_16_ISAREF_1(digit_string,IFIX(index_1)) < 
	    IFIX(char_list_element))
	return VALUES_1(Nil);
    if (FIXNUM_EQ(index_1,last_index_in_digit_string))
	return VALUES_1(Nil);
    goto next_loop;
  end_loop:
    temp = TRUEP(T);
    goto end_1;
    temp = TRUEP(Qnil);
  end_1:;
    if (temp) {
	char_list_element = Nil;
	ab_loop_list_ = righthand_digit_char_list;
      next_loop_1:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop_1;
	char_list_element = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	index_1 = FIXNUM_ADD1(index_1);
	if (UBYTE_16_ISAREF_1(digit_string,IFIX(index_1)) > 
		IFIX(char_list_element))
	    return VALUES_1(T);
	if (UBYTE_16_ISAREF_1(digit_string,IFIX(index_1)) < 
		IFIX(char_list_element))
	    return VALUES_1(Nil);
	if (FIXNUM_EQ(index_1,last_index_in_digit_string))
	    return VALUES_1(Nil);
	goto next_loop_1;
      end_loop_1:
	return VALUES_1(T);
	return VALUES_1(Qnil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qlong;               /* long */

static Object Qoverflow;           /* overflow */

static Object Qunderflow;          /* underflow */

/* READ-POSSIBLY-OUT-OF-BOUNDS-NUMERIC-TOKEN */
Object read_possibly_out_of_bounds_numeric_token(string_1,start_index,
	    final_index,sign_of_fraction,number_of_lefthand_digits,
	    lefthand_digits,decimal_point_present_p,
	    number_of_righthand_leading_zeros,righthand_digits,
	    exponent_present_p,sign_of_exponent,exponent_integer,
	    read_as_long_qm)
    Object string_1, start_index, final_index, sign_of_fraction;
    Object number_of_lefthand_digits, lefthand_digits, decimal_point_present_p;
    Object number_of_righthand_leading_zeros, righthand_digits;
    Object exponent_present_p, sign_of_exponent, exponent_integer;
    Object read_as_long_qm;
{
    Object temp, explicit_exponent, implicit_exponent, exponent;
    Object cond_temporary_1, cond_temporary_2, cond_temporary_3;
    Object cond_temporary_4;

    x_note_fn_call(126,463);
    if (read_as_long_qm) {
	temp = read_long_from_string(3,string_1,start_index,
		FIXNUM_SUB1(final_index));
	return VALUES_2(temp,Qlong);
    }
    else if (FIXNUM_GT(number_of_lefthand_digits,Most_lefthand_float_digits))
	return VALUES_2(Qoverflow,Nil);
    else if (FIXNUM_EQ(number_of_lefthand_digits,
	    Most_lefthand_float_digits) && 
	    digit_string_overflowed_by_digit_char_lists(Digits_of_largest_float_as_string,
	    lefthand_digits,righthand_digits))
	return VALUES_2(Qoverflow,Nil);
    else if (FIXNUM_GT(number_of_righthand_leading_zeros,
	    Most_righthand_float_zeros))
	return VALUES_2(Qunderflow,Nil);
    else if (FIXNUM_EQ(number_of_righthand_leading_zeros,
	    Most_righthand_float_zeros) && 
	    digit_string_underflowed_by_digit_char_lists(Digits_of_smallest_normalized_float_as_string,
	    lefthand_digits,righthand_digits))
	return VALUES_2(Qunderflow,Nil);
    else {
	temp = sign_of_exponent;
	if (temp);
	else
	    temp = FIX((SI_Long)43L);
	if ( !(FIXNUMP(temp) && FIXNUM_LE(FIX((SI_Long)-128L),temp) && 
		FIXNUM_LE(temp,FIX((SI_Long)127L))))
	    explicit_exponent = exponent_integer;
	else
	    switch (INTEGER_TO_CHAR(temp)) {
	      case 45:
		explicit_exponent = FIXNUM_NEGATE(exponent_integer);
		break;
	      default:
		explicit_exponent = exponent_integer;
		break;
	    }
	implicit_exponent = IFIX(number_of_lefthand_digits) > (SI_Long)0L ?
		 number_of_lefthand_digits : 
		FIXNUM_NEGATE(FIXNUM_ADD1(number_of_righthand_leading_zeros));
	exponent = FIXNUM_ADD(explicit_exponent,implicit_exponent);
	if (FIXNUM_GT(exponent,Most_lefthand_float_digits))
	    return VALUES_2(Qoverflow,Nil);
	else {
	    cond_temporary_1 = Nil;
	    cond_temporary_1 = FIXNUM_EQ(exponent,
		    Most_lefthand_float_digits) ? T : Nil;
	    if (cond_temporary_1 && 
		    digit_string_overflowed_by_digit_char_lists(Digits_of_largest_float_as_string,
		    lefthand_digits,righthand_digits))
		return VALUES_2(Qoverflow,Nil);
	    else if (cond_temporary_1) {
		temp = read_float_from_string(string_1,start_index,
			final_index);
		return VALUES_2(temp,Qfloat);
	    }
	    else {
		cond_temporary_2 = Nil;
		cond_temporary_2 = FIXNUM_NEGATE(exponent);
		if (FIXNUM_GT(cond_temporary_2,Most_righthand_float_zeros))
		    return VALUES_2(Qunderflow,Nil);
		else if (FIXNUM_EQ(cond_temporary_2,
			Most_righthand_float_zeros) && 
			digit_string_underflowed_by_digit_char_lists(Digits_of_smallest_normalized_float_as_string,
			lefthand_digits,righthand_digits))
		    return VALUES_2(Qunderflow,Nil);
		else if (FIXNUM_EQ(cond_temporary_2,
			Most_righthand_float_zeros)) {
		    temp = read_float_from_string(string_1,start_index,
			    final_index);
		    return VALUES_2(temp,Qfloat);
		}
		else if (decimal_point_present_p || exponent_present_p || 
			FIXNUM_GT(exponent,Most_fixnum_digits)) {
		    temp = read_float_from_string(string_1,start_index,
			    final_index);
		    return VALUES_2(temp,Qfloat);
		}
		else {
		    cond_temporary_3 = Nil;
		    cond_temporary_4 = Nil;
		    cond_temporary_4 = FIXNUM_EQ(exponent,
			    Most_fixnum_digits) ? T : Nil;
		    cond_temporary_3 = cond_temporary_4 ? 
			    (EQ(FIX((SI_Long)45L),sign_of_fraction) ? T : 
			    Nil) : Qnil;
		    if (cond_temporary_3 && 
			    digit_string_overflowed_by_digit_char_lists(Digits_of_most_negative_fixnum_as_string,
			    lefthand_digits,righthand_digits)) {
			temp = read_float_from_string(string_1,start_index,
				final_index);
			return VALUES_2(temp,Qfloat);
		    }
		    else if (cond_temporary_3) {
			temp = read_fixnum_from_string(3,string_1,
				start_index,final_index);
			return VALUES_2(temp,Qfixnum);
		    }
		    else if (cond_temporary_4 && 
			    digit_string_overflowed_by_digit_char_lists(Digits_of_most_positive_fixnum_as_string,
			    lefthand_digits,righthand_digits)) {
			temp = read_float_from_string(string_1,start_index,
				final_index);
			return VALUES_2(temp,Qfloat);
		    }
		    else {
			temp = read_fixnum_from_string(3,string_1,
				start_index,final_index);
			return VALUES_2(temp,Qfixnum);
		    }
		}
	    }
	}
    }
}

/* INSTANCE-OF-TOKEN-ACCEPTABLE-IN-CURRENT-EDIT-STATE-P */
Object instance_of_token_acceptable_in_current_edit_state_p(token_value,
	    line_index,character_index)
    Object token_value, line_index, character_index;
{
    Object current_line_index_for_end_of_token;
    Object current_character_index_after_token, temp;
    Declare_special(2);

    x_note_fn_call(126,464);
    current_line_index_for_end_of_token = line_index;
    current_character_index_after_token = character_index;
    PUSH_SPECIAL(Current_character_index_after_token,current_character_index_after_token,
	    1);
      PUSH_SPECIAL(Current_line_index_for_end_of_token,current_line_index_for_end_of_token,
	      0);
	temp = Current_edit_state ? 
		instance_of_category_acceptable_p(token_value,
		incomplete_phrases_for_previous_token(),T) : Nil;
      POP_SPECIAL();
    POP_SPECIAL();
    return VALUES_1(temp);
}

/* PARTIAL-STRING-ACCEPTABLE-P-FUNCTION */
Object partial_string_acceptable_p_function(partial_string_token,
	    line_index,character_index)
    Object partial_string_token, line_index, character_index;
{
    Object current_line_index_for_end_of_token;
    Object current_character_index_after_token, temp;
    Declare_special(2);

    x_note_fn_call(126,465);
    if (Tokenize_with_editing_context_p) {
	current_line_index_for_end_of_token = line_index;
	current_character_index_after_token = character_index;
	PUSH_SPECIAL(Current_character_index_after_token,current_character_index_after_token,
		1);
	  PUSH_SPECIAL(Current_line_index_for_end_of_token,current_line_index_for_end_of_token,
		  0);
	    temp = ISVREF(Current_edit_state,(SI_Long)31L);
	    temp = instance_of_category_acceptable_p(partial_string_token,
		    CAR(temp),Nil);
	  POP_SPECIAL();
	POP_SPECIAL();
    }
    else
	temp = Nil;
    return VALUES_1(temp);
}

static Object Qkb_load_file_command;  /* kb-load-file-command */

/* NOT-IN-KB-LOADING-EDITING-CONTEXT */
Object not_in_kb_loading_editing_context()
{
    Object temp, frame, symbol, gensymed_symbol, sub_class_bit_vector;
    SI_Long superior_class_bit_number, sub_class_vector_index;
    SI_Long gensymed_symbol_1, gensymed_symbol_2, gensymed_symbol_3;
    char temp_1;

    x_note_fn_call(126,466);
    temp =  !TRUEP(Tokenize_with_editing_context_p) ? T : Nil;
    if (temp);
    else {
	frame = ISVREF(Current_edit_state,(SI_Long)3L);
	symbol = Qkb_load_file_command;
	gensymed_symbol = 
		lookup_global_or_kb_specific_property_value(symbol,
		Class_description_gkbprop);
	if (gensymed_symbol) {
	    sub_class_bit_vector = ISVREF(ISVREF(frame,(SI_Long)1L),
		    (SI_Long)19L);
	    superior_class_bit_number = IFIX(ISVREF(gensymed_symbol,
		    (SI_Long)18L));
	    sub_class_vector_index = superior_class_bit_number >>  -  - 
		    (SI_Long)3L;
	    if (sub_class_vector_index < 
		    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(sub_class_bit_vector))) {
		gensymed_symbol_1 = UBYTE_8_ISAREF_1(sub_class_bit_vector,
			sub_class_vector_index);
		gensymed_symbol_2 = (SI_Long)1L;
		gensymed_symbol_3 = superior_class_bit_number & (SI_Long)7L;
		gensymed_symbol_2 = gensymed_symbol_2 << gensymed_symbol_3;
		gensymed_symbol_1 = gensymed_symbol_1 & gensymed_symbol_2;
		temp_1 = (SI_Long)0L < gensymed_symbol_1;
	    }
	    else
		temp_1 = TRUEP(Nil);
	}
	else
	    temp_1 = TRUEP(Nil);
	temp =  !temp_1 ? T : Nil;
    }
    return VALUES_1(temp);
}

/* CURRENT-PUNCTUATION-ALIST */
Object current_punctuation_alist()
{
    Object temp;

    x_note_fn_call(126,467);
    temp = Tokenize_with_editing_context_p ? ISVREF(Current_edit_state,
	    (SI_Long)72L) : Qnil;
    if (temp);
    else
	temp = Punctuation_alist;
    return VALUES_1(temp);
}

/* COPY-CURRENT-WIDE-STRING-POSSIBLY-NOTING-CREATION */
Object copy_current_wide_string_possibly_noting_creation()
{
    Object temp;

    x_note_fn_call(126,468);
    temp = Tokenize_with_editing_context_p ? 
	    note_use_of_text_string_in_phrase(copy_current_wide_string()) :
	     copy_current_wide_string();
    return VALUES_1(temp);
}

/* MAKE-RUNTIME-FLOAT-FOR-TOKENIZER */
Object make_runtime_float_for_tokenizer(value)
    Object value;
{
    Object amf_available_array_cons_qm, amf_array, temp, svref_new_value;
    Object amf_result, incff_1_arg, new_float, temp_1;
    double aref_new_value;

    x_note_fn_call(126,469);
    if (Tokenize_with_editing_context_p) {
	amf_available_array_cons_qm = 
		ISVREF(Vector_of_simple_float_array_pools,(SI_Long)1L);
	if (amf_available_array_cons_qm) {
	    amf_array = M_CAR(amf_available_array_cons_qm);
	    temp = Vector_of_simple_float_array_pools;
	    svref_new_value = M_CDR(amf_available_array_cons_qm);
	    SVREF(temp,FIX((SI_Long)1L)) = svref_new_value;
	    inline_note_reclaim_cons(amf_available_array_cons_qm,Qab_gensym);
	    temp = Available_gensym_conses;
	    M_CDR(amf_available_array_cons_qm) = temp;
	    Available_gensym_conses = amf_available_array_cons_qm;
	    amf_result = amf_array;
	}
	else {
	    temp = FIXNUM_ADD1(Created_simple_float_array_pool_arrays);
	    Created_simple_float_array_pool_arrays = temp;
	    incff_1_arg = 
		    bytes_per_double_float_simple_array(FIX((SI_Long)1L));
	    temp = FIXNUM_ADD(Simple_float_array_pool_memory_usage,
		    incff_1_arg);
	    Simple_float_array_pool_memory_usage = temp;
	    amf_result = generate_float_vector(FIX((SI_Long)1L));
	}
	new_float = amf_result;
	aref_new_value = DOUBLE_FLOAT_TO_DOUBLE(value);
	DFLOAT_ISASET_1(new_float,(SI_Long)0L,aref_new_value);
	temp_1 = note_use_of_managed_float_in_phrase(new_float);
    }
    else
	temp_1 = make_slot_value_float(value);
    return VALUES_1(temp_1);
}

/* MAKE-RUNTIME-LONG-FOR-TOKENIZER */
Object make_runtime_long_for_tokenizer(value)
    Object value;
{
    Object new_long, temp;
    SI_int64 aref_new_value;

    x_note_fn_call(126,470);
    if (Tokenize_with_editing_context_p) {
	new_long = allocate_managed_long_box();
	aref_new_value = INTEGER_TO_INT64(value);
	set_aref1(new_long,FIX((SI_Long)0L),INT64_TO_INTEGER(aref_new_value));
	temp = note_use_of_managed_long_in_phrase(new_long);
    }
    else
	temp = make_slot_value_long(value);
    return VALUES_1(temp);
}

/* GET-NEXT-TOKEN-FROM-TEXT-IF-AVAILABLE */
Object get_next_token_from_text_if_available varargs_1(int, n)
{
    Object tokenizer, cursor_line_index_qm, cursor_character_index_qm;
    Object line_index, character_index, text_tail;
    Object in_editing_context_qm, end_line_index_qm, end_character_index_qm;
    Object return_partial_tokens_qm, tokenize_with_editing_context_p;
    Object end_line_index, end_character_index, current_wide_string_list;
    Object wide_string_bv16, current_wide_string;
    Object fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object token_value, token_type_or_partial_types;
    Object line_index_for_end_of_token, character_index_after_token;
    Object text_tail_for_end_of_token_qm, token_self_terminating_p;
    SI_Long bv16_length, aref_arg_2, aref_new_value, length_1;
    Declare_varargs_nonrelocating;
    Declare_special(6);
    Object result;

    x_note_fn_call(126,471);
    INIT_ARGS_nonrelocating();
    tokenizer = REQUIRED_ARG_nonrelocating();
    cursor_line_index_qm = REQUIRED_ARG_nonrelocating();
    cursor_character_index_qm = REQUIRED_ARG_nonrelocating();
    line_index = REQUIRED_ARG_nonrelocating();
    character_index = REQUIRED_ARG_nonrelocating();
    text_tail = REQUIRED_ARG_nonrelocating();
    in_editing_context_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    end_line_index_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    end_character_index_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    return_partial_tokens_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : cursor_line_index_qm;
    END_ARGS_nonrelocating();
    tokenize_with_editing_context_p =  ! !TRUEP(in_editing_context_qm) ? T 
	    : Nil;
    end_line_index = Nil;
    end_character_index = Nil;
    PUSH_SPECIAL(Tokenize_with_editing_context_p,tokenize_with_editing_context_p,
	    5);
      if (cursor_line_index_qm) {
	  end_line_index = cursor_line_index_qm;
	  end_character_index = cursor_character_index_qm;
      }
      else {
	  end_line_index = end_line_index_qm;
	  end_character_index = end_character_index_qm;
      }
      current_wide_string_list = Qdo_not_use;
      PUSH_SPECIAL(Current_wide_string_list,current_wide_string_list,4);
	wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)2048L + 
		(SI_Long)3L));
	bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	aref_arg_2 = bv16_length - (SI_Long)2L;
	aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
	UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	aref_arg_2 = bv16_length - (SI_Long)1L;
	aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
	current_wide_string = wide_string_bv16;
	PUSH_SPECIAL(Current_wide_string,current_wide_string,3);
	  fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	  PUSH_SPECIAL(Fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		  2);
	    length_1 = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(Current_wide_string));
	    total_length_of_current_wide_string = 
		    FIX(UBYTE_16_ISAREF_1(Current_wide_string,length_1 - 
		    (SI_Long)2L) + ((UBYTE_16_ISAREF_1(Current_wide_string,
		    length_1 - (SI_Long)1L) & (SI_Long)8191L) << 
		    (SI_Long)16L));
	    PUSH_SPECIAL(Total_length_of_current_wide_string,total_length_of_current_wide_string,
		    1);
	      current_twriting_output_type = Qwide_string;
	      PUSH_SPECIAL(Current_twriting_output_type,current_twriting_output_type,
		      0);
		result = new_get_next_token_from_wide_text_if_available_1(tokenizer,
			text_tail,line_index,character_index,
			end_line_index,end_character_index,
			return_partial_tokens_qm);
		MVS_6(result,token_value,token_type_or_partial_types,
			line_index_for_end_of_token,
			character_index_after_token,
			text_tail_for_end_of_token_qm,
			token_self_terminating_p);
		reclaim_wide_string(Current_wide_string);
		result = VALUES_6(token_value,token_type_or_partial_types,
			line_index_for_end_of_token,
			character_index_after_token,
			text_tail_for_end_of_token_qm,
			token_self_terminating_p);
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
      POP_SPECIAL();
    POP_SPECIAL();
    return result;
}

/* TOKEN-FROM-TEXT-STRING */
Object token_from_text_string(text_string,start_index_qm,end_index_qm)
    Object text_string, start_index_qm, end_index_qm;
{
    Object temporary_text, tokenize_with_editing_context_p, temp, temp_1;
    Object token_value, token_type_or_partial_types;
    Object character_index_after_token;
    Declare_special(1);
    Object result;

    x_note_fn_call(126,472);
    temporary_text = gensym_cons_1(text_string,Nil);
    tokenize_with_editing_context_p = Nil;
    PUSH_SPECIAL(Tokenize_with_editing_context_p,tokenize_with_editing_context_p,
	    0);
      temp = determine_appropriate_tokenizer();
      temp_1 = start_index_qm;
      if (temp_1);
      else
	  temp_1 = FIX((SI_Long)0L);
      result = new_get_next_token_from_wide_text_if_available_1(temp,
	      temporary_text,FIX((SI_Long)1L),temp_1,FIX((SI_Long)1L),
	      end_index_qm,Nil);
      MVS_4(result,token_value,token_type_or_partial_types,temp_1,
	      character_index_after_token);
      reclaim_gensym_cons_1(temporary_text);
      result = VALUES_3(token_value,token_type_or_partial_types,
	      character_index_after_token);
    POP_SPECIAL();
    return result;
}

static Object list_constant_19;    /* # */

static Object Qpunctuation_mark;   /* punctuation-mark */

static Object Qcol_col;            /* |::| */

static Object list_constant_20;    /* # */

/* OLD-READ-ATTRIBUTE-NAME-FROM-TEXT-STRING */
Object old_read_attribute_name_from_text_string varargs_1(int, n)
{
    Object text_string;
    Object start_index_qm, end_index_qm, attribute_qm, class_qm, read_end_qm;
    Object token_value, token_type_or_partial_types;
    Object character_index_after_token, initial_token_qm, type_of_token_qm;
    Object token_end_index_qm, n_2nd_token_qm, type_of_2nd_token_qm;
    Object punctuation_end_index_qm, attribute_token_qm;
    Object type_of_attribute_token_qm, attribute_end_index_qm;
    Declare_varargs_nonrelocating;
    Object result;

    x_note_fn_call(126,473);
    INIT_ARGS_nonrelocating();
    text_string = REQUIRED_ARG_nonrelocating();
    start_index_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    end_index_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    attribute_qm = Nil;
    class_qm = Nil;
    read_end_qm = Nil;
    result = token_from_text_string(text_string,start_index_qm,end_index_qm);
    MVS_3(result,token_value,token_type_or_partial_types,
	    character_index_after_token);
    if (CONSP(token_type_or_partial_types) || 
	    memq_function(token_type_or_partial_types,list_constant_19))
	result = VALUES_3(Nil,Nil,Nil);
    else
	result = VALUES_3(token_value,token_type_or_partial_types,
		character_index_after_token);
    MVS_3(result,initial_token_qm,type_of_token_qm,token_end_index_qm);
    if (initial_token_qm) {
	attribute_qm = initial_token_qm;
	read_end_qm = token_end_index_qm;
	if (EQ(type_of_token_qm,Qsymbol)) {
	    if (FIXNUM_NE(token_end_index_qm,end_index_qm ? end_index_qm : 
		    text_string_length(text_string))) {
		result = token_from_text_string(text_string,
			token_end_index_qm,end_index_qm);
		MVS_3(result,token_value,token_type_or_partial_types,
			character_index_after_token);
		if (CONSP(token_type_or_partial_types) || 
			memq_function(token_type_or_partial_types,
			list_constant_19))
		    result = VALUES_3(Nil,Nil,Nil);
		else
		    result = VALUES_3(token_value,
			    token_type_or_partial_types,
			    character_index_after_token);
		MVS_3(result,n_2nd_token_qm,type_of_2nd_token_qm,
			punctuation_end_index_qm);
		if (n_2nd_token_qm && EQ(type_of_2nd_token_qm,
			Qpunctuation_mark) && EQ(n_2nd_token_qm,Qcol_col)) {
		    result = token_from_text_string(text_string,
			    punctuation_end_index_qm,end_index_qm);
		    MVS_3(result,token_value,token_type_or_partial_types,
			    character_index_after_token);
		    if (CONSP(token_type_or_partial_types) || 
			    memq_function(token_type_or_partial_types,
			    list_constant_19))
			result = VALUES_3(Nil,Nil,Nil);
		    else
			result = VALUES_3(token_value,
				token_type_or_partial_types,
				character_index_after_token);
		    MVS_3(result,attribute_token_qm,
			    type_of_attribute_token_qm,attribute_end_index_qm);
		    if (attribute_token_qm && 
			    EQ(type_of_attribute_token_qm,Qsymbol)) {
			attribute_qm = attribute_token_qm;
			class_qm = initial_token_qm;
			read_end_qm = attribute_end_index_qm;
		    }
		}
	    }
	    return VALUES_3(attribute_qm,read_end_qm,class_qm);
	}
	else if (member_eql(type_of_token_qm,list_constant_20)) {
	    reclaim_slot_value(initial_token_qm);
	    return VALUES_1(Nil);
	}
	else
	    return VALUES_1(Qnil);
    }
    else
	return VALUES_1(Nil);
}

static Object Qdouble_colon;       /* double-colon */

/* READ-ATTRIBUTE-NAME-FROM-TEXT-STRING-1 */
Object read_attribute_name_from_text_string_1(text_string,start_index_qm,
	    end_index_qm)
    Object text_string, start_index_qm, end_index_qm;
{
    Object temporary_text, tokenize_with_editing_context_p, attribute_qm;
    Object class_qm, read_end_qm, temp, temp_1, token_value;
    Object token_type_or_partial_types, line_index_for_end_of_token;
    Object character_index_after_token;
    Declare_special(1);
    Object result;

    x_note_fn_call(126,474);
    temporary_text = gensym_cons_1(text_string,Nil);
    tokenize_with_editing_context_p = Nil;
    PUSH_SPECIAL(Tokenize_with_editing_context_p,tokenize_with_editing_context_p,
	    0);
      attribute_qm = Nil;
      class_qm = Nil;
      read_end_qm = Nil;
      temp = G2_symbol_tokenizer;
      temp_1 = start_index_qm;
      if (temp_1);
      else
	  temp_1 = FIX((SI_Long)0L);
      result = new_get_next_token_from_wide_text_if_available_1(temp,
	      temporary_text,FIX((SI_Long)1L),temp_1,FIX((SI_Long)1L),
	      end_index_qm,Nil);
      MVS_4(result,token_value,token_type_or_partial_types,
	      line_index_for_end_of_token,character_index_after_token);
      if (EQ(token_type_or_partial_types,Qsymbol)) {
	  attribute_qm = token_value;
	  read_end_qm = character_index_after_token;
	  if ( !TRUEP(end_index_qm) || FIXNUM_GE(end_index_qm,
		  character_index_after_token)) {
	      result = new_get_next_token_from_wide_text_if_available_1(G2_symbol_tokenizer,
		      temporary_text,FIX((SI_Long)1L),read_end_qm,
		      FIX((SI_Long)1L),end_index_qm,Nil);
	      MVS_4(result,token_value,token_type_or_partial_types,
		      line_index_for_end_of_token,character_index_after_token);
	      if (EQ(token_type_or_partial_types,Qdouble_colon) && ( 
		      !TRUEP(end_index_qm) || FIXNUM_GE(end_index_qm,
		      character_index_after_token))) {
		  result = new_get_next_token_from_wide_text_if_available_1(G2_symbol_tokenizer,
			  temporary_text,FIX((SI_Long)1L),
			  character_index_after_token,FIX((SI_Long)1L),
			  end_index_qm,Nil);
		  MVS_4(result,token_value,token_type_or_partial_types,
			  line_index_for_end_of_token,
			  character_index_after_token);
		  if (EQ(token_type_or_partial_types,Qsymbol)) {
		      class_qm = attribute_qm;
		      read_end_qm = character_index_after_token;
		      attribute_qm = token_value;
		  }
	      }
	  }
      }
      reclaim_gensym_cons_1(temporary_text);
      result = VALUES_3(attribute_qm,read_end_qm,class_qm);
    POP_SPECIAL();
    return result;
}

/* READ-SYMBOL-FROM-TEXT-STRING */
Object read_symbol_from_text_string varargs_1(int, n)
{
    Object text_string;
    Object start_index_qm, end_index_qm, token_value;
    Object token_type_or_partial_types, character_index_after_token, token_qm;
    Object type_of_token_qm;
    Declare_varargs_nonrelocating;
    Object result;

    x_note_fn_call(126,475);
    INIT_ARGS_nonrelocating();
    text_string = REQUIRED_ARG_nonrelocating();
    start_index_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    end_index_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    result = token_from_text_string(text_string,start_index_qm,end_index_qm);
    MVS_3(result,token_value,token_type_or_partial_types,
	    character_index_after_token);
    if (CONSP(token_type_or_partial_types) || 
	    memq_function(token_type_or_partial_types,list_constant_19))
	result = VALUES_3(Nil,Nil,Nil);
    else
	result = VALUES_3(token_value,token_type_or_partial_types,
		character_index_after_token);
    MVS_3(result,token_qm,type_of_token_qm,end_index_qm);
    if (token_qm) {
	if (EQ(type_of_token_qm,Qsymbol))
	    return VALUES_2(token_qm,end_index_qm);
	else if (member_eql(type_of_token_qm,list_constant_20)) {
	    reclaim_slot_value(token_qm);
	    return VALUES_1(Nil);
	}
	else
	    return VALUES_1(Qnil);
    }
    else
	return VALUES_1(Nil);
}

/* READ-NUMBER-FROM-TEXT-STRING */
Object read_number_from_text_string varargs_1(int, n)
{
    Object text_string;
    Object start_qm, end_qm, disallow_junk_qm, disallow_leading_whitespace_qm;
    Object kind_qm, number_start_index, number_end_index, number, kind;
    Declare_varargs_nonrelocating;
    Object result;

    x_note_fn_call(126,476);
    INIT_ARGS_nonrelocating();
    text_string = REQUIRED_ARG_nonrelocating();
    start_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    end_qm = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() 
	    : Nil;
    disallow_junk_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    disallow_leading_whitespace_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    result = syntactically_numeric_substring_p(5,text_string,start_qm,
	    end_qm,disallow_junk_qm,disallow_leading_whitespace_qm);
    MVS_3(result,kind_qm,number_start_index,number_end_index);
    if (kind_qm) {
	result = tokenize_number_from_user(text_string,number_start_index,
		number_end_index);
	MVS_2(result,number,kind);
	return VALUES_4(number,kind,number_start_index,number_end_index);
    }
    else
	return VALUES_1(Nil);
}

/* READ-EVALUATION-QUANTITY-FROM-TEXT-STRING */
Object read_evaluation_quantity_from_text_string varargs_1(int, n)
{
    Object text_string;
    Object start_qm, end_qm, disallow_junk_qm, disallow_leading_whitespace_qm;
    Object temp, number_qm;
    Declare_varargs_nonrelocating;
    XDeclare_area(1);
    XDeclare_frontier(1);
    Object result;

    x_note_fn_call(126,477);
    INIT_ARGS_nonrelocating();
    text_string = REQUIRED_ARG_nonrelocating();
    start_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    end_qm = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() 
	    : Nil;
    disallow_junk_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    disallow_leading_whitespace_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    if (PUSH_LOCAL_ALLOCATION(Local_area,0,0)) {
	temp = read_number_from_text_string(5,text_string,start_qm,end_qm,
		disallow_junk_qm,disallow_leading_whitespace_qm);
	number_qm = temp;
	if (number_qm)
	    result = make_evaluation_quantity(number_qm);
	else
	    result = make_evaluation_quantity(FIX((SI_Long)0L));
    }
    POP_LOCAL_ALLOCATION(0,0);
    return result;
}

/* PUSH-FOR-TOKEN */
Object push_for_token(line_index_for_end_of_token,
	    character_index_after_token,token_self_terminating_qm,
	    text_tail_for_end_of_token,incomplete_phrases_after_token_qm,
	    token_qm,type_of_token)
    Object line_index_for_end_of_token, character_index_after_token;
    Object token_self_terminating_qm, text_tail_for_end_of_token;
    Object incomplete_phrases_after_token_qm, token_qm, type_of_token;
{
    Object svref_arg_1, gensym_push_modify_macro_arg, car_1, cdr_1;
    Object svref_new_value;

    x_note_fn_call(126,478);
    if (token_qm) {
	svref_arg_1 = Current_edit_state;
	gensym_push_modify_macro_arg = token_qm;
	car_1 = gensym_push_modify_macro_arg;
	cdr_1 = ISVREF(svref_arg_1,(SI_Long)54L);
	svref_new_value = gensym_cons_1(car_1,cdr_1);
	SVREF(svref_arg_1,FIX((SI_Long)54L)) = svref_new_value;
    }
    svref_arg_1 = Current_edit_state;
    SVREF(svref_arg_1,FIX((SI_Long)28L)) = text_tail_for_end_of_token;
    svref_arg_1 = Current_edit_state;
    gensym_push_modify_macro_arg = 
	    make_position_after_token(line_index_for_end_of_token,
	    character_index_after_token,token_self_terminating_qm);
    car_1 = gensym_push_modify_macro_arg;
    cdr_1 = ISVREF(svref_arg_1,(SI_Long)29L);
    svref_new_value = gensym_cons_1(car_1,cdr_1);
    SVREF(svref_arg_1,FIX((SI_Long)29L)) = svref_new_value;
    if (incomplete_phrases_after_token_qm) {
	svref_arg_1 = Current_edit_state;
	gensym_push_modify_macro_arg = incomplete_phrases_after_token_qm;
	car_1 = gensym_push_modify_macro_arg;
	cdr_1 = ISVREF(svref_arg_1,(SI_Long)31L);
	svref_new_value = gensym_cons_1(car_1,cdr_1);
	SVREF(svref_arg_1,FIX((SI_Long)31L)) = svref_new_value;
	svref_arg_1 = Current_edit_state;
	car_1 = Nil;
	cdr_1 = ISVREF(svref_arg_1,(SI_Long)32L);
	svref_new_value = gensym_cons_1(car_1,cdr_1);
	SVREF(svref_arg_1,FIX((SI_Long)32L)) = svref_new_value;
    }
    return VALUES_1(Nil);
}

/* MAKE-POSITION-AFTER-TOKEN */
Object make_position_after_token(line_index_for_end_of_token,
	    character_index_after_token,token_self_terminating_qm)
    Object line_index_for_end_of_token, character_index_after_token;
    Object token_self_terminating_qm;
{
    x_note_fn_call(126,479);
    return gensym_cons_1(line_index_for_end_of_token,
	    gensym_cons_1(character_index_after_token,
	    token_self_terminating_qm));
}

/* RECLAIM-IF-POSITION-AFTER-TOKEN */
Object reclaim_if_position_after_token(pos)
    Object pos;
{
    x_note_fn_call(126,480);
    if (pos) {
	reclaim_gensym_cons_1(CDR(pos));
	return reclaim_gensym_cons_1(pos);
    }
    else
	return VALUES_1(Nil);
}

/* RECLAIM-IF-MENU-CONTENT-STRUCTURE */
Object reclaim_if_menu_content_structure(mcs)
    Object mcs;
{
    x_note_fn_call(126,481);
    if (mcs)
	return reclaim_menu_content_structure(mcs);
    else
	return VALUES_1(Nil);
}

/* POP-FOR-TOKEN */
Object pop_for_token()
{
    Object gensym_pop_store, svref_arg_1, cons_1, next_cons, cdr_new_value;

    x_note_fn_call(126,482);
    gensym_pop_store = Nil;
    svref_arg_1 = Current_edit_state;
    cons_1 = ISVREF(svref_arg_1,(SI_Long)29L);
    if (cons_1) {
	gensym_pop_store = M_CAR(cons_1);
	next_cons = M_CDR(cons_1);
	inline_note_reclaim_cons(cons_1,Qab_gensym);
	cdr_new_value = Available_gensym_conses;
	M_CDR(cons_1) = cdr_new_value;
	Available_gensym_conses = cons_1;
    }
    else
	next_cons = Nil;
    SVREF(svref_arg_1,FIX((SI_Long)29L)) = next_cons;
    reclaim_if_position_after_token(gensym_pop_store);
    gensym_pop_store = Nil;
    svref_arg_1 = Current_edit_state;
    cons_1 = ISVREF(svref_arg_1,(SI_Long)54L);
    if (cons_1) {
	gensym_pop_store = M_CAR(cons_1);
	next_cons = M_CDR(cons_1);
	inline_note_reclaim_cons(cons_1,Qab_gensym);
	cdr_new_value = Available_gensym_conses;
	M_CDR(cons_1) = cdr_new_value;
	Available_gensym_conses = cons_1;
    }
    else
	next_cons = Nil;
    SVREF(svref_arg_1,FIX((SI_Long)54L)) = next_cons;
    if (ISVREF(Current_edit_state,(SI_Long)31L)) {
	gensym_pop_store = Nil;
	svref_arg_1 = Current_edit_state;
	cons_1 = ISVREF(svref_arg_1,(SI_Long)32L);
	if (cons_1) {
	    gensym_pop_store = M_CAR(cons_1);
	    next_cons = M_CDR(cons_1);
	    inline_note_reclaim_cons(cons_1,Qab_gensym);
	    cdr_new_value = Available_gensym_conses;
	    M_CDR(cons_1) = cdr_new_value;
	    Available_gensym_conses = cons_1;
	}
	else
	    next_cons = Nil;
	SVREF(svref_arg_1,FIX((SI_Long)32L)) = next_cons;
	reclaim_if_menu_content_structure(gensym_pop_store);
    }
    gensym_pop_store = Nil;
    svref_arg_1 = Current_edit_state;
    cons_1 = ISVREF(svref_arg_1,(SI_Long)31L);
    if (cons_1) {
	gensym_pop_store = M_CAR(cons_1);
	next_cons = M_CDR(cons_1);
	inline_note_reclaim_cons(cons_1,Qab_gensym);
	cdr_new_value = Available_gensym_conses;
	M_CDR(cons_1) = cdr_new_value;
	Available_gensym_conses = cons_1;
    }
    else
	next_cons = Nil;
    SVREF(svref_arg_1,FIX((SI_Long)31L)) = next_cons;
    return VALUES_1(gensym_pop_store);
}

/* ADD-SPACE-OUT-TEXT-IF-NO-LISP */
Object add_space_out_text_if_no_lisp(string_1)
    Object string_1;
{
    Object string_length, wide_string_bv16, space, result_1;
    SI_Long bv16_length, aref_arg_2, aref_new_value;

    x_note_fn_call(126,483);
    string_length = text_string_length(string_1);
    wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)3L + (SI_Long)1L));
    fill_wide_string_1(wide_string_bv16,FIX((SI_Long)32L),FIX((SI_Long)0L),
	    FIX((SI_Long)1L));
    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
    aref_arg_2 = bv16_length - (SI_Long)2L;
    aref_new_value = (SI_Long)1L & (SI_Long)65535L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    aref_arg_2 = bv16_length - (SI_Long)1L;
    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)1L,(SI_Long)0L);
    space = wide_string_bv16;
    result_1 =  !TRUEP(string_equalw(get_from_g2_text(string_1,
	    FIX((SI_Long)1L),FIX((SI_Long)1L)),space)) ? 
	    insert_in_g2_text(space,string_1,FIX((SI_Long)1L)) : string_1;
    if ( !TRUEP(string_equalw(get_from_g2_text(string_1,string_length,
	    string_length),space)))
	return insert_in_g2_text(result_1,space,FIX((SI_Long)1L));
    else
	return VALUES_1(result_1);
}

/* CONTINUOUS-SPACES-FILTER-LISP */
Object continuous_spaces_filter_lisp(string_1)
    Object string_1;
{
    Object wide_string_bv16, result_1, space, string_length, cur_pos, cur_char;
    SI_Long bv16_length, aref_arg_2, aref_new_value;

    x_note_fn_call(126,484);
    wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)0L + (SI_Long)3L));
    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
    aref_arg_2 = bv16_length - (SI_Long)2L;
    aref_new_value = (SI_Long)0L & (SI_Long)65535L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    aref_arg_2 = bv16_length - (SI_Long)1L;
    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)0L,(SI_Long)0L);
    result_1 = wide_string_bv16;
    wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)3L + (SI_Long)1L));
    fill_wide_string_1(wide_string_bv16,FIX((SI_Long)32L),FIX((SI_Long)0L),
	    FIX((SI_Long)1L));
    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
    aref_arg_2 = bv16_length - (SI_Long)2L;
    aref_new_value = (SI_Long)1L & (SI_Long)65535L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    aref_arg_2 = bv16_length - (SI_Long)1L;
    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)1L,(SI_Long)0L);
    space = wide_string_bv16;
    string_length = text_string_length(string_1);
    cur_pos = FIX((SI_Long)1L);
    cur_char = space;
  next_loop:
    if ( !FIXNUM_LE(cur_pos,string_length))
	goto end_loop;
    cur_char = get_from_g2_text(string_1,cur_pos,cur_pos);
    result_1 = insert_in_g2_text(result_1,cur_char,FIX((SI_Long)1L));
    if (string_equalw(cur_char,space)) {
      next_loop_1:
	if ( !(string_equalw(cur_char,space) && FIXNUM_LT(cur_pos,
		string_length)))
	    goto end_loop_1;
	cur_pos = FIXNUM_ADD1(cur_pos);
	cur_char = get_from_g2_text(string_1,cur_pos,cur_pos);
	goto next_loop_1;
      end_loop_1:;
    }
    else
	cur_pos = FIXNUM_ADD1(cur_pos);
    goto next_loop;
  end_loop:;
    return VALUES_1(result_1);
}

/* PARSE-FIRST-VAR-BEFORE-SPACE-OR-EOF-LISP */
Object parse_first_var_before_space_or_eof_lisp(string_1)
    Object string_1;
{
    Object wide_string_bv16, result_1, space, string_length, pos, cur_char;
    SI_Long bv16_length, aref_arg_2, aref_new_value;

    x_note_fn_call(126,485);
    wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)0L + (SI_Long)3L));
    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
    aref_arg_2 = bv16_length - (SI_Long)2L;
    aref_new_value = (SI_Long)0L & (SI_Long)65535L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    aref_arg_2 = bv16_length - (SI_Long)1L;
    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)0L,(SI_Long)0L);
    result_1 = wide_string_bv16;
    wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)3L + (SI_Long)1L));
    fill_wide_string_1(wide_string_bv16,FIX((SI_Long)32L),FIX((SI_Long)0L),
	    FIX((SI_Long)1L));
    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
    aref_arg_2 = bv16_length - (SI_Long)2L;
    aref_new_value = (SI_Long)1L & (SI_Long)65535L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    aref_arg_2 = bv16_length - (SI_Long)1L;
    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)1L,(SI_Long)0L);
    space = wide_string_bv16;
    string_length = text_string_length(string_1);
    pos = FIX((SI_Long)0L);
    wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)3L + (SI_Long)1L));
    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
    aref_arg_2 = bv16_length - (SI_Long)2L;
    aref_new_value = (SI_Long)1L & (SI_Long)65535L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    aref_arg_2 = bv16_length - (SI_Long)1L;
    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)1L,(SI_Long)0L);
    cur_char = wide_string_bv16;
    if (IFIX(string_length) > (SI_Long)0L) {
      next_loop:
	cur_char = get_from_g2_text(string_1,pos,pos);
	if ( !( !TRUEP(string_equalw(cur_char,space)) && FIXNUM_LT(pos,
		string_length)))
	    goto end_loop;
	cur_char = get_from_g2_text(string_1,pos,pos);
	pos = FIXNUM_ADD1(pos);
	goto next_loop;
      end_loop:
	if (string_equalw(cur_char,space))
	    result_1 = get_from_g2_text(string_1,FIX((SI_Long)1L),
		    FIXNUM_SUB1(pos));
	else
	    result_1 = get_from_g2_text(string_1,FIX((SI_Long)1L),pos);
    }
    return VALUES_1(result_1);
}

static Object Qtext_list;          /* text-list */

/* PARSE-VAR-OF-CLASS-FROM-RULE-OR-GF-TEXT-LISP */
Object parse_var_of_class_from_rule_or_gf_text_lisp(class_name,string_1)
    Object class_name, string_1;
{
    Object class_name_text, class_name_length, rule_or_gf_text, result_1;
    Object wide_string_bv16, null_string, pos, temp, temp_1, cur_char;
    SI_Long bv16_length, aref_arg_2, aref_new_value;

    x_note_fn_call(126,486);
    class_name_text = 
	    add_space_out_text_if_no_lisp(continuous_spaces_filter_lisp(class_name));
    class_name_length = text_string_length(class_name_text);
    rule_or_gf_text = continuous_spaces_filter_lisp(string_1);
    result_1 = make_transient_item(Qtext_list);
    wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)0L + (SI_Long)3L));
    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
    aref_arg_2 = bv16_length - (SI_Long)2L;
    aref_new_value = (SI_Long)0L & (SI_Long)65535L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    aref_arg_2 = bv16_length - (SI_Long)1L;
    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
    UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)0L,(SI_Long)0L);
    null_string = wide_string_bv16;
    pos = FIX((SI_Long)1L);
  next_loop:
    if ( !(IFIX(pos) != (SI_Long)0L))
	goto end_loop;
    rule_or_gf_text = add_space_out_text_if_no_lisp(rule_or_gf_text);
    pos = text_string_search(class_name_text,rule_or_gf_text,Nil,Nil);
    if (IFIX(pos) != (SI_Long)0L) {
	temp = rule_or_gf_text;
	temp_1 = FIXNUM_ADD(pos,class_name_length);
	rule_or_gf_text = get_from_g2_text(temp,temp_1,
		text_string_length(rule_or_gf_text));
	cur_char = parse_first_var_before_space_or_eof_lisp(rule_or_gf_text);
	if ( !TRUEP(string_equalw(cur_char,null_string))) {
	    temp_1 = copy_as_wide_string(cur_char);
	    result_1 = g2_list_insert_at_beginning(temp_1,result_1);
	}
	else {
	    wide_string_bv16 = allocate_byte_vector_16(FIX((SI_Long)3L + 
		    (SI_Long)1L));
	    fill_wide_string_1(wide_string_bv16,CHR(','),FIX((SI_Long)0L),
		    FIX((SI_Long)1L));
	    bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	    aref_arg_2 = bv16_length - (SI_Long)2L;
	    aref_new_value = (SI_Long)1L & (SI_Long)65535L;
	    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	    aref_arg_2 = bv16_length - (SI_Long)1L;
	    aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	    UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	    UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)1L,(SI_Long)0L);
	    temp_1 = copy_as_wide_string(insert_in_g2_text(cur_char,
		    wide_string_bv16,FIX((SI_Long)1L)));
	    result_1 = g2_list_insert_at_beginning(temp_1,result_1);
	}
	temp = rule_or_gf_text;
	temp_1 = FIXNUM_ADD1(text_string_length(cur_char));
	rule_or_gf_text = get_from_g2_text(temp,temp_1,
		text_string_length(rule_or_gf_text));
    }
    goto next_loop;
  end_loop:
    return VALUES_1(result_1);
}

void edit1_INIT()
{
    Object temp, reclaim_structure_for_text_marking_state_1;
    Object valid_workstation_context_p_for_text_marking_state_1;
    Object reclaim_structure_for_button_menu_spot_1, type_description, temp_1;
    Object reclaim_structure_for_menu_button_spot_1;
    Object reclaim_structure_for_subcommand_menu_button_spot_1;
    Object reclaim_structure_for_category_menu_button_spot_1;
    Object reclaim_structure_for_token_menu_button_spot_1;
    Object reclaim_structure_for_replacement_token_menu_button_spot_1;
    Object reclaim_structure_for_character_sequence_token_menu_button_spot_1;
    Object reclaim_structure_for_pathname_component_token_menu_button_spot_1;
    Object reclaim_structure_for_kfep_conversion_choice_menu_button_spot_1;
    Object temp_2, gensymed_symbol;
    Object valid_workstation_context_p_for_edit_state_1;
    Object clean_up_workstation_context_for_edit_state_1;
    Object suspend_workstation_context_for_edit_state_1;
    Object resume_workstation_context_for_edit_state_1;
    Object reclaim_structure_for_edit_box_spot_1, com_editor_catch_all_1;
    Object editor_catch_all_command_pursuer_1;
    Object editor_catch_all_command_translator_1;
    Object com_unicode_character_in_text_1;
    Object unicode_character_in_text_command_pursuer_1;
    Object unicode_character_in_text_command_translator_1;
    Object com_space_or_convert_sl_next_1;
    Object space_or_convert_sl_next_command_pursuer_1;
    Object space_or_convert_sl_next_command_translator_1;
    Object com_go_forward_character_1, go_forward_character_command_pursuer_1;
    Object go_forward_character_command_translator_1;
    Object com_go_backward_character_1;
    Object go_backward_character_command_pursuer_1;
    Object go_backward_character_command_translator_1, com_go_up_line_1;
    Object go_up_line_command_pursuer_1, go_up_line_command_translator_1;
    Object com_go_down_line_1, go_down_line_command_pursuer_1;
    Object go_down_line_command_translator_1, com_delete_backward_word_1;
    Object delete_backward_word_command_pursuer_1;
    Object delete_backward_word_command_translator_1;
    Object com_delete_forward_word_1, delete_forward_word_command_pursuer_1;
    Object delete_forward_word_command_translator_1, com_go_backward_word_1;
    Object go_backward_word_command_pursuer_1;
    Object go_backward_word_command_translator_1, com_go_forward_word_1;
    Object go_forward_word_command_pursuer_1;
    Object go_forward_word_command_translator_1, com_undo_1;
    Object undo_command_pursuer_1, undo_command_translator_1, com_redo_1;
    Object redo_command_pursuer_1, redo_command_translator_1;
    Object com_delete_backward_character_1;
    Object delete_backward_character_command_pursuer_1;
    Object delete_backward_character_command_translator_1;
    Object com_delete_forward_character_1;
    Object delete_forward_character_command_pursuer_1;
    Object delete_forward_character_command_translator_1;
    Object com_delete_backward_to_beginning_1;
    Object delete_backward_to_beginning_command_pursuer_1;
    Object delete_backward_to_beginning_command_translator_1, com_go_up_page_1;
    Object go_up_page_command_pursuer_1, go_up_page_command_translator_1;
    Object com_go_down_page_1, go_down_page_command_pursuer_1;
    Object go_down_page_command_translator_1, com_go_to_beginning_1;
    Object go_to_beginning_command_pursuer_1;
    Object go_to_beginning_command_translator_1, com_go_to_end_1;
    Object go_to_end_command_pursuer_1, go_to_end_command_translator_1;
    Object com_go_to_beginning_of_line_1;
    Object go_to_beginning_of_line_command_pursuer_1;
    Object go_to_beginning_of_line_command_translator_1;
    Object com_go_to_end_of_line_1, go_to_end_of_line_command_pursuer_1;
    Object go_to_end_of_line_command_translator_1;
    Object com_insert_newline_complex_character_1;
    Object insert_newline_complex_character_command_pursuer_1;
    Object insert_newline_complex_character_command_translator_1;
    Object com_maybe_insert_newline_1, maybe_insert_newline_command_pursuer_1;
    Object maybe_insert_newline_command_translator_1;
    Object com_do_return_key_function_1;
    Object do_return_key_function_command_pursuer_1;
    Object do_return_key_function_command_translator_1, com_do_tab_function_1;
    Object do_tab_function_command_pursuer_1;
    Object do_tab_function_command_translator_1, com_end_editing_1;
    Object end_editing_command_pursuer_1, end_editing_command_translator_1;
    Object com_abort_editing_1, abort_editing_command_pursuer_1;
    Object abort_editing_command_translator_1;
    Object com_insert_accented_or_special_or_coded_character_1;
    Object insert_accented_or_special_or_coded_character_command_pursuer_1;
    Object insert_accented_or_special_or_coded_character_command_translator_1;
    Object com_cycle_to_next_kana_1, cycle_to_next_kana_command_pursuer_1;
    Object cycle_to_next_kana_command_translator_1, com_enter_kanji_mode_1;
    Object enter_kanji_mode_command_pursuer_1;
    Object enter_kanji_mode_command_translator_1;
    Object com_go_up_one_row_in_kfep_conversion_choice_menu_1;
    Object go_up_one_row_in_kfep_conversion_choice_menu_command_pursuer_1;
    Object go_up_one_row_in_kfep_conversion_choice_menu_command_translator_1;
    Object com_go_down_one_row_in_kfep_conversion_choice_menu_1;
    Object go_down_one_row_in_kfep_conversion_choice_menu_command_pursuer_1;
    Object go_down_one_row_in_kfep_conversion_choice_menu_command_translator_1;
    Object com_skip_kfep_conversion_1, skip_kfep_conversion_command_pursuer_1;
    Object skip_kfep_conversion_command_translator_1;
    Object com_shrink_kfep_conversion_text_region_1;
    Object shrink_kfep_conversion_text_region_command_pursuer_1;
    Object shrink_kfep_conversion_text_region_command_translator_1;
    Object com_expand_kfep_conversion_text_region_1;
    Object expand_kfep_conversion_text_region_command_pursuer_1;
    Object expand_kfep_conversion_text_region_command_translator_1;
    Object com_cut_within_editor_1, cut_within_editor_command_pursuer_1;
    Object cut_within_editor_command_translator_1, com_copy_within_editor_1;
    Object copy_within_editor_command_pursuer_1;
    Object copy_within_editor_command_translator_1, com_paste_within_editor_1;
    Object paste_within_editor_command_pursuer_1;
    Object paste_within_editor_command_translator_1;
    Object com_search_for_text_in_editor_1;
    Object search_for_text_in_editor_command_pursuer_1;
    Object search_for_text_in_editor_command_translator_1;
    Object com_find_forward_instance_of_search_string_1;
    Object find_forward_instance_of_search_string_command_pursuer_1;
    Object find_forward_instance_of_search_string_command_translator_1;
    Object com_find_backward_instance_of_search_string_1;
    Object find_backward_instance_of_search_string_command_pursuer_1;
    Object find_backward_instance_of_search_string_command_translator_1;
    Object com_paste_into_editor_1, paste_into_editor_command_pursuer_1;
    Object paste_into_editor_command_translator_1, com_update_paste_status_1;
    Object update_paste_status_command_pursuer_1;
    Object update_paste_status_command_translator_1;
    Object com_cyrillic_character_in_text_1;
    Object cyrillic_character_in_text_command_pursuer_1;
    Object cyrillic_character_in_text_command_translator_1;
    Object com_hangul_character_in_text_1;
    Object hangul_character_in_text_command_pursuer_1;
    Object hangul_character_in_text_command_translator_1;
    Object com_go_forward_character_extending_region_1;
    Object go_forward_character_extending_region_command_pursuer_1;
    Object go_forward_character_extending_region_command_translator_1;
    Object com_go_backward_character_extending_region_1;
    Object go_backward_character_extending_region_command_pursuer_1;
    Object go_backward_character_extending_region_command_translator_1;
    Object com_go_up_line_extending_region_1;
    Object go_up_line_extending_region_command_pursuer_1;
    Object go_up_line_extending_region_command_translator_1;
    Object com_go_down_line_extending_region_1;
    Object go_down_line_extending_region_command_pursuer_1;
    Object go_down_line_extending_region_command_translator_1;
    Object com_go_down_page_extending_region_1;
    Object go_down_page_extending_region_command_pursuer_1;
    Object go_down_page_extending_region_command_translator_1;
    Object com_go_up_page_extending_region_1;
    Object go_up_page_extending_region_command_pursuer_1;
    Object go_up_page_extending_region_command_translator_1;
    Object com_go_backward_word_extending_region_1;
    Object go_backward_word_extending_region_command_pursuer_1;
    Object go_backward_word_extending_region_command_translator_1;
    Object com_go_forward_word_extending_region_1;
    Object go_forward_word_extending_region_command_pursuer_1;
    Object go_forward_word_extending_region_command_translator_1;
    Object com_go_to_end_of_line_extending_region_1;
    Object go_to_end_of_line_extending_region_command_pursuer_1;
    Object go_to_end_of_line_extending_region_command_translator_1;
    Object com_go_to_beginning_of_line_extending_region_1;
    Object go_to_beginning_of_line_extending_region_command_pursuer_1;
    Object go_to_beginning_of_line_extending_region_command_translator_1;
    Object com_go_to_end_extending_region_1;
    Object go_to_end_extending_region_command_pursuer_1;
    Object go_to_end_extending_region_command_translator_1;
    Object com_go_to_beginning_extending_region_1;
    Object go_to_beginning_extending_region_command_pursuer_1;
    Object go_to_beginning_extending_region_command_translator_1;
    Object com_insert_first_token_menu_choice_1;
    Object insert_first_token_menu_choice_command_pursuer_1;
    Object insert_first_token_menu_choice_command_translator_1;
    Object com_insert_last_token_menu_choice_1;
    Object insert_last_token_menu_choice_command_pursuer_1;
    Object insert_last_token_menu_choice_command_translator_1;
    Object com_select_next_editor_component_group_1;
    Object select_next_editor_component_group_command_pursuer_1;
    Object select_next_editor_component_group_command_translator_1;
    Object com_select_previous_editor_component_group_1;
    Object select_previous_editor_component_group_command_pursuer_1;
    Object select_previous_editor_component_group_command_translator_1;
    Object Qparse_var_of_class_from_rule_or_gf_text_lisp, AB_package;
    Object Qfunction_keeps_procedure_environment_valid_qm;
    Object Qparse_first_var_before_space_or_eof_lisp;
    Object Qcontinuous_spaces_filter_lisp, Qadd_space_out_text_if_no_lisp;
    Object array_constant_11, list_constant_23, array_constant_10;
    Object array_constant_9, Qvms, list_constant_29, Qeditor_command_p;
    Object Qcorresponding_small_font_format_name;
    Object Qright_aligned_small_token_menu_item_format;
    Object Qcenter_aligned_small_token_menu_item_format;
    Object Qleft_aligned_small_token_menu_item_format;
    Object Qright_aligned_small_category_menu_item_format;
    Object Qcenter_aligned_small_category_menu_item_format;
    Object Qleft_aligned_small_category_menu_item_format, Qformat_description;
    Object string_constant_149, string_constant_148, string_constant_147;
    Object string_constant_146, string_constant_145, string_constant_144;
    Object string_constant_143, Qdefault_small_token_menu_item_format;
    Object string_constant_142, list_constant_39;
    Object Qsmall_token_menu_item_format, string_constant_141;
    Object string_constant_140, string_constant_139, string_constant_138;
    Object string_constant_83, Qtoken_menu_item_format, string_constant_137;
    Object Qdefault_token_menu_item_format, string_constant_136;
    Object list_constant_38, string_constant_135, string_constant_134;
    Object string_constant_133, string_constant_132, string_constant_131;
    Object string_constant_130, Qclasses_which_define, Qgenerate_spot;
    Object Qgenerate_spot_for_kfep_conversion_choice_menu, string_constant_129;
    Object list_constant_35, Qpathname_component_token_menu;
    Object Qgenerate_spot_for_pathname_component_token_menu;
    Object string_constant_128, list_constant_37, string_constant_127;
    Object string_constant_126, Qcharacter_sequence_token_menu;
    Object Qgenerate_spot_for_character_sequence_token_menu;
    Object string_constant_125, list_constant_36, string_constant_124;
    Object string_constant_123, Qreplacement_token_menu;
    Object Qgenerate_spot_for_replacement_token_menu, string_constant_122;
    Object string_constant_121, Qgenerate_spot_for_token_menu;
    Object string_constant_120, string_constant_119, string_constant_118;
    Object Qgenerate_spot_for_category_menu, string_constant_117;
    Object string_constant_116, list_constant_34, string_constant_115;
    Object Qnon_kb_workspace, Qgeneric_method_lambda_list, list_constant_33;
    Object Qadd_items_to_edit_workspace, Qrefresh_case_qm, list_constant_32;
    Object Qhandle_end_operation, Qworkstation_context;
    Object Qdelete_frame_after_checking_serial_number_with_list;
    Object Qdelete_frame_after_checking_serial_number, Qinternal;
    Object string_constant_114, string_constant_113, string_constant_112;
    Object Qcursor_movement_shift_variant_commands;
    Object Qauto_insert_text_in_editor, Qnew_style_event_handler;
    Object Qnative_editor_commands_p, string_constant_111;
    Object Qnative_editor_commands, Qrun_top_level_event_handler;
    Object string_constant_110, string_constant_109, Qprivate_editor_commands;
    Object Qmouse_up_in_editing_context;
    Object Qhandle_mouse_down_event_in_edit_context, Qenter_elevator_state;
    Object Qenter_hot_spot_state_upon_frame_component, string_constant_108;
    Object string_constant_107, string_constant_106;
    Object Qmswindows_text_editor_commands, string_constant_105;
    Object string_constant_104, Qmotif_text_editor_commands, Qscroll_line_up;
    Object Qscroll_line_down, string_constant_103, string_constant_102;
    Object string_constant_101, string_constant_100, string_constant_99;
    Object string_constant_98, string_constant_97, Qeditor_commands, Qcp;
    Object Qclose_paren_token, Qop, Qopen_paren_token, list_constant_31;
    Object list_constant_28, Qcopy, Qcut, Qcommand, Qborderless_free_text;
    Object Qfree_text, Qpage_number, Qrunning_head, Qmessage, Qlabel_box;
    Object Qname_box, Qstatement, Qicon_cell, Qtext_highlight_bar;
    Object list_constant_30, G2_DEFSTRUCT_STRUCTURE_NAME_package;
    Object list_constant_27, Qtop_level;
    Object Qselection_style_of_workstation_context_type;
    Object Qtop_level_is_selection_style, Qediting_state;
    Object Qgenerate_spot_for_editor_notification, string_constant_96;
    Object string_constant_95, Qeditor_notification_format, string_constant_94;
    Object list_constant_26, string_constant_93, string_constant_92;
    Object Qgenerate_spot_for_edit_box, Qtype_of_frame_represented;
    Object Qabstract_type, Qimage_plane_spot, Qenclosing_spot_type;
    Object Qinnermost_spot_p, Qedit_box_spot, Qreclaim_structure;
    Object Qoutstanding_edit_box_spot_count;
    Object Qedit_box_spot_structure_memory_usage, Qutilities2;
    Object Qedit_box_spot_count, Qchain_of_available_edit_box_spots;
    Object string_constant_91, string_constant_90;
    Object Qunique_structure_type_of_ab_name_qm;
    Object Qab_name_of_unique_structure_type, string_constant_89;
    Object Qedit_box_format, string_constant_88, string_constant_87;
    Object Qresume_workstation_context, Qsuspend_workstation_context;
    Object Qclean_up_workstation_context, Qvalid_workstation_context_p;
    Object Qchart_annotations, Qobject_configuration, Qtokens_definition;
    Object Qpatterns_definition, Qjava_class_body_declarations_or_none;
    Object list_constant_25, Qicon_description, Qstubs, Qattribute_displays;
    Object Qattribute_initializations, Qclass_specific_attributes;
    Object Qg2_use_scrolling_editor, Qevaluation_value_constant_allowing_items;
    Object list_constant_24, Qevaluation_value_constant_allowing_binary_data;
    Object Qwhole_string_qm, Qtext_attribute, Qitem_or_datum_attribute;
    Object Qitem_or_datum_or_no_item_attribute, Qg2_standard_tokenizer, Qedit1;
    Object Qchain_of_recycled_edit_states, Qcleanup;
    Object Qcleanup_for_edit_workspace, string_constant_86, list_constant_22;
    Object string_constant_85, string_constant_84, Qeditor_parameters;
    Object Qmaximum_number_of_names_in_menus;
    Object Qmaximum_number_of_names_for_a_menu, Qauthor_recording_enabled_qm;
    Object Qkeep_edit_history_qm, Qslot_value_writer;
    Object Qwrite_attributes_to_edit_using_multiline_editor_from_slot;
    Object Qattributes_to_edit_using_multiline_editor;
    Object Quse_slot_value_compiler_for_default_overrides_p;
    Object Qcompile_attributes_to_edit_using_multiline_editor_for_slot;
    Object Qabsent_slot_putter, Qput_preferred_editor_where_slot_is_absent;
    Object Qpreferred_editor, Ksystem_frame, string_constant_82;
    Object string_constant_81, string_constant_80, string_constant_79;
    Object list_constant_21, string_constant_78, string_constant_77;
    Object string_constant_76, string_constant_75, string_constant_74;
    Object string_constant_73, string_constant_72, string_constant_71;
    Object string_constant_70, string_constant_69, Qsystem_table, Qbackground;
    Object Qtransparent, Qbutton_menu_spot;
    Object Qkfep_conversion_choice_menu_button_spot;
    Object Qoutstanding_kfep_conversion_choice_menu_button_spot_count;
    Object Qkfep_conversion_choice_menu_button_spot_structure_memory_usage;
    Object Qkfep_conversion_choice_menu_button_spot_count;
    Object Qchain_of_available_kfep_conversion_choice_menu_button_spots;
    Object string_constant_68, string_constant_67;
    Object Qpathname_component_token_menu_button_spot;
    Object Qoutstanding_pathname_component_token_menu_button_spot_count;
    Object Qpathname_component_token_menu_button_spot_structure_memory_usage;
    Object Qpathname_component_token_menu_button_spot_count;
    Object Qchain_of_available_pathname_component_token_menu_button_spots;
    Object string_constant_66, string_constant_65;
    Object Qcharacter_sequence_token_menu_button_spot;
    Object Qoutstanding_character_sequence_token_menu_button_spot_count;
    Object Qcharacter_sequence_token_menu_button_spot_structure_memory_usage;
    Object Qcharacter_sequence_token_menu_button_spot_count;
    Object Qchain_of_available_character_sequence_token_menu_button_spots;
    Object string_constant_64, string_constant_63;
    Object Qreplacement_token_menu_button_spot;
    Object Qoutstanding_replacement_token_menu_button_spot_count;
    Object Qreplacement_token_menu_button_spot_structure_memory_usage;
    Object Qreplacement_token_menu_button_spot_count;
    Object Qchain_of_available_replacement_token_menu_button_spots;
    Object string_constant_62, string_constant_61, Qtoken_menu_button_spot;
    Object Qoutstanding_token_menu_button_spot_count;
    Object Qtoken_menu_button_spot_structure_memory_usage;
    Object Qtoken_menu_button_spot_count;
    Object Qchain_of_available_token_menu_button_spots, string_constant_60;
    Object string_constant_59, Qcategory_menu_button_spot;
    Object Qoutstanding_category_menu_button_spot_count;
    Object Qcategory_menu_button_spot_structure_memory_usage;
    Object Qcategory_menu_button_spot_count;
    Object Qchain_of_available_category_menu_button_spots, string_constant_58;
    Object string_constant_57, Qsubcommand_menu, Qsubcommand_menu_button_spot;
    Object Qoutstanding_subcommand_menu_button_spot_count;
    Object Qsubcommand_menu_button_spot_structure_memory_usage;
    Object Qsubcommand_menu_button_spot_count;
    Object Qchain_of_available_subcommand_menu_button_spots;
    Object string_constant_56, string_constant_55, Qmenu_button_spot;
    Object Qoutstanding_menu_button_spot_count;
    Object Qmenu_button_spot_structure_memory_usage, Qmenu_button_spot_count;
    Object Qchain_of_available_menu_button_spots, string_constant_54;
    Object string_constant_53, Qoutstanding_button_menu_spot_count;
    Object Qbutton_menu_spot_structure_memory_usage, Qbutton_menu_spot_count;
    Object Qchain_of_available_button_menu_spots, string_constant_52;
    Object string_constant_51, Qmouse_up_in_text_marking;
    Object Qmouse_motion_in_text_marking, Qtext_marking_state;
    Object string_constant_50, Qabort_workstation_context;
    Object Qtop_level_with_selection_focus_is_selection_style;
    Object Qoutstanding_text_marking_state_count;
    Object Qtext_marking_state_structure_memory_usage;
    Object Qtext_marking_state_count, Qchain_of_available_text_marking_states;
    Object string_constant_49, string_constant_48;

    x_note_fn_call(126,487);
    SET_PACKAGE("AB");
    G2_DEFSTRUCT_STRUCTURE_NAME_package = 
	    STATIC_PACKAGE("G2-DEFSTRUCT-STRUCTURE-NAME");
    Qg2_defstruct_structure_name_text_marking_state_g2_struct = 
	    STATIC_SYMBOL("TEXT-MARKING-STATE-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    AB_package = STATIC_PACKAGE("AB");
    Qtext_marking_state = STATIC_SYMBOL("TEXT-MARKING-STATE",AB_package);
    Qab_name_of_unique_structure_type = 
	    STATIC_SYMBOL("AB-NAME-OF-UNIQUE-STRUCTURE-TYPE",AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_text_marking_state_g2_struct,
	    Qtext_marking_state,Qab_name_of_unique_structure_type);
    Qunique_structure_type_of_ab_name_qm = 
	    STATIC_SYMBOL("UNIQUE-STRUCTURE-TYPE-OF-AB-NAME\?",AB_package);
    mutate_global_property(Qtext_marking_state,
	    Qg2_defstruct_structure_name_text_marking_state_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_text_marking_state == UNBOUND)
	The_type_description_of_text_marking_state = Nil;
    string_constant_48 = 
	    STATIC_STRING("43Dy8m83nqy1p83nqy830Vy83-Sy8n8k1l830Vy0000001m1n8y83-68y1o831Ky831Oy831Cy83vay1m8x830Vykrk0k0");
    temp = The_type_description_of_text_marking_state;
    The_type_description_of_text_marking_state = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_48));
    Qtype_description_of_unique_type_name_of_gensym_structure = 
	    STATIC_SYMBOL("TYPE-DESCRIPTION-OF-UNIQUE-TYPE-NAME-OF-GENSYM-STRUCTURE",
	    AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_text_marking_state_g2_struct,
	    The_type_description_of_text_marking_state,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    Qtype_description_of_type = STATIC_SYMBOL("TYPE-DESCRIPTION-OF-TYPE",
	    AB_package);
    mutate_global_property(Qtext_marking_state,
	    The_type_description_of_text_marking_state,
	    Qtype_description_of_type);
    Qoutstanding_text_marking_state_count = 
	    STATIC_SYMBOL("OUTSTANDING-TEXT-MARKING-STATE-COUNT",AB_package);
    Qtext_marking_state_structure_memory_usage = 
	    STATIC_SYMBOL("TEXT-MARKING-STATE-STRUCTURE-MEMORY-USAGE",
	    AB_package);
    string_constant_49 = STATIC_STRING("1q83nqy8s83-r+y09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_text_marking_state_count);
    push_optimized_constant(Qtext_marking_state_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_49));
    Qchain_of_available_text_marking_states = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-TEXT-MARKING-STATES",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_text_marking_states,
	    Chain_of_available_text_marking_states);
    Qutilities2 = STATIC_SYMBOL("UTILITIES2",AB_package);
    record_system_variable(Qchain_of_available_text_marking_states,
	    Qutilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qtext_marking_state_count = STATIC_SYMBOL("TEXT-MARKING-STATE-COUNT",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qtext_marking_state_count,
	    Text_marking_state_count);
    record_system_variable(Qtext_marking_state_count,Qutilities2,
	    FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qtext_marking_state_structure_memory_usage,
	    STATIC_FUNCTION(text_marking_state_structure_memory_usage,NIL,
	    FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_text_marking_state_count,
	    STATIC_FUNCTION(outstanding_text_marking_state_count,NIL,FALSE,
	    0,0));
    Qreclaim_structure = STATIC_SYMBOL("RECLAIM-STRUCTURE",AB_package);
    reclaim_structure_for_text_marking_state_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_text_marking_state,NIL,
	    FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,Qtext_marking_state,
	    reclaim_structure_for_text_marking_state_1);
    Qtop_level_with_selection_focus_is_selection_style = 
	    STATIC_SYMBOL("TOP-LEVEL-WITH-SELECTION-FOCUS-IS-SELECTION-STYLE",
	    AB_package);
    Qselection_style_of_workstation_context_type = 
	    STATIC_SYMBOL("SELECTION-STYLE-OF-WORKSTATION-CONTEXT-TYPE",
	    AB_package);
    mutate_global_property(Qtext_marking_state,
	    Qtop_level_with_selection_focus_is_selection_style,
	    Qselection_style_of_workstation_context_type);
    Qtext_marking = STATIC_SYMBOL("TEXT-MARKING",AB_package);
    make_context_description(Qtext_marking,Qnil,Qt,Qnil);
    Qmouse_up_in_text_marking = STATIC_SYMBOL("MOUSE-UP-IN-TEXT-MARKING",
	    AB_package);
    Qmouse_motion_in_text_marking = 
	    STATIC_SYMBOL("MOUSE-MOTION-IN-TEXT-MARKING",AB_package);
    Qabort_workstation_context = STATIC_SYMBOL("ABORT-WORKSTATION-CONTEXT",
	    AB_package);
    string_constant_50 = STATIC_STRING("1n1n830-y8k9k1n830+y8k9l1n831-y8k9m");
    Qinternal = STATIC_SYMBOL("INTERNAL",AB_package);
    clear_optimized_constants();
    push_optimized_constant(Qmouse_up_in_text_marking);
    push_optimized_constant(Qmouse_motion_in_text_marking);
    push_optimized_constant(Qabort_workstation_context);
    make_keymap(Qtext_marking,Qtext_marking,
	    regenerate_optimized_constant(string_constant_50),Qinternal,
	    Qnil,Qnil,Qnil,Qnil);
    add_keymap_to_workstation_context(Qtext_marking,Qtext_marking);
    Qvalid_workstation_context_p = 
	    STATIC_SYMBOL("VALID-WORKSTATION-CONTEXT-P",AB_package);
    Qavailable_frame_vector = STATIC_SYMBOL("AVAILABLE-FRAME-VECTOR",
	    AB_package);
    valid_workstation_context_p_for_text_marking_state_1 = 
	    STATIC_FUNCTION(valid_workstation_context_p_for_text_marking_state,
	    NIL,FALSE,1,1);
    record_direct_structure_method(Qvalid_workstation_context_p,
	    Qtext_marking_state,
	    valid_workstation_context_p_for_text_marking_state_1);
    Qnew_style_event_handler = STATIC_SYMBOL("NEW-STYLE-EVENT-HANDLER",
	    AB_package);
    mutate_global_property(Qmouse_motion_in_text_marking,
	    Qmouse_motion_in_text_marking,Qnew_style_event_handler);
    Qframe_transforms_of_block = STATIC_SYMBOL("FRAME-TRANSFORMS-OF-BLOCK",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qmouse_motion_in_text_marking,
	    STATIC_FUNCTION(mouse_motion_in_text_marking,NIL,FALSE,1,1));
    mutate_global_property(Qmouse_up_in_text_marking,
	    Qmouse_up_in_text_marking,Qnew_style_event_handler);
    Kok = STATIC_SYMBOL("OK",Pkeyword);
    SET_SYMBOL_FUNCTION(Qmouse_up_in_text_marking,
	    STATIC_FUNCTION(mouse_up_in_text_marking,NIL,FALSE,1,1));
    Qg2_defstruct_structure_name_button_menu_spot_g2_struct = 
	    STATIC_SYMBOL("BUTTON-MENU-SPOT-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qbutton_menu_spot = STATIC_SYMBOL("BUTTON-MENU-SPOT",AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_button_menu_spot_g2_struct,
	    Qbutton_menu_spot,Qab_name_of_unique_structure_type);
    mutate_global_property(Qbutton_menu_spot,
	    Qg2_defstruct_structure_name_button_menu_spot_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_button_menu_spot == UNBOUND)
	The_type_description_of_button_menu_spot = Nil;
    string_constant_51 = 
	    STATIC_STRING("43Dy8m83fZy1r83fZy83=ty83*xy83*Cy83Qy8n8k1l83=ty0000001l1m8x83=tyk3Jyk0k0");
    temp = The_type_description_of_button_menu_spot;
    The_type_description_of_button_menu_spot = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_51));
    mutate_global_property(Qg2_defstruct_structure_name_button_menu_spot_g2_struct,
	    The_type_description_of_button_menu_spot,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    mutate_global_property(Qbutton_menu_spot,
	    The_type_description_of_button_menu_spot,
	    Qtype_description_of_type);
    Qoutstanding_button_menu_spot_count = 
	    STATIC_SYMBOL("OUTSTANDING-BUTTON-MENU-SPOT-COUNT",AB_package);
    Qbutton_menu_spot_structure_memory_usage = 
	    STATIC_SYMBOL("BUTTON-MENU-SPOT-STRUCTURE-MEMORY-USAGE",
	    AB_package);
    string_constant_52 = STATIC_STRING("1q83fZy8s83-L7y09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_button_menu_spot_count);
    push_optimized_constant(Qbutton_menu_spot_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_52));
    Qchain_of_available_button_menu_spots = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-BUTTON-MENU-SPOTS",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_button_menu_spots,
	    Chain_of_available_button_menu_spots);
    record_system_variable(Qchain_of_available_button_menu_spots,
	    Qutilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qbutton_menu_spot_count = STATIC_SYMBOL("BUTTON-MENU-SPOT-COUNT",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qbutton_menu_spot_count,Button_menu_spot_count);
    record_system_variable(Qbutton_menu_spot_count,Qutilities2,
	    FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qbutton_menu_spot_structure_memory_usage,
	    STATIC_FUNCTION(button_menu_spot_structure_memory_usage,NIL,
	    FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_button_menu_spot_count,
	    STATIC_FUNCTION(outstanding_button_menu_spot_count,NIL,FALSE,0,0));
    reclaim_structure_for_button_menu_spot_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_button_menu_spot,NIL,
	    FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,Qbutton_menu_spot,
	    reclaim_structure_for_button_menu_spot_1);
    Kunknown = STATIC_SYMBOL("UNKNOWN",Pkeyword);
    Qinnermost_spot_p = STATIC_SYMBOL("INNERMOST-SPOT-P",AB_package);
    Qenclosing_spot_type = STATIC_SYMBOL("ENCLOSING-SPOT-TYPE",AB_package);
    Qimage_plane_spot = STATIC_SYMBOL("IMAGE-PLANE-SPOT",AB_package);
    Qabstract_type = STATIC_SYMBOL("ABSTRACT-TYPE",AB_package);
    Qtype_of_frame_represented = STATIC_SYMBOL("TYPE-OF-FRAME-REPRESENTED",
	    AB_package);
    Qtable = STATIC_SYMBOL("TABLE",AB_package);
    type_description = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(Qbutton_menu_spot),
	    Qtype_description_of_type);
    temp_1 = list_star(5,LIST_2(Qinnermost_spot_p,Qnil),
	    LIST_2(Qenclosing_spot_type,Qimage_plane_spot),
	    LIST_2(Qabstract_type,Qnil),LIST_2(Qtype_of_frame_represented,
	    Qtable),ISVREF(type_description,(SI_Long)10L));
    SVREF(type_description,FIX((SI_Long)10L)) = temp_1;
    Qg2_defstruct_structure_name_menu_button_spot_g2_struct = 
	    STATIC_SYMBOL("MENU-BUTTON-SPOT-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qmenu_button_spot = STATIC_SYMBOL("MENU-BUTTON-SPOT",AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_menu_button_spot_g2_struct,
	    Qmenu_button_spot,Qab_name_of_unique_structure_type);
    mutate_global_property(Qmenu_button_spot,
	    Qg2_defstruct_structure_name_menu_button_spot_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_menu_button_spot == UNBOUND)
	The_type_description_of_menu_button_spot = Nil;
    string_constant_53 = 
	    STATIC_STRING("43Dy8m830Oy1o830Oy83Qy8n8k1l83Qy0000001l1m8x83Qykqk0k0");
    temp = The_type_description_of_menu_button_spot;
    The_type_description_of_menu_button_spot = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_53));
    mutate_global_property(Qg2_defstruct_structure_name_menu_button_spot_g2_struct,
	    The_type_description_of_menu_button_spot,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    mutate_global_property(Qmenu_button_spot,
	    The_type_description_of_menu_button_spot,
	    Qtype_description_of_type);
    Qoutstanding_menu_button_spot_count = 
	    STATIC_SYMBOL("OUTSTANDING-MENU-BUTTON-SPOT-COUNT",AB_package);
    Qmenu_button_spot_structure_memory_usage = 
	    STATIC_SYMBOL("MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE",
	    AB_package);
    string_constant_54 = STATIC_STRING("1q830Oy8s83-dJy09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_menu_button_spot_count);
    push_optimized_constant(Qmenu_button_spot_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_54));
    Qchain_of_available_menu_button_spots = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-MENU-BUTTON-SPOTS",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_menu_button_spots,
	    Chain_of_available_menu_button_spots);
    record_system_variable(Qchain_of_available_menu_button_spots,
	    Qutilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qmenu_button_spot_count = STATIC_SYMBOL("MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qmenu_button_spot_count,Menu_button_spot_count);
    record_system_variable(Qmenu_button_spot_count,Qutilities2,
	    FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qmenu_button_spot_structure_memory_usage,
	    STATIC_FUNCTION(menu_button_spot_structure_memory_usage,NIL,
	    FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_menu_button_spot_count,
	    STATIC_FUNCTION(outstanding_menu_button_spot_count,NIL,FALSE,0,0));
    reclaim_structure_for_menu_button_spot_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_menu_button_spot,NIL,
	    FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,Qmenu_button_spot,
	    reclaim_structure_for_menu_button_spot_1);
    type_description = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(Qmenu_button_spot),
	    Qtype_description_of_type);
    temp_1 = list_star(5,LIST_2(Qinnermost_spot_p,Qt),
	    LIST_2(Qenclosing_spot_type,Qbutton_menu_spot),
	    LIST_2(Qabstract_type,Qt),LIST_2(Qtype_of_frame_represented,
	    Qtable),ISVREF(type_description,(SI_Long)10L));
    SVREF(type_description,FIX((SI_Long)10L)) = temp_1;
    Qg2_defstruct_structure_name_subcommand_menu_button_spot_g2_struct = 
	    STATIC_SYMBOL("SUBCOMMAND-MENU-BUTTON-SPOT-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qsubcommand_menu_button_spot = 
	    STATIC_SYMBOL("SUBCOMMAND-MENU-BUTTON-SPOT",AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_subcommand_menu_button_spot_g2_struct,
	    Qsubcommand_menu_button_spot,Qab_name_of_unique_structure_type);
    mutate_global_property(Qsubcommand_menu_button_spot,
	    Qg2_defstruct_structure_name_subcommand_menu_button_spot_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_subcommand_menu_button_spot == UNBOUND)
	The_type_description_of_subcommand_menu_button_spot = Nil;
    string_constant_55 = 
	    STATIC_STRING("43Dy8m83A0y1p83A0y830Oy83Qy8n8k1l830Oy0000001l1m8x830Oykqk0k0");
    temp = The_type_description_of_subcommand_menu_button_spot;
    The_type_description_of_subcommand_menu_button_spot = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_55));
    mutate_global_property(Qg2_defstruct_structure_name_subcommand_menu_button_spot_g2_struct,
	    The_type_description_of_subcommand_menu_button_spot,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    mutate_global_property(Qsubcommand_menu_button_spot,
	    The_type_description_of_subcommand_menu_button_spot,
	    Qtype_description_of_type);
    Qoutstanding_subcommand_menu_button_spot_count = 
	    STATIC_SYMBOL("OUTSTANDING-SUBCOMMAND-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    Qsubcommand_menu_button_spot_structure_memory_usage = 
	    STATIC_SYMBOL("SUBCOMMAND-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE",
	    AB_package);
    string_constant_56 = STATIC_STRING("1q83A0y8s83-poy09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_subcommand_menu_button_spot_count);
    push_optimized_constant(Qsubcommand_menu_button_spot_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_56));
    Qchain_of_available_subcommand_menu_button_spots = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-SUBCOMMAND-MENU-BUTTON-SPOTS",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_subcommand_menu_button_spots,
	    Chain_of_available_subcommand_menu_button_spots);
    record_system_variable(Qchain_of_available_subcommand_menu_button_spots,
	    Qutilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qsubcommand_menu_button_spot_count = 
	    STATIC_SYMBOL("SUBCOMMAND-MENU-BUTTON-SPOT-COUNT",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qsubcommand_menu_button_spot_count,
	    Subcommand_menu_button_spot_count);
    record_system_variable(Qsubcommand_menu_button_spot_count,Qutilities2,
	    FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qsubcommand_menu_button_spot_structure_memory_usage,
	    STATIC_FUNCTION(subcommand_menu_button_spot_structure_memory_usage,
	    NIL,FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_subcommand_menu_button_spot_count,
	    STATIC_FUNCTION(outstanding_subcommand_menu_button_spot_count,
	    NIL,FALSE,0,0));
    reclaim_structure_for_subcommand_menu_button_spot_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_subcommand_menu_button_spot,
	    NIL,FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,
	    Qsubcommand_menu_button_spot,
	    reclaim_structure_for_subcommand_menu_button_spot_1);
    Qsubcommand_menu = STATIC_SYMBOL("SUBCOMMAND-MENU",AB_package);
    type_description = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(Qsubcommand_menu_button_spot),
	    Qtype_description_of_type);
    temp_1 = list_star(5,LIST_2(Qinnermost_spot_p,Qt),
	    LIST_2(Qenclosing_spot_type,Qbutton_menu_spot),
	    LIST_2(Qabstract_type,Qnil),LIST_2(Qtype_of_frame_represented,
	    Qsubcommand_menu),ISVREF(type_description,(SI_Long)10L));
    SVREF(type_description,FIX((SI_Long)10L)) = temp_1;
    Qg2_defstruct_structure_name_category_menu_button_spot_g2_struct = 
	    STATIC_SYMBOL("CATEGORY-MENU-BUTTON-SPOT-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qcategory_menu_button_spot = STATIC_SYMBOL("CATEGORY-MENU-BUTTON-SPOT",
	    AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_category_menu_button_spot_g2_struct,
	    Qcategory_menu_button_spot,Qab_name_of_unique_structure_type);
    mutate_global_property(Qcategory_menu_button_spot,
	    Qg2_defstruct_structure_name_category_menu_button_spot_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_category_menu_button_spot == UNBOUND)
	The_type_description_of_category_menu_button_spot = Nil;
    string_constant_57 = 
	    STATIC_STRING("43Dy8m83fly1p83fly830Oy83Qy8n8k1l830Oy0000001l1m8x830Oykqk0k0");
    temp = The_type_description_of_category_menu_button_spot;
    The_type_description_of_category_menu_button_spot = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_57));
    mutate_global_property(Qg2_defstruct_structure_name_category_menu_button_spot_g2_struct,
	    The_type_description_of_category_menu_button_spot,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    mutate_global_property(Qcategory_menu_button_spot,
	    The_type_description_of_category_menu_button_spot,
	    Qtype_description_of_type);
    Qoutstanding_category_menu_button_spot_count = 
	    STATIC_SYMBOL("OUTSTANDING-CATEGORY-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    Qcategory_menu_button_spot_structure_memory_usage = 
	    STATIC_SYMBOL("CATEGORY-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE",
	    AB_package);
    string_constant_58 = STATIC_STRING("1q83fly8s83-Lhy09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_category_menu_button_spot_count);
    push_optimized_constant(Qcategory_menu_button_spot_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_58));
    Qchain_of_available_category_menu_button_spots = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-CATEGORY-MENU-BUTTON-SPOTS",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_category_menu_button_spots,
	    Chain_of_available_category_menu_button_spots);
    record_system_variable(Qchain_of_available_category_menu_button_spots,
	    Qutilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qcategory_menu_button_spot_count = 
	    STATIC_SYMBOL("CATEGORY-MENU-BUTTON-SPOT-COUNT",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qcategory_menu_button_spot_count,
	    Category_menu_button_spot_count);
    record_system_variable(Qcategory_menu_button_spot_count,Qutilities2,
	    FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qcategory_menu_button_spot_structure_memory_usage,
	    STATIC_FUNCTION(category_menu_button_spot_structure_memory_usage,
	    NIL,FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_category_menu_button_spot_count,
	    STATIC_FUNCTION(outstanding_category_menu_button_spot_count,
	    NIL,FALSE,0,0));
    reclaim_structure_for_category_menu_button_spot_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_category_menu_button_spot,
	    NIL,FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,
	    Qcategory_menu_button_spot,
	    reclaim_structure_for_category_menu_button_spot_1);
    Qcategory_menu = STATIC_SYMBOL("CATEGORY-MENU",AB_package);
    type_description = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(Qcategory_menu_button_spot),
	    Qtype_description_of_type);
    temp_1 = list_star(5,LIST_2(Qinnermost_spot_p,Qt),
	    LIST_2(Qenclosing_spot_type,Qbutton_menu_spot),
	    LIST_2(Qabstract_type,Qnil),LIST_2(Qtype_of_frame_represented,
	    Qcategory_menu),ISVREF(type_description,(SI_Long)10L));
    SVREF(type_description,FIX((SI_Long)10L)) = temp_1;
    Qg2_defstruct_structure_name_token_menu_button_spot_g2_struct = 
	    STATIC_SYMBOL("TOKEN-MENU-BUTTON-SPOT-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qtoken_menu_button_spot = STATIC_SYMBOL("TOKEN-MENU-BUTTON-SPOT",
	    AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_token_menu_button_spot_g2_struct,
	    Qtoken_menu_button_spot,Qab_name_of_unique_structure_type);
    mutate_global_property(Qtoken_menu_button_spot,
	    Qg2_defstruct_structure_name_token_menu_button_spot_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_token_menu_button_spot == UNBOUND)
	The_type_description_of_token_menu_button_spot = Nil;
    string_constant_59 = 
	    STATIC_STRING("43Dy8m83cEy1p83cEy830Oy83Qy8n8k1l830Oy0000001l1m8x830Oykqk0k0");
    temp = The_type_description_of_token_menu_button_spot;
    The_type_description_of_token_menu_button_spot = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_59));
    mutate_global_property(Qg2_defstruct_structure_name_token_menu_button_spot_g2_struct,
	    The_type_description_of_token_menu_button_spot,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    mutate_global_property(Qtoken_menu_button_spot,
	    The_type_description_of_token_menu_button_spot,
	    Qtype_description_of_type);
    Qoutstanding_token_menu_button_spot_count = 
	    STATIC_SYMBOL("OUTSTANDING-TOKEN-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    Qtoken_menu_button_spot_structure_memory_usage = 
	    STATIC_SYMBOL("TOKEN-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE",
	    AB_package);
    string_constant_60 = STATIC_STRING("1q83cEy8s83-rsy09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_token_menu_button_spot_count);
    push_optimized_constant(Qtoken_menu_button_spot_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_60));
    Qchain_of_available_token_menu_button_spots = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-TOKEN-MENU-BUTTON-SPOTS",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_token_menu_button_spots,
	    Chain_of_available_token_menu_button_spots);
    record_system_variable(Qchain_of_available_token_menu_button_spots,
	    Qutilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qtoken_menu_button_spot_count = 
	    STATIC_SYMBOL("TOKEN-MENU-BUTTON-SPOT-COUNT",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qtoken_menu_button_spot_count,
	    Token_menu_button_spot_count);
    record_system_variable(Qtoken_menu_button_spot_count,Qutilities2,
	    FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qtoken_menu_button_spot_structure_memory_usage,
	    STATIC_FUNCTION(token_menu_button_spot_structure_memory_usage,
	    NIL,FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_token_menu_button_spot_count,
	    STATIC_FUNCTION(outstanding_token_menu_button_spot_count,NIL,
	    FALSE,0,0));
    reclaim_structure_for_token_menu_button_spot_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_token_menu_button_spot,
	    NIL,FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,
	    Qtoken_menu_button_spot,
	    reclaim_structure_for_token_menu_button_spot_1);
    Qtoken_menu = STATIC_SYMBOL("TOKEN-MENU",AB_package);
    type_description = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(Qtoken_menu_button_spot),
	    Qtype_description_of_type);
    temp_1 = list_star(5,LIST_2(Qinnermost_spot_p,Qt),
	    LIST_2(Qenclosing_spot_type,Qbutton_menu_spot),
	    LIST_2(Qabstract_type,Qnil),LIST_2(Qtype_of_frame_represented,
	    Qtoken_menu),ISVREF(type_description,(SI_Long)10L));
    SVREF(type_description,FIX((SI_Long)10L)) = temp_1;
    Qg2_defstruct_structure_name_replacement_token_menu_button_spot_g2_struct 
	    = STATIC_SYMBOL("REPLACEMENT-TOKEN-MENU-BUTTON-SPOT-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qreplacement_token_menu_button_spot = 
	    STATIC_SYMBOL("REPLACEMENT-TOKEN-MENU-BUTTON-SPOT",AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_replacement_token_menu_button_spot_g2_struct,
	    Qreplacement_token_menu_button_spot,
	    Qab_name_of_unique_structure_type);
    mutate_global_property(Qreplacement_token_menu_button_spot,
	    Qg2_defstruct_structure_name_replacement_token_menu_button_spot_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_replacement_token_menu_button_spot == UNBOUND)
	The_type_description_of_replacement_token_menu_button_spot = Nil;
    string_constant_61 = 
	    STATIC_STRING("43Dy8m83mNy1p83mNy830Oy83Qy8n8k1l830Oy0000001l1m8x830Oykqk0k0");
    temp = The_type_description_of_replacement_token_menu_button_spot;
    The_type_description_of_replacement_token_menu_button_spot = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_61));
    mutate_global_property(Qg2_defstruct_structure_name_replacement_token_menu_button_spot_g2_struct,
	    The_type_description_of_replacement_token_menu_button_spot,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    mutate_global_property(Qreplacement_token_menu_button_spot,
	    The_type_description_of_replacement_token_menu_button_spot,
	    Qtype_description_of_type);
    Qoutstanding_replacement_token_menu_button_spot_count = 
	    STATIC_SYMBOL("OUTSTANDING-REPLACEMENT-TOKEN-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    Qreplacement_token_menu_button_spot_structure_memory_usage = 
	    STATIC_SYMBOL("REPLACEMENT-TOKEN-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE",
	    AB_package);
    string_constant_62 = STATIC_STRING("1q83mNy8s83-l1y09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_replacement_token_menu_button_spot_count);
    push_optimized_constant(Qreplacement_token_menu_button_spot_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_62));
    Qchain_of_available_replacement_token_menu_button_spots = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-REPLACEMENT-TOKEN-MENU-BUTTON-SPOTS",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_replacement_token_menu_button_spots,
	    Chain_of_available_replacement_token_menu_button_spots);
    record_system_variable(Qchain_of_available_replacement_token_menu_button_spots,
	    Qutilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qreplacement_token_menu_button_spot_count = 
	    STATIC_SYMBOL("REPLACEMENT-TOKEN-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qreplacement_token_menu_button_spot_count,
	    Replacement_token_menu_button_spot_count);
    record_system_variable(Qreplacement_token_menu_button_spot_count,
	    Qutilities2,FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qreplacement_token_menu_button_spot_structure_memory_usage,
	    STATIC_FUNCTION(replacement_token_menu_button_spot_structure_memory_usage,
	    NIL,FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_replacement_token_menu_button_spot_count,
	    STATIC_FUNCTION(outstanding_replacement_token_menu_button_spot_count,
	    NIL,FALSE,0,0));
    reclaim_structure_for_replacement_token_menu_button_spot_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_replacement_token_menu_button_spot,
	    NIL,FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,
	    Qreplacement_token_menu_button_spot,
	    reclaim_structure_for_replacement_token_menu_button_spot_1);
    Qreplacement_token_menu = STATIC_SYMBOL("REPLACEMENT-TOKEN-MENU",
	    AB_package);
    type_description = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(Qreplacement_token_menu_button_spot),
	    Qtype_description_of_type);
    temp_1 = list_star(5,LIST_2(Qinnermost_spot_p,Qt),
	    LIST_2(Qenclosing_spot_type,Qbutton_menu_spot),
	    LIST_2(Qabstract_type,Qnil),LIST_2(Qtype_of_frame_represented,
	    Qreplacement_token_menu),ISVREF(type_description,(SI_Long)10L));
    SVREF(type_description,FIX((SI_Long)10L)) = temp_1;
    Qg2_defstruct_structure_name_character_sequence_token_menu_button_spot_g2_struct 
	    = 
	    STATIC_SYMBOL("CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qcharacter_sequence_token_menu_button_spot = 
	    STATIC_SYMBOL("CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT",
	    AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_character_sequence_token_menu_button_spot_g2_struct,
	    Qcharacter_sequence_token_menu_button_spot,
	    Qab_name_of_unique_structure_type);
    mutate_global_property(Qcharacter_sequence_token_menu_button_spot,
	    Qg2_defstruct_structure_name_character_sequence_token_menu_button_spot_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_character_sequence_token_menu_button_spot 
	    == UNBOUND)
	The_type_description_of_character_sequence_token_menu_button_spot 
		= Nil;
    string_constant_63 = 
	    STATIC_STRING("43Dy8m83fqy1p83fqy830Oy83Qy8n8k1l830Oy0000001l1m8x830Oykqk0k0");
    temp = The_type_description_of_character_sequence_token_menu_button_spot;
    The_type_description_of_character_sequence_token_menu_button_spot = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_63));
    mutate_global_property(Qg2_defstruct_structure_name_character_sequence_token_menu_button_spot_g2_struct,
	    The_type_description_of_character_sequence_token_menu_button_spot,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    mutate_global_property(Qcharacter_sequence_token_menu_button_spot,
	    The_type_description_of_character_sequence_token_menu_button_spot,
	    Qtype_description_of_type);
    Qoutstanding_character_sequence_token_menu_button_spot_count = 
	    STATIC_SYMBOL("OUTSTANDING-CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    Qcharacter_sequence_token_menu_button_spot_structure_memory_usage = 
	    STATIC_SYMBOL("CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE",
	    AB_package);
    string_constant_64 = STATIC_STRING("1q83fqy8s83-MCy09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_character_sequence_token_menu_button_spot_count);
    push_optimized_constant(Qcharacter_sequence_token_menu_button_spot_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_64));
    Qchain_of_available_character_sequence_token_menu_button_spots = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOTS",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_character_sequence_token_menu_button_spots,
	    Chain_of_available_character_sequence_token_menu_button_spots);
    record_system_variable(Qchain_of_available_character_sequence_token_menu_button_spots,
	    Qutilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qcharacter_sequence_token_menu_button_spot_count = 
	    STATIC_SYMBOL("CHARACTER-SEQUENCE-TOKEN-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qcharacter_sequence_token_menu_button_spot_count,
	    Character_sequence_token_menu_button_spot_count);
    record_system_variable(Qcharacter_sequence_token_menu_button_spot_count,
	    Qutilities2,FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qcharacter_sequence_token_menu_button_spot_structure_memory_usage,
	    STATIC_FUNCTION(character_sequence_token_menu_button_spot_structure_memory_usage,
	    NIL,FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_character_sequence_token_menu_button_spot_count,
	    STATIC_FUNCTION(outstanding_character_sequence_token_menu_button_spot_count,
	    NIL,FALSE,0,0));
    reclaim_structure_for_character_sequence_token_menu_button_spot_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_character_sequence_token_menu_button_spot,
	    NIL,FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,
	    Qcharacter_sequence_token_menu_button_spot,
	    reclaim_structure_for_character_sequence_token_menu_button_spot_1);
    type_description = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(Qcharacter_sequence_token_menu_button_spot),
	    Qtype_description_of_type);
    temp_1 = list_star(5,LIST_2(Qinnermost_spot_p,Qt),
	    LIST_2(Qenclosing_spot_type,Qbutton_menu_spot),
	    LIST_2(Qabstract_type,Qnil),LIST_2(Qtype_of_frame_represented,
	    Qreplacement_token_menu),ISVREF(type_description,(SI_Long)10L));
    SVREF(type_description,FIX((SI_Long)10L)) = temp_1;
    Qg2_defstruct_structure_name_pathname_component_token_menu_button_spot_g2_struct 
	    = 
	    STATIC_SYMBOL("PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qpathname_component_token_menu_button_spot = 
	    STATIC_SYMBOL("PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT",
	    AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_pathname_component_token_menu_button_spot_g2_struct,
	    Qpathname_component_token_menu_button_spot,
	    Qab_name_of_unique_structure_type);
    mutate_global_property(Qpathname_component_token_menu_button_spot,
	    Qg2_defstruct_structure_name_pathname_component_token_menu_button_spot_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_pathname_component_token_menu_button_spot 
	    == UNBOUND)
	The_type_description_of_pathname_component_token_menu_button_spot 
		= Nil;
    string_constant_65 = 
	    STATIC_STRING("43Dy8m83lYy1p83lYy830Oy83Qy8n8k1l830Oy0000001l1m8x830Oykqk0k0");
    temp = The_type_description_of_pathname_component_token_menu_button_spot;
    The_type_description_of_pathname_component_token_menu_button_spot = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_65));
    mutate_global_property(Qg2_defstruct_structure_name_pathname_component_token_menu_button_spot_g2_struct,
	    The_type_description_of_pathname_component_token_menu_button_spot,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    mutate_global_property(Qpathname_component_token_menu_button_spot,
	    The_type_description_of_pathname_component_token_menu_button_spot,
	    Qtype_description_of_type);
    Qoutstanding_pathname_component_token_menu_button_spot_count = 
	    STATIC_SYMBOL("OUTSTANDING-PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    Qpathname_component_token_menu_button_spot_structure_memory_usage = 
	    STATIC_SYMBOL("PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE",
	    AB_package);
    string_constant_66 = STATIC_STRING("1q83lYy8s83-hZy09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_pathname_component_token_menu_button_spot_count);
    push_optimized_constant(Qpathname_component_token_menu_button_spot_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_66));
    Qchain_of_available_pathname_component_token_menu_button_spots = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOTS",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_pathname_component_token_menu_button_spots,
	    Chain_of_available_pathname_component_token_menu_button_spots);
    record_system_variable(Qchain_of_available_pathname_component_token_menu_button_spots,
	    Qutilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qpathname_component_token_menu_button_spot_count = 
	    STATIC_SYMBOL("PATHNAME-COMPONENT-TOKEN-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qpathname_component_token_menu_button_spot_count,
	    Pathname_component_token_menu_button_spot_count);
    record_system_variable(Qpathname_component_token_menu_button_spot_count,
	    Qutilities2,FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qpathname_component_token_menu_button_spot_structure_memory_usage,
	    STATIC_FUNCTION(pathname_component_token_menu_button_spot_structure_memory_usage,
	    NIL,FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_pathname_component_token_menu_button_spot_count,
	    STATIC_FUNCTION(outstanding_pathname_component_token_menu_button_spot_count,
	    NIL,FALSE,0,0));
    reclaim_structure_for_pathname_component_token_menu_button_spot_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_pathname_component_token_menu_button_spot,
	    NIL,FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,
	    Qpathname_component_token_menu_button_spot,
	    reclaim_structure_for_pathname_component_token_menu_button_spot_1);
    type_description = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(Qpathname_component_token_menu_button_spot),
	    Qtype_description_of_type);
    temp_1 = list_star(5,LIST_2(Qinnermost_spot_p,Qt),
	    LIST_2(Qenclosing_spot_type,Qbutton_menu_spot),
	    LIST_2(Qabstract_type,Qnil),LIST_2(Qtype_of_frame_represented,
	    Qreplacement_token_menu),ISVREF(type_description,(SI_Long)10L));
    SVREF(type_description,FIX((SI_Long)10L)) = temp_1;
    Qg2_defstruct_structure_name_kfep_conversion_choice_menu_button_spot_g2_struct 
	    = 
	    STATIC_SYMBOL("KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qkfep_conversion_choice_menu_button_spot = 
	    STATIC_SYMBOL("KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT",
	    AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_kfep_conversion_choice_menu_button_spot_g2_struct,
	    Qkfep_conversion_choice_menu_button_spot,
	    Qab_name_of_unique_structure_type);
    mutate_global_property(Qkfep_conversion_choice_menu_button_spot,
	    Qg2_defstruct_structure_name_kfep_conversion_choice_menu_button_spot_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_kfep_conversion_choice_menu_button_spot == 
	    UNBOUND)
	The_type_description_of_kfep_conversion_choice_menu_button_spot = Nil;
    string_constant_67 = 
	    STATIC_STRING("43Dy8m83kGy1p83kGy830Oy83Qy8n8k1l830Oy0000001l1m8x830Oykqk0k0");
    temp = The_type_description_of_kfep_conversion_choice_menu_button_spot;
    The_type_description_of_kfep_conversion_choice_menu_button_spot = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_67));
    mutate_global_property(Qg2_defstruct_structure_name_kfep_conversion_choice_menu_button_spot_g2_struct,
	    The_type_description_of_kfep_conversion_choice_menu_button_spot,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    mutate_global_property(Qkfep_conversion_choice_menu_button_spot,
	    The_type_description_of_kfep_conversion_choice_menu_button_spot,
	    Qtype_description_of_type);
    Qoutstanding_kfep_conversion_choice_menu_button_spot_count = 
	    STATIC_SYMBOL("OUTSTANDING-KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    Qkfep_conversion_choice_menu_button_spot_structure_memory_usage = 
	    STATIC_SYMBOL("KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT-STRUCTURE-MEMORY-USAGE",
	    AB_package);
    string_constant_68 = STATIC_STRING("1q83kGy8s83-b8y09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_kfep_conversion_choice_menu_button_spot_count);
    push_optimized_constant(Qkfep_conversion_choice_menu_button_spot_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_68));
    Qchain_of_available_kfep_conversion_choice_menu_button_spots = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOTS",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_kfep_conversion_choice_menu_button_spots,
	    Chain_of_available_kfep_conversion_choice_menu_button_spots);
    record_system_variable(Qchain_of_available_kfep_conversion_choice_menu_button_spots,
	    Qutilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qkfep_conversion_choice_menu_button_spot_count = 
	    STATIC_SYMBOL("KFEP-CONVERSION-CHOICE-MENU-BUTTON-SPOT-COUNT",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qkfep_conversion_choice_menu_button_spot_count,
	    Kfep_conversion_choice_menu_button_spot_count);
    record_system_variable(Qkfep_conversion_choice_menu_button_spot_count,
	    Qutilities2,FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qkfep_conversion_choice_menu_button_spot_structure_memory_usage,
	    STATIC_FUNCTION(kfep_conversion_choice_menu_button_spot_structure_memory_usage,
	    NIL,FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_kfep_conversion_choice_menu_button_spot_count,
	    STATIC_FUNCTION(outstanding_kfep_conversion_choice_menu_button_spot_count,
	    NIL,FALSE,0,0));
    reclaim_structure_for_kfep_conversion_choice_menu_button_spot_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_kfep_conversion_choice_menu_button_spot,
	    NIL,FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,
	    Qkfep_conversion_choice_menu_button_spot,
	    reclaim_structure_for_kfep_conversion_choice_menu_button_spot_1);
    Qkfep_conversion_choice_menu = 
	    STATIC_SYMBOL("KFEP-CONVERSION-CHOICE-MENU",AB_package);
    type_description = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(Qkfep_conversion_choice_menu_button_spot),
	    Qtype_description_of_type);
    temp_1 = list_star(5,LIST_2(Qinnermost_spot_p,Qt),
	    LIST_2(Qenclosing_spot_type,Qbutton_menu_spot),
	    LIST_2(Qabstract_type,Qnil),LIST_2(Qtype_of_frame_represented,
	    Qkfep_conversion_choice_menu),ISVREF(type_description,
	    (SI_Long)10L));
    SVREF(type_description,FIX((SI_Long)10L)) = temp_1;
    Qeditor_subcommand_button = STATIC_SYMBOL("EDITOR-SUBCOMMAND-BUTTON",
	    AB_package);
    Qeditor_subcommand_disabled_p = 
	    STATIC_SYMBOL("EDITOR-SUBCOMMAND-DISABLED-P",AB_package);
    Qline_color = STATIC_SYMBOL("LINE-COLOR",AB_package);
    Qtransparent = STATIC_SYMBOL("TRANSPARENT",AB_package);
    Qbackground = STATIC_SYMBOL("BACKGROUND",AB_package);
    list_constant = STATIC_LIST((SI_Long)2L,Qtransparent,Qbackground);
    Qbackground_color = STATIC_SYMBOL("BACKGROUND-COLOR",AB_package);
    Qeditor_parameters = STATIC_SYMBOL("EDITOR-PARAMETERS",AB_package);
    Qsystem_table = STATIC_SYMBOL("SYSTEM-TABLE",AB_package);
    list_constant_21 = STATIC_CONS(Qsystem_table,Qnil);
    check_if_superior_classes_are_defined(Qeditor_parameters,list_constant_21);
    string_constant_69 = STATIC_STRING("1l1l83ey");
    string_constant_70 = 
	    STATIC_STRING("13Ey4z8r83V+y83V+y83KOy83KOy0r001n1l8o1l8l1m8p83-Vy000004z8r83X7y83X7y83KOy83KOy00001n1l8o1l8l1m8p83Ky000004z8r83a-y83a-y83KOy83");
    string_constant_71 = 
	    STATIC_STRING("KOy08k001n1l8o1l8l1m8p0000004z8r83X-y83X-y83KOy83KOy0o001n1l8o1l8l1m8p83*7y000004z8r83V0y83V0y83KOy83KOy03-Wy001n1l8o1l8l1m8p83-");
    string_constant_72 = 
	    STATIC_STRING("Vy000004z8r83V=y83V=y83KOy83KOy03ky001n1l83Ey1l8l1m8p83-Vy000004z8r83Voy83Voy83KOy83KOy0k001n1l8o1l8l1m8p83*7y000004z8r83Vgy83Vg");
    string_constant_73 = 
	    STATIC_STRING("y83KOy83KOy0k001o1l8o1l8l1m8p01l83Hy000004z8r83TWy83TWy83KOy83KOy083f-y001o1l8o1l8l1m8p01l83Hy000004z8r83TXy83TXy83KOy83KOy083f-");
    string_constant_74 = 
	    STATIC_STRING("y001o1l8o1l8l1m8p01l83Hy000004z8r83TYy83TYy83KOy83KOy083f=y001o1l8o1l8l1m8p01l83Hy000004z8r83TQy83TQy83KOy83KOy08k001o1m8p83Ky1l");
    string_constant_75 = 
	    STATIC_STRING("8o1l8l1l83Cy000004z8r83Guy83Guy83KOy83KOy01s83Gy835Xy835Wy8353y83Gqy83*ey83Vy8u001o1m8p01l8o1l8l1l83Cy000004z8r83Xxy83Xxy83KOy83");
    string_constant_76 = 
	    STATIC_STRING("KOy08k001o1m8p83Ky1l8o1l8l1l83Cy000004z8r83HSy83HSy83KOy83KOy00001o1m8p83Ky1l8o1l8l1l83Cy000004z8r83a=y83a=y83KOy83KOy08k001o1m8");
    string_constant_77 = 
	    STATIC_STRING("p83Ky1l8o1l8l1l83Cy000004z8r83aYy83aYy83KOy83KOy08k001o1m8p83Ky1l8o1l8l1l83Cy000004z8r83Y2y83Y2y83KOy83KOy08k001o1m8p83Ky1l8o1l8");
    string_constant_78 = STATIC_STRING("l1l83Cy00000");
    string_constant_79 = 
	    STATIC_STRING("13Gy8q1n83KOy1l83-sy83ey1p83V+yr8o8l1m8p83-Vy1p83X7y08o8l1m8p83Ky1p83a-y8k8o8l1m8p01p83X-yo8o8l1m8p83*7y1p83V0y3-Wy8o8l1m8p83-Vy");
    string_constant_80 = 
	    STATIC_STRING("1p83V=y3ky83Ey8l1m8p83-Vy1p83Voyk8o8l1m8p83*7y1q83Vgyk8o8l1m8p083Hy1q83TWy83f-y8o8l1m8p083Hy1q83TXy83f-y8o8l1m8p083Hy1q83TYy83f=");
    string_constant_81 = 
	    STATIC_STRING("y8o8l1m8p083Hy1q83TQy8k1m8p83Ky8o8l83Cy1q83Guy1s83Gy835Xy835Wy8353y83Gqy83*ey83Vy8u1m8p08o8l83Cy1q83Xxy8k1m8p83Ky8o8l83Cy1q83HSy");
    string_constant_82 = 
	    STATIC_STRING("01m8p83Ky8o8l83Cy1q83a=y8k1m8p83Ky8o8l83Cy1q83aYy8k1m8p83Ky8o8l83Cy1q83Y2y8k1m8p83Ky8o8l83Cy");
    temp = regenerate_optimized_constant(string_constant_69);
    temp_2 = regenerate_optimized_constant(list(9,string_constant_70,
	    string_constant_71,string_constant_72,string_constant_73,
	    string_constant_74,string_constant_75,string_constant_76,
	    string_constant_77,string_constant_78));
    add_class_to_environment(9,Qeditor_parameters,list_constant_21,Nil,
	    temp,Nil,temp_2,list_constant_21,
	    regenerate_optimized_constant(LIST_4(string_constant_79,
	    string_constant_80,string_constant_81,string_constant_82)),Nil);
    Qedit1 = STATIC_SYMBOL("EDIT1",AB_package);
    Ksystem_frame = STATIC_SYMBOL("SYSTEM-FRAME",Pkeyword);
    record_system_variable(Qeditor_parameters,Qedit1,Ksystem_frame,Qnil,
	    Qnil,Qnil,Qt);
    if (Override_preferred_editor == UNBOUND)
	Override_preferred_editor = Nil;
    Qprefer_native_editor = STATIC_SYMBOL("PREFER-NATIVE-EDITOR",AB_package);
    Qnative = STATIC_SYMBOL("NATIVE",AB_package);
    Qpreferred_editor = STATIC_SYMBOL("PREFERRED-EDITOR",AB_package);
    Qput_preferred_editor_where_slot_is_absent = 
	    STATIC_SYMBOL("PUT-PREFERRED-EDITOR-WHERE-SLOT-IS-ABSENT",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qput_preferred_editor_where_slot_is_absent,
	    STATIC_FUNCTION(put_preferred_editor_where_slot_is_absent,NIL,
	    FALSE,2,2));
    Qabsent_slot_putter = STATIC_SYMBOL("ABSENT-SLOT-PUTTER",AB_package);
    mutate_global_property(Qpreferred_editor,
	    SYMBOL_FUNCTION(Qput_preferred_editor_where_slot_is_absent),
	    Qabsent_slot_putter);
    Qclassic = STATIC_SYMBOL("CLASSIC",AB_package);
    Qattributes_to_edit_using_multiline_editor = 
	    STATIC_SYMBOL("ATTRIBUTES-TO-EDIT-USING-MULTILINE-EDITOR",
	    AB_package);
    Qcompile_attributes_to_edit_using_multiline_editor_for_slot = 
	    STATIC_SYMBOL("COMPILE-ATTRIBUTES-TO-EDIT-USING-MULTILINE-EDITOR-FOR-SLOT",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qcompile_attributes_to_edit_using_multiline_editor_for_slot,
	    STATIC_FUNCTION(compile_attributes_to_edit_using_multiline_editor_for_slot,
	    NIL,TRUE,3,6));
    Qslot_value_compiler = STATIC_SYMBOL("SLOT-VALUE-COMPILER",AB_package);
    mutate_global_property(Qattributes_to_edit_using_multiline_editor,
	    SYMBOL_FUNCTION(Qcompile_attributes_to_edit_using_multiline_editor_for_slot),
	    Qslot_value_compiler);
    Quse_slot_value_compiler_for_default_overrides_p = 
	    STATIC_SYMBOL("USE-SLOT-VALUE-COMPILER-FOR-DEFAULT-OVERRIDES-P",
	    AB_package);
    mutate_global_property(Qattributes_to_edit_using_multiline_editor,T,
	    Quse_slot_value_compiler_for_default_overrides_p);
    Qcm = STATIC_SYMBOL(",",AB_package);
    Qnone = STATIC_SYMBOL("NONE",AB_package);
    add_grammar_rules_for_list(6,
	    Qattributes_to_edit_using_multiline_editor,Qsymbol,Qcm,Nil,
	    Qnone,Nil);
    Qwrite_attributes_to_edit_using_multiline_editor_from_slot = 
	    STATIC_SYMBOL("WRITE-ATTRIBUTES-TO-EDIT-USING-MULTILINE-EDITOR-FROM-SLOT",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qwrite_attributes_to_edit_using_multiline_editor_from_slot,
	    STATIC_FUNCTION(write_attributes_to_edit_using_multiline_editor_from_slot,
	    NIL,FALSE,2,2));
    Qslot_value_writer = STATIC_SYMBOL("SLOT-VALUE-WRITER",AB_package);
    mutate_global_property(Qattributes_to_edit_using_multiline_editor,
	    SYMBOL_FUNCTION(Qwrite_attributes_to_edit_using_multiline_editor_from_slot),
	    Qslot_value_writer);
    Qkeep_edit_history_qm = STATIC_SYMBOL("KEEP-EDIT-HISTORY\?",AB_package);
    Qauthor_recording_enabled_qm = 
	    STATIC_SYMBOL("AUTHOR-RECORDING-ENABLED\?",AB_package);
    alias_slot_name(3,Qkeep_edit_history_qm,Qauthor_recording_enabled_qm,
	    Qeditor_parameters);
    Qmaximum_number_of_names_for_a_menu = 
	    STATIC_SYMBOL("MAXIMUM-NUMBER-OF-NAMES-FOR-A-MENU",AB_package);
    Qmaximum_number_of_names_in_menus = 
	    STATIC_SYMBOL("MAXIMUM-NUMBER-OF-NAMES-IN-MENUS",AB_package);
    alias_slot_name(3,Qmaximum_number_of_names_for_a_menu,
	    Qmaximum_number_of_names_in_menus,Qeditor_parameters);
    Qedit_workspace = STATIC_SYMBOL("EDIT-WORKSPACE",AB_package);
    Qtemporary_workspace = STATIC_SYMBOL("TEMPORARY-WORKSPACE",AB_package);
    list_constant_22 = STATIC_CONS(Qtemporary_workspace,Qnil);
    check_if_superior_classes_are_defined(Qedit_workspace,list_constant_22);
    string_constant_83 = STATIC_STRING("0");
    string_constant_84 = 
	    STATIC_STRING("1o4z8r83*Ly83*Ly83KKy83KKy0u001n1l8l1l8o1m8p83*7y000004z8r836Uy836Uy83KKy83KKy00001n1l83Ey1l8l1l83-4y000004z8r83ZCy83ZCy83KKy83K");
    string_constant_85 = 
	    STATIC_STRING("Ky00001n1l8o1l8l1m8p0000004z8r83ZDy83ZDy83KKy83KKy00001n1l8o1l8l1m8p000000");
    string_constant_86 = 
	    STATIC_STRING("1q8q1m83KKy1l8318y1m83*Lyu1p836Uy083Ey8l83-4y1p83ZCy08o8l1m8p01p83ZDy08o8l1m8p0");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(LIST_2(string_constant_84,
	    string_constant_85));
    add_class_to_environment(9,Qedit_workspace,list_constant_22,Nil,temp,
	    Nil,temp_2,list_constant_22,
	    regenerate_optimized_constant(string_constant_86),Nil);
    Qediting = STATIC_SYMBOL("EDITING",AB_package);
    Qcleanup_for_edit_workspace = 
	    STATIC_SYMBOL("CLEANUP-FOR-EDIT-WORKSPACE",AB_package);
    SET_SYMBOL_FUNCTION(Qcleanup_for_edit_workspace,
	    STATIC_FUNCTION(cleanup_for_edit_workspace,NIL,FALSE,1,1));
    Qcleanup = STATIC_SYMBOL("CLEANUP",AB_package);
    temp_1 = SYMBOL_FUNCTION(Qcleanup_for_edit_workspace);
    set_get(Qedit_workspace,Qcleanup,temp_1);
    Qclasses_which_define = STATIC_SYMBOL("CLASSES-WHICH-DEFINE",AB_package);
    temp = getfq_function_no_default(INLINE_SYMBOL_PLIST(Qcleanup),
	    Qclasses_which_define);
    temp_1 = CONS(Qedit_workspace,temp);
    mutate_global_property(Qcleanup,temp_1,Qclasses_which_define);
    Qchain_of_recycled_edit_states = 
	    STATIC_SYMBOL("CHAIN-OF-RECYCLED-EDIT-STATES",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_recycled_edit_states,
	    Chain_of_recycled_edit_states);
    record_system_variable(Qchain_of_recycled_edit_states,Qedit1,Nil,Qnil,
	    Qnil,Qnil,Qnil);
    Qtokenizer_for_category = STATIC_SYMBOL("TOKENIZER-FOR-CATEGORY",
	    AB_package);
    Tokenizer_for_category_prop = Qtokenizer_for_category;
    Qg2_standard_tokenizer = STATIC_SYMBOL("G2-STANDARD-TOKENIZER",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qg2_standard_tokenizer,G2_standard_tokenizer);
    Default_tokenizer = Qg2_standard_tokenizer;
    Qgeneric_file_pathname = STATIC_SYMBOL("GENERIC-FILE-PATHNAME",AB_package);
    Qitem_or_datum_or_no_item_attribute = 
	    STATIC_SYMBOL("ITEM-OR-DATUM-OR-NO-ITEM-ATTRIBUTE",AB_package);
    Qitem_or_datum_attribute = STATIC_SYMBOL("ITEM-OR-DATUM-ATTRIBUTE",
	    AB_package);
    Qtext_attribute = STATIC_SYMBOL("TEXT-ATTRIBUTE",AB_package);
    Qfile_command = STATIC_SYMBOL("FILE-COMMAND",AB_package);
    Qwhole_string_qm = STATIC_SYMBOL("WHOLE-STRING\?",AB_package);
    Qwhole_string = STATIC_SYMBOL("WHOLE-STRING",AB_package);
    Qevaluation_value_constant_allowing_items = 
	    STATIC_SYMBOL("EVALUATION-VALUE-CONSTANT-ALLOWING-ITEMS",
	    AB_package);
    Qevaluation_value_constant_allowing_binary_data = 
	    STATIC_SYMBOL("EVALUATION-VALUE-CONSTANT-ALLOWING-BINARY-DATA",
	    AB_package);
    list_constant_1 = STATIC_LIST((SI_Long)8L,
	    Qitem_or_datum_or_no_item_attribute,Qitem_or_datum_attribute,
	    Qtext_attribute,Qfile_command,Qwhole_string_qm,Qwhole_string,
	    Qevaluation_value_constant_allowing_items,
	    Qevaluation_value_constant_allowing_binary_data);
    list_constant_23 = STATIC_LIST((SI_Long)2L,Qunsigned_byte,
	    FIX((SI_Long)16L));
    array_constant = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant,(SI_Long)0L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)1L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)2L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)3L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)4L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)5L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)6L,(SI_Long)58L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)7L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)14L,(SI_Long)8L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)15L,(SI_Long)57344L);
    if (Editor_specific_natural_language_override_qm == UNBOUND)
	Editor_specific_natural_language_override_qm = Nil;
    if (Editor_frame_style_override_qm == UNBOUND)
	Editor_frame_style_override_qm = Nil;
    if (Editor_background_color_override_qm == UNBOUND)
	Editor_background_color_override_qm = Nil;
    if (Editor_text_color_override_qm == UNBOUND)
	Editor_text_color_override_qm = Nil;
    if (Editor_font_size_override_qm == UNBOUND)
	Editor_font_size_override_qm = Nil;
    if (Editor_initial_editor_height_override_qm == UNBOUND)
	Editor_initial_editor_height_override_qm = Nil;
    if (Editor_caption_text_override_qm == UNBOUND)
	Editor_caption_text_override_qm = Nil;
    if (Editor_prompt_filter_qm == UNBOUND)
	Editor_prompt_filter_qm = Nil;
    Qedit = STATIC_SYMBOL("EDIT",AB_package);
    Qtwrite_edit_backtrace_info = 
	    STATIC_SYMBOL("TWRITE-EDIT-BACKTRACE-INFO",AB_package);
    SET_SYMBOL_FUNCTION(Qtwrite_edit_backtrace_info,
	    STATIC_FUNCTION(twrite_edit_backtrace_info,NIL,FALSE,0,0));
    Qtext_editor = STATIC_SYMBOL("TEXT-EDITOR",AB_package);
    Qvirtual_attribute = STATIC_SYMBOL("VIRTUAL-ATTRIBUTE",AB_package);
    Qimage_data = STATIC_SYMBOL("IMAGE-DATA",AB_package);
    Qmedia_bin_data = STATIC_SYMBOL("MEDIA-BIN-DATA",AB_package);
    Quuid = STATIC_SYMBOL("UUID",AB_package);
    list_constant_24 = 
	    STATIC_CONS(Qevaluation_value_constant_allowing_binary_data,Qnil);
    list_constant_2 = STATIC_CONS(Qtype,list_constant_24);
    list_constant_3 = STATIC_LIST((SI_Long)2L,Qtype,
	    Qevaluation_value_constant_allowing_items);
    Qfree = STATIC_SYMBOL("FREE",AB_package);
    Qtext = STATIC_SYMBOL("TEXT",AB_package);
    list_constant_4 = STATIC_LIST((SI_Long)3L,Qtype,Qfree,Qtext);
    Qg2_defstruct_structure_name_class_description_g2_struct = 
	    STATIC_SYMBOL("CLASS-DESCRIPTION-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qtitle_bar_caption_text = STATIC_SYMBOL("TITLE-BAR-CAPTION-TEXT",
	    AB_package);
    Qframe_style = STATIC_SYMBOL("FRAME-STYLE",AB_package);
    Qworkspace_background_color_qm = 
	    STATIC_SYMBOL("WORKSPACE-BACKGROUND-COLOR\?",AB_package);
    Qfont_for_editing = STATIC_SYMBOL("FONT-FOR-EDITING",AB_package);
    Qsmall = STATIC_SYMBOL("SMALL",AB_package);
    Qsmall_edit_cursor = STATIC_SYMBOL("SMALL-EDIT-CURSOR",AB_package);
    Qedit_cursor = STATIC_SYMBOL("EDIT-CURSOR",AB_package);
    Qno_native_clipboard = STATIC_SYMBOL("NO-NATIVE-CLIPBOARD",AB_package);
    Qmenus_for_this = STATIC_SYMBOL("MENUS-FOR-THIS",AB_package);
    Qwhat_this_is_a_menu_for_qm = 
	    STATIC_SYMBOL("WHAT-THIS-IS-A-MENU-FOR\?",AB_package);
    Qfree_text_attribute = STATIC_SYMBOL("FREE-TEXT-ATTRIBUTE",AB_package);
    Qirrelevant = STATIC_SYMBOL("IRRELEVANT",AB_package);
    Qsystem_workspace_background_color = 
	    STATIC_SYMBOL("SYSTEM-WORKSPACE-BACKGROUND-COLOR",AB_package);
    Qwide_string = STATIC_SYMBOL("WIDE-STRING",AB_package);
    string_constant = STATIC_STRING("Text Editor");
    string_constant_1 = STATIC_STRING(" for ");
    Qab_or = STATIC_SYMBOL("OR",AB_package);
    Qinspect_history = STATIC_SYMBOL("INSPECT-HISTORY",AB_package);
    string_constant_2 = STATIC_STRING("Inspect Command");
    string_constant_3 = STATIC_STRING("File Command");
    string_constant_4 = STATIC_STRING("the ");
    string_constant_5 = STATIC_STRING("~(~A~) of ");
    string_constant_6 = STATIC_STRING("the ~(~A~) of ");
    Qab_gensym = STATIC_SYMBOL("GENSYM",AB_package);
    if (Editor_scroll_decision_override_qm == UNBOUND)
	Editor_scroll_decision_override_qm = Nil;
    Qg2_use_scrolling_editor = STATIC_SYMBOL("G2-USE-SCROLLING-EDITOR",
	    AB_package);
    Qfunction_keeps_procedure_environment_valid_qm = 
	    STATIC_SYMBOL("FUNCTION-KEEPS-PROCEDURE-ENVIRONMENT-VALID\?",
	    AB_package);
    gensymed_symbol = Nil;
    mutate_global_property(Qg2_use_scrolling_editor,gensymed_symbol,
	    Qfunction_keeps_procedure_environment_valid_qm);
    Qalways = STATIC_SYMBOL("ALWAYS",AB_package);
    Qnever = STATIC_SYMBOL("NEVER",AB_package);
    SET_SYMBOL_FUNCTION(Qg2_use_scrolling_editor,
	    STATIC_FUNCTION(g2_use_scrolling_editor,NIL,FALSE,1,1));
    Qclass_specific_attributes = STATIC_SYMBOL("CLASS-SPECIFIC-ATTRIBUTES",
	    AB_package);
    Qattribute_initializations = STATIC_SYMBOL("ATTRIBUTE-INITIALIZATIONS",
	    AB_package);
    Qattribute_displays = STATIC_SYMBOL("ATTRIBUTE-DISPLAYS",AB_package);
    Qstubs = STATIC_SYMBOL("STUBS",AB_package);
    Qicon_description = STATIC_SYMBOL("ICON-DESCRIPTION",AB_package);
    list_constant_25 = STATIC_LIST((SI_Long)5L,Qclass_specific_attributes,
	    Qattribute_initializations,Qattribute_displays,Qstubs,
	    Qicon_description);
    Attributes_to_edit_using_scrolling_editor = list_constant_25;
    Qprocedure_definition = STATIC_SYMBOL("PROCEDURE-DEFINITION",AB_package);
    Qjava_class_body_declarations_or_none = 
	    STATIC_SYMBOL("JAVA-CLASS-BODY-DECLARATIONS-OR-NONE",AB_package);
    Qpatterns_definition = STATIC_SYMBOL("PATTERNS-DEFINITION",AB_package);
    Qtokens_definition = STATIC_SYMBOL("TOKENS-DEFINITION",AB_package);
    Qobject_configuration = STATIC_SYMBOL("OBJECT-CONFIGURATION",AB_package);
    Qchart_annotations = STATIC_SYMBOL("CHART-ANNOTATIONS",AB_package);
    list_constant_5 = STATIC_LIST((SI_Long)6L,Qprocedure_definition,
	    Qjava_class_body_declarations_or_none,Qpatterns_definition,
	    Qtokens_definition,Qobject_configuration,Qchart_annotations);
    Qedit_state = STATIC_SYMBOL("EDIT-STATE",AB_package);
    valid_workstation_context_p_for_edit_state_1 = 
	    STATIC_FUNCTION(valid_workstation_context_p_for_edit_state,NIL,
	    FALSE,1,1);
    record_direct_structure_method(Qvalid_workstation_context_p,
	    Qedit_state,valid_workstation_context_p_for_edit_state_1);
    Qclean_up_workstation_context = 
	    STATIC_SYMBOL("CLEAN-UP-WORKSTATION-CONTEXT",AB_package);
    Qitem_reference = STATIC_SYMBOL("ITEM-REFERENCE",AB_package);
    Qname_or_names_for_frame = STATIC_SYMBOL("NAME-OR-NAMES-FOR-FRAME",
	    AB_package);
    clean_up_workstation_context_for_edit_state_1 = 
	    STATIC_FUNCTION(clean_up_workstation_context_for_edit_state,
	    NIL,FALSE,1,1);
    record_direct_structure_method(Qclean_up_workstation_context,
	    Qedit_state,clean_up_workstation_context_for_edit_state_1);
    Qabove = STATIC_SYMBOL("ABOVE",AB_package);
    Qthick_workspace_frame_style = 
	    STATIC_SYMBOL("THICK-WORKSPACE-FRAME-STYLE",AB_package);
    Qdefault_workspace_frame_style = 
	    STATIC_SYMBOL("DEFAULT-WORKSPACE-FRAME-STYLE",AB_package);
    Qriding = STATIC_SYMBOL("RIDING",AB_package);
    Qriding_workspace_x_offset_qm = 
	    STATIC_SYMBOL("RIDING-WORKSPACE-X-OFFSET\?",AB_package);
    Qriding_workspace_y_offset_qm = 
	    STATIC_SYMBOL("RIDING-WORKSPACE-Y-OFFSET\?",AB_package);
    Qleft = STATIC_SYMBOL("LEFT",AB_package);
    Qtop = STATIC_SYMBOL("TOP",AB_package);
    Qsuspend_workstation_context = 
	    STATIC_SYMBOL("SUSPEND-WORKSTATION-CONTEXT",AB_package);
    suspend_workstation_context_for_edit_state_1 = 
	    STATIC_FUNCTION(suspend_workstation_context_for_edit_state,NIL,
	    FALSE,1,1);
    record_direct_structure_method(Qsuspend_workstation_context,
	    Qedit_state,suspend_workstation_context_for_edit_state_1);
    Qresume_workstation_context = 
	    STATIC_SYMBOL("RESUME-WORKSTATION-CONTEXT",AB_package);
    resume_workstation_context_for_edit_state_1 = 
	    STATIC_FUNCTION(resume_workstation_context_for_edit_state,NIL,
	    FALSE,1,1);
    record_direct_structure_method(Qresume_workstation_context,Qedit_state,
	    resume_workstation_context_for_edit_state_1);
    Qedit_box = STATIC_SYMBOL("EDIT-BOX",AB_package);
    Qtext_box = STATIC_SYMBOL("TEXT-BOX",AB_package);
    list_constant_26 = STATIC_CONS(Qtext_box,Qnil);
    check_if_superior_classes_are_defined(Qedit_box,list_constant_26);
    string_constant_87 = 
	    STATIC_STRING("1m4z8r83xy83xy83KHy83KHy0830qy001n1l8l1l83Ey1m83Dy53CyExport, writable000004z8r83MNy83MNy83KHy83KHy00001l1l8l00000");
    string_constant_88 = 
	    STATIC_STRING("1o8q1m83KHy1l83-ly1m83xy830qy1m83MNy0");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(string_constant_87);
    add_class_to_environment(9,Qedit_box,list_constant_26,Nil,temp,Nil,
	    temp_2,list_constant_26,
	    regenerate_optimized_constant(string_constant_88),Nil);
    Edit_box_class_description = 
	    lookup_global_or_kb_specific_property_value(Qedit_box,
	    Class_description_gkbprop);
    Qscrolling_editor_text_format = 
	    STATIC_SYMBOL("SCROLLING-EDITOR-TEXT-FORMAT",AB_package);
    Qdefault_text_box_format_name = 
	    STATIC_SYMBOL("DEFAULT-TEXT-BOX-FORMAT-NAME",AB_package);
    Qformat_frame = STATIC_SYMBOL("FORMAT-FRAME",AB_package);
    Qbox_translation_and_text = STATIC_SYMBOL("BOX-TRANSLATION-AND-TEXT",
	    AB_package);
    Qtext_box_format = STATIC_SYMBOL("TEXT-BOX-FORMAT",AB_package);
    Qtext_cell_plist_for_text_box = 
	    STATIC_SYMBOL("TEXT-CELL-PLIST-FOR-TEXT-BOX",AB_package);
    Kedit_box_with_scroll_bar_frame_style = 
	    STATIC_SYMBOL("EDIT-BOX-WITH-SCROLL-BAR-FRAME-STYLE",Pkeyword);
    Qminimum_width_of_text_box = STATIC_SYMBOL("MINIMUM-WIDTH-OF-TEXT-BOX",
	    AB_package);
    Qminimum_height_of_text_box = 
	    STATIC_SYMBOL("MINIMUM-HEIGHT-OF-TEXT-BOX",AB_package);
    Qmaximum_width_of_text_box_qm = 
	    STATIC_SYMBOL("MAXIMUM-WIDTH-OF-TEXT-BOX\?",AB_package);
    Qmaximum_height_of_text_box = 
	    STATIC_SYMBOL("MAXIMUM-HEIGHT-OF-TEXT-BOX",AB_package);
    Qremembered_block_transform = 
	    STATIC_SYMBOL("REMEMBERED-BLOCK-TRANSFORM",AB_package);
    Qedit_box_format = STATIC_SYMBOL("EDIT-BOX-FORMAT",AB_package);
    string_constant_89 = 
	    STATIC_STRING("13Jy83-My83ny1l83-uy83ty3Gy83syz83-7y3N+y83*3y3G+y83*+y3u+y83kyk83-=y3My83-By083-Ny83fy83*ky83fy");
    Qformat_description = STATIC_SYMBOL("FORMAT-DESCRIPTION",AB_package);
    mutate_global_property(Qedit_box_format,
	    regenerate_optimized_constant(string_constant_89),
	    Qformat_description);
    Qg2_defstruct_structure_name_edit_box_spot_g2_struct = 
	    STATIC_SYMBOL("EDIT-BOX-SPOT-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qedit_box_spot = STATIC_SYMBOL("EDIT-BOX-SPOT",AB_package);
    mutate_global_property(Qg2_defstruct_structure_name_edit_box_spot_g2_struct,
	    Qedit_box_spot,Qab_name_of_unique_structure_type);
    mutate_global_property(Qedit_box_spot,
	    Qg2_defstruct_structure_name_edit_box_spot_g2_struct,
	    Qunique_structure_type_of_ab_name_qm);
    if (The_type_description_of_edit_box_spot == UNBOUND)
	The_type_description_of_edit_box_spot = Nil;
    string_constant_90 = 
	    STATIC_STRING("43Dy8m83h-y1q83h-y832my83*Cy83Qy8n8k1l832my0000001l1m8x832myk3Cyk0k0");
    temp = The_type_description_of_edit_box_spot;
    The_type_description_of_edit_box_spot = 
	    load_and_initialize_type_description(temp,
	    regenerate_optimized_constant(string_constant_90));
    mutate_global_property(Qg2_defstruct_structure_name_edit_box_spot_g2_struct,
	    The_type_description_of_edit_box_spot,
	    Qtype_description_of_unique_type_name_of_gensym_structure);
    mutate_global_property(Qedit_box_spot,
	    The_type_description_of_edit_box_spot,Qtype_description_of_type);
    Qoutstanding_edit_box_spot_count = 
	    STATIC_SYMBOL("OUTSTANDING-EDIT-BOX-SPOT-COUNT",AB_package);
    Qedit_box_spot_structure_memory_usage = 
	    STATIC_SYMBOL("EDIT-BOX-SPOT-STRUCTURE-MEMORY-USAGE",AB_package);
    string_constant_91 = STATIC_STRING("1q83h-y8s83-S4y09k9l");
    clear_optimized_constants();
    push_optimized_constant(Qoutstanding_edit_box_spot_count);
    push_optimized_constant(Qedit_box_spot_structure_memory_usage);
    update_object_pool_meters_list(regenerate_optimized_constant(string_constant_91));
    Qchain_of_available_edit_box_spots = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-EDIT-BOX-SPOTS",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qchain_of_available_edit_box_spots,
	    Chain_of_available_edit_box_spots);
    record_system_variable(Qchain_of_available_edit_box_spots,Qutilities2,
	    Nil,Qnil,Qt,Qnil,Qnil);
    Qedit_box_spot_count = STATIC_SYMBOL("EDIT-BOX-SPOT-COUNT",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qedit_box_spot_count,Edit_box_spot_count);
    record_system_variable(Qedit_box_spot_count,Qutilities2,
	    FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    SET_SYMBOL_FUNCTION(Qedit_box_spot_structure_memory_usage,
	    STATIC_FUNCTION(edit_box_spot_structure_memory_usage,NIL,FALSE,
	    0,0));
    SET_SYMBOL_FUNCTION(Qoutstanding_edit_box_spot_count,
	    STATIC_FUNCTION(outstanding_edit_box_spot_count,NIL,FALSE,0,0));
    reclaim_structure_for_edit_box_spot_1 = 
	    STATIC_FUNCTION(reclaim_structure_for_edit_box_spot,NIL,FALSE,1,1);
    record_direct_structure_method(Qreclaim_structure,Qedit_box_spot,
	    reclaim_structure_for_edit_box_spot_1);
    type_description = 
	    getfq_function_no_default(INLINE_SYMBOL_PLIST(Qedit_box_spot),
	    Qtype_description_of_type);
    temp_1 = list_star(5,LIST_2(Qinnermost_spot_p,Qt),
	    LIST_2(Qenclosing_spot_type,Qimage_plane_spot),
	    LIST_2(Qabstract_type,Qnil),LIST_2(Qtype_of_frame_represented,
	    Qedit_box),ISVREF(type_description,(SI_Long)10L));
    SVREF(type_description,FIX((SI_Long)10L)) = temp_1;
    Qgenerate_spot_for_edit_box = 
	    STATIC_SYMBOL("GENERATE-SPOT-FOR-EDIT-BOX",AB_package);
    SET_SYMBOL_FUNCTION(Qgenerate_spot_for_edit_box,
	    STATIC_FUNCTION(generate_spot_for_edit_box,NIL,FALSE,2,2));
    Qgenerate_spot = STATIC_SYMBOL("GENERATE-SPOT",AB_package);
    temp_1 = SYMBOL_FUNCTION(Qgenerate_spot_for_edit_box);
    set_get(Qedit_box,Qgenerate_spot,temp_1);
    temp = getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgenerate_spot),
	    Qclasses_which_define);
    temp_1 = CONS(Qedit_box,temp);
    mutate_global_property(Qgenerate_spot,temp_1,Qclasses_which_define);
    Qtext_region = STATIC_SYMBOL("TEXT-REGION",AB_package);
    Qeditor_notification = STATIC_SYMBOL("EDITOR-NOTIFICATION",AB_package);
    check_if_superior_classes_are_defined(Qeditor_notification,
	    list_constant_26);
    string_constant_92 = 
	    STATIC_STRING("1m4z8r83ry83ry83KMy83KMy00001o1l8l1n8p083Gy1l8o1l83-3y000004z8r83xy83xy83KMy83KMy083KNy001n1l8l1l83Ey1m83Dy53CyExport, writable0");
    string_constant_93 = STATIC_STRING("0000");
    string_constant_94 = 
	    STATIC_STRING("1o8q1m83KMy1l83-ly1n83ry01n8p083Gy1m83xy83KNy");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(LIST_2(string_constant_92,
	    string_constant_93));
    add_class_to_environment(9,Qeditor_notification,list_constant_26,Nil,
	    temp,Nil,temp_2,list_constant_26,
	    regenerate_optimized_constant(string_constant_94),Nil);
    Qeditor_notification_format = 
	    STATIC_SYMBOL("EDITOR-NOTIFICATION-FORMAT",AB_package);
    string_constant_95 = 
	    STATIC_STRING("13Vy83-My83*ky83m8y83*Ky832py83-Ny83Ty83ny1l83-uy83ty3Gy83syz83-7y3N+y83*3y3G+y83*+y3u+y83*=yk83*1yo83*0yk83**yk83kyk83-=yk83iy3");
    string_constant_96 = STATIC_STRING("2qy83*ay32qy");
    mutate_global_property(Qeditor_notification_format,
	    regenerate_optimized_constant(LIST_2(string_constant_95,
	    string_constant_96)),Qformat_description);
    Qgenerate_spot_for_editor_notification = 
	    STATIC_SYMBOL("GENERATE-SPOT-FOR-EDITOR-NOTIFICATION",AB_package);
    SET_SYMBOL_FUNCTION(Qgenerate_spot_for_editor_notification,
	    STATIC_FUNCTION(generate_spot_for_editor_notification,NIL,
	    FALSE,2,2));
    temp_1 = SYMBOL_FUNCTION(Qgenerate_spot_for_editor_notification);
    set_get(Qeditor_notification,Qgenerate_spot,temp_1);
    temp = getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgenerate_spot),
	    Qclasses_which_define);
    temp_1 = CONS(Qeditor_notification,temp);
    mutate_global_property(Qgenerate_spot,temp_1,Qclasses_which_define);
    Qediting_state = STATIC_SYMBOL("EDITING-STATE",AB_package);
    Qtop_level_is_selection_style = 
	    STATIC_SYMBOL("TOP-LEVEL-IS-SELECTION-STYLE",AB_package);
    mutate_global_property(Qediting_state,Qtop_level_is_selection_style,
	    Qselection_style_of_workstation_context_type);
    Qtop_level = STATIC_SYMBOL("TOP-LEVEL",AB_package);
    Qnative_editor_commands = STATIC_SYMBOL("NATIVE-EDITOR-COMMANDS",
	    AB_package);
    Qeditor_commands = STATIC_SYMBOL("EDITOR-COMMANDS",AB_package);
    Qcursor_movement_shift_variant_commands = 
	    STATIC_SYMBOL("CURSOR-MOVEMENT-SHIFT-VARIANT-COMMANDS",AB_package);
    Qprivate_editor_commands = STATIC_SYMBOL("PRIVATE-EDITOR-COMMANDS",
	    AB_package);
    list_constant_27 = STATIC_LIST((SI_Long)4L,Qnative_editor_commands,
	    Qeditor_commands,Qcursor_movement_shift_variant_commands,
	    Qprivate_editor_commands);
    make_context_description(Qediting,Qtop_level,Qnil,list_constant_27);
    Qeditor_command_p = STATIC_SYMBOL("EDITOR-COMMAND-P",AB_package);
    Editor_command_p_prop = Qeditor_command_p;
    Qeditor_catch_all = STATIC_SYMBOL("EDITOR-CATCH-ALL",AB_package);
    mutate_global_property(Qeditor_catch_all,T,Qeditor_command_p);
    Qevent = STATIC_SYMBOL("EVENT",AB_package);
    Qworkstation_context_specifics = 
	    STATIC_SYMBOL("WORKSTATION-CONTEXT-SPECIFICS",AB_package);
    list_constant_28 = STATIC_LIST((SI_Long)2L,Qedit_state,
	    Qworkstation_context_specifics);
    list_constant_29 = STATIC_LIST((SI_Long)2L,Qevent,list_constant_28);
    make_ui_command(5,Qeditor_catch_all,list_constant_29,Qnil,
	    Qeditor_catch_all,Qnil);
    Qg2_defstruct_structure_name_edit_state_g2_struct = 
	    STATIC_SYMBOL("EDIT-STATE-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    com_editor_catch_all_1 = STATIC_FUNCTION(com_editor_catch_all,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qeditor_catch_all,com_editor_catch_all_1);
    editor_catch_all_command_pursuer_1 = 
	    STATIC_FUNCTION(editor_catch_all_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qeditor_catch_all,
	    editor_catch_all_command_pursuer_1);
    editor_catch_all_command_translator_1 = 
	    STATIC_FUNCTION(editor_catch_all_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qeditor_catch_all,
	    editor_catch_all_command_translator_1);
    Qunicode_character_in_text = STATIC_SYMBOL("UNICODE-CHARACTER-IN-TEXT",
	    AB_package);
    mutate_global_property(Qunicode_character_in_text,T,Qeditor_command_p);
    make_ui_command(5,Qunicode_character_in_text,list_constant_29,Qnil,
	    Qunicode_character_in_text,Qnil);
    com_unicode_character_in_text_1 = 
	    STATIC_FUNCTION(com_unicode_character_in_text,NIL,FALSE,2,2);
    set_ui_command_function(Qunicode_character_in_text,
	    com_unicode_character_in_text_1);
    unicode_character_in_text_command_pursuer_1 = 
	    STATIC_FUNCTION(unicode_character_in_text_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qunicode_character_in_text,
	    unicode_character_in_text_command_pursuer_1);
    unicode_character_in_text_command_translator_1 = 
	    STATIC_FUNCTION(unicode_character_in_text_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qunicode_character_in_text,
	    unicode_character_in_text_command_translator_1);
    Qinsertion_of_symbol = STATIC_SYMBOL("INSERTION-OF-SYMBOL",AB_package);
    Qspace_or_convert_sl_next = STATIC_SYMBOL("SPACE-OR-CONVERT/NEXT",
	    AB_package);
    mutate_global_property(Qspace_or_convert_sl_next,T,Qeditor_command_p);
    make_ui_command(5,Qspace_or_convert_sl_next,list_constant_29,Qnil,
	    Qspace_or_convert_sl_next,Qnil);
    com_space_or_convert_sl_next_1 = 
	    STATIC_FUNCTION(com_space_or_convert_sl_next,NIL,FALSE,2,2);
    set_ui_command_function(Qspace_or_convert_sl_next,
	    com_space_or_convert_sl_next_1);
    space_or_convert_sl_next_command_pursuer_1 = 
	    STATIC_FUNCTION(space_or_convert_sl_next_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qspace_or_convert_sl_next,
	    space_or_convert_sl_next_command_pursuer_1);
    space_or_convert_sl_next_command_translator_1 = 
	    STATIC_FUNCTION(space_or_convert_sl_next_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qspace_or_convert_sl_next,
	    space_or_convert_sl_next_command_translator_1);
    Qgo_forward_character = STATIC_SYMBOL("GO-FORWARD-CHARACTER",AB_package);
    mutate_global_property(Qgo_forward_character,T,Qeditor_command_p);
    make_ui_command(5,Qgo_forward_character,list_constant_29,Qnil,
	    Qgo_forward_character,Qnil);
    Qright = STATIC_SYMBOL("RIGHT",AB_package);
    com_go_forward_character_1 = STATIC_FUNCTION(com_go_forward_character,
	    NIL,FALSE,2,2);
    set_ui_command_function(Qgo_forward_character,com_go_forward_character_1);
    go_forward_character_command_pursuer_1 = 
	    STATIC_FUNCTION(go_forward_character_command_pursuer,NIL,FALSE,
	    1,1);
    set_ui_command_pursuer(Qgo_forward_character,
	    go_forward_character_command_pursuer_1);
    go_forward_character_command_translator_1 = 
	    STATIC_FUNCTION(go_forward_character_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qgo_forward_character,
	    go_forward_character_command_translator_1);
    Qgo_backward_character = STATIC_SYMBOL("GO-BACKWARD-CHARACTER",AB_package);
    mutate_global_property(Qgo_backward_character,T,Qeditor_command_p);
    make_ui_command(5,Qgo_backward_character,list_constant_29,Qnil,
	    Qgo_backward_character,Qnil);
    com_go_backward_character_1 = 
	    STATIC_FUNCTION(com_go_backward_character,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_backward_character,
	    com_go_backward_character_1);
    go_backward_character_command_pursuer_1 = 
	    STATIC_FUNCTION(go_backward_character_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qgo_backward_character,
	    go_backward_character_command_pursuer_1);
    go_backward_character_command_translator_1 = 
	    STATIC_FUNCTION(go_backward_character_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qgo_backward_character,
	    go_backward_character_command_translator_1);
    Qgo_up_line = STATIC_SYMBOL("GO-UP-LINE",AB_package);
    mutate_global_property(Qgo_up_line,T,Qeditor_command_p);
    make_ui_command(5,Qgo_up_line,list_constant_29,Qnil,Qgo_up_line,Qnil);
    Qup = STATIC_SYMBOL("UP",AB_package);
    com_go_up_line_1 = STATIC_FUNCTION(com_go_up_line,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_up_line,com_go_up_line_1);
    go_up_line_command_pursuer_1 = 
	    STATIC_FUNCTION(go_up_line_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_up_line,go_up_line_command_pursuer_1);
    go_up_line_command_translator_1 = 
	    STATIC_FUNCTION(go_up_line_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_up_line,go_up_line_command_translator_1);
    Qgo_down_line = STATIC_SYMBOL("GO-DOWN-LINE",AB_package);
    mutate_global_property(Qgo_down_line,T,Qeditor_command_p);
    make_ui_command(5,Qgo_down_line,list_constant_29,Qnil,Qgo_down_line,Qnil);
    Qdown = STATIC_SYMBOL("DOWN",AB_package);
    com_go_down_line_1 = STATIC_FUNCTION(com_go_down_line,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_down_line,com_go_down_line_1);
    go_down_line_command_pursuer_1 = 
	    STATIC_FUNCTION(go_down_line_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_down_line,go_down_line_command_pursuer_1);
    go_down_line_command_translator_1 = 
	    STATIC_FUNCTION(go_down_line_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_down_line,go_down_line_command_translator_1);
    Qdelete_backward_word = STATIC_SYMBOL("DELETE-BACKWARD-WORD",AB_package);
    mutate_global_property(Qdelete_backward_word,T,Qeditor_command_p);
    make_ui_command(5,Qdelete_backward_word,list_constant_29,Qnil,
	    Qdelete_backward_word,Qnil);
    com_delete_backward_word_1 = STATIC_FUNCTION(com_delete_backward_word,
	    NIL,FALSE,2,2);
    set_ui_command_function(Qdelete_backward_word,com_delete_backward_word_1);
    delete_backward_word_command_pursuer_1 = 
	    STATIC_FUNCTION(delete_backward_word_command_pursuer,NIL,FALSE,
	    1,1);
    set_ui_command_pursuer(Qdelete_backward_word,
	    delete_backward_word_command_pursuer_1);
    delete_backward_word_command_translator_1 = 
	    STATIC_FUNCTION(delete_backward_word_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qdelete_backward_word,
	    delete_backward_word_command_translator_1);
    Qdelete_forward_word = STATIC_SYMBOL("DELETE-FORWARD-WORD",AB_package);
    mutate_global_property(Qdelete_forward_word,T,Qeditor_command_p);
    make_ui_command(5,Qdelete_forward_word,list_constant_29,Qnil,
	    Qdelete_forward_word,Qnil);
    com_delete_forward_word_1 = STATIC_FUNCTION(com_delete_forward_word,
	    NIL,FALSE,2,2);
    set_ui_command_function(Qdelete_forward_word,com_delete_forward_word_1);
    delete_forward_word_command_pursuer_1 = 
	    STATIC_FUNCTION(delete_forward_word_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qdelete_forward_word,
	    delete_forward_word_command_pursuer_1);
    delete_forward_word_command_translator_1 = 
	    STATIC_FUNCTION(delete_forward_word_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qdelete_forward_word,
	    delete_forward_word_command_translator_1);
    Qgo_backward_word = STATIC_SYMBOL("GO-BACKWARD-WORD",AB_package);
    mutate_global_property(Qgo_backward_word,T,Qeditor_command_p);
    make_ui_command(5,Qgo_backward_word,list_constant_29,Qnil,
	    Qgo_backward_word,Qnil);
    com_go_backward_word_1 = STATIC_FUNCTION(com_go_backward_word,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qgo_backward_word,com_go_backward_word_1);
    go_backward_word_command_pursuer_1 = 
	    STATIC_FUNCTION(go_backward_word_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_backward_word,
	    go_backward_word_command_pursuer_1);
    go_backward_word_command_translator_1 = 
	    STATIC_FUNCTION(go_backward_word_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_backward_word,
	    go_backward_word_command_translator_1);
    Qgo_forward_word = STATIC_SYMBOL("GO-FORWARD-WORD",AB_package);
    mutate_global_property(Qgo_forward_word,T,Qeditor_command_p);
    make_ui_command(5,Qgo_forward_word,list_constant_29,Qnil,
	    Qgo_forward_word,Qnil);
    com_go_forward_word_1 = STATIC_FUNCTION(com_go_forward_word,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_forward_word,com_go_forward_word_1);
    go_forward_word_command_pursuer_1 = 
	    STATIC_FUNCTION(go_forward_word_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_forward_word,go_forward_word_command_pursuer_1);
    go_forward_word_command_translator_1 = 
	    STATIC_FUNCTION(go_forward_word_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_forward_word,
	    go_forward_word_command_translator_1);
    Qundo = STATIC_SYMBOL("UNDO",AB_package);
    mutate_global_property(Qundo,T,Qeditor_command_p);
    make_ui_command(5,Qundo,list_constant_29,Qnil,Qundo,Qnil);
    string_constant_7 = STATIC_STRING("There is nothing more to undo");
    com_undo_1 = STATIC_FUNCTION(com_undo,NIL,FALSE,2,2);
    set_ui_command_function(Qundo,com_undo_1);
    undo_command_pursuer_1 = STATIC_FUNCTION(undo_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qundo,undo_command_pursuer_1);
    undo_command_translator_1 = STATIC_FUNCTION(undo_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qundo,undo_command_translator_1);
    Qredo = STATIC_SYMBOL("REDO",AB_package);
    mutate_global_property(Qredo,T,Qeditor_command_p);
    make_ui_command(5,Qredo,list_constant_29,Qnil,Qredo,Qnil);
    string_constant_8 = 
	    STATIC_STRING("There is nothing more to redo.  (You may only redo edits right after undoing them.)");
    com_redo_1 = STATIC_FUNCTION(com_redo,NIL,FALSE,2,2);
    set_ui_command_function(Qredo,com_redo_1);
    redo_command_pursuer_1 = STATIC_FUNCTION(redo_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qredo,redo_command_pursuer_1);
    redo_command_translator_1 = STATIC_FUNCTION(redo_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qredo,redo_command_translator_1);
    Qdelete_backward_character = STATIC_SYMBOL("DELETE-BACKWARD-CHARACTER",
	    AB_package);
    mutate_global_property(Qdelete_backward_character,T,Qeditor_command_p);
    make_ui_command(5,Qdelete_backward_character,list_constant_29,Qnil,
	    Qdelete_backward_character,Qnil);
    com_delete_backward_character_1 = 
	    STATIC_FUNCTION(com_delete_backward_character,NIL,FALSE,2,2);
    set_ui_command_function(Qdelete_backward_character,
	    com_delete_backward_character_1);
    delete_backward_character_command_pursuer_1 = 
	    STATIC_FUNCTION(delete_backward_character_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qdelete_backward_character,
	    delete_backward_character_command_pursuer_1);
    delete_backward_character_command_translator_1 = 
	    STATIC_FUNCTION(delete_backward_character_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qdelete_backward_character,
	    delete_backward_character_command_translator_1);
    Qrubout_on_blank_text = STATIC_SYMBOL("RUBOUT-ON-BLANK-TEXT",AB_package);
    Qdelete_forward_character = STATIC_SYMBOL("DELETE-FORWARD-CHARACTER",
	    AB_package);
    mutate_global_property(Qdelete_forward_character,T,Qeditor_command_p);
    make_ui_command(5,Qdelete_forward_character,list_constant_29,Qnil,
	    Qdelete_forward_character,Qnil);
    com_delete_forward_character_1 = 
	    STATIC_FUNCTION(com_delete_forward_character,NIL,FALSE,2,2);
    set_ui_command_function(Qdelete_forward_character,
	    com_delete_forward_character_1);
    delete_forward_character_command_pursuer_1 = 
	    STATIC_FUNCTION(delete_forward_character_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qdelete_forward_character,
	    delete_forward_character_command_pursuer_1);
    delete_forward_character_command_translator_1 = 
	    STATIC_FUNCTION(delete_forward_character_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qdelete_forward_character,
	    delete_forward_character_command_translator_1);
    Qdelete_backward_to_beginning = 
	    STATIC_SYMBOL("DELETE-BACKWARD-TO-BEGINNING",AB_package);
    mutate_global_property(Qdelete_backward_to_beginning,T,Qeditor_command_p);
    make_ui_command(5,Qdelete_backward_to_beginning,list_constant_29,Qnil,
	    Qdelete_backward_to_beginning,Qnil);
    com_delete_backward_to_beginning_1 = 
	    STATIC_FUNCTION(com_delete_backward_to_beginning,NIL,FALSE,2,2);
    set_ui_command_function(Qdelete_backward_to_beginning,
	    com_delete_backward_to_beginning_1);
    delete_backward_to_beginning_command_pursuer_1 = 
	    STATIC_FUNCTION(delete_backward_to_beginning_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qdelete_backward_to_beginning,
	    delete_backward_to_beginning_command_pursuer_1);
    delete_backward_to_beginning_command_translator_1 = 
	    STATIC_FUNCTION(delete_backward_to_beginning_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qdelete_backward_to_beginning,
	    delete_backward_to_beginning_command_translator_1);
    Qforward = STATIC_SYMBOL("FORWARD",AB_package);
    Qpage = STATIC_SYMBOL("PAGE",AB_package);
    Qgo_up_page = STATIC_SYMBOL("GO-UP-PAGE",AB_package);
    mutate_global_property(Qgo_up_page,T,Qeditor_command_p);
    make_ui_command(5,Qgo_up_page,list_constant_29,Qnil,Qgo_up_page,Qnil);
    Qbackward = STATIC_SYMBOL("BACKWARD",AB_package);
    com_go_up_page_1 = STATIC_FUNCTION(com_go_up_page,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_up_page,com_go_up_page_1);
    go_up_page_command_pursuer_1 = 
	    STATIC_FUNCTION(go_up_page_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_up_page,go_up_page_command_pursuer_1);
    go_up_page_command_translator_1 = 
	    STATIC_FUNCTION(go_up_page_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_up_page,go_up_page_command_translator_1);
    Qgo_down_page = STATIC_SYMBOL("GO-DOWN-PAGE",AB_package);
    mutate_global_property(Qgo_down_page,T,Qeditor_command_p);
    make_ui_command(5,Qgo_down_page,list_constant_29,Qnil,Qgo_down_page,Qnil);
    com_go_down_page_1 = STATIC_FUNCTION(com_go_down_page,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_down_page,com_go_down_page_1);
    go_down_page_command_pursuer_1 = 
	    STATIC_FUNCTION(go_down_page_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_down_page,go_down_page_command_pursuer_1);
    go_down_page_command_translator_1 = 
	    STATIC_FUNCTION(go_down_page_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_down_page,go_down_page_command_translator_1);
    Qgo_to_beginning = STATIC_SYMBOL("GO-TO-BEGINNING",AB_package);
    mutate_global_property(Qgo_to_beginning,T,Qeditor_command_p);
    make_ui_command(5,Qgo_to_beginning,list_constant_29,Qnil,
	    Qgo_to_beginning,Qnil);
    com_go_to_beginning_1 = STATIC_FUNCTION(com_go_to_beginning,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_to_beginning,com_go_to_beginning_1);
    go_to_beginning_command_pursuer_1 = 
	    STATIC_FUNCTION(go_to_beginning_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_to_beginning,go_to_beginning_command_pursuer_1);
    go_to_beginning_command_translator_1 = 
	    STATIC_FUNCTION(go_to_beginning_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_to_beginning,
	    go_to_beginning_command_translator_1);
    Qgo_to_end = STATIC_SYMBOL("GO-TO-END",AB_package);
    mutate_global_property(Qgo_to_end,T,Qeditor_command_p);
    make_ui_command(5,Qgo_to_end,list_constant_29,Qnil,Qgo_to_end,Qnil);
    com_go_to_end_1 = STATIC_FUNCTION(com_go_to_end,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_to_end,com_go_to_end_1);
    go_to_end_command_pursuer_1 = 
	    STATIC_FUNCTION(go_to_end_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_to_end,go_to_end_command_pursuer_1);
    go_to_end_command_translator_1 = 
	    STATIC_FUNCTION(go_to_end_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_to_end,go_to_end_command_translator_1);
    Qgo_to_beginning_of_line = STATIC_SYMBOL("GO-TO-BEGINNING-OF-LINE",
	    AB_package);
    mutate_global_property(Qgo_to_beginning_of_line,T,Qeditor_command_p);
    make_ui_command(5,Qgo_to_beginning_of_line,list_constant_29,Qnil,
	    Qgo_to_beginning_of_line,Qnil);
    com_go_to_beginning_of_line_1 = 
	    STATIC_FUNCTION(com_go_to_beginning_of_line,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_to_beginning_of_line,
	    com_go_to_beginning_of_line_1);
    go_to_beginning_of_line_command_pursuer_1 = 
	    STATIC_FUNCTION(go_to_beginning_of_line_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qgo_to_beginning_of_line,
	    go_to_beginning_of_line_command_pursuer_1);
    go_to_beginning_of_line_command_translator_1 = 
	    STATIC_FUNCTION(go_to_beginning_of_line_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qgo_to_beginning_of_line,
	    go_to_beginning_of_line_command_translator_1);
    Qgo_to_end_of_line = STATIC_SYMBOL("GO-TO-END-OF-LINE",AB_package);
    mutate_global_property(Qgo_to_end_of_line,T,Qeditor_command_p);
    make_ui_command(5,Qgo_to_end_of_line,list_constant_29,Qnil,
	    Qgo_to_end_of_line,Qnil);
    com_go_to_end_of_line_1 = STATIC_FUNCTION(com_go_to_end_of_line,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qgo_to_end_of_line,com_go_to_end_of_line_1);
    go_to_end_of_line_command_pursuer_1 = 
	    STATIC_FUNCTION(go_to_end_of_line_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_to_end_of_line,
	    go_to_end_of_line_command_pursuer_1);
    go_to_end_of_line_command_translator_1 = 
	    STATIC_FUNCTION(go_to_end_of_line_command_translator,NIL,FALSE,
	    1,1);
    set_ui_command_translator(Qgo_to_end_of_line,
	    go_to_end_of_line_command_translator_1);
    Qinsert_newline_complex_character = 
	    STATIC_SYMBOL("INSERT-NEWLINE-COMPLEX-CHARACTER",AB_package);
    mutate_global_property(Qinsert_newline_complex_character,T,
	    Qeditor_command_p);
    make_ui_command(5,Qinsert_newline_complex_character,list_constant_29,
	    Qnil,Qinsert_newline_complex_character,Qnil);
    com_insert_newline_complex_character_1 = 
	    STATIC_FUNCTION(com_insert_newline_complex_character,NIL,FALSE,
	    2,2);
    set_ui_command_function(Qinsert_newline_complex_character,
	    com_insert_newline_complex_character_1);
    insert_newline_complex_character_command_pursuer_1 = 
	    STATIC_FUNCTION(insert_newline_complex_character_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qinsert_newline_complex_character,
	    insert_newline_complex_character_command_pursuer_1);
    insert_newline_complex_character_command_translator_1 = 
	    STATIC_FUNCTION(insert_newline_complex_character_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qinsert_newline_complex_character,
	    insert_newline_complex_character_command_translator_1);
    array_constant_1 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_1,(SI_Long)0L,(SI_Long)8232L);
    UBYTE_16_ISASET_1(array_constant_1,(SI_Long)6L,(SI_Long)1L);
    UBYTE_16_ISASET_1(array_constant_1,(SI_Long)7L,(SI_Long)57344L);
    Qmaybe_insert_newline = STATIC_SYMBOL("MAYBE-INSERT-NEWLINE",AB_package);
    mutate_global_property(Qmaybe_insert_newline,T,Qeditor_command_p);
    Qmouse_pointer = STATIC_SYMBOL("MOUSE-POINTER",AB_package);
    Qselected_workspace = STATIC_SYMBOL("SELECTED-WORKSPACE",AB_package);
    Qworkspace = STATIC_SYMBOL("WORKSPACE",AB_package);
    list_constant_30 = STATIC_LIST((SI_Long)6L,Qevent,list_constant_28,
	    Qmouse_pointer,Qand_optional,Qselected_workspace,Qworkspace);
    make_ui_command(5,Qmaybe_insert_newline,list_constant_30,Qnil,
	    Qmaybe_insert_newline,Qnil);
    com_maybe_insert_newline_1 = STATIC_FUNCTION(com_maybe_insert_newline,
	    NIL,TRUE,3,5);
    set_ui_command_function(Qmaybe_insert_newline,com_maybe_insert_newline_1);
    maybe_insert_newline_command_pursuer_1 = 
	    STATIC_FUNCTION(maybe_insert_newline_command_pursuer,NIL,FALSE,
	    1,1);
    set_ui_command_pursuer(Qmaybe_insert_newline,
	    maybe_insert_newline_command_pursuer_1);
    maybe_insert_newline_command_translator_1 = 
	    STATIC_FUNCTION(maybe_insert_newline_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qmaybe_insert_newline,
	    maybe_insert_newline_command_translator_1);
    Qdo_return_key_function = STATIC_SYMBOL("DO-RETURN-KEY-FUNCTION",
	    AB_package);
    mutate_global_property(Qdo_return_key_function,T,Qeditor_command_p);
    make_ui_command(5,Qdo_return_key_function,list_constant_29,Qnil,
	    Qdo_return_key_function,Qnil);
    Qend_editing = STATIC_SYMBOL("END-EDITING",AB_package);
    com_do_return_key_function_1 = 
	    STATIC_FUNCTION(com_do_return_key_function,NIL,FALSE,2,2);
    set_ui_command_function(Qdo_return_key_function,
	    com_do_return_key_function_1);
    do_return_key_function_command_pursuer_1 = 
	    STATIC_FUNCTION(do_return_key_function_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qdo_return_key_function,
	    do_return_key_function_command_pursuer_1);
    do_return_key_function_command_translator_1 = 
	    STATIC_FUNCTION(do_return_key_function_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qdo_return_key_function,
	    do_return_key_function_command_translator_1);
    Qdo_tab_function = STATIC_SYMBOL("DO-TAB-FUNCTION",AB_package);
    mutate_global_property(Qdo_tab_function,T,Qeditor_command_p);
    make_ui_command(5,Qdo_tab_function,list_constant_29,Qnil,
	    Qdo_tab_function,Qnil);
    Qtab_exit = STATIC_SYMBOL("TAB-EXIT",AB_package);
    Qend = STATIC_SYMBOL("END",AB_package);
    com_do_tab_function_1 = STATIC_FUNCTION(com_do_tab_function,NIL,FALSE,2,2);
    set_ui_command_function(Qdo_tab_function,com_do_tab_function_1);
    do_tab_function_command_pursuer_1 = 
	    STATIC_FUNCTION(do_tab_function_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qdo_tab_function,do_tab_function_command_pursuer_1);
    do_tab_function_command_translator_1 = 
	    STATIC_FUNCTION(do_tab_function_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qdo_tab_function,
	    do_tab_function_command_translator_1);
    mutate_global_property(Qend_editing,T,Qeditor_command_p);
    make_ui_command(5,Qend_editing,list_constant_29,Qnil,Qend_editing,Qnil);
    com_end_editing_1 = STATIC_FUNCTION(com_end_editing,NIL,FALSE,2,2);
    set_ui_command_function(Qend_editing,com_end_editing_1);
    end_editing_command_pursuer_1 = 
	    STATIC_FUNCTION(end_editing_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qend_editing,end_editing_command_pursuer_1);
    end_editing_command_translator_1 = 
	    STATIC_FUNCTION(end_editing_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qend_editing,end_editing_command_translator_1);
    Qend_exit = STATIC_SYMBOL("END-EXIT",AB_package);
    SET_SYMBOL_FUNCTION(Qend_editing,STATIC_FUNCTION(end_editing,NIL,FALSE,
	    0,0));
    Qabort_editing = STATIC_SYMBOL("ABORT-EDITING",AB_package);
    mutate_global_property(Qabort_editing,T,Qeditor_command_p);
    make_ui_command(5,Qabort_editing,list_constant_29,Qnil,Qabort_editing,
	    Qnil);
    com_abort_editing_1 = STATIC_FUNCTION(com_abort_editing,NIL,FALSE,2,2);
    set_ui_command_function(Qabort_editing,com_abort_editing_1);
    abort_editing_command_pursuer_1 = 
	    STATIC_FUNCTION(abort_editing_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qabort_editing,abort_editing_command_pursuer_1);
    abort_editing_command_translator_1 = 
	    STATIC_FUNCTION(abort_editing_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qabort_editing,
	    abort_editing_command_translator_1);
    string_constant_9 = 
	    STATIC_STRING("Discard edits\? (Changes made to the edited text will be lost!)");
    Qabort_editing_current_workstation_context = 
	    STATIC_SYMBOL("ABORT-EDITING-CURRENT-WORKSTATION-CONTEXT",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qabort_editing_current_workstation_context,
	    STATIC_FUNCTION(abort_editing_current_workstation_context,NIL,
	    FALSE,0,0));
    Qinsert_accented_or_special_or_coded_character = 
	    STATIC_SYMBOL("INSERT-ACCENTED-OR-SPECIAL-OR-CODED-CHARACTER",
	    AB_package);
    mutate_global_property(Qinsert_accented_or_special_or_coded_character,
	    T,Qeditor_command_p);
    make_ui_command(5,Qinsert_accented_or_special_or_coded_character,
	    list_constant_29,Qnil,
	    Qinsert_accented_or_special_or_coded_character,Qnil);
    com_insert_accented_or_special_or_coded_character_1 = 
	    STATIC_FUNCTION(com_insert_accented_or_special_or_coded_character,
	    NIL,FALSE,2,2);
    set_ui_command_function(Qinsert_accented_or_special_or_coded_character,
	    com_insert_accented_or_special_or_coded_character_1);
    insert_accented_or_special_or_coded_character_command_pursuer_1 = 
	    STATIC_FUNCTION(insert_accented_or_special_or_coded_character_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qinsert_accented_or_special_or_coded_character,
	    insert_accented_or_special_or_coded_character_command_pursuer_1);
    insert_accented_or_special_or_coded_character_command_translator_1 = 
	    STATIC_FUNCTION(insert_accented_or_special_or_coded_character_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qinsert_accented_or_special_or_coded_character,
	    insert_accented_or_special_or_coded_character_command_translator_1);
    Qmouse_up_in_editing_context = 
	    STATIC_SYMBOL("MOUSE-UP-IN-EDITING-CONTEXT",AB_package);
    mutate_global_property(Qmouse_up_in_editing_context,
	    Qmouse_up_in_editing_context,Qnew_style_event_handler);
    SET_SYMBOL_FUNCTION(Qmouse_up_in_editing_context,
	    STATIC_FUNCTION(mouse_up_in_editing_context,NIL,FALSE,1,1));
    Qcycle_to_next_kana = STATIC_SYMBOL("CYCLE-TO-NEXT-KANA",AB_package);
    mutate_global_property(Qcycle_to_next_kana,T,Qeditor_command_p);
    make_ui_command(5,Qcycle_to_next_kana,list_constant_29,Qnil,
	    Qcycle_to_next_kana,Qnil);
    Qkorean = STATIC_SYMBOL("KOREAN",AB_package);
    Qjapanese = STATIC_SYMBOL("JAPANESE",AB_package);
    Qkatakana = STATIC_SYMBOL("KATAKANA",AB_package);
    Qhiragana = STATIC_SYMBOL("HIRAGANA",AB_package);
    Qrussian = STATIC_SYMBOL("RUSSIAN",AB_package);
    com_cycle_to_next_kana_1 = STATIC_FUNCTION(com_cycle_to_next_kana,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qcycle_to_next_kana,com_cycle_to_next_kana_1);
    cycle_to_next_kana_command_pursuer_1 = 
	    STATIC_FUNCTION(cycle_to_next_kana_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qcycle_to_next_kana,
	    cycle_to_next_kana_command_pursuer_1);
    cycle_to_next_kana_command_translator_1 = 
	    STATIC_FUNCTION(cycle_to_next_kana_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qcycle_to_next_kana,
	    cycle_to_next_kana_command_translator_1);
    Qenter_kanji_mode = STATIC_SYMBOL("ENTER-KANJI-MODE",AB_package);
    mutate_global_property(Qenter_kanji_mode,T,Qeditor_command_p);
    make_ui_command(5,Qenter_kanji_mode,list_constant_29,Qnil,
	    Qenter_kanji_mode,Qnil);
    com_enter_kanji_mode_1 = STATIC_FUNCTION(com_enter_kanji_mode,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qenter_kanji_mode,com_enter_kanji_mode_1);
    enter_kanji_mode_command_pursuer_1 = 
	    STATIC_FUNCTION(enter_kanji_mode_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qenter_kanji_mode,
	    enter_kanji_mode_command_pursuer_1);
    enter_kanji_mode_command_translator_1 = 
	    STATIC_FUNCTION(enter_kanji_mode_command_translator,NIL,FALSE,1,1);
    set_ui_command_translator(Qenter_kanji_mode,
	    enter_kanji_mode_command_translator_1);
    Qgo_up_one_row_in_kfep_conversion_choice_menu = 
	    STATIC_SYMBOL("GO-UP-ONE-ROW-IN-KFEP-CONVERSION-CHOICE-MENU",
	    AB_package);
    mutate_global_property(Qgo_up_one_row_in_kfep_conversion_choice_menu,T,
	    Qeditor_command_p);
    make_ui_command(5,Qgo_up_one_row_in_kfep_conversion_choice_menu,
	    list_constant_29,Qnil,
	    Qgo_up_one_row_in_kfep_conversion_choice_menu,Qnil);
    com_go_up_one_row_in_kfep_conversion_choice_menu_1 = 
	    STATIC_FUNCTION(com_go_up_one_row_in_kfep_conversion_choice_menu,
	    NIL,FALSE,2,2);
    set_ui_command_function(Qgo_up_one_row_in_kfep_conversion_choice_menu,
	    com_go_up_one_row_in_kfep_conversion_choice_menu_1);
    go_up_one_row_in_kfep_conversion_choice_menu_command_pursuer_1 = 
	    STATIC_FUNCTION(go_up_one_row_in_kfep_conversion_choice_menu_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_up_one_row_in_kfep_conversion_choice_menu,
	    go_up_one_row_in_kfep_conversion_choice_menu_command_pursuer_1);
    go_up_one_row_in_kfep_conversion_choice_menu_command_translator_1 = 
	    STATIC_FUNCTION(go_up_one_row_in_kfep_conversion_choice_menu_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_up_one_row_in_kfep_conversion_choice_menu,
	    go_up_one_row_in_kfep_conversion_choice_menu_command_translator_1);
    Qgo_down_one_row_in_kfep_conversion_choice_menu = 
	    STATIC_SYMBOL("GO-DOWN-ONE-ROW-IN-KFEP-CONVERSION-CHOICE-MENU",
	    AB_package);
    mutate_global_property(Qgo_down_one_row_in_kfep_conversion_choice_menu,
	    T,Qeditor_command_p);
    make_ui_command(5,Qgo_down_one_row_in_kfep_conversion_choice_menu,
	    list_constant_29,Qnil,
	    Qgo_down_one_row_in_kfep_conversion_choice_menu,Qnil);
    com_go_down_one_row_in_kfep_conversion_choice_menu_1 = 
	    STATIC_FUNCTION(com_go_down_one_row_in_kfep_conversion_choice_menu,
	    NIL,FALSE,2,2);
    set_ui_command_function(Qgo_down_one_row_in_kfep_conversion_choice_menu,
	    com_go_down_one_row_in_kfep_conversion_choice_menu_1);
    go_down_one_row_in_kfep_conversion_choice_menu_command_pursuer_1 = 
	    STATIC_FUNCTION(go_down_one_row_in_kfep_conversion_choice_menu_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_down_one_row_in_kfep_conversion_choice_menu,
	    go_down_one_row_in_kfep_conversion_choice_menu_command_pursuer_1);
    go_down_one_row_in_kfep_conversion_choice_menu_command_translator_1 = 
	    STATIC_FUNCTION(go_down_one_row_in_kfep_conversion_choice_menu_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_down_one_row_in_kfep_conversion_choice_menu,
	    go_down_one_row_in_kfep_conversion_choice_menu_command_translator_1);
    Qskip_kfep_conversion = STATIC_SYMBOL("SKIP-KFEP-CONVERSION",AB_package);
    mutate_global_property(Qskip_kfep_conversion,T,Qeditor_command_p);
    make_ui_command(5,Qskip_kfep_conversion,list_constant_29,Qnil,
	    Qskip_kfep_conversion,Qnil);
    com_skip_kfep_conversion_1 = STATIC_FUNCTION(com_skip_kfep_conversion,
	    NIL,FALSE,2,2);
    set_ui_command_function(Qskip_kfep_conversion,com_skip_kfep_conversion_1);
    skip_kfep_conversion_command_pursuer_1 = 
	    STATIC_FUNCTION(skip_kfep_conversion_command_pursuer,NIL,FALSE,
	    1,1);
    set_ui_command_pursuer(Qskip_kfep_conversion,
	    skip_kfep_conversion_command_pursuer_1);
    skip_kfep_conversion_command_translator_1 = 
	    STATIC_FUNCTION(skip_kfep_conversion_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qskip_kfep_conversion,
	    skip_kfep_conversion_command_translator_1);
    Qshrink_kfep_conversion_text_region = 
	    STATIC_SYMBOL("SHRINK-KFEP-CONVERSION-TEXT-REGION",AB_package);
    mutate_global_property(Qshrink_kfep_conversion_text_region,T,
	    Qeditor_command_p);
    make_ui_command(5,Qshrink_kfep_conversion_text_region,list_constant_29,
	    Qnil,Qshrink_kfep_conversion_text_region,Qnil);
    com_shrink_kfep_conversion_text_region_1 = 
	    STATIC_FUNCTION(com_shrink_kfep_conversion_text_region,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qshrink_kfep_conversion_text_region,
	    com_shrink_kfep_conversion_text_region_1);
    shrink_kfep_conversion_text_region_command_pursuer_1 = 
	    STATIC_FUNCTION(shrink_kfep_conversion_text_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qshrink_kfep_conversion_text_region,
	    shrink_kfep_conversion_text_region_command_pursuer_1);
    shrink_kfep_conversion_text_region_command_translator_1 = 
	    STATIC_FUNCTION(shrink_kfep_conversion_text_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qshrink_kfep_conversion_text_region,
	    shrink_kfep_conversion_text_region_command_translator_1);
    Qexpand_kfep_conversion_text_region = 
	    STATIC_SYMBOL("EXPAND-KFEP-CONVERSION-TEXT-REGION",AB_package);
    mutate_global_property(Qexpand_kfep_conversion_text_region,T,
	    Qeditor_command_p);
    make_ui_command(5,Qexpand_kfep_conversion_text_region,list_constant_29,
	    Qnil,Qexpand_kfep_conversion_text_region,Qnil);
    com_expand_kfep_conversion_text_region_1 = 
	    STATIC_FUNCTION(com_expand_kfep_conversion_text_region,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qexpand_kfep_conversion_text_region,
	    com_expand_kfep_conversion_text_region_1);
    expand_kfep_conversion_text_region_command_pursuer_1 = 
	    STATIC_FUNCTION(expand_kfep_conversion_text_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qexpand_kfep_conversion_text_region,
	    expand_kfep_conversion_text_region_command_pursuer_1);
    expand_kfep_conversion_text_region_command_translator_1 = 
	    STATIC_FUNCTION(expand_kfep_conversion_text_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qexpand_kfep_conversion_text_region,
	    expand_kfep_conversion_text_region_command_translator_1);
    Qhandle_mouse_down_event_in_edit_context = 
	    STATIC_SYMBOL("HANDLE-MOUSE-DOWN-EVENT-IN-EDIT-CONTEXT",
	    AB_package);
    mutate_global_property(Qhandle_mouse_down_event_in_edit_context,
	    Qhandle_mouse_down_event_in_edit_context,Qnew_style_event_handler);
    Qtext_highlight_bar = STATIC_SYMBOL("TEXT-HIGHLIGHT-BAR",AB_package);
    Qicon_cell = STATIC_SYMBOL("ICON-CELL",AB_package);
    list_constant_6 = STATIC_LIST((SI_Long)6L,Qtext_region,
	    Qsmall_edit_cursor,Qedit_cursor,Qtext_highlight_bar,Qicon_cell,
	    Qeditor_subcommand_button);
    Qsearch_for_text_in_editor = STATIC_SYMBOL("SEARCH-FOR-TEXT-IN-EDITOR",
	    AB_package);
    Qtext_inserter = STATIC_SYMBOL("TEXT-INSERTER",AB_package);
    Qdo_edit_subcommand = STATIC_SYMBOL("DO-EDIT-SUBCOMMAND",AB_package);
    Qg2_login = STATIC_SYMBOL("G2-LOGIN",AB_package);
    Qbutton = STATIC_SYMBOL("BUTTON",AB_package);
    Quser_settings_editor_workspace = 
	    STATIC_SYMBOL("USER-SETTINGS-EDITOR-WORKSPACE",AB_package);
    Qno_autocompletion = STATIC_SYMBOL("NO-AUTOCOMPLETION",AB_package);
    Qchoice = STATIC_SYMBOL("CHOICE",AB_package);
    Qcategory_instance_menu_workspace = 
	    STATIC_SYMBOL("CATEGORY-INSTANCE-MENU-WORKSPACE",AB_package);
    Qobject_name = STATIC_SYMBOL("OBJECT-NAME",AB_package);
    string_constant_10 = STATIC_STRING("Enter ~a");
    Qblinker = STATIC_SYMBOL("BLINKER",AB_package);
    Qallow_selection_of_outside_text_from_editor = 
	    STATIC_SYMBOL("ALLOW-SELECTION-OF-OUTSIDE-TEXT-FROM-EDITOR",
	    AB_package);
    Qallow_selection_of_text = STATIC_SYMBOL("ALLOW-SELECTION-OF-TEXT",
	    AB_package);
    Qscrap = STATIC_SYMBOL("SCRAP",AB_package);
    Qstatement = STATIC_SYMBOL("STATEMENT",AB_package);
    Qname_box = STATIC_SYMBOL("NAME-BOX",AB_package);
    Qlabel_box = STATIC_SYMBOL("LABEL-BOX",AB_package);
    Qmessage = STATIC_SYMBOL("MESSAGE",AB_package);
    Qrunning_head = STATIC_SYMBOL("RUNNING-HEAD",AB_package);
    Qpage_number = STATIC_SYMBOL("PAGE-NUMBER",AB_package);
    Qfree_text = STATIC_SYMBOL("FREE-TEXT",AB_package);
    Qborderless_free_text = STATIC_SYMBOL("BORDERLESS-FREE-TEXT",AB_package);
    Qcommand = STATIC_SYMBOL("COMMAND",AB_package);
    list_constant_7 = STATIC_LIST((SI_Long)11L,Qedit_box,Qscrap,Qstatement,
	    Qname_box,Qlabel_box,Qmessage,Qrunning_head,Qpage_number,
	    Qfree_text,Qborderless_free_text,Qcommand);
    Qmenu = STATIC_SYMBOL("MENU",AB_package);
    list_constant_8 = STATIC_LIST((SI_Long)2L,Qscrap,Qedit_box);
    Qcontinue_edit_after_mouse_watch = 
	    STATIC_SYMBOL("CONTINUE-EDIT-AFTER-MOUSE-WATCH",AB_package);
    SET_SYMBOL_FUNCTION(Qhandle_mouse_down_event_in_edit_context,
	    STATIC_FUNCTION(handle_mouse_down_event_in_edit_context,NIL,
	    FALSE,1,1));
    Kselect = STATIC_SYMBOL("SELECT",Pkeyword);
    Kdrag = STATIC_SYMBOL("DRAG",Pkeyword);
    Qcontinue_editing_by_posting_cut_copy_paste_menu = 
	    STATIC_SYMBOL("CONTINUE-EDITING-BY-POSTING-CUT-COPY-PASTE-MENU",
	    AB_package);
    Qcontinue_editing_by_doing_insert_selected_text_command = 
	    STATIC_SYMBOL("CONTINUE-EDITING-BY-DOING-INSERT-SELECTED-TEXT-COMMAND",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qcontinue_edit_after_mouse_watch,
	    STATIC_FUNCTION(continue_edit_after_mouse_watch,NIL,FALSE,1,1));
    Qobject_name_menus_in_upper_case_qm = 
	    STATIC_SYMBOL("OBJECT-NAME-MENUS-IN-UPPER-CASE\?",AB_package);
    Qattribute_name_represented_by_table_spot = 
	    STATIC_SYMBOL("ATTRIBUTE-NAME-REPRESENTED-BY-TABLE-SPOT",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qcontinue_editing_by_doing_insert_selected_text_command,
	    STATIC_FUNCTION(continue_editing_by_doing_insert_selected_text_command,
	    NIL,FALSE,1,1));
    Qeditor_text_marking_menu = STATIC_SYMBOL("EDITOR-TEXT-MARKING-MENU",
	    AB_package);
    Qreturn_from_edit_menu = STATIC_SYMBOL("RETURN-FROM-EDIT-MENU",AB_package);
    SET_SYMBOL_FUNCTION(Qcontinue_editing_by_posting_cut_copy_paste_menu,
	    STATIC_FUNCTION(continue_editing_by_posting_cut_copy_paste_menu,
	    NIL,FALSE,1,1));
    Qpending_delete_type_in = STATIC_SYMBOL("PENDING-DELETE-TYPE-IN",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qreturn_from_edit_menu,
	    STATIC_FUNCTION(return_from_edit_menu,NIL,FALSE,1,1));
    Qhandle_spaces_intelligently_qm = 
	    STATIC_SYMBOL("HANDLE-SPACES-INTELLIGENTLY\?",AB_package);
    Qcut_within_editor = STATIC_SYMBOL("CUT-WITHIN-EDITOR",AB_package);
    mutate_global_property(Qcut_within_editor,T,Qeditor_command_p);
    Qcut = STATIC_SYMBOL("CUT",AB_package);
    make_ui_command(5,Qcut_within_editor,list_constant_29,Qnil,Qcut,Qnil);
    com_cut_within_editor_1 = STATIC_FUNCTION(com_cut_within_editor,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qcut_within_editor,com_cut_within_editor_1);
    cut_within_editor_command_pursuer_1 = 
	    STATIC_FUNCTION(cut_within_editor_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qcut_within_editor,
	    cut_within_editor_command_pursuer_1);
    cut_within_editor_command_translator_1 = 
	    STATIC_FUNCTION(cut_within_editor_command_translator,NIL,FALSE,
	    1,1);
    set_ui_command_translator(Qcut_within_editor,
	    cut_within_editor_command_translator_1);
    Qui_command_named = STATIC_SYMBOL("UI-COMMAND-NAMED",AB_package);
    Qcopy_within_editor = STATIC_SYMBOL("COPY-WITHIN-EDITOR",AB_package);
    mutate_global_property(Qcopy_within_editor,T,Qeditor_command_p);
    Qcopy = STATIC_SYMBOL("COPY",AB_package);
    make_ui_command(5,Qcopy_within_editor,list_constant_29,Qnil,Qcopy,Qnil);
    com_copy_within_editor_1 = STATIC_FUNCTION(com_copy_within_editor,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qcopy_within_editor,com_copy_within_editor_1);
    copy_within_editor_command_pursuer_1 = 
	    STATIC_FUNCTION(copy_within_editor_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qcopy_within_editor,
	    copy_within_editor_command_pursuer_1);
    copy_within_editor_command_translator_1 = 
	    STATIC_FUNCTION(copy_within_editor_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qcopy_within_editor,
	    copy_within_editor_command_translator_1);
    Deselect_text_region_after_copy_p = Nil;
    Qpaste_within_editor = STATIC_SYMBOL("PASTE-WITHIN-EDITOR",AB_package);
    mutate_global_property(Qpaste_within_editor,T,Qeditor_command_p);
    Qimage_plane = STATIC_SYMBOL("IMAGE-PLANE",AB_package);
    list_constant_31 = STATIC_LIST((SI_Long)5L,Qevent,list_constant_28,
	    Qworkspace,Qimage_plane,Qmouse_pointer);
    Qpaste = STATIC_SYMBOL("PASTE",AB_package);
    make_ui_command(5,Qpaste_within_editor,list_constant_31,Qnil,Qpaste,Qnil);
    com_paste_within_editor_1 = STATIC_FUNCTION(com_paste_within_editor,
	    NIL,FALSE,5,5);
    set_ui_command_function(Qpaste_within_editor,com_paste_within_editor_1);
    paste_within_editor_command_pursuer_1 = 
	    STATIC_FUNCTION(paste_within_editor_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qpaste_within_editor,
	    paste_within_editor_command_pursuer_1);
    paste_within_editor_command_translator_1 = 
	    STATIC_FUNCTION(paste_within_editor_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qpaste_within_editor,
	    paste_within_editor_command_translator_1);
    Close_pending_procedure_signature_workspaces_on_close = T;
    Qopen_paren_token = STATIC_SYMBOL("OPEN-PAREN-TOKEN",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qopen_paren_token,Open_paren_token);
    Qop = STATIC_SYMBOL("(",AB_package);
    SET_SYMBOL_VALUE(Qopen_paren_token,Qop);
    Qclose_paren_token = STATIC_SYMBOL("CLOSE-PAREN-TOKEN",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qclose_paren_token,Close_paren_token);
    Qcp = STATIC_SYMBOL(")",AB_package);
    SET_SYMBOL_VALUE(Qclose_paren_token,Qcp);
    Qcall = STATIC_SYMBOL("CALL",AB_package);
    Qdo_not_use = STATIC_SYMBOL("DO-NOT-USE",AB_package);
    Kreturn = STATIC_SYMBOL("RETURN",Pkeyword);
    string_constant_11 = STATIC_STRING("~(~a~) (");
    string_constant_12 = STATIC_STRING(")");
    string_constant_13 = STATIC_STRING(" => (");
    array_constant_2 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)0L,(SI_Long)44L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)1L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)6L,(SI_Long)2L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)7L,(SI_Long)57344L);
    array_constant_3 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)0L,(SI_Long)58L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)1L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)6L,(SI_Long)2L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)7L,(SI_Long)57344L);
    array_constant_4 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)0L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)1L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)2L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)3L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)4L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)5L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)14L,(SI_Long)6L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)15L,(SI_Long)57344L);
    string_constant_14 = STATIC_STRING("~(~L,-~) arguments");
    Qstretch_new_image_planes_for_caption_p = 
	    STATIC_SYMBOL("STRETCH-NEW-IMAGE-PLANES-FOR-CAPTION-P",AB_package);
    Qab_method = STATIC_SYMBOL("METHOD",AB_package);
    Qprocedure = STATIC_SYMBOL("PROCEDURE",AB_package);
    Kgeneral_description = STATIC_SYMBOL("GENERAL-DESCRIPTION",Pkeyword);
    Qab_class = STATIC_SYMBOL("CLASS",AB_package);
    Ksequence = STATIC_SYMBOL("SEQUENCE",Pkeyword);
    Qab_structure = STATIC_SYMBOL("STRUCTURE",AB_package);
    Kstructure = STATIC_SYMBOL("STRUCTURE",Pkeyword);
    Qitem_or_datum = STATIC_SYMBOL("ITEM-OR-DATUM",AB_package);
    Qitem_or_value = STATIC_SYMBOL("ITEM-OR-VALUE",AB_package);
    Qx = STATIC_SYMBOL("X",AB_package);
    Qremote_procedure_argument_description = 
	    STATIC_SYMBOL("REMOTE-PROCEDURE-ARGUMENT-DESCRIPTION",AB_package);
    Kall_remaining = STATIC_SYMBOL("ALL-REMAINING",Pkeyword);
    string_constant_15 = STATIC_STRING("ARG-~d-AND-ALL-REMAINING");
    string_constant_16 = STATIC_STRING("ARG-~d");
    if (Disable_parameter_strings_for_internal_proprietary_procedures == 
	    UNBOUND)
	Disable_parameter_strings_for_internal_proprietary_procedures = Nil;
    mutate_global_property(Qsearch_for_text_in_editor,T,Qeditor_command_p);
    make_ui_command(5,Qsearch_for_text_in_editor,list_constant_29,Qnil,
	    Qsearch_for_text_in_editor,Qnil);
    Qsearch_forward_incrementally_for_text_in_editor = 
	    STATIC_SYMBOL("SEARCH-FORWARD-INCREMENTALLY-FOR-TEXT-IN-EDITOR",
	    AB_package);
    com_search_for_text_in_editor_1 = 
	    STATIC_FUNCTION(com_search_for_text_in_editor,NIL,FALSE,2,2);
    set_ui_command_function(Qsearch_for_text_in_editor,
	    com_search_for_text_in_editor_1);
    search_for_text_in_editor_command_pursuer_1 = 
	    STATIC_FUNCTION(search_for_text_in_editor_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qsearch_for_text_in_editor,
	    search_for_text_in_editor_command_pursuer_1);
    search_for_text_in_editor_command_translator_1 = 
	    STATIC_FUNCTION(search_for_text_in_editor_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qsearch_for_text_in_editor,
	    search_for_text_in_editor_command_translator_1);
    Qreturn_from_search_in_editor = 
	    STATIC_SYMBOL("RETURN-FROM-SEARCH-IN-EDITOR",AB_package);
    string_constant_17 = STATIC_STRING("Search: ");
    Qsmall_borderless_free_text_format = 
	    STATIC_SYMBOL("SMALL-BORDERLESS-FREE-TEXT-FORMAT",AB_package);
    Relative_horizontal_displacement_for_search_workspace = FIX((SI_Long)10L);
    Relative_vertical_displacement_for_search_workspace = FIX((SI_Long)34L);
    Qfind_forward_instance_of_search_string = 
	    STATIC_SYMBOL("FIND-FORWARD-INSTANCE-OF-SEARCH-STRING",AB_package);
    mutate_global_property(Qfind_forward_instance_of_search_string,T,
	    Qeditor_command_p);
    make_ui_command(5,Qfind_forward_instance_of_search_string,
	    list_constant_29,Qnil,Qfind_forward_instance_of_search_string,
	    Qnil);
    com_find_forward_instance_of_search_string_1 = 
	    STATIC_FUNCTION(com_find_forward_instance_of_search_string,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qfind_forward_instance_of_search_string,
	    com_find_forward_instance_of_search_string_1);
    find_forward_instance_of_search_string_command_pursuer_1 = 
	    STATIC_FUNCTION(find_forward_instance_of_search_string_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qfind_forward_instance_of_search_string,
	    find_forward_instance_of_search_string_command_pursuer_1);
    find_forward_instance_of_search_string_command_translator_1 = 
	    STATIC_FUNCTION(find_forward_instance_of_search_string_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qfind_forward_instance_of_search_string,
	    find_forward_instance_of_search_string_command_translator_1);
    Qfind_backward_instance_of_search_string = 
	    STATIC_SYMBOL("FIND-BACKWARD-INSTANCE-OF-SEARCH-STRING",
	    AB_package);
    mutate_global_property(Qfind_backward_instance_of_search_string,T,
	    Qeditor_command_p);
    make_ui_command(5,Qfind_backward_instance_of_search_string,
	    list_constant_29,Qnil,Qfind_backward_instance_of_search_string,
	    Qnil);
    Qsearch_backward_incrementally_for_text_in_editor = 
	    STATIC_SYMBOL("SEARCH-BACKWARD-INCREMENTALLY-FOR-TEXT-IN-EDITOR",
	    AB_package);
    com_find_backward_instance_of_search_string_1 = 
	    STATIC_FUNCTION(com_find_backward_instance_of_search_string,
	    NIL,FALSE,2,2);
    set_ui_command_function(Qfind_backward_instance_of_search_string,
	    com_find_backward_instance_of_search_string_1);
    find_backward_instance_of_search_string_command_pursuer_1 = 
	    STATIC_FUNCTION(find_backward_instance_of_search_string_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qfind_backward_instance_of_search_string,
	    find_backward_instance_of_search_string_command_pursuer_1);
    find_backward_instance_of_search_string_command_translator_1 = 
	    STATIC_FUNCTION(find_backward_instance_of_search_string_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qfind_backward_instance_of_search_string,
	    find_backward_instance_of_search_string_command_translator_1);
    SET_SYMBOL_FUNCTION(Qreturn_from_search_in_editor,
	    STATIC_FUNCTION(return_from_search_in_editor,NIL,FALSE,1,1));
    Qscroll_line_up = STATIC_SYMBOL("SCROLL-LINE-UP",AB_package);
    Qscroll_line_down = STATIC_SYMBOL("SCROLL-LINE-DOWN",AB_package);
    string_constant_97 = STATIC_STRING("Editor Commands");
    string_constant_98 = 
	    STATIC_STRING("13ey1n30Hy8k83-WDy1n30Gy8k83-W8y1n30Ey8k83--Ey1n30Fy8k83--7y1n83pBy8k83-Qby1nr8k83-Qby1n83pAy8k83-QXy1n3*+-Yy8k83i8y1n3*+-Uy8k83");
    string_constant_99 = 
	    STATIC_STRING("i7y1n3*+-Wy8k83-Qcy1n3Jy8k83-QYy1n3*+-xy8k83-QYy1n3Ky8k83-PWy1nn8k83-Ody1n3Iy8k83-hXy1n32Gy8k83--Cy1n33Wy8k83--Ay1n321y8k83--8y1");
    string_constant_100 = 
	    STATIC_STRING("n32=y8k83--Fy1n3S+2Gy8k83--By1n3S+3Wy8k83--9y1n3S+0Gy8k83i7y1n3S+0Hy8k83i8y1n3S++wy8k83--Cy1n3S++uy8k83--Ay1n3*++wy8k83--By1n3*+");
    string_constant_101 = 
	    STATIC_STRING("+uy8k83--9y1n3*+-ny8k83dSy1n3*+-ky8k83m9y1n3S+0Ly8k9k1n83GMy8k83-Rdy1n83pFy8k83-ZLy1n3*+0Ly8k83-d5y1n3*+-by8k83-ZIy1n3*+-ly8k83-");
    string_constant_102 = 
	    STATIC_STRING("mVy1n3*+-iy8k83-Tny1n3*+-gy8k83-Toy1n30Jy8k83-Rfy1n3S++Sy8k83-ZJy1n3T++Sy8k83-ZKy1n30My8k83-J=y1n831-y8k83-J=y1n388y8k9l1n389y8k");
    string_constant_103 = STATIC_STRING("9m");
    clear_optimized_constants();
    push_optimized_constant(Qend_editing);
    push_optimized_constant(Qscroll_line_up);
    push_optimized_constant(Qscroll_line_down);
    make_keymap(Qeditor_commands,string_constant_97,
	    regenerate_optimized_constant(list(6,string_constant_98,
	    string_constant_99,string_constant_100,string_constant_101,
	    string_constant_102,string_constant_103)),Qinternal,Qnil,Qnil,
	    Qnil,Qnil);
    mutate_global_property(Qscroll_line_down,Qscroll_line_down,
	    Qnew_style_event_handler);
    Qline = STATIC_SYMBOL("LINE",AB_package);
    SET_SYMBOL_FUNCTION(Qscroll_line_down,STATIC_FUNCTION(scroll_line_down,
	    NIL,FALSE,1,1));
    mutate_global_property(Qscroll_line_up,Qscroll_line_up,
	    Qnew_style_event_handler);
    SET_SYMBOL_FUNCTION(Qscroll_line_up,STATIC_FUNCTION(scroll_line_up,NIL,
	    FALSE,1,1));
    Qmotif_text_editor_commands = 
	    STATIC_SYMBOL("MOTIF-TEXT-EDITOR-COMMANDS",AB_package);
    string_constant_104 = STATIC_STRING("Motif Text Editor Commands");
    string_constant_105 = 
	    STATIC_STRING("1q1n3S+0Gy8k83i7y1n3S+0Hy8k83i8y1n3-+-xy8k83gXy1n3S+3Sy8k83Ipy1n3-+3Sy8k83lXy1n3*+0Iy8k83dSy");
    make_keymap(Qmotif_text_editor_commands,string_constant_104,
	    regenerate_optimized_constant(string_constant_105),Qinternal,
	    Qnil,Qnil,Qnil,Qnil);
    Qmswindows_text_editor_commands = 
	    STATIC_SYMBOL("MSWINDOWS-TEXT-EDITOR-COMMANDS",AB_package);
    string_constant_106 = STATIC_STRING("MSWindows Text Editor Commands");
    string_constant_107 = 
	    STATIC_STRING("1z1n30Fy8k83--7y1n30Ey8k83--Ey1n32Gy8k83--Cy1n33Wy8k83--Ay1n321y8k83--8y1n32=y8k83--Fy1n3S+0Hy8k83i8y1n3S+0Gy8k83i7y1n3S+2Gy8k83");
    string_constant_108 = 
	    STATIC_STRING("--By1n3S+3Wy8k83--9y1n3Ky8k83gXy1nn8k83Ipy1n3Iy8k83lXy1n3My8k83dSy1n3Ly8k83m9y");
    make_keymap(Qmswindows_text_editor_commands,string_constant_106,
	    regenerate_optimized_constant(LIST_2(string_constant_107,
	    string_constant_108)),Qinternal,Qnil,Qnil,Qnil,Qnil);
    Qenter_hot_spot_state_upon_frame_component = 
	    STATIC_SYMBOL("ENTER-HOT-SPOT-STATE-UPON-FRAME-COMPONENT",
	    AB_package);
    Qenter_elevator_state = STATIC_SYMBOL("ENTER-ELEVATOR-STATE",AB_package);
    Qauto_insert_text_in_editor = 
	    STATIC_SYMBOL("AUTO-INSERT-TEXT-IN-EDITOR",AB_package);
    string_constant_109 = 
	    STATIC_STRING("1y1n3Sy8k83-oxy1n3*+-dy8k83-Sdy1nv8k83-PYy1n3S++Zy8k9k1n3S+0Gy8k83-nry1n3S+0Hy8k83-T5y1n830Dy83FCy9l1n830Dy83KSy9m1n830Dy8k9n1n8");
    string_constant_110 = 
	    STATIC_STRING("30-y8k9o1n836Xy83cEy9p1n38Ey8k83-hVy1n38Fy8k83-tsy1n83pDy8k83-SHy");
    clear_optimized_constants();
    push_optimized_constant(Qskip_kfep_conversion);
    push_optimized_constant(Qenter_hot_spot_state_upon_frame_component);
    push_optimized_constant(Qenter_elevator_state);
    push_optimized_constant(Qhandle_mouse_down_event_in_edit_context);
    push_optimized_constant(Qmouse_up_in_editing_context);
    push_optimized_constant(Qauto_insert_text_in_editor);
    make_keymap(Qprivate_editor_commands,Qnil,
	    regenerate_optimized_constant(LIST_2(string_constant_109,
	    string_constant_110)),Qinternal,Qnil,Qnil,Qnil,Qnil);
    Qrun_top_level_event_handler = 
	    STATIC_SYMBOL("RUN-TOP-LEVEL-EVENT-HANDLER",AB_package);
    string_constant_111 = STATIC_STRING("1l1n83-Ify8k9k");
    Qnative_editor_commands_p = STATIC_SYMBOL("NATIVE-EDITOR-COMMANDS-P",
	    AB_package);
    clear_optimized_constants();
    push_optimized_constant(Qrun_top_level_event_handler);
    make_keymap(Qnative_editor_commands,Qnil,
	    regenerate_optimized_constant(string_constant_111),Qinternal,
	    Qnative_editor_commands_p,Qnil,Qnil,Qnil);
    Qcurrent_workstation_context = 
	    STATIC_SYMBOL("CURRENT-WORKSTATION-CONTEXT",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qcurrent_workstation_context,
	    Current_workstation_context);
    SET_SYMBOL_FUNCTION(Qnative_editor_commands_p,
	    STATIC_FUNCTION(native_editor_commands_p,NIL,FALSE,0,0));
    Qpaste_into_editor = STATIC_SYMBOL("PASTE-INTO-EDITOR",AB_package);
    mutate_global_property(Qpaste_into_editor,T,Qeditor_command_p);
    make_ui_command(5,Qpaste_into_editor,list_constant_29,Qnil,
	    Qpaste_into_editor,Qnil);
    com_paste_into_editor_1 = STATIC_FUNCTION(com_paste_into_editor,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qpaste_into_editor,com_paste_into_editor_1);
    paste_into_editor_command_pursuer_1 = 
	    STATIC_FUNCTION(paste_into_editor_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qpaste_into_editor,
	    paste_into_editor_command_pursuer_1);
    paste_into_editor_command_translator_1 = 
	    STATIC_FUNCTION(paste_into_editor_command_translator,NIL,FALSE,
	    1,1);
    set_ui_command_translator(Qpaste_into_editor,
	    paste_into_editor_command_translator_1);
    Qupdate_paste_status = STATIC_SYMBOL("UPDATE-PASTE-STATUS",AB_package);
    mutate_global_property(Qupdate_paste_status,T,Qeditor_command_p);
    make_ui_command(5,Qupdate_paste_status,list_constant_29,Qnil,
	    Qupdate_paste_status,Qnil);
    com_update_paste_status_1 = STATIC_FUNCTION(com_update_paste_status,
	    NIL,FALSE,2,2);
    set_ui_command_function(Qupdate_paste_status,com_update_paste_status_1);
    update_paste_status_command_pursuer_1 = 
	    STATIC_FUNCTION(update_paste_status_command_pursuer,NIL,FALSE,1,1);
    set_ui_command_pursuer(Qupdate_paste_status,
	    update_paste_status_command_pursuer_1);
    update_paste_status_command_translator_1 = 
	    STATIC_FUNCTION(update_paste_status_command_translator,NIL,
	    FALSE,1,1);
    set_ui_command_translator(Qupdate_paste_status,
	    update_paste_status_command_translator_1);
    mutate_global_property(Qauto_insert_text_in_editor,
	    Qauto_insert_text_in_editor,Qnew_style_event_handler);
    SET_SYMBOL_FUNCTION(Qauto_insert_text_in_editor,
	    STATIC_FUNCTION(auto_insert_text_in_editor,NIL,FALSE,1,1));
    Qcyrillic_character_in_text = 
	    STATIC_SYMBOL("CYRILLIC-CHARACTER-IN-TEXT",AB_package);
    mutate_global_property(Qcyrillic_character_in_text,T,Qeditor_command_p);
    make_ui_command(5,Qcyrillic_character_in_text,list_constant_29,Qnil,
	    Qcyrillic_character_in_text,Qnil);
    com_cyrillic_character_in_text_1 = 
	    STATIC_FUNCTION(com_cyrillic_character_in_text,NIL,FALSE,2,2);
    set_ui_command_function(Qcyrillic_character_in_text,
	    com_cyrillic_character_in_text_1);
    cyrillic_character_in_text_command_pursuer_1 = 
	    STATIC_FUNCTION(cyrillic_character_in_text_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qcyrillic_character_in_text,
	    cyrillic_character_in_text_command_pursuer_1);
    cyrillic_character_in_text_command_translator_1 = 
	    STATIC_FUNCTION(cyrillic_character_in_text_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qcyrillic_character_in_text,
	    cyrillic_character_in_text_command_translator_1);
    Qcyrillic = STATIC_SYMBOL("CYRILLIC",AB_package);
    Qenglish = STATIC_SYMBOL("ENGLISH",AB_package);
    Qhangul_character_in_text = STATIC_SYMBOL("HANGUL-CHARACTER-IN-TEXT",
	    AB_package);
    mutate_global_property(Qhangul_character_in_text,T,Qeditor_command_p);
    make_ui_command(5,Qhangul_character_in_text,list_constant_29,Qnil,
	    Qhangul_character_in_text,Qnil);
    com_hangul_character_in_text_1 = 
	    STATIC_FUNCTION(com_hangul_character_in_text,NIL,FALSE,2,2);
    set_ui_command_function(Qhangul_character_in_text,
	    com_hangul_character_in_text_1);
    hangul_character_in_text_command_pursuer_1 = 
	    STATIC_FUNCTION(hangul_character_in_text_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qhangul_character_in_text,
	    hangul_character_in_text_command_pursuer_1);
    hangul_character_in_text_command_translator_1 = 
	    STATIC_FUNCTION(hangul_character_in_text_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qhangul_character_in_text,
	    hangul_character_in_text_command_translator_1);
    Qunbound_in_protected_let = STATIC_SYMBOL("UNBOUND-IN-PROTECTED-LET",
	    AB_package);
    string_constant_18 = STATIC_STRING("I~c");
    list_constant_9 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)71L),
	    FIX((SI_Long)87L));
    string_constant_19 = STATIC_STRING("~c");
    array_constant_5 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)0L,(SI_Long)82L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)6L,(SI_Long)1L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)7L,(SI_Long)57344L);
    Qhangul = STATIC_SYMBOL("HANGUL",AB_package);
    if (Shift_variant_for_cursor_movement_p == UNBOUND)
	Shift_variant_for_cursor_movement_p = Nil;
    Qtyped_in_space_or_at = STATIC_SYMBOL("TYPED-IN-SPACE-OR-@",AB_package);
    Qdo_not_add_space_after = STATIC_SYMBOL("DO-NOT-ADD-SPACE-AFTER",
	    AB_package);
    Qautomatic = STATIC_SYMBOL("AUTOMATIC",AB_package);
    Qgo_up_line_extending_region = 
	    STATIC_SYMBOL("GO-UP-LINE-EXTENDING-REGION",AB_package);
    Qgo_down_line_extending_region = 
	    STATIC_SYMBOL("GO-DOWN-LINE-EXTENDING-REGION",AB_package);
    Qgo_up_page_extending_region = 
	    STATIC_SYMBOL("GO-UP-PAGE-EXTENDING-REGION",AB_package);
    Qgo_down_page_extending_region = 
	    STATIC_SYMBOL("GO-DOWN-PAGE-EXTENDING-REGION",AB_package);
    list_constant_10 = STATIC_LIST((SI_Long)8L,Qgo_up_line,
	    Qgo_up_line_extending_region,Qgo_down_line,
	    Qgo_down_line_extending_region,Qgo_up_page,
	    Qgo_up_page_extending_region,Qgo_down_page,
	    Qgo_down_page_extending_region);
    string_constant_112 = 
	    STATIC_STRING("13Ey1n3-+0Hy8k83-WEy1n3-+0Gy8k83-W9y1n3-+0Ey8k83-WQy1n3-+0Fy8k83-WBy1n3*+-2y8k83-WFy1n3*+-*y8k83-WAy1n3-+2Gy8k83-WJy1n3-+3Wy8k83");
    string_constant_113 = 
	    STATIC_STRING("-WHy1n3-+21y8k83-WCy1n3-+2=y8k83-WRy1n3T+2Gy8k83-WIy1n3T+3Wy8k83-WGy1n3T+0Gy8k83-WAy1n3T+0Hy8k83-WFy1n3S++wy8k83-WJy1n3S++uy8k83");
    string_constant_114 = 
	    STATIC_STRING("-WHy1n3*++wy8k83-WIy1n3*++uy8k83-WGy");
    make_keymap(Qcursor_movement_shift_variant_commands,Qnil,
	    regenerate_optimized_constant(LIST_3(string_constant_112,
	    string_constant_113,string_constant_114)),Qinternal,Qnil,Qnil,
	    Qnil,Qnil);
    Qgo_forward_character_extending_region = 
	    STATIC_SYMBOL("GO-FORWARD-CHARACTER-EXTENDING-REGION",AB_package);
    mutate_global_property(Qgo_forward_character_extending_region,T,
	    Qeditor_command_p);
    make_ui_command(5,Qgo_forward_character_extending_region,
	    list_constant_29,Qnil,Qgo_forward_character_extending_region,Qnil);
    com_go_forward_character_extending_region_1 = 
	    STATIC_FUNCTION(com_go_forward_character_extending_region,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qgo_forward_character_extending_region,
	    com_go_forward_character_extending_region_1);
    go_forward_character_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_forward_character_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_forward_character_extending_region,
	    go_forward_character_extending_region_command_pursuer_1);
    go_forward_character_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_forward_character_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_forward_character_extending_region,
	    go_forward_character_extending_region_command_translator_1);
    Qgo_backward_character_extending_region = 
	    STATIC_SYMBOL("GO-BACKWARD-CHARACTER-EXTENDING-REGION",AB_package);
    mutate_global_property(Qgo_backward_character_extending_region,T,
	    Qeditor_command_p);
    make_ui_command(5,Qgo_backward_character_extending_region,
	    list_constant_29,Qnil,Qgo_backward_character_extending_region,
	    Qnil);
    com_go_backward_character_extending_region_1 = 
	    STATIC_FUNCTION(com_go_backward_character_extending_region,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qgo_backward_character_extending_region,
	    com_go_backward_character_extending_region_1);
    go_backward_character_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_backward_character_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_backward_character_extending_region,
	    go_backward_character_extending_region_command_pursuer_1);
    go_backward_character_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_backward_character_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_backward_character_extending_region,
	    go_backward_character_extending_region_command_translator_1);
    mutate_global_property(Qgo_up_line_extending_region,T,Qeditor_command_p);
    make_ui_command(5,Qgo_up_line_extending_region,list_constant_29,Qnil,
	    Qgo_up_line_extending_region,Qnil);
    com_go_up_line_extending_region_1 = 
	    STATIC_FUNCTION(com_go_up_line_extending_region,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_up_line_extending_region,
	    com_go_up_line_extending_region_1);
    go_up_line_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_up_line_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_up_line_extending_region,
	    go_up_line_extending_region_command_pursuer_1);
    go_up_line_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_up_line_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_up_line_extending_region,
	    go_up_line_extending_region_command_translator_1);
    mutate_global_property(Qgo_down_line_extending_region,T,Qeditor_command_p);
    make_ui_command(5,Qgo_down_line_extending_region,list_constant_29,Qnil,
	    Qgo_down_line_extending_region,Qnil);
    com_go_down_line_extending_region_1 = 
	    STATIC_FUNCTION(com_go_down_line_extending_region,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_down_line_extending_region,
	    com_go_down_line_extending_region_1);
    go_down_line_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_down_line_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_down_line_extending_region,
	    go_down_line_extending_region_command_pursuer_1);
    go_down_line_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_down_line_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_down_line_extending_region,
	    go_down_line_extending_region_command_translator_1);
    mutate_global_property(Qgo_down_page_extending_region,T,Qeditor_command_p);
    make_ui_command(5,Qgo_down_page_extending_region,list_constant_29,Qnil,
	    Qgo_down_page_extending_region,Qnil);
    com_go_down_page_extending_region_1 = 
	    STATIC_FUNCTION(com_go_down_page_extending_region,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_down_page_extending_region,
	    com_go_down_page_extending_region_1);
    go_down_page_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_down_page_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_down_page_extending_region,
	    go_down_page_extending_region_command_pursuer_1);
    go_down_page_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_down_page_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_down_page_extending_region,
	    go_down_page_extending_region_command_translator_1);
    mutate_global_property(Qgo_up_page_extending_region,T,Qeditor_command_p);
    make_ui_command(5,Qgo_up_page_extending_region,list_constant_29,Qnil,
	    Qgo_up_page_extending_region,Qnil);
    com_go_up_page_extending_region_1 = 
	    STATIC_FUNCTION(com_go_up_page_extending_region,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_up_page_extending_region,
	    com_go_up_page_extending_region_1);
    go_up_page_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_up_page_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_up_page_extending_region,
	    go_up_page_extending_region_command_pursuer_1);
    go_up_page_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_up_page_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_up_page_extending_region,
	    go_up_page_extending_region_command_translator_1);
    Qgo_backward_word_extending_region = 
	    STATIC_SYMBOL("GO-BACKWARD-WORD-EXTENDING-REGION",AB_package);
    mutate_global_property(Qgo_backward_word_extending_region,T,
	    Qeditor_command_p);
    make_ui_command(5,Qgo_backward_word_extending_region,list_constant_29,
	    Qnil,Qgo_backward_word_extending_region,Qnil);
    com_go_backward_word_extending_region_1 = 
	    STATIC_FUNCTION(com_go_backward_word_extending_region,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qgo_backward_word_extending_region,
	    com_go_backward_word_extending_region_1);
    go_backward_word_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_backward_word_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_backward_word_extending_region,
	    go_backward_word_extending_region_command_pursuer_1);
    go_backward_word_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_backward_word_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_backward_word_extending_region,
	    go_backward_word_extending_region_command_translator_1);
    Qgo_forward_word_extending_region = 
	    STATIC_SYMBOL("GO-FORWARD-WORD-EXTENDING-REGION",AB_package);
    mutate_global_property(Qgo_forward_word_extending_region,T,
	    Qeditor_command_p);
    make_ui_command(5,Qgo_forward_word_extending_region,list_constant_29,
	    Qnil,Qgo_forward_word_extending_region,Qnil);
    com_go_forward_word_extending_region_1 = 
	    STATIC_FUNCTION(com_go_forward_word_extending_region,NIL,FALSE,
	    2,2);
    set_ui_command_function(Qgo_forward_word_extending_region,
	    com_go_forward_word_extending_region_1);
    go_forward_word_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_forward_word_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_forward_word_extending_region,
	    go_forward_word_extending_region_command_pursuer_1);
    go_forward_word_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_forward_word_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_forward_word_extending_region,
	    go_forward_word_extending_region_command_translator_1);
    Qgo_to_end_of_line_extending_region = 
	    STATIC_SYMBOL("GO-TO-END-OF-LINE-EXTENDING-REGION",AB_package);
    mutate_global_property(Qgo_to_end_of_line_extending_region,T,
	    Qeditor_command_p);
    make_ui_command(5,Qgo_to_end_of_line_extending_region,list_constant_29,
	    Qnil,Qgo_to_end_of_line_extending_region,Qnil);
    com_go_to_end_of_line_extending_region_1 = 
	    STATIC_FUNCTION(com_go_to_end_of_line_extending_region,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qgo_to_end_of_line_extending_region,
	    com_go_to_end_of_line_extending_region_1);
    go_to_end_of_line_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_to_end_of_line_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_to_end_of_line_extending_region,
	    go_to_end_of_line_extending_region_command_pursuer_1);
    go_to_end_of_line_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_to_end_of_line_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_to_end_of_line_extending_region,
	    go_to_end_of_line_extending_region_command_translator_1);
    Qgo_to_beginning_of_line_extending_region = 
	    STATIC_SYMBOL("GO-TO-BEGINNING-OF-LINE-EXTENDING-REGION",
	    AB_package);
    mutate_global_property(Qgo_to_beginning_of_line_extending_region,T,
	    Qeditor_command_p);
    make_ui_command(5,Qgo_to_beginning_of_line_extending_region,
	    list_constant_29,Qnil,
	    Qgo_to_beginning_of_line_extending_region,Qnil);
    com_go_to_beginning_of_line_extending_region_1 = 
	    STATIC_FUNCTION(com_go_to_beginning_of_line_extending_region,
	    NIL,FALSE,2,2);
    set_ui_command_function(Qgo_to_beginning_of_line_extending_region,
	    com_go_to_beginning_of_line_extending_region_1);
    go_to_beginning_of_line_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_to_beginning_of_line_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_to_beginning_of_line_extending_region,
	    go_to_beginning_of_line_extending_region_command_pursuer_1);
    go_to_beginning_of_line_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_to_beginning_of_line_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_to_beginning_of_line_extending_region,
	    go_to_beginning_of_line_extending_region_command_translator_1);
    Qgo_to_end_extending_region = 
	    STATIC_SYMBOL("GO-TO-END-EXTENDING-REGION",AB_package);
    mutate_global_property(Qgo_to_end_extending_region,T,Qeditor_command_p);
    make_ui_command(5,Qgo_to_end_extending_region,list_constant_29,Qnil,
	    Qgo_to_end_extending_region,Qnil);
    com_go_to_end_extending_region_1 = 
	    STATIC_FUNCTION(com_go_to_end_extending_region,NIL,FALSE,2,2);
    set_ui_command_function(Qgo_to_end_extending_region,
	    com_go_to_end_extending_region_1);
    go_to_end_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_to_end_extending_region_command_pursuer,NIL,
	    FALSE,1,1);
    set_ui_command_pursuer(Qgo_to_end_extending_region,
	    go_to_end_extending_region_command_pursuer_1);
    go_to_end_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_to_end_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_to_end_extending_region,
	    go_to_end_extending_region_command_translator_1);
    Qgo_to_beginning_extending_region = 
	    STATIC_SYMBOL("GO-TO-BEGINNING-EXTENDING-REGION",AB_package);
    mutate_global_property(Qgo_to_beginning_extending_region,T,
	    Qeditor_command_p);
    make_ui_command(5,Qgo_to_beginning_extending_region,list_constant_29,
	    Qnil,Qgo_to_beginning_extending_region,Qnil);
    com_go_to_beginning_extending_region_1 = 
	    STATIC_FUNCTION(com_go_to_beginning_extending_region,NIL,FALSE,
	    2,2);
    set_ui_command_function(Qgo_to_beginning_extending_region,
	    com_go_to_beginning_extending_region_1);
    go_to_beginning_extending_region_command_pursuer_1 = 
	    STATIC_FUNCTION(go_to_beginning_extending_region_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qgo_to_beginning_extending_region,
	    go_to_beginning_extending_region_command_pursuer_1);
    go_to_beginning_extending_region_command_translator_1 = 
	    STATIC_FUNCTION(go_to_beginning_extending_region_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qgo_to_beginning_extending_region,
	    go_to_beginning_extending_region_command_translator_1);
    Qsource_position = STATIC_SYMBOL("SOURCE-POSITION",AB_package);
    string_constant_20 = 
	    string_append2(STATIC_STRING("Edit this item\?  (It is in ~\n             a part of the KB ~\n             declared as stable. This edit could cause dependent ~\n             parts of the KB to become incomple"),
	    STATIC_STRING("te, and to ~\n             require recompilation.)"));
    Qallow_continuation_of_editing_context_upon_confirmation = 
	    STATIC_SYMBOL("ALLOW-CONTINUATION-OF-EDITING-CONTEXT-UPON-CONFIRMATION",
	    AB_package);
    Qexit_editing_context_upon_denial_of_confirmation = 
	    STATIC_SYMBOL("EXIT-EDITING-CONTEXT-UPON-DENIAL-OF-CONFIRMATION",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qexit_editing_context_upon_denial_of_confirmation,
	    STATIC_FUNCTION(exit_editing_context_upon_denial_of_confirmation,
	    NIL,FALSE,0,0));
    SET_SYMBOL_FUNCTION(Qallow_continuation_of_editing_context_upon_confirmation,
	    STATIC_FUNCTION(allow_continuation_of_editing_context_upon_confirmation,
	    NIL,FALSE,0,0));
    if (Recording_items_made_incomplete_qm == UNBOUND)
	Recording_items_made_incomplete_qm = Nil;
    if (Items_made_incomplete == UNBOUND)
	Items_made_incomplete = Nil;
    Qtransfer = STATIC_SYMBOL("TRANSFER",AB_package);
    string_constant_21 = STATIC_STRING("A transfer was made in");
    string_constant_22 = STATIC_STRING("An edit was made to");
    Qchoose_existing_class = STATIC_SYMBOL("CHOOSE-EXISTING-CLASS",AB_package);
    string_constant_23 = STATIC_STRING("A new superior class was chosen for");
    string_constant_24 = STATIC_STRING("Deleting");
    string_constant_25 = 
	    STATIC_STRING("~A a part of the KB declared as stable or dependent, which has caused ~\n      dependent parts of the KB to become incomplete, and to require ~\n      recompilation.");
    string_constant_26 = STATIC_STRING("Recompile the KB\?  (~A)");
    Qlaunch_compile_to_bring_kb_up_to_date = 
	    STATIC_SYMBOL("LAUNCH-COMPILE-TO-BRING-KB-UP-TO-DATE",AB_package);
    Qdelete_frame_after_checking_serial_number = 
	    STATIC_SYMBOL("DELETE-FRAME-AFTER-CHECKING-SERIAL-NUMBER",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qdelete_frame_after_checking_serial_number,
	    STATIC_FUNCTION(delete_frame_after_checking_serial_number,NIL,
	    FALSE,2,2));
    Qdelete_frame_after_checking_serial_number_with_list = 
	    STATIC_SYMBOL("DELETE-FRAME-AFTER-CHECKING-SERIAL-NUMBER-WITH-LIST",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qdelete_frame_after_checking_serial_number_with_list,
	    STATIC_FUNCTION(delete_frame_after_checking_serial_number_with_list,
	    NIL,FALSE,1,1));
    Qsingle_line_comment = STATIC_SYMBOL("SINGLE-LINE-COMMENT",AB_package);
    Kdisplay_notification = STATIC_SYMBOL("DISPLAY-NOTIFICATION",Pkeyword);
    Qquoted_character = STATIC_SYMBOL("QUOTED-CHARACTER",AB_package);
    Qcomment = STATIC_SYMBOL("COMMENT",AB_package);
    list_constant_13 = STATIC_LIST((SI_Long)2L,Qcomment,Qsingle_line_comment);
    list_constant_11 = STATIC_CONS(Qquoted_character,list_constant_13);
    Qillegal_character = STATIC_SYMBOL("ILLEGAL-CHARACTER",AB_package);
    string_constant_27 = STATIC_STRING("This cannot be parsed");
    Qbad_java_character_literal = 
	    STATIC_SYMBOL("BAD-JAVA-CHARACTER-LITERAL",AB_package);
    list_constant_12 = STATIC_CONS(Qbad_java_character_literal,Qnil);
    string_constant_28 = 
	    STATIC_STRING("This does not form a valid character literal in Java");
    string_constant_29 = STATIC_STRING("This is incomplete");
    string_constant_30 = STATIC_STRING("within a Java comment");
    string_constant_31 = STATIC_STRING("Hit enter to terminate comment.");
    string_constant_32 = STATIC_STRING("Hit Control+J to terminate comment.");
    string_constant_33 = STATIC_STRING("Use } to terminate comment.");
    string_constant_34 = 
	    STATIC_STRING("Use } to terminate comment.  NOTE: This comment will not be preserved!");
    string_constant_35 = STATIC_STRING("This is missing a character after @");
    Qellipsis = STATIC_SYMBOL("ELLIPSIS",AB_package);
    string_constant_36 = STATIC_STRING("This contains an ellipsis");
    Qreserved_word_p = STATIC_SYMBOL("RESERVED-WORD-P",AB_package);
    Qunreserved_symbol = STATIC_SYMBOL("UNRESERVED-SYMBOL",AB_package);
    array_constant_6 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)24L));
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)0L,(SI_Long)84L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)1L,(SI_Long)104L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)2L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)3L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)4L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)5L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)6L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)7L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)8L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)9L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)10L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)11L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)12L,(SI_Long)98L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)13L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)14L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)15L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)16L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)17L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)18L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)19L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)20L,(SI_Long)100L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)22L,(SI_Long)21L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)23L,(SI_Long)57344L);
    Qhandle_end_operation = STATIC_SYMBOL("HANDLE-END-OPERATION",AB_package);
    Qworkstation_context = STATIC_SYMBOL("WORKSTATION-CONTEXT",AB_package);
    list_constant_32 = STATIC_LIST((SI_Long)2L,Qblock,Qworkstation_context);
    Qgeneric_method_lambda_list = 
	    STATIC_SYMBOL("GENERIC-METHOD-LAMBDA-LIST",AB_package);
    mutate_global_property(Qhandle_end_operation,list_constant_32,
	    Qgeneric_method_lambda_list);
    Qadd_items_to_edit_workspace = 
	    STATIC_SYMBOL("ADD-ITEMS-TO-EDIT-WORKSPACE",AB_package);
    Qkb_load_file_command = STATIC_SYMBOL("KB-LOAD-FILE-COMMAND",AB_package);
    Qrefresh_case_qm = STATIC_SYMBOL("REFRESH-CASE\?",AB_package);
    list_constant_33 = STATIC_LIST((SI_Long)4L,Qkb_load_file_command,
	    Qedit_workspace,Qedit_box,Qrefresh_case_qm);
    mutate_global_property(Qadd_items_to_edit_workspace,list_constant_33,
	    Qgeneric_method_lambda_list);
    if (Text_of_definition_being_compiled == UNBOUND)
	Text_of_definition_being_compiled = Nil;
    Kpaint_infered_from_xor = STATIC_SYMBOL("PAINT-INFERED-FROM-XOR",Pkeyword);
    Kdraw_as_late_as_possible = STATIC_SYMBOL("DRAW-AS-LATE-AS-POSSIBLE",
	    Pkeyword);
    Qforce = STATIC_SYMBOL("FORCE",AB_package);
    Qcategory_evaluator_interface = 
	    STATIC_SYMBOL("CATEGORY-EVALUATOR-INTERFACE",AB_package);
    string_constant_37 = STATIC_STRING("Unable to conclude the ~A because ");
    string_constant_38 = STATIC_STRING(" was not found.");
    Maximum_proglem_length_to_show_in_the_editor = FIX((SI_Long)300L);
    array_constant_7 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)32L));
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)0L,(SI_Long)84L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)1L,(SI_Long)104L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)2L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)3L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)4L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)5L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)6L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)7L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)8L,(SI_Long)117L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)9L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)10L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)11L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)12L,(SI_Long)109L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)13L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)14L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)15L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)16L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)17L,(SI_Long)98L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)18L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)19L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)20L,(SI_Long)46L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)21L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)22L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)24L,(SI_Long)78L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)25L,(SI_Long)65L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)26L,(SI_Long)77L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)27L,(SI_Long)69L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)28L,(SI_Long)63L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)30L,(SI_Long)23L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)31L,(SI_Long)57344L);
    string_constant_39 = STATIC_STRING("~A");
    string_constant_40 = 
	    STATIC_STRING("There was a problem.  See the logbook for the message.");
    string_constant_41 = 
	    STATIC_STRING("Error: could not accept edit.  The attribute ~NQ of ~NF is no longer defined.");
    string_constant_42 = 
	    STATIC_STRING("Error:  Could not accept the edit for ~NF.  The new value for the attribute ~NQ ~\n          does not conform to its changed attribute type specification.");
    string_constant_43 = 
	    STATIC_STRING("Cannot edit ~NF, because ~A.  See the saving-parameters.");
    Qallow_text_slot_to_have_no_value = 
	    STATIC_SYMBOL("ALLOW-TEXT-SLOT-TO-HAVE-NO-VALUE",AB_package);
    Qtype_in_box_input_value = STATIC_SYMBOL("TYPE-IN-BOX-INPUT-VALUE",
	    AB_package);
    string_constant_44 = STATIC_STRING("This is ambiguous in G2");
    string_constant_45 = STATIC_STRING("~A~A");
    string_constant_46 = STATIC_STRING("~A~A~A");
    Qcol_col = STATIC_SYMBOL("::",AB_package);
    list_constant_14 = STATIC_CONS(Qcol_col,Qnil);
    Qneeds_refreshing = STATIC_SYMBOL("NEEDS-REFRESHING",AB_package);
    Qnon_kb_workspace = STATIC_SYMBOL("NON-KB-WORKSPACE",AB_package);
    list_constant_34 = STATIC_CONS(Qnon_kb_workspace,Qnil);
    check_if_superior_classes_are_defined(Qcategory_instance_menu_workspace,
	    list_constant_34);
    string_constant_115 = 
	    STATIC_STRING("1l4z8r83*Ly83*Ly83Hfy83Hfy03Gy001n1l8l1l8o1m8p83*7y00000");
    string_constant_116 = STATIC_STRING("1n8q1m83Hfy1l832Ay1m83*Ly3Gy");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(string_constant_115);
    add_class_to_environment(9,Qcategory_instance_menu_workspace,
	    list_constant_34,Nil,temp,Nil,temp_2,list_constant_34,
	    regenerate_optimized_constant(string_constant_116),Nil);
    Category_instance_menu_workspace_class_description = 
	    lookup_global_or_kb_specific_property_value(Qcategory_instance_menu_workspace,
	    Class_description_gkbprop);
    list_constant_35 = STATIC_CONS(Qmenu,Qnil);
    check_if_superior_classes_are_defined(Qcategory_menu,list_constant_35);
    string_constant_117 = STATIC_STRING("1m8q1m83rky1l9k");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(string_constant_83);
    clear_optimized_constants();
    push_optimized_constant(Qmenu);
    add_class_to_environment(9,Qcategory_menu,list_constant_35,Nil,temp,
	    Nil,temp_2,list_constant_35,
	    regenerate_optimized_constant(string_constant_117),Nil);
    Category_menu_class_description = 
	    lookup_global_or_kb_specific_property_value(Qcategory_menu,
	    Class_description_gkbprop);
    Qgenerate_spot_for_category_menu = 
	    STATIC_SYMBOL("GENERATE-SPOT-FOR-CATEGORY-MENU",AB_package);
    SET_SYMBOL_FUNCTION(Qgenerate_spot_for_category_menu,
	    STATIC_FUNCTION(generate_spot_for_category_menu,NIL,FALSE,2,2));
    temp_1 = SYMBOL_FUNCTION(Qgenerate_spot_for_category_menu);
    set_get(Qcategory_menu,Qgenerate_spot,temp_1);
    temp = getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgenerate_spot),
	    Qclasses_which_define);
    temp_1 = CONS(Qcategory_menu,temp);
    mutate_global_property(Qgenerate_spot,temp_1,Qclasses_which_define);
    check_if_superior_classes_are_defined(Qtoken_menu,list_constant_35);
    string_constant_118 = 
	    STATIC_STRING("1n4z8r83=2y83=2y836Ly836Ly08k001n1l8l1l83-4y1l83Ey000004z8r83==y83==y836Ly836Ly08k001n1l8l1l83-4y1l83Ey000004z8r83=iy83=iy836Ly8");
    string_constant_119 = STATIC_STRING("36Ly00001n1l8l1l83-4y1l83Ey00000");
    string_constant_120 = 
	    STATIC_STRING("1p8q1m836Ly1l9k1o83=2y8k83-4y83Ey1o83==y8k83-4y83Ey1o83=iy083-4y83Ey");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(LIST_2(string_constant_118,
	    string_constant_119));
    clear_optimized_constants();
    push_optimized_constant(Qmenu);
    add_class_to_environment(9,Qtoken_menu,list_constant_35,Nil,temp,Nil,
	    temp_2,list_constant_35,
	    regenerate_optimized_constant(string_constant_120),Nil);
    Qgenerate_spot_for_token_menu = 
	    STATIC_SYMBOL("GENERATE-SPOT-FOR-TOKEN-MENU",AB_package);
    SET_SYMBOL_FUNCTION(Qgenerate_spot_for_token_menu,
	    STATIC_FUNCTION(generate_spot_for_token_menu,NIL,FALSE,2,2));
    temp_1 = SYMBOL_FUNCTION(Qgenerate_spot_for_token_menu);
    set_get(Qtoken_menu,Qgenerate_spot,temp_1);
    temp = getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgenerate_spot),
	    Qclasses_which_define);
    temp_1 = CONS(Qtoken_menu,temp);
    mutate_global_property(Qgenerate_spot,temp_1,Qclasses_which_define);
    list_constant_36 = STATIC_CONS(Qtoken_menu,Qnil);
    check_if_superior_classes_are_defined(Qreplacement_token_menu,
	    list_constant_36);
    string_constant_121 = 
	    STATIC_STRING("1l4z8r83=iy83=iy83Z*y83Z*y08k001n1l8l1l83-4y1l83Ey00000");
    string_constant_122 = STATIC_STRING("1n8q1m83Z*y1l836Ly1m83=iy8k");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(string_constant_121);
    add_class_to_environment(9,Qreplacement_token_menu,list_constant_36,
	    Nil,temp,Nil,temp_2,list_constant_36,
	    regenerate_optimized_constant(string_constant_122),Nil);
    Qgenerate_spot_for_replacement_token_menu = 
	    STATIC_SYMBOL("GENERATE-SPOT-FOR-REPLACEMENT-TOKEN-MENU",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qgenerate_spot_for_replacement_token_menu,
	    STATIC_FUNCTION(generate_spot_for_replacement_token_menu,NIL,
	    FALSE,2,2));
    temp_1 = SYMBOL_FUNCTION(Qgenerate_spot_for_replacement_token_menu);
    set_get(Qreplacement_token_menu,Qgenerate_spot,temp_1);
    temp = getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgenerate_spot),
	    Qclasses_which_define);
    temp_1 = CONS(Qreplacement_token_menu,temp);
    mutate_global_property(Qgenerate_spot,temp_1,Qclasses_which_define);
    Qcharacter_sequence_token_menu = 
	    STATIC_SYMBOL("CHARACTER-SEQUENCE-TOKEN-MENU",AB_package);
    check_if_superior_classes_are_defined(Qcharacter_sequence_token_menu,
	    list_constant_36);
    string_constant_123 = 
	    STATIC_STRING("1n4z8r83=2y83=2y837vy837vy00001n1l8l1l83-4y1l83Ey000004z8r83==y83==y837vy837vy00001n1l8l1l83-4y1l83Ey000004z8r83=iy83=iy837vy837");
    string_constant_124 = STATIC_STRING("vy00001n1l8l1l83-4y1l83Ey00000");
    string_constant_125 = 
	    STATIC_STRING("1p8q1m837vy1l836Ly1m83=2y01m83==y01m83=iy0");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(LIST_2(string_constant_123,
	    string_constant_124));
    add_class_to_environment(9,Qcharacter_sequence_token_menu,
	    list_constant_36,Nil,temp,Nil,temp_2,list_constant_36,
	    regenerate_optimized_constant(string_constant_125),Nil);
    Qgenerate_spot_for_character_sequence_token_menu = 
	    STATIC_SYMBOL("GENERATE-SPOT-FOR-CHARACTER-SEQUENCE-TOKEN-MENU",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qgenerate_spot_for_character_sequence_token_menu,
	    STATIC_FUNCTION(generate_spot_for_character_sequence_token_menu,
	    NIL,FALSE,2,2));
    temp_1 = SYMBOL_FUNCTION(Qgenerate_spot_for_character_sequence_token_menu);
    set_get(Qcharacter_sequence_token_menu,Qgenerate_spot,temp_1);
    temp = getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgenerate_spot),
	    Qclasses_which_define);
    temp_1 = CONS(Qcharacter_sequence_token_menu,temp);
    mutate_global_property(Qgenerate_spot,temp_1,Qclasses_which_define);
    Qpathname_component_token_menu = 
	    STATIC_SYMBOL("PATHNAME-COMPONENT-TOKEN-MENU",AB_package);
    list_constant_37 = STATIC_CONS(Qcharacter_sequence_token_menu,Qnil);
    check_if_superior_classes_are_defined(Qpathname_component_token_menu,
	    list_constant_37);
    string_constant_126 = 
	    STATIC_STRING("1n4z8r83=2y83=2y83Xjy83Xjy08k001n1l8l1l83-4y1l83Ey000004z8r83==y83==y83Xjy83Xjy00001n1l8l1l83-4y1l83Ey000004z8r83=iy83=iy83Xjy83");
    string_constant_127 = STATIC_STRING("Xjy00001n1l8l1l83-4y1l83Ey00000");
    string_constant_128 = 
	    STATIC_STRING("1p8q1m83Xjy1l837vy1m83=2y8k1m83==y01m83=iy0");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(LIST_2(string_constant_126,
	    string_constant_127));
    add_class_to_environment(9,Qpathname_component_token_menu,
	    list_constant_37,Nil,temp,Nil,temp_2,list_constant_37,
	    regenerate_optimized_constant(string_constant_128),Nil);
    Qgenerate_spot_for_pathname_component_token_menu = 
	    STATIC_SYMBOL("GENERATE-SPOT-FOR-PATHNAME-COMPONENT-TOKEN-MENU",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qgenerate_spot_for_pathname_component_token_menu,
	    STATIC_FUNCTION(generate_spot_for_pathname_component_token_menu,
	    NIL,FALSE,2,2));
    temp_1 = SYMBOL_FUNCTION(Qgenerate_spot_for_pathname_component_token_menu);
    set_get(Qpathname_component_token_menu,Qgenerate_spot,temp_1);
    temp = getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgenerate_spot),
	    Qclasses_which_define);
    temp_1 = CONS(Qpathname_component_token_menu,temp);
    mutate_global_property(Qgenerate_spot,temp_1,Qclasses_which_define);
    check_if_superior_classes_are_defined(Qkfep_conversion_choice_menu,
	    list_constant_35);
    string_constant_129 = STATIC_STRING("1m8q1m83-1fy1l9k");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(string_constant_83);
    clear_optimized_constants();
    push_optimized_constant(Qmenu);
    add_class_to_environment(9,Qkfep_conversion_choice_menu,
	    list_constant_35,Nil,temp,Nil,temp_2,list_constant_35,
	    regenerate_optimized_constant(string_constant_129),Nil);
    Kfep_conversion_choice_menu_class_description = 
	    lookup_global_or_kb_specific_property_value(Qkfep_conversion_choice_menu,
	    Class_description_gkbprop);
    Qgenerate_spot_for_kfep_conversion_choice_menu = 
	    STATIC_SYMBOL("GENERATE-SPOT-FOR-KFEP-CONVERSION-CHOICE-MENU",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qgenerate_spot_for_kfep_conversion_choice_menu,
	    STATIC_FUNCTION(generate_spot_for_kfep_conversion_choice_menu,
	    NIL,FALSE,2,2));
    temp_1 = SYMBOL_FUNCTION(Qgenerate_spot_for_kfep_conversion_choice_menu);
    set_get(Qkfep_conversion_choice_menu,Qgenerate_spot,temp_1);
    temp = getfq_function_no_default(INLINE_SYMBOL_PLIST(Qgenerate_spot),
	    Qclasses_which_define);
    temp_1 = CONS(Qkfep_conversion_choice_menu,temp);
    mutate_global_property(Qgenerate_spot,temp_1,Qclasses_which_define);
    Qtoken_menu_format = STATIC_SYMBOL("TOKEN-MENU-FORMAT",AB_package);
    string_constant_130 = 
	    STATIC_STRING("1z83*oy83=wy832py83=Dyk83=Nyk8308yk830Ayk8309yk8307yk");
    mutate_global_property(Qtoken_menu_format,
	    regenerate_optimized_constant(string_constant_130),
	    Qformat_description);
    Qtoken_menu_item_format = STATIC_SYMBOL("TOKEN-MENU-ITEM-FORMAT",
	    AB_package);
    list_constant_38 = STATIC_CONS(Qtext_box_format,Qnil);
    check_if_superior_classes_are_defined(Qtoken_menu_item_format,
	    list_constant_38);
    string_constant_131 = 
	    STATIC_STRING("1v4z8r83by83by831ly831ly0r001n1l8l1m8p83*4y1l8o000004z8r83ay83ay831ly831ly0n001n1l8l1m8p83*4y1l8o000004z8r83Wy83Wy831ly831ly0r00");
    string_constant_132 = 
	    STATIC_STRING("1n1l8l1m8p83*4y1l8o000004z8r83cy83cy831ly831ly0n001n1l8l1m8p83*4y1l8o000004z8r83ny83ny831ly831ly01l83-uy001n1l8l1m8p831wy1l8o000");
    string_constant_133 = 
	    STATIC_STRING("004z8r83ty83ty831ly831ly03Gy001n1l8l1m8p83*4y1l8o000004z8r83sy83sy831ly831ly0z001n1l8l1m8p83*4y1l8o000004z8r83uy83uy831ly831ly0k");
    string_constant_134 = 
	    STATIC_STRING("001n1l8l1m8p83*4y1l8o000004z8r83wy83wy831ly831ly083-dy001n1l8l1m8p833Xy1l8o000004z8r83iy83iy831ly831ly032Cy001n1l8l1m8p83*4y1l8o");
    string_constant_135 = 
	    STATIC_STRING("000004z8r832cy832cy831ly831ly03uy001n1l8l1m8p83*4y1l8o00000");
    string_constant_136 = 
	    STATIC_STRING("1x8q1m831ly1l83-My1m83byr1m83ayn1m83Wyr1m83cyn1m83ny1l83-uy1m83ty3Gy1m83syz1m83uyk1m83wy83-dy1m83iy32Cy1m832cy3uy");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(LIST_5(string_constant_131,
	    string_constant_132,string_constant_133,string_constant_134,
	    string_constant_135));
    add_class_to_environment(9,Qtoken_menu_item_format,list_constant_38,
	    Nil,temp,Nil,temp_2,list_constant_38,
	    regenerate_optimized_constant(string_constant_136),Nil);
    Qdefault_token_menu_item_format = 
	    STATIC_SYMBOL("DEFAULT-TOKEN-MENU-ITEM-FORMAT",AB_package);
    string_constant_137 = STATIC_STRING("1l831ly");
    mutate_global_property(Qdefault_token_menu_item_format,
	    regenerate_optimized_constant(string_constant_137),
	    Qformat_description);
    Qsmall_token_menu_item_format = 
	    STATIC_SYMBOL("SMALL-TOKEN-MENU-ITEM-FORMAT",AB_package);
    list_constant_39 = STATIC_CONS(Qtoken_menu_item_format,Qnil);
    check_if_superior_classes_are_defined(Qsmall_token_menu_item_format,
	    list_constant_39);
    string_constant_138 = 
	    STATIC_STRING("1t4z8r83by83by832jy832jy0q001n1l8l1m8p83*4y1l8o000004z8r83ay83ay832jy832jy0m001n1l8l1m8p83*4y1l8o000004z8r83Wy83Wy832jy832jy0q00");
    string_constant_139 = 
	    STATIC_STRING("1n1l8l1m8p83*4y1l8o000004z8r83cy83cy832jy832jy0m001n1l8l1m8p83*4y1l8o000004z8r83ny83ny832jy832jy01l83-ry001n1l8l1m8p831wy1l8o000");
    string_constant_140 = 
	    STATIC_STRING("004z8r83ty83ty832jy832jy0z001n1l8l1m8p83*4y1l8o000004z8r83sy83sy832jy832jy0x001n1l8l1m8p83*4y1l8o000004z8r83uy83uy832jy832jy0m00");
    string_constant_141 = 
	    STATIC_STRING("1n1l8l1m8p83*4y1l8o000004z8r83iy83iy832jy832jy031Qy001n1l8l1m8p83*4y1l8o00000");
    string_constant_142 = 
	    STATIC_STRING("1v8q1m832jy1l831ly1m83byq1m83aym1m83Wyq1m83cym1m83ny1l83-ry1m83tyz1m83syx1m83uym1m83iy31Qy");
    temp = regenerate_optimized_constant(string_constant_83);
    temp_2 = regenerate_optimized_constant(LIST_4(string_constant_138,
	    string_constant_139,string_constant_140,string_constant_141));
    add_class_to_environment(9,Qsmall_token_menu_item_format,
	    list_constant_39,Nil,temp,Nil,temp_2,list_constant_39,
	    regenerate_optimized_constant(string_constant_142),Nil);
    Qdefault_small_token_menu_item_format = 
	    STATIC_SYMBOL("DEFAULT-SMALL-TOKEN-MENU-ITEM-FORMAT",AB_package);
    string_constant_143 = STATIC_STRING("1l832jy");
    mutate_global_property(Qdefault_small_token_menu_item_format,
	    regenerate_optimized_constant(string_constant_143),
	    Qformat_description);
    Qleft_aligned_token_menu_item_format = 
	    STATIC_SYMBOL("LEFT-ALIGNED-TOKEN-MENU-ITEM-FORMAT",AB_package);
    string_constant_144 = STATIC_STRING("1n831ly83wy83*hy");
    mutate_global_property(Qleft_aligned_token_menu_item_format,
	    regenerate_optimized_constant(string_constant_144),
	    Qformat_description);
    Qcenter_aligned_token_menu_item_format = 
	    STATIC_SYMBOL("CENTER-ALIGNED-TOKEN-MENU-ITEM-FORMAT",AB_package);
    string_constant_145 = STATIC_STRING("1n831ly83wy83-dy");
    mutate_global_property(Qcenter_aligned_token_menu_item_format,
	    regenerate_optimized_constant(string_constant_145),
	    Qformat_description);
    Qright_aligned_token_menu_item_format = 
	    STATIC_SYMBOL("RIGHT-ALIGNED-TOKEN-MENU-ITEM-FORMAT",AB_package);
    string_constant_146 = STATIC_STRING("1n831ly83wy83-cy");
    mutate_global_property(Qright_aligned_token_menu_item_format,
	    regenerate_optimized_constant(string_constant_146),
	    Qformat_description);
    Qleft_aligned_small_token_menu_item_format = 
	    STATIC_SYMBOL("LEFT-ALIGNED-SMALL-TOKEN-MENU-ITEM-FORMAT",
	    AB_package);
    string_constant_147 = STATIC_STRING("1n832jy83wy83*hy");
    mutate_global_property(Qleft_aligned_small_token_menu_item_format,
	    regenerate_optimized_constant(string_constant_147),
	    Qformat_description);
    Qcenter_aligned_small_token_menu_item_format = 
	    STATIC_SYMBOL("CENTER-ALIGNED-SMALL-TOKEN-MENU-ITEM-FORMAT",
	    AB_package);
    string_constant_148 = STATIC_STRING("1n832jy83wy83-dy");
    mutate_global_property(Qcenter_aligned_small_token_menu_item_format,
	    regenerate_optimized_constant(string_constant_148),
	    Qformat_description);
    Qright_aligned_small_token_menu_item_format = 
	    STATIC_SYMBOL("RIGHT-ALIGNED-SMALL-TOKEN-MENU-ITEM-FORMAT",
	    AB_package);
    string_constant_149 = STATIC_STRING("1n832jy83wy83-cy");
    mutate_global_property(Qright_aligned_small_token_menu_item_format,
	    regenerate_optimized_constant(string_constant_149),
	    Qformat_description);
    Qleft_aligned_category_menu_item_format = 
	    STATIC_SYMBOL("LEFT-ALIGNED-CATEGORY-MENU-ITEM-FORMAT",AB_package);
    mutate_global_property(Qleft_aligned_category_menu_item_format,
	    regenerate_optimized_constant(string_constant_144),
	    Qformat_description);
    Qcenter_aligned_category_menu_item_format = 
	    STATIC_SYMBOL("CENTER-ALIGNED-CATEGORY-MENU-ITEM-FORMAT",
	    AB_package);
    mutate_global_property(Qcenter_aligned_category_menu_item_format,
	    regenerate_optimized_constant(string_constant_145),
	    Qformat_description);
    Qright_aligned_category_menu_item_format = 
	    STATIC_SYMBOL("RIGHT-ALIGNED-CATEGORY-MENU-ITEM-FORMAT",
	    AB_package);
    mutate_global_property(Qright_aligned_category_menu_item_format,
	    regenerate_optimized_constant(string_constant_146),
	    Qformat_description);
    Qleft_aligned_small_category_menu_item_format = 
	    STATIC_SYMBOL("LEFT-ALIGNED-SMALL-CATEGORY-MENU-ITEM-FORMAT",
	    AB_package);
    mutate_global_property(Qleft_aligned_small_category_menu_item_format,
	    regenerate_optimized_constant(string_constant_147),
	    Qformat_description);
    Qcenter_aligned_small_category_menu_item_format = 
	    STATIC_SYMBOL("CENTER-ALIGNED-SMALL-CATEGORY-MENU-ITEM-FORMAT",
	    AB_package);
    mutate_global_property(Qcenter_aligned_small_category_menu_item_format,
	    regenerate_optimized_constant(string_constant_148),
	    Qformat_description);
    Qright_aligned_small_category_menu_item_format = 
	    STATIC_SYMBOL("RIGHT-ALIGNED-SMALL-CATEGORY-MENU-ITEM-FORMAT",
	    AB_package);
    mutate_global_property(Qright_aligned_small_category_menu_item_format,
	    regenerate_optimized_constant(string_constant_149),
	    Qformat_description);
    Qcorresponding_small_font_format_name = 
	    STATIC_SYMBOL("CORRESPONDING-SMALL-FONT-FORMAT-NAME",AB_package);
    mutate_global_property(Qleft_aligned_category_menu_item_format,
	    Qleft_aligned_small_category_menu_item_format,
	    Qcorresponding_small_font_format_name);
    mutate_global_property(Qcenter_aligned_category_menu_item_format,
	    Qcenter_aligned_small_category_menu_item_format,
	    Qcorresponding_small_font_format_name);
    mutate_global_property(Qright_aligned_category_menu_item_format,
	    Qright_aligned_small_category_menu_item_format,
	    Qcorresponding_small_font_format_name);
    mutate_global_property(Qleft_aligned_token_menu_item_format,
	    Qleft_aligned_small_token_menu_item_format,
	    Qcorresponding_small_font_format_name);
    mutate_global_property(Qcenter_aligned_token_menu_item_format,
	    Qcenter_aligned_small_token_menu_item_format,
	    Qcorresponding_small_font_format_name);
    mutate_global_property(Qright_aligned_token_menu_item_format,
	    Qright_aligned_small_token_menu_item_format,
	    Qcorresponding_small_font_format_name);
    Qcenter = STATIC_SYMBOL("CENTER",AB_package);
    Qnon_negative_integer = STATIC_SYMBOL("NON-NEGATIVE-INTEGER",AB_package);
    Qleft_string = STATIC_SYMBOL("LEFT-STRING",AB_package);
    Qquoted_message = STATIC_SYMBOL("QUOTED-MESSAGE",AB_package);
    Qmiddle_string = STATIC_SYMBOL("MIDDLE-STRING",AB_package);
    Qright_string = STATIC_SYMBOL("RIGHT-STRING",AB_package);
    Qend_of_message = STATIC_SYMBOL("END-OF-MESSAGE",AB_package);
    Qneutral_unit_of_measure = STATIC_SYMBOL("NEUTRAL-UNIT-OF-MEASURE",
	    AB_package);
    Qsingular_unit_of_measure = STATIC_SYMBOL("SINGULAR-UNIT-OF-MEASURE",
	    AB_package);
    Qplural_unit_of_measure = STATIC_SYMBOL("PLURAL-UNIT-OF-MEASURE",
	    AB_package);
    Qunit_of_measure = STATIC_SYMBOL("UNIT-OF-MEASURE",AB_package);
    Kall_category = STATIC_SYMBOL("ALL-CATEGORY",Pkeyword);
    array_constant_8 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)0L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)1L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)2L,(SI_Long)121L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)3L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)6L,(SI_Long)4L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)7L,(SI_Long)57344L);
    Qspecial_case_qm = STATIC_SYMBOL("SPECIAL-CASE\?",AB_package);
    Qany_instance = STATIC_SYMBOL("ANY-INSTANCE",AB_package);
    Qtoken_menu_string_to_display_function = 
	    STATIC_SYMBOL("TOKEN-MENU-STRING-TO-DISPLAY-FUNCTION",AB_package);
    Token_menu_string_to_display_function_prop = 
	    Qtoken_menu_string_to_display_function;
    Qtoken_menu_string_to_insert_function = 
	    STATIC_SYMBOL("TOKEN-MENU-STRING-TO-INSERT-FUNCTION",AB_package);
    Token_menu_string_to_insert_function_prop = 
	    Qtoken_menu_string_to_insert_function;
    Qcolor = STATIC_SYMBOL("COLOR",AB_package);
    Kall_token = STATIC_SYMBOL("ALL-TOKEN",Pkeyword);
    Qinsert_first_token_menu_choice = 
	    STATIC_SYMBOL("INSERT-FIRST-TOKEN-MENU-CHOICE",AB_package);
    mutate_global_property(Qinsert_first_token_menu_choice,T,
	    Qeditor_command_p);
    make_ui_command(5,Qinsert_first_token_menu_choice,list_constant_29,
	    Qnil,Qinsert_first_token_menu_choice,Qnil);
    com_insert_first_token_menu_choice_1 = 
	    STATIC_FUNCTION(com_insert_first_token_menu_choice,NIL,FALSE,2,2);
    set_ui_command_function(Qinsert_first_token_menu_choice,
	    com_insert_first_token_menu_choice_1);
    insert_first_token_menu_choice_command_pursuer_1 = 
	    STATIC_FUNCTION(insert_first_token_menu_choice_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qinsert_first_token_menu_choice,
	    insert_first_token_menu_choice_command_pursuer_1);
    insert_first_token_menu_choice_command_translator_1 = 
	    STATIC_FUNCTION(insert_first_token_menu_choice_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qinsert_first_token_menu_choice,
	    insert_first_token_menu_choice_command_translator_1);
    Qinsert_last_token_menu_choice = 
	    STATIC_SYMBOL("INSERT-LAST-TOKEN-MENU-CHOICE",AB_package);
    mutate_global_property(Qinsert_last_token_menu_choice,T,Qeditor_command_p);
    make_ui_command(5,Qinsert_last_token_menu_choice,list_constant_29,Qnil,
	    Qinsert_last_token_menu_choice,Qnil);
    com_insert_last_token_menu_choice_1 = 
	    STATIC_FUNCTION(com_insert_last_token_menu_choice,NIL,FALSE,2,2);
    set_ui_command_function(Qinsert_last_token_menu_choice,
	    com_insert_last_token_menu_choice_1);
    insert_last_token_menu_choice_command_pursuer_1 = 
	    STATIC_FUNCTION(insert_last_token_menu_choice_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qinsert_last_token_menu_choice,
	    insert_last_token_menu_choice_command_pursuer_1);
    insert_last_token_menu_choice_command_translator_1 = 
	    STATIC_FUNCTION(insert_last_token_menu_choice_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qinsert_last_token_menu_choice,
	    insert_last_token_menu_choice_command_translator_1);
    Qselect_next_editor_component_group = 
	    STATIC_SYMBOL("SELECT-NEXT-EDITOR-COMPONENT-GROUP",AB_package);
    mutate_global_property(Qselect_next_editor_component_group,T,
	    Qeditor_command_p);
    make_ui_command(5,Qselect_next_editor_component_group,list_constant_29,
	    Qnil,Qselect_next_editor_component_group,Qnil);
    Qnext = STATIC_SYMBOL("NEXT",AB_package);
    com_select_next_editor_component_group_1 = 
	    STATIC_FUNCTION(com_select_next_editor_component_group,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qselect_next_editor_component_group,
	    com_select_next_editor_component_group_1);
    select_next_editor_component_group_command_pursuer_1 = 
	    STATIC_FUNCTION(select_next_editor_component_group_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qselect_next_editor_component_group,
	    select_next_editor_component_group_command_pursuer_1);
    select_next_editor_component_group_command_translator_1 = 
	    STATIC_FUNCTION(select_next_editor_component_group_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qselect_next_editor_component_group,
	    select_next_editor_component_group_command_translator_1);
    Qselect_previous_editor_component_group = 
	    STATIC_SYMBOL("SELECT-PREVIOUS-EDITOR-COMPONENT-GROUP",AB_package);
    mutate_global_property(Qselect_previous_editor_component_group,T,
	    Qeditor_command_p);
    make_ui_command(5,Qselect_previous_editor_component_group,
	    list_constant_29,Qnil,Qselect_previous_editor_component_group,
	    Qnil);
    Qprevious = STATIC_SYMBOL("PREVIOUS",AB_package);
    com_select_previous_editor_component_group_1 = 
	    STATIC_FUNCTION(com_select_previous_editor_component_group,NIL,
	    FALSE,2,2);
    set_ui_command_function(Qselect_previous_editor_component_group,
	    com_select_previous_editor_component_group_1);
    select_previous_editor_component_group_command_pursuer_1 = 
	    STATIC_FUNCTION(select_previous_editor_component_group_command_pursuer,
	    NIL,FALSE,1,1);
    set_ui_command_pursuer(Qselect_previous_editor_component_group,
	    select_previous_editor_component_group_command_pursuer_1);
    select_previous_editor_component_group_command_translator_1 = 
	    STATIC_FUNCTION(select_previous_editor_component_group_command_translator,
	    NIL,FALSE,1,1);
    set_ui_command_translator(Qselect_previous_editor_component_group,
	    select_previous_editor_component_group_command_translator_1);
    Qreplace_fragments_on_sides_qm = 
	    STATIC_SYMBOL("REPLACE-FRAGMENTS-ON-SIDES\?",AB_package);
    Qreplace_entire_text_qm = STATIC_SYMBOL("REPLACE-ENTIRE-TEXT\?",
	    AB_package);
    Qlight_gray = STATIC_SYMBOL("LIGHT-GRAY",AB_package);
    Qclass_qualified_name = STATIC_SYMBOL("CLASS-QUALIFIED-NAME",AB_package);
    Qof = STATIC_SYMBOL("OF",AB_package);
    Qvms = STATIC_SYMBOL("VMS",AB_package);
    if (Most_lefthand_float_digits == UNBOUND)
	Most_lefthand_float_digits = EQ(G2_operating_system,Qvms) ? 
		FIX((SI_Long)308L) : FIX((SI_Long)309L);
    if (Most_righthand_float_zeros == UNBOUND)
	Most_righthand_float_zeros = FIX((SI_Long)307L);
    if (Most_fixnum_digits == UNBOUND)
	Most_fixnum_digits = initialize_most_fixnum_digits();
    string_constant_47 = STATIC_STRING("~d");
    if (Digits_of_extremal_fixnum_as_string == UNBOUND)
	Digits_of_extremal_fixnum_as_string = 
		initialize_digits_of_extremal_fixnum_as_string();
    if (Digits_of_most_positive_fixnum_as_string == UNBOUND)
	Digits_of_most_positive_fixnum_as_string = 
		initialize_digits_of_most_positive_fixnum_as_string();
    if (Digits_of_most_negative_fixnum_as_string == UNBOUND)
	Digits_of_most_negative_fixnum_as_string = 
		initialize_digits_of_most_negative_fixnum_as_string();
    array_constant_9 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)24L));
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)0L,(SI_Long)56L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)1L,(SI_Long)57L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)2L,(SI_Long)56L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)3L,(SI_Long)56L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)4L,(SI_Long)52L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)5L,(SI_Long)54L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)6L,(SI_Long)53L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)7L,(SI_Long)54L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)8L,(SI_Long)55L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)9L,(SI_Long)52L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)10L,(SI_Long)51L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)11L,(SI_Long)49L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)12L,(SI_Long)49L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)13L,(SI_Long)53L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)14L,(SI_Long)55L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)15L,(SI_Long)56L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)16L,(SI_Long)53L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)17L,(SI_Long)52L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)22L,(SI_Long)18L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)23L,(SI_Long)57344L);
    array_constant_10 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)24L));
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)0L,(SI_Long)49L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)1L,(SI_Long)55L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)2L,(SI_Long)57L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)3L,(SI_Long)55L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)4L,(SI_Long)54L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)5L,(SI_Long)57L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)6L,(SI_Long)51L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)7L,(SI_Long)49L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)8L,(SI_Long)51L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)9L,(SI_Long)52L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)10L,(SI_Long)56L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)11L,(SI_Long)54L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)12L,(SI_Long)50L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)13L,(SI_Long)51L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)14L,(SI_Long)49L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)15L,(SI_Long)53L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)16L,(SI_Long)56L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)22L,(SI_Long)17L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)23L,(SI_Long)57344L);
    if (Digits_of_largest_float_as_string == UNBOUND)
	Digits_of_largest_float_as_string = EQ(G2_operating_system,Qvms) ? 
		array_constant_9 : array_constant_10;
    array_constant_11 = STATIC_ARRAY(list_constant_23,(SI_Long)1L,
	    FIX((SI_Long)24L));
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)0L,(SI_Long)50L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)1L,(SI_Long)50L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)2L,(SI_Long)50L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)3L,(SI_Long)53L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)4L,(SI_Long)48L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)5L,(SI_Long)55L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)6L,(SI_Long)51L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)7L,(SI_Long)56L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)8L,(SI_Long)53L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)9L,(SI_Long)56L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)10L,(SI_Long)53L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)11L,(SI_Long)48L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)12L,(SI_Long)55L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)13L,(SI_Long)50L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)14L,(SI_Long)48L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)15L,(SI_Long)49L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)16L,(SI_Long)53L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)22L,(SI_Long)17L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)23L,(SI_Long)57344L);
    if (Digits_of_smallest_normalized_float_as_string == UNBOUND)
	Digits_of_smallest_normalized_float_as_string = array_constant_11;
    list_constant_15 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)43L),
	    FIX((SI_Long)45L));
    list_constant_16 = STATIC_LIST((SI_Long)9L,FIX((SI_Long)49L),
	    FIX((SI_Long)50L),FIX((SI_Long)51L),FIX((SI_Long)52L),
	    FIX((SI_Long)53L),FIX((SI_Long)54L),FIX((SI_Long)55L),
	    FIX((SI_Long)56L),FIX((SI_Long)57L));
    list_constant_17 = STATIC_CONS(FIX((SI_Long)48L),list_constant_16);
    list_constant_18 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)101L),
	    FIX((SI_Long)69L));
    Qlong = STATIC_SYMBOL("LONG",AB_package);
    Qoverflow = STATIC_SYMBOL("OVERFLOW",AB_package);
    Qunderflow = STATIC_SYMBOL("UNDERFLOW",AB_package);
    list_constant_19 = STATIC_LIST_STAR((SI_Long)3L,Qquoted_character,
	    Qellipsis,list_constant_13);
    Qpunctuation_mark = STATIC_SYMBOL("PUNCTUATION-MARK",AB_package);
    list_constant_20 = STATIC_LIST((SI_Long)5L,Qfloat,Qwhole_string,
	    Qleft_string,Qmiddle_string,Qright_string);
    Qdouble_colon = STATIC_SYMBOL("DOUBLE-COLON",AB_package);
    Qadd_space_out_text_if_no_lisp = 
	    STATIC_SYMBOL("ADD-SPACE-OUT-TEXT-IF-NO-LISP",AB_package);
    gensymed_symbol = Nil;
    mutate_global_property(Qadd_space_out_text_if_no_lisp,gensymed_symbol,
	    Qfunction_keeps_procedure_environment_valid_qm);
    SET_SYMBOL_FUNCTION(Qadd_space_out_text_if_no_lisp,
	    STATIC_FUNCTION(add_space_out_text_if_no_lisp,NIL,FALSE,1,1));
    Qcontinuous_spaces_filter_lisp = 
	    STATIC_SYMBOL("CONTINUOUS-SPACES-FILTER-LISP",AB_package);
    gensymed_symbol = Nil;
    mutate_global_property(Qcontinuous_spaces_filter_lisp,gensymed_symbol,
	    Qfunction_keeps_procedure_environment_valid_qm);
    SET_SYMBOL_FUNCTION(Qcontinuous_spaces_filter_lisp,
	    STATIC_FUNCTION(continuous_spaces_filter_lisp,NIL,FALSE,1,1));
    Qparse_first_var_before_space_or_eof_lisp = 
	    STATIC_SYMBOL("PARSE-FIRST-VAR-BEFORE-SPACE-OR-EOF-LISP",
	    AB_package);
    gensymed_symbol = Nil;
    mutate_global_property(Qparse_first_var_before_space_or_eof_lisp,
	    gensymed_symbol,Qfunction_keeps_procedure_environment_valid_qm);
    SET_SYMBOL_FUNCTION(Qparse_first_var_before_space_or_eof_lisp,
	    STATIC_FUNCTION(parse_first_var_before_space_or_eof_lisp,NIL,
	    FALSE,1,1));
    Qparse_var_of_class_from_rule_or_gf_text_lisp = 
	    STATIC_SYMBOL("PARSE-VAR-OF-CLASS-FROM-RULE-OR-GF-TEXT-LISP",
	    AB_package);
    gensymed_symbol = Nil;
    mutate_global_property(Qparse_var_of_class_from_rule_or_gf_text_lisp,
	    gensymed_symbol,Qfunction_keeps_procedure_environment_valid_qm);
    Qtext_list = STATIC_SYMBOL("TEXT-LIST",AB_package);
    SET_SYMBOL_FUNCTION(Qparse_var_of_class_from_rule_or_gf_text_lisp,
	    STATIC_FUNCTION(parse_var_of_class_from_rule_or_gf_text_lisp,
	    NIL,FALSE,2,2));
}
