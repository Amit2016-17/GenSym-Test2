<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by LibreOffice - see http://cgit.freedesktop.org/libreoffice/core/tree/filter/source/xslt for the code.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">BeanXporter Additional Documentation</title><meta name="DCTERMS.title" content="BeanXporter Additional Documentation" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.creator" content="Allan Scott"/><meta name="DCTERMS.issued" content="1998-08-26T16:43:00" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.contributor" content="Allan Scott"/><meta name="DCTERMS.modified" content="1998-08-26T16:43:00" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.Heading_20_2 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; text-decoration:underline; }
	.Heading_20_3 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; }
	.P1 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; }
	.P10 { font-size:14pt; font-family:Times New Roman; text-decoration:underline; writing-mode:lr-tb; }
	.P2 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; }
	.P3 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; }
	.P4 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; text-decoration:underline; }
	.P5 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; text-decoration:underline; }
	.P6 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; font-weight:bold; }
	.P7 { font-size:10pt; font-family:Times New Roman; writing-mode:lr-tb; }
	.P8 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0in; margin-right:0in; text-indent:0.5in; }
	.P9 { font-size:12pt; font-family:Times New Roman; text-decoration:underline; writing-mode:lr-tb; }
	.Standard { font-size:10pt; font-family:Times New Roman; writing-mode:lr-tb; }
	.Text_20_body { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; }
	.Table1 { width:6.1569in; margin-left:-0.0785in; margin-right:auto;writing-mode:lr-tb; }
	.Table1_A1 { vertical-align:top; padding-left:0.075in; padding-right:0.075in; padding-top:0in; padding-bottom:0in; border-left-width:0,0176cm; border-left-style:solid; border-left-color:#000000; border-right-style:none; border-top-width:0,0176cm; border-top-style:solid; border-top-color:#000000; border-bottom-width:0,0176cm; border-bottom-style:solid; border-bottom-color:#000000; writing-mode:lr-tb; }
	.Table1_B1 { vertical-align:top; padding-left:0.075in; padding-right:0.075in; padding-top:0in; padding-bottom:0in; border-width:0,0176cm; border-style:solid; border-color:#000000; writing-mode:lr-tb; }
	.Table1_A { width:3.075in; }
	.Table1_B { width:3.0819in; }
	.T1 { font-size:12pt; }
	.T2 { font-size:12pt; font-weight:bold; }
	.T3 { font-size:12pt; text-decoration:underline; }
	.T4 { text-decoration:underline; }
	.WW8Num3z0 { font-size:12pt; text-decoration:none ! important; }
	<!-- ODF styles with no properties representable as CSS -->
	.Table1.1 .WW8Num1z0 .WW8Num2z0  { }
	</style></head><body dir="ltr" style="max-width:8.5in;margin-top:1in; margin-bottom:1in; margin-left:1.25in; margin-right:1.25in; writing-mode:lr-tb; "><h1 class="P10"><a id="a__BeanXporter_Additional_Documentation"><span/></a>BeanXporter Additional Documentation</h1><p class="P1">Allan Scott</p><p class="P1">Wednesday, August 26, 1998</p><p class="P1"> </p><p class="P1">The following information is useful for serious/professional users of BeanXporter.</p><p class="P1"> </p><ol><li><p class="P2" style="margin-left:0cm;"><span class="WW8Num1z0" style="display:block;float:left;min-width:NaNcm;">1.</span>Licensing Support<span class="odfLiEnd"/> </p></li><li><p class="P2" style="margin-left:0cm;"><span class="WW8Num1z0" style="display:block;float:left;min-width:NaNcm;">2.</span>Tracing<span class="odfLiEnd"/> </p></li><li><p class="P2" style="margin-left:0cm;"><span class="WW8Num1z0" style="display:block;float:left;min-width:NaNcm;">3.</span>Exception reporting<span class="odfLiEnd"/> </p></li><li><p class="P2" style="margin-left:0cm;"><span class="WW8Num1z0" style="display:block;float:left;min-width:NaNcm;">4.</span>Casting<span class="odfLiEnd"/> </p></li></ol><p class="P1"> </p><p class="P1"> </p><h2 class="Heading_20_2"><a id="a__1_Licensing_Support"><span/></a>1 Licensing Support </h2><p class="P1"> </p><p class="P1">When BeanXporter emits the Java classes that are the stubs for an ActiveX library,</p><p class="P1">BeanXporter asks each ActiveX control if it is licensed.  If it is licensed BeanXporter will emit a protected instance field of type com.gensym.com.License into the Java class that wraps the ActiveX control .  BeanXporter will also ask each licensed ActiveX control if there is a runtime key available   If there is a runtime key available, BeanXporter will emit the code to initialize the license field to that key.   For example the following line could be emitted for a control that is licensed and provides a runtime key:</p><p class="P1"> </p><p class="P1">protected License license = new License("licenseKey");</p><p class="P1"> </p><p class="P1">If the control is licensed but no runtime key is available then the code to initialize the field will not be initialized. For example:</p><p class="P1"> </p><p class="P1">protected License license;</p><p class="P1"> </p><p class="P1">It is possible to change the license emitted for a licensed control by subclassing an emitted class and initializing the license key in the constructor. For example:</p><p class="P1"> </p><p class="P1">. public class MyCtrl extends AnyActiveXCtrl </p><p class="P1">{</p><p class="P8">public MyCtrl()</p><p class="P1"><span> {</span></p><p class="P8"><span> license = new License(“myLicense”);</span></p><p class="P8">}</p><p class="P1">}</p><p class="P1"> </p><p class="P1">BeanXporter will not emit a license field for controls that do not declare themselves as licensed in the type library.  If a new version of a control is released that supports licensing, where in the past it did not, you must re-run BeanXporter on that ActiveX library to get the licensing support</p><p class="P1"> </p><p class="P1"> </p><h2 class="P9"><a id="a__2_Tracing"><span/></a>2 Tracing</h2><p class="Standard"> </p><h3 class="Heading_20_3"><a id="a__BeanXporter_provides_runtime_tracing_support_using_Gensym’s_standard_tracing_facility__defined_in_com_gensym_message__Tracing_is_useful_if_you_run_into_a_failure_in_BeanXporter_or_a_runtime_failure_that_is_difficult_to_debug_"><span/></a>BeanXporter provides runtime tracing support using Gensym’s standard tracing facility, defined in com.gensym.message.  Tracing is useful if you run into a failure in BeanXporter or a runtime failure that is difficult to debug.</h3><h2 class="Heading_20_2"><a id="a__Tracing_the_BeanXporter_Application"><span/></a>Tracing the BeanXporter Application</h2><p class="P1"> </p><p class="Text_20_body">The BeanXporter application itself provides support for tracing by command line arguments.  BeanXporter uses the standard tracing and debugging arguments used by all other Gensym java applications.  These arguments are:</p><p class="P1"> </p><table border="0" cellspacing="0" cellpadding="0" class="Table1"><colgroup><col width="341"/><col width="342"/></colgroup><tr class="Table11"><td style="text-align:left;width:3.075in; " class="Table1_A1"><p class="P1">Argument Syntax</p></td><td style="text-align:left;width:3.0819in; " class="Table1_B1"><p class="P1">Description</p></td></tr><tr class="Table11"><td style="text-align:left;width:3.075in; " class="Table1_A1"><p class="P1">-traceOn</p></td><td style="text-align:left;width:3.0819in; " class="Table1_B1"><p class="P1">Enable the tracing facility</p></td></tr><tr class="Table11"><td style="text-align:left;width:3.075in; " class="Table1_A1"><p class="P1">-traceLevel &lt;int&gt;</p></td><td style="text-align:left;width:3.0819in; " class="Table1_B1"><p class="P1">Set the tracing level for printing messages</p></td></tr><tr class="Table11"><td style="text-align:left;width:3.075in; " class="Table1_A1"><p class="P1">-traceKeys &lt;traceKey1&gt; …. &lt;traceKeyN&gt;</p></td><td style="text-align:left;width:3.0819in; " class="Table1_B1"><p class="P1">Select which trace keys are listened to</p></td></tr></table><p class="P1"> </p><p class="Standard"><span class="T1">In addition BeanXporter provides another command-line argument </span><span class="T2">axTraceLevel</span><span class="T1">.  This argument controls the level of tracing at which the native BeanXporter dll will report trace messages to the Java VM.  </span></p><p class="P1"> </p><p class="P1">For example, to run the BeanXporter wizard and display all trace messages:</p><p class="P1"> </p><p class="P1">java com.gensym.com.BeanXporter –wizard –traceOn –traceKeys com.gensym.com </p><p class="P1">                                                          –axTraceLevel 40  -traceLevel 40</p><p class="P1"> </p><p class="P1">This will produce a very verbose trace to standard output.  </p><p class="P1"> </p><p class="P4">Runtime Tracing of BeanXporter (Java source code)</p><p class="P1"> </p><p class="P1">If you are developing a Java application, using Java source files, you may wish to get a trace of the runtime activities of BeanXporter.  To do this simply add the following code into your application:</p><p class="P1"> </p><p class="P1">import com.gensym.com.ActiveXTraceTool;</p><p class="P1">import com.gensym.com.ActiveXTraceLevels;</p><p class="P1"> </p><p class="P1">…</p><p class="P1"> </p><p class="P1">ActiveXTraceTool tool =  new ActiveXTraceTool();</p><p class="P1">tool.setAxTraceLevel(ActiveXTraceLevels.AX_MAX_TRACE_LEVEL);</p><p class="P1">tool.setLogToStdout(true);</p><p class="Text_20_body">This code uses the ActiveXTraceTool to produce a trace to standard out.</p><p class="P1"> </p><p class="P1"> </p><p class="P4">Runtime Tracing of BeanXporter (visual editor)</p><p class="P1"> </p><p class="P1">If you are developing with BeanXporter beans in a visual editor, such as Gensym’s ComponentEditor  you may need the ability to add a visual component which controls the tracing of BeanXporter.   BeanXporter 1.0 ships with a jar file called axtools.jar.  This jar contains the ActiveXTraceTool bean.  </p><p class="P1"> </p><p class="P1">Load the axtools.jar into the visual editor and insert an ActiveXTraceTool bean.  Edit the axTraceLevel property of the ActiveXTraceTool to the required trace level.  Then the tracing will appear in the text area provided by the ActiveXTraceTool.  It is also possible to echo the tracing to standard output by editing the logToStdout property.</p><p class="P1"> </p><p class="P1">See the javadoc on com.gensym.comActiveXTraceTool for more information on runtime tracing.</p><p class="P1"> </p><p class="P1"> </p><ol><li><p class="P7" style="margin-left:0cm;"><span class="WW8Num3z0" style="display:block;float:left;min-width:NaNcm;">3.</span><span class="T3">Exception Reporting</span><span class="T4"> </span><span class="odfLiEnd"/> </p></li></ol><p class="P1"> </p><p class="P1">When running the BeanXporter on a particular ActiveX library you will be given the option of whether to emit methods that can produce exceptions or not.   It is recommended that for serious or professional use of BeanXporter that you always select the option to emit exceptions. The only reason that BeanXporter currently gives users this choice is because some visual editor tools cannot create hookups for methods that throw exceptions.</p><p class="P1"> </p><p class="P1">If you do not select the option to emit methods with exceptions then runtime execeptions in dispatching methods will be added as trace messages at the trace level ActiveXTraceLevels.AX_ERROR.</p><p class="P1"> </p><p class="P1">If you do select the option to emit methods with exceptions then each method that wraps an ActiveX method or property will be able to throw instances of ActiveXException.  This means that your code must be able to catch these exceptions.</p><p class="P1"> </p><p class="P1">In BeanXporter 1.0 the following ActiveXExceptions can be thrown:</p><p class="P1"> </p><p class="Standard"><span class="T2">ActiveXMissingProxyException </span><span class="T1">This can take place when a method is called on a component and the ActiveXProxy instance for that component has not been created.  This can happen if the initializeProxy() method on the component has never been called.  Note that for non-visual components the initializeProxy() is called in the zero-argument constructor of the component. For visual components initializeProxy() will not be called until the addNotify() method has been called on the component.</span></p><p class="P1"> </p><p class="Standard"><span class="T2">ActiveXDispatchException </span><span class="T1">There was a proxy but during the attempt to dispatch a method or property there was a failure.  Each ActiveXDispatchException instance has associated with it an error code that can be retrieved by calling getErrorCode(). In some cases more error information is available in the form of an Excepinfo instance.  To check </span><span class="T1">for an Excepinfo instance call getExcepinfo() on an ActiveXDispatchException.  See the javadoc for Excepinfo and ActiveXDispatchException for further discussion.</span></p><p class="P1"> </p><p class="P6"> </p><ol><li><p class="P5" style="margin-left:0cm;"><span class="WW8Num3z0" style="display:block;float:left;min-width:NaNcm;">4.</span>Casting<span class="odfLiEnd"/> </p></li></ol><p class="P1"> </p><p class="P1">BeanXporter contains limited support for casting between classes that implement the ActiveXDispatchable interface and classes that implement ActiveXComponent.  This casting is useful in cases where an ActiveX API only returns something which is dispatchable, but the user knows a-priori which ActiveX class is involved.  </p><p class="P1"> </p><p class="Standard"><span class="T1">Each ActiveXComponent that is emitted by BeanXporter will have a constructor that takes ActiveXDispatchable.  Passing in any ActiveXDispatchable into this class will cause it to check whether this Guid associated with the ActiveXComponent is </span><span class="T2">identical</span><span class="T1"> to  the Guid associated with the dispatch interface. If this check fails an instance of ActiveXCastException will be thrown.</span></p><p class="P1"> </p><p class="P1">This is the 1.0 behavior of BeanXporter.  Future versions of BeanXporter should improve on this, in two ways:</p><ol><li><p class="P3" style="margin-left:0cm;"><span class="WW8Num2z0" style="display:block;float:left;min-width:NaNcm;">i)</span>Support for IDispatch::QueryInterface from Java;<span class="odfLiEnd"/> </p></li><li><p class="P3" style="margin-left:0cm;"><span class="WW8Num2z0" style="display:block;float:left;min-width:NaNcm;">ii)</span>Support for using subclass relationships when casting.<span class="odfLiEnd"/> </p></li></ol><p class="P1"> </p><p class="P1">Of the four subjects discussed here I would not recommend documenting the current casting behavior, although this information is very useful for someone supporting BeanXporter.</p><p class="P1"> </p><p class="P1"> </p><p class="P1"> </p></body></html>