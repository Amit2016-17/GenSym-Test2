/* gsi.c
 * Input file:  gsi.lisp
 * Copyright (c) 1986 - 2017 Gensym Corporation.  All Rights Reserved.
 */

#include "user.h"
#include "gsi.h"


Object G2int_next_available_context_number = UNBOUND;

Object G2int_fake_array_of_one_wrapper = UNBOUND;

Object G2int_reusable_circularity_table = UNBOUND;

Object G2int_array_element_attribute_spec = UNBOUND;

Object G2int_list_element_attribute_spec = UNBOUND;

Object G2int_item_name_attribute_spec = UNBOUND;

Object G2int_simple_item_value_attribute_spec = UNBOUND;

Object G2int_reusable_name_instance = UNBOUND;

Object G2int_reusable_value_instance = UNBOUND;

Object G2int_within_run_loop_extent = UNBOUND;

Object G2int_gsi_shutdown_reason = UNBOUND;

Object G2int_gsi_error_code_table = UNBOUND;

Object G2int_gsi_scheduled_tasks_time_limit = UNBOUND;

/* GSI-PRIORITY-OF-DATA-SERVICE-FUNCTION */
Object g2int_gsi_priority_of_data_service_function()
{
    x_note_fn_call(47,0);
    return VALUES_1(FIX((SI_Long)4L));
}

static Object string_constant;     /* "gsi_signal_handler" */

/* ENTERING-SIGNAL-HANDLER-FUNCTION */
Object g2int_entering_signal_handler_function()
{
    x_note_fn_call(47,1);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi_by_signal,
	    G2int_gsi_run_state_type_signal,string_constant);
    return VALUES_1(Nil);
}

/* CALL-GSI-OPEN-FD-CALLBACK */
Object g2int_call_gsi_open_fd_callback(fd)
    Object fd;
{
    x_note_fn_call(47,2);
    g2int_call_gsi_callback(2,G2int_gsi_open_fd,fd);
    return VALUES_1(Nil);
}

/* CALL-GSI-CLOSE-FD-CALLBACK */
Object g2int_call_gsi_close_fd_callback(fd)
    Object fd;
{
    x_note_fn_call(47,3);
    g2int_call_gsi_callback(2,G2int_gsi_close_fd,fd);
    return VALUES_1(Nil);
}

/* CALL-GSI-WRITING-FD-CALLBACK */
Object g2int_call_gsi_writing_fd_callback(fd)
    Object fd;
{
    x_note_fn_call(47,4);
    g2int_call_gsi_callback(2,G2int_gsi_writing_fd,fd);
    return VALUES_1(Nil);
}

/* CALL-GSI-NOT-WRITING-FD-CALLBACK */
Object g2int_call_gsi_not_writing_fd_callback(fd)
    Object fd;
{
    x_note_fn_call(47,5);
    g2int_call_gsi_callback(2,G2int_gsi_not_writing_fd,fd);
    return VALUES_1(Nil);
}

Object G2int_gsi_global_option_array = UNBOUND;

Object G2int_callback_is_global_array = UNBOUND;

Object G2int_gsi_callback_name_symbol_array = UNBOUND;

Object G2int_gsi_callback_name_string_array = UNBOUND;

static Object Qab_g2int_gsi_set_up;  /* |gsi_set_up| */

/* SHARED-GSIN-SET-UP */
Object g2int_shared_gsin_set_up(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,6);
    gsi_fc_result = Qab_g2int_gsi_set_up;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_1;   /* "gsin_set_up" */

/* GSIN-SET-UP */
DLLEXPORT Object gsin_set_up()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,7);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_1);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_set_up(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_1);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_get_tcp_port;  /* |gsi_get_tcp_port| */

/* SHARED-GSIN-GET-TCP-PORT */
Object g2int_shared_gsin_get_tcp_port(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,8);
    gsi_fc_result = Qab_g2int_gsi_get_tcp_port;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_2;   /* "gsin_get_tcp_port" */

/* GSIN-GET-TCP-PORT */
DLLEXPORT Object gsin_get_tcp_port()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,9);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_2);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_get_tcp_port(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_2);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_pause_context;  /* |gsi_pause_context| */

/* SHARED-GSIN-PAUSE-CONTEXT */
Object g2int_shared_gsin_pause_context(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,10);
    gsi_fc_result = Qab_g2int_gsi_pause_context;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_3;   /* "gsin_pause_context" */

/* GSIN-PAUSE-CONTEXT */
DLLEXPORT Object gsin_pause_context()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,11);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_3);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_pause_context(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_3);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_resume_context;  /* |gsi_resume_context| */

/* SHARED-GSIN-RESUME-CONTEXT */
Object g2int_shared_gsin_resume_context(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,12);
    gsi_fc_result = Qab_g2int_gsi_resume_context;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_4;   /* "gsin_resume_context" */

/* GSIN-RESUME-CONTEXT */
DLLEXPORT Object gsin_resume_context()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,13);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_4);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_resume_context(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_4);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_shutdown_context;  /* |gsi_shutdown_context| */

/* SHARED-GSIN-SHUTDOWN-CONTEXT */
Object g2int_shared_gsin_shutdown_context(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,14);
    gsi_fc_result = Qab_g2int_gsi_shutdown_context;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_5;   /* "gsin_shutdown_context" */

/* GSIN-SHUTDOWN-CONTEXT */
DLLEXPORT Object gsin_shutdown_context()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,15);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_5);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_shutdown_context(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_5);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_g2_poll;  /* |gsi_g2_poll| */

/* SHARED-GSIN-G2-POLL */
Object g2int_shared_gsin_g2_poll(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,16);
    gsi_fc_result = Qab_g2int_gsi_g2_poll;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_6;   /* "gsin_g2_poll" */

/* GSIN-G2-POLL */
DLLEXPORT Object gsin_g2_poll()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,17);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_6);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_g2_poll(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_6);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_read_callback;  /* |gsi_read_callback| */

/* SHARED-GSIN-READ-CALLBACK */
Object g2int_shared_gsin_read_callback(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,18);
    gsi_fc_result = Qab_g2int_gsi_read_callback;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_7;   /* "gsin_read_callback" */

/* GSIN-READ-CALLBACK */
DLLEXPORT Object gsin_read_callback()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,19);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_7);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_read_callback(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_7);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_write_callback;  /* |gsi_write_callback| */

/* SHARED-GSIN-WRITE-CALLBACK */
Object g2int_shared_gsin_write_callback(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,20);
    gsi_fc_result = Qab_g2int_gsi_write_callback;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_8;   /* "gsin_write_callback" */

/* GSIN-WRITE-CALLBACK */
DLLEXPORT Object gsin_write_callback()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,21);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_8);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_write_callback(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_8);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_open_fd;  /* |gsi_open_fd| */

/* SHARED-GSIN-OPEN-FD */
Object g2int_shared_gsin_open_fd(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,22);
    gsi_fc_result = Qab_g2int_gsi_open_fd;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_9;   /* "gsin_open_fd" */

/* GSIN-OPEN-FD */
DLLEXPORT Object gsin_open_fd()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,23);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_9);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_open_fd(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_9);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_close_fd;  /* |gsi_close_fd| */

/* SHARED-GSIN-CLOSE-FD */
Object g2int_shared_gsin_close_fd(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,24);
    gsi_fc_result = Qab_g2int_gsi_close_fd;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_10;  /* "gsin_close_fd" */

/* GSIN-CLOSE-FD */
DLLEXPORT Object gsin_close_fd()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,25);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_10);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_close_fd(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_10);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_initialize_context;  /* |gsi_initialize_context| */

/* SHARED-GSIN-INITIALIZE-CONTEXT */
Object g2int_shared_gsin_initialize_context(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,26);
    gsi_fc_result = Qab_g2int_gsi_initialize_context;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_11;  /* "gsin_initialize_context" */

/* GSIN-INITIALIZE-CONTEXT */
DLLEXPORT Object gsin_initialize_context()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,27);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_11);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_initialize_context(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_11);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_receive_registration;  /* |gsi_receive_registration| */

/* SHARED-GSIN-RECEIVE-REGISTRATION */
Object g2int_shared_gsin_receive_registration(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,28);
    gsi_fc_result = Qab_g2int_gsi_receive_registration;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_12;  /* "gsin_receive_registration" */

/* GSIN-RECEIVE-REGISTRATION */
DLLEXPORT Object gsin_receive_registration()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,29);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_12);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_receive_registration(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_12);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_receive_deregistrations;  /* |gsi_receive_deregistrations| */

/* SHARED-GSIN-RECEIVE-DEREGISTRATIONS */
Object g2int_shared_gsin_receive_deregistrations(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,30);
    gsi_fc_result = Qab_g2int_gsi_receive_deregistrations;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_13;  /* "gsin_receive_deregistrations" */

/* GSIN-RECEIVE-DEREGISTRATIONS */
DLLEXPORT Object gsin_receive_deregistrations()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,31);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_13);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = 
	      g2int_shared_gsin_receive_deregistrations(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_13);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_get_data;  /* |gsi_get_data| */

/* SHARED-GSIN-GET-DATA */
Object g2int_shared_gsin_get_data(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,32);
    gsi_fc_result = Qab_g2int_gsi_get_data;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_14;  /* "gsin_get_data" */

/* GSIN-GET-DATA */
DLLEXPORT Object gsin_get_data()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,33);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_14);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_get_data(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_14);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_set_data;  /* |gsi_set_data| */

/* SHARED-GSIN-SET-DATA */
Object g2int_shared_gsin_set_data(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,34);
    gsi_fc_result = Qab_g2int_gsi_set_data;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_15;  /* "gsin_set_data" */

/* GSIN-SET-DATA */
DLLEXPORT Object gsin_set_data()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,35);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_15);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_set_data(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_15);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_receive_message;  /* |gsi_receive_message| */

/* SHARED-GSIN-RECEIVE-MESSAGE */
Object g2int_shared_gsin_receive_message(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,36);
    gsi_fc_result = Qab_g2int_gsi_receive_message;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_16;  /* "gsin_receive_message" */

/* GSIN-RECEIVE-MESSAGE */
DLLEXPORT Object gsin_receive_message()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,37);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_16);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_receive_message(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_16);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_run_state_change;  /* |gsi_run_state_change| */

/* SHARED-GSIN-RUN-STATE-CHANGE */
Object g2int_shared_gsin_run_state_change(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,38);
    gsi_fc_result = Qab_g2int_gsi_run_state_change;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_17;  /* "gsin_run_state_change" */

/* GSIN-RUN-STATE-CHANGE */
DLLEXPORT Object gsin_run_state_change()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,39);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_17);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_run_state_change(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_17);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_error_handler;  /* |gsi_error_handler| */

/* SHARED-GSIN-ERROR-HANDLER */
Object g2int_shared_gsin_error_handler(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,40);
    gsi_fc_result = Qab_g2int_gsi_error_handler;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_18;  /* "gsin_error_handler" */

/* GSIN-ERROR-HANDLER */
DLLEXPORT Object gsin_error_handler()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,41);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_18);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_error_handler(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_18);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_missing_procedure_handler;  /* |gsi_missing_procedure_handler| */

/* SHARED-GSIN-MISSING-PROCEDURE-HANDLER */
Object g2int_shared_gsin_missing_procedure_handler(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,42);
    gsi_fc_result = Qab_g2int_gsi_missing_procedure_handler;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_19;  /* "gsin_missing_procedure_handler" */

/* GSIN-MISSING-PROCEDURE-HANDLER */
DLLEXPORT Object gsin_missing_procedure_handler()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,43);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_19);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = 
	      g2int_shared_gsin_missing_procedure_handler(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_19);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_watchdog_function;  /* |gsi_watchdog_function| */

/* SHARED-GSIN-WATCHDOG-FUNCTION */
Object g2int_shared_gsin_watchdog_function(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,44);
    gsi_fc_result = Qab_g2int_gsi_watchdog_function;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_20;  /* "gsin_watchdog_function" */

/* GSIN-WATCHDOG-FUNCTION */
DLLEXPORT Object gsin_watchdog_function()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,45);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_20);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_watchdog_function(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_20);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_idle;  /* |gsi_idle| */

/* SHARED-GSIN-IDLE */
Object g2int_shared_gsin_idle(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,46);
    gsi_fc_result = Qab_g2int_gsi_idle;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_21;  /* "gsin_idle" */

/* GSIN-IDLE */
DLLEXPORT Object gsin_idle()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,47);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_21);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_idle(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_21);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_start_context;  /* |gsi_start_context| */

/* SHARED-GSIN-START-CONTEXT */
Object g2int_shared_gsin_start_context(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,48);
    gsi_fc_result = Qab_g2int_gsi_start_context;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_22;  /* "gsin_start_context" */

/* GSIN-START-CONTEXT */
DLLEXPORT Object gsin_start_context()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,49);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_22);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_start_context(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_22);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_reset_context;  /* |gsi_reset_context| */

/* SHARED-GSIN-RESET-CONTEXT */
Object g2int_shared_gsin_reset_context(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,50);
    gsi_fc_result = Qab_g2int_gsi_reset_context;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_23;  /* "gsin_reset_context" */

/* GSIN-RESET-CONTEXT */
DLLEXPORT Object gsin_reset_context()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,51);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_23);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_reset_context(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_23);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_writing_fd;  /* |gsi_writing_fd| */

/* SHARED-GSIN-WRITING-FD */
Object g2int_shared_gsin_writing_fd(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,52);
    gsi_fc_result = Qab_g2int_gsi_writing_fd;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_24;  /* "gsin_writing_fd" */

/* GSIN-WRITING-FD */
DLLEXPORT Object gsin_writing_fd()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,53);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_24);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_writing_fd(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_24);
    result_2 = result_1;
    return result_2;
}

static Object Qab_g2int_gsi_not_writing_fd;  /* |gsi_not_writing_fd| */

/* SHARED-GSIN-NOT-WRITING-FD */
Object g2int_shared_gsin_not_writing_fd(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,54);
    gsi_fc_result = Qab_g2int_gsi_not_writing_fd;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_25;  /* "gsin_not_writing_fd" */

/* GSIN-NOT-WRITING-FD */
DLLEXPORT Object gsin_not_writing_fd()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,55);
    result_1 = Nil;
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_25);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsin_not_writing_fd(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_25);
    result_2 = result_1;
    return result_2;
}

/* ALLOCATE-INITIALIZED-MANAGED-SIMPLE-VECTOR */
Object g2int_allocate_initialized_managed_simple_vector(size)
    Object size;
{
    Object array;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,56);
    array = g2int_allocate_managed_simple_vector(size);
    i = (SI_Long)0L;
    ab_loop_bind_ = IFIX(size);
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    ISVREF(array,i) = Nil;
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    return VALUES_1(array);
}

Object G2int_the_type_description_of_gsi_application = UNBOUND;

Object G2int_chain_of_available_gsi_applications = UNBOUND;

Object G2int_gsi_application_count = UNBOUND;

/* RECLAIM-GSI-APPLICATION-1 */
Object g2int_reclaim_gsi_application_1(gsi_application)
    Object gsi_application;
{
    Object old_structure_being_reclaimed, schedule_task_qm;
    Object old_structure_being_reclaimed_1, svref_new_value;

    x_note_fn_call(47,57);
    inline_note_reclaim_cons(gsi_application,Nil);
    old_structure_being_reclaimed = G2int_structure_being_reclaimed;
    G2int_structure_being_reclaimed = gsi_application;
    g2int_reclaim_managed_simple_vector(ISVREF(gsi_application,(SI_Long)2L));
    SVREF(gsi_application,FIX((SI_Long)2L)) = Nil;
    g2int_reclaim_managed_simple_vector(ISVREF(gsi_application,(SI_Long)3L));
    SVREF(gsi_application,FIX((SI_Long)3L)) = Nil;
    g2int_reclaim_list_of_local_functions(ISVREF(gsi_application,(SI_Long)4L));
    SVREF(gsi_application,FIX((SI_Long)4L)) = Nil;
    schedule_task_qm = ISVREF(gsi_application,(SI_Long)6L);
    if (schedule_task_qm) {
	if (EQ(schedule_task_qm,G2int_current_schedule_task))
	    G2int_current_schedule_task = Nil;
	if (ISVREF(schedule_task_qm,(SI_Long)6L))
	    g2int_cancel_and_reclaim_scheduled_queue_element_1(schedule_task_qm);
	inline_note_reclaim_cons(schedule_task_qm,Nil);
	old_structure_being_reclaimed_1 = G2int_structure_being_reclaimed;
	G2int_structure_being_reclaimed = schedule_task_qm;
	g2int_reclaim_schedule_task_args(ISVREF(schedule_task_qm,(SI_Long)9L));
	SVREF(schedule_task_qm,FIX((SI_Long)9L)) = Nil;
	G2int_structure_being_reclaimed = old_structure_being_reclaimed_1;
	svref_new_value = G2int_chain_of_available_schedule_tasks;
	SVREF(schedule_task_qm,FIX((SI_Long)0L)) = svref_new_value;
	G2int_chain_of_available_schedule_tasks = schedule_task_qm;
    }
    svref_new_value = Nil;
    SVREF(gsi_application,FIX((SI_Long)6L)) = svref_new_value;
    SVREF(gsi_application,FIX((SI_Long)6L)) = Nil;
    g2int_reclaim_if_text_or_gensym_string_function(ISVREF(gsi_application,
	    (SI_Long)7L));
    SVREF(gsi_application,FIX((SI_Long)7L)) = Nil;
    G2int_structure_being_reclaimed = old_structure_being_reclaimed;
    svref_new_value = G2int_chain_of_available_gsi_applications;
    SVREF(gsi_application,FIX((SI_Long)0L)) = svref_new_value;
    G2int_chain_of_available_gsi_applications = gsi_application;
    return VALUES_1(Nil);
}

/* RECLAIM-STRUCTURE-FOR-GSI-APPLICATION */
Object g2int_reclaim_structure_for_gsi_application(gsi_application)
    Object gsi_application;
{
    x_note_fn_call(47,58);
    return g2int_reclaim_gsi_application_1(gsi_application);
}

static Object Qg2_defstruct_structure_name_gsi_application_g2_struct;  /* g2-defstruct-structure-name::gsi-application-g2-struct */

/* MAKE-PERMANENT-GSI-APPLICATION-STRUCTURE-INTERNAL */
Object g2int_make_permanent_gsi_application_structure_internal()
{
    Object def_structure_gsi_application_variable;
    Object gsi_application_count_new_value;
    Object defstruct_g2_gsi_application_variable, the_array;
    SI_Long gensymed_symbol, i, ab_loop_bind_;
    XDeclare_area(1);

    x_note_fn_call(47,59);
    def_structure_gsi_application_variable = Nil;
    gsi_application_count_new_value = FIXNUM_ADD1(G2int_gsi_application_count);
    G2int_gsi_application_count = gsi_application_count_new_value;
    if (PUSH_AREA(Dynamic_area,0)) {
	defstruct_g2_gsi_application_variable = Nil;
	gensymed_symbol = (SI_Long)8L;
	the_array = make_array(1,FIX(gensymed_symbol));
	i = (SI_Long)0L;
	ab_loop_bind_ = gensymed_symbol;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	ISVREF(the_array,i) = Nil;
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	defstruct_g2_gsi_application_variable = the_array;
	SVREF(defstruct_g2_gsi_application_variable,FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_gsi_application_g2_struct;
	def_structure_gsi_application_variable = 
		defstruct_g2_gsi_application_variable;
    }
    POP_AREA(0);
    return VALUES_1(def_structure_gsi_application_variable);
}

/* MAKE-GSI-APPLICATION-1 */
Object g2int_make_gsi_application_1(gsi_application_name_symbol)
    Object gsi_application_name_symbol;
{
    Object def_structure_gsi_application_variable, svref_new_value;

    x_note_fn_call(47,60);
    def_structure_gsi_application_variable = 
	    G2int_chain_of_available_gsi_applications;
    if (def_structure_gsi_application_variable) {
	G2int_chain_of_available_gsi_applications = 
		ISVREF(def_structure_gsi_application_variable,(SI_Long)0L);
	SVREF(def_structure_gsi_application_variable,FIX((SI_Long)0L)) = 
		Qg2_defstruct_structure_name_gsi_application_g2_struct;
    }
    else
	def_structure_gsi_application_variable = 
		g2int_make_permanent_gsi_application_structure_internal();
    inline_note_allocate_cons(def_structure_gsi_application_variable,Nil);
    SVREF(def_structure_gsi_application_variable,FIX((SI_Long)1L)) = 
	    gsi_application_name_symbol;
    svref_new_value = 
	    g2int_allocate_initialized_managed_simple_vector(G2int_gsi_number_of_options);
    SVREF(def_structure_gsi_application_variable,FIX((SI_Long)2L)) = 
	    svref_new_value;
    svref_new_value = 
	    g2int_allocate_initialized_managed_simple_vector(G2int_gsi_number_of_callbacks);
    SVREF(def_structure_gsi_application_variable,FIX((SI_Long)3L)) = 
	    svref_new_value;
    SVREF(def_structure_gsi_application_variable,FIX((SI_Long)4L)) = Nil;
    SVREF(def_structure_gsi_application_variable,FIX((SI_Long)5L)) = Nil;
    SVREF(def_structure_gsi_application_variable,FIX((SI_Long)6L)) = Nil;
    SVREF(def_structure_gsi_application_variable,FIX((SI_Long)7L)) = Nil;
    return VALUES_1(def_structure_gsi_application_variable);
}

Object G2int_loadable_bridges_enabled_p = UNBOUND;

Object G2int_have_default_gsi_application = UNBOUND;

Object G2int_default_gsi_application = UNBOUND;

static Object Qg2int_default;      /* default */

/* MAKE-DEFAULT-GSI-APPLICATION */
Object g2int_make_default_gsi_application()
{
    Object temp;

    x_note_fn_call(47,61);
    if (G2int_have_default_gsi_application)
	temp = G2int_default_gsi_application;
    else {
	G2int_have_default_gsi_application = T;
	temp = g2int_make_gsi_application_1(Qg2int_default);
    }
    return VALUES_1(temp);
}

Object G2int_all_gsi_applications = UNBOUND;

Object G2int_current_gsi_application = UNBOUND;

/* GSI-APPLICATION-FOR-SOCKET */
Object g2int_gsi_application_for_socket(icp_socket)
    Object icp_socket;
{
    Object socket_extension_data_qm, application, application_name;
    Object gsi_application, ab_loop_list_, temp;

    x_note_fn_call(47,62);
    socket_extension_data_qm = ISVREF(icp_socket,(SI_Long)29L);
    if (socket_extension_data_qm);
    else
	return VALUES_1(Nil);
    application = ISVREF(socket_extension_data_qm,(SI_Long)9L);
    if (application)
	return VALUES_1(application);
    application_name = Nil;
    gsi_application = Nil;
    ab_loop_list_ = G2int_all_gsi_applications;
  next_loop:
    temp = ISVREF(G2int_current_icp_socket,(SI_Long)1L);
    if (temp);
    else
	temp = Qg2int_default;
    application_name = temp;
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    gsi_application = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    if (EQ(ISVREF(gsi_application,(SI_Long)1L),application_name))
	application = gsi_application;
    goto next_loop;
  end_loop:
    application = G2int_default_gsi_application;
    SVREF(socket_extension_data_qm,FIX((SI_Long)9L)) = application;
    return VALUES_1(application);
}

/* CURRENT-GSI-APPLICATION */
Object g2int_current_gsi_application()
{
    Object temp;

    x_note_fn_call(47,63);
    temp = G2int_current_icp_socket ? 
	    g2int_gsi_application_for_socket(G2int_current_icp_socket) : Nil;
    if (temp);
    else
	temp = G2int_current_gsi_application;
    if (temp);
    else
	temp = G2int_default_gsi_application;
    return VALUES_1(temp);
}

/* FIND-OR-LOAD-GSI-APPLICATION */
Object g2int_find_or_load_gsi_application(name)
    Object name;
{
    Object gsi_application, ab_loop_list_, temp;

    x_note_fn_call(47,64);
    if ( !TRUEP(name) || EQ(name,Qg2int_default))
	return VALUES_1(G2int_default_gsi_application);
    gsi_application = Nil;
    ab_loop_list_ = G2int_all_gsi_applications;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    gsi_application = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    if (EQ(ISVREF(gsi_application,(SI_Long)1L),name))
	return VALUES_1(gsi_application);
    goto next_loop;
  end_loop:;
    temp = G2int_loadable_bridges_enabled_p ? 
	    g2int_load_gsi_application(name) : G2int_default_gsi_application;
    return VALUES_1(temp);
}

/* SET-GSI-CURRENT-APPLICATION */
Object g2int_set_gsi_current_application(application)
    Object application;
{
    Object socket_extension_data_qm;

    x_note_fn_call(47,65);
    socket_extension_data_qm = G2int_current_icp_socket ? 
	    ISVREF(G2int_current_icp_socket,(SI_Long)29L) : Nil;
    if (socket_extension_data_qm)
	SVREF(socket_extension_data_qm,FIX((SI_Long)9L)) = application;
    else
	G2int_current_gsi_application = application;
    return VALUES_1(Nil);
}

static Object string_constant_26;  /* "~(~A~)" */

static Object string_constant_27;  /* "gsi_set_options_from_compile" */

/* LOAD-LIBRARY-FOR-GSI */
Object g2int_load_library_for_gsi(name)
    Object name;
{
    Object downcased_symbol_name_text, pathname_1, shared_pathname;
    Object namestring_as_gensym_string, temp;

    x_note_fn_call(47,66);
    downcased_symbol_name_text = g2int_tformat_text_string(2,
	    string_constant_26,name);
    pathname_1 = g2int_gensym_make_pathname_with_copied_components(Nil,Nil,
	    Nil,downcased_symbol_name_text,Nil,Nil,Nil);
    shared_pathname = g2int_pathname_gtshared_file_pathname(pathname_1);
    namestring_as_gensym_string = 
	    g2int_namestring_as_gensym_string(shared_pathname);
    temp = g2int_load_library(namestring_as_gensym_string,
	    string_constant_27,inline_gsi_api_function_array());
    g2int_reclaim_text_string(downcased_symbol_name_text);
    g2int_reclaim_gensym_pathname(pathname_1);
    g2int_reclaim_gensym_pathname(shared_pathname);
    return VALUES_1(temp);
}

static Object Qg2int_load_gsi_application;  /* load-gsi-application */

static Object string_constant_28;  /* "gsi_set_up" */

/* LOAD-GSI-APPLICATION */
Object g2int_load_gsi_application(name)
    Object name;
{
    Object application, temp, function;

    x_note_fn_call(47,67);
    if (G2int_loadable_bridges_enabled_p) {
	application = g2int_make_gsi_application_1(name);
	G2int_all_gsi_applications = g2int_gensym_cons_1(application,
		G2int_all_gsi_applications);
	g2int_set_gsi_current_application(application);
	if ( !TRUEP(g2int_load_library_for_gsi(name))) {
	    G2int_all_gsi_applications = 
		    g2int_delete_gensym_element_1(application,
		    G2int_all_gsi_applications);
	    g2int_reclaim_gsi_application_1(application);
	    g2int_set_gsi_current_application(Nil);
	    g2int_gsi_warning(3,Qg2int_load_gsi_application,
		    G2int_gsi_application_load_failed,name);
	    temp = Nil;
	}
	else {
	    function = ISVREF(ISVREF(application,(SI_Long)3L),
		    IFIX(G2int_gsi_set_up));
	    if (function) {
		g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
			G2int_gsi_run_state_direction_leaving_gsi,
			G2int_gsi_run_state_type_callback,string_constant_28);
		inline_call_gsi_set_up(function);
		g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
			G2int_gsi_run_state_direction_entering_gsi,
			G2int_gsi_run_state_type_callback,string_constant_28);
	    }
	    temp = application;
	}
    }
    else
	temp = Nil;
    return VALUES_1(temp);
}

static Object Qg2int_gsi_set_current_application;  /* |gsi_set_current_application| */

/* SHARED-GSI-SET-CURRENT-APPLICATION */
void g2int_shared_gsi_set_current_application(wide_api_p,
	    gsi_fc_outer_application_name)
    Object wide_api_p, gsi_fc_outer_application_name;
{
    Object arg_symbol, application_name, gsi_application, ab_loop_list_, temp;
    Object application;

    x_note_fn_call(47,68);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_application_name,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_current_application,Qerror,T);
	goto end_shared_gsi_set_current_application;
    }
    application_name = arg_symbol;
    if ( !TRUEP(application_name) || EQ(application_name,Qg2int_default))
	G2int_current_gsi_application = Nil;
    else {
	gsi_application = Nil;
	ab_loop_list_ = G2int_all_gsi_applications;
      next_loop:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	gsi_application = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	if (EQ(ISVREF(gsi_application,(SI_Long)1L),application_name)) {
	    temp = gsi_application;
	    goto end;
	}
	goto next_loop;
      end_loop:
	application = g2int_make_gsi_application_1(application_name);
	G2int_all_gsi_applications = g2int_gensym_cons_1(application,
		G2int_all_gsi_applications);
	temp = application;
	goto end;
	temp = Qnil;
      end:;
	g2int_set_gsi_current_application(temp);
    }
  end_shared_gsi_set_current_application:;
}

static Object string_constant_29;  /* "gsi_set_current_application" */

static Object Qg2int_gsi_catch;    /* gsi-catch */

/* GSI-SET-CURRENT-APPLICATION */
DLLEXPORT void gsi_set_current_application(application_name)
    Object application_name;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,69);
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_29);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_current_application(G2int_gsi_wide_api_p,
		    application_name);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_current_application(G2int_gsi_wide_api_p,
			    application_name);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_29);
}

static Object Qg2int_gsi_initialize_callback;  /* |gsi_initialize_callback| */

/* SHARED-GSI-INITIALIZE-CALLBACK */
void g2int_shared_gsi_initialize_callback(wide_api_p,gsi_fc_outer_name,
	    function)
    Object wide_api_p, gsi_fc_outer_name, function;
{
    Object arg_symbol, name, svref_arg_1, svref_arg_2;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,70);
    arg_symbol = g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_name,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_initialize_callback,Qerror,T);
	goto end_shared_gsi_initialize_callback;
    }
    name = arg_symbol;
    if ( !TRUEP(name)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_callback_name_not_found,name,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_initialize_callback,Qerror,T);
	goto end_shared_gsi_initialize_callback;
    }
    svref_arg_1 = ISVREF(g2int_current_gsi_application(),(SI_Long)3L);
    i = (SI_Long)0L;
    ab_loop_bind_ = IFIX(length(G2int_gsi_callback_name_symbol_array));
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    if (EQ(name,ISVREF(G2int_gsi_callback_name_symbol_array,i))) {
	svref_arg_2 = FIX(i);
	goto end;
    }
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:
    g2int_set_gsi_error_message_1(Nil,G2int_gsi_callback_name_not_found,
	    name,Nil,Nil,Nil,Nil,Nil);
    g2int_gsi_handle_error_1(Qg2int_gsi_initialize_callback,Qerror,T);
    goto end_shared_gsi_initialize_callback;
    svref_arg_2 = Qnil;
  end:;
    SVREF(svref_arg_1,svref_arg_2) = function;
  end_shared_gsi_initialize_callback:;
}

static Object string_constant_30;  /* "gsi_initialize_callback" */

/* GSI-INITIALIZE-CALLBACK */
DLLEXPORT void gsi_initialize_callback(name,function)
    Object name, function;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,71);
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_30);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_initialize_callback(G2int_gsi_wide_api_p,name,
		    function);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_initialize_callback(G2int_gsi_wide_api_p,
			    name,function);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_30);
}

Object G2int_pending_gsi_callbacks = UNBOUND;

Object G2int_enable_global_errors = UNBOUND;

/* CALL-GSI-CALLBACK */
Object g2int_call_gsi_callback varargs_1(int, n)
{
    Object callback_index;
    Object arg1, arg2, arg3, push_arg, pending_gsi_callbacks_new_value;
    Object callback_index_1, arg1_1, arg2_1, arg3_1, temp, ab_loop_list_;
    Object ab_loop_desetq_, name_string, global_p, result_1, application;
    Object applications_tail, function;
    char gsi_run_state_change_p;
    Declare_varargs_nonrelocating;
    XDeclare_area(1);

    x_note_fn_call(47,72);
    INIT_ARGS_nonrelocating();
    callback_index = REQUIRED_ARG_nonrelocating();
    arg1 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg2 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg3 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    if ( !TRUEP(G2int_have_default_gsi_application)) {
	if (PUSH_AREA(Dynamic_area,0)) {
	    push_arg = LIST_4(callback_index,arg1,arg2,arg3);
	    pending_gsi_callbacks_new_value = CONS(push_arg,
		    G2int_pending_gsi_callbacks);
	    G2int_pending_gsi_callbacks = pending_gsi_callbacks_new_value;
	}
	POP_AREA(0);
	return VALUES_1(Nil);
    }
    if (G2int_pending_gsi_callbacks) {
	callback_index_1 = Nil;
	arg1_1 = Nil;
	arg2_1 = Nil;
	arg3_1 = Nil;
	temp = nreverse(G2int_pending_gsi_callbacks);
	G2int_pending_gsi_callbacks = Nil;
	ab_loop_list_ = temp;
	ab_loop_desetq_ = Nil;
      next_loop:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	ab_loop_desetq_ = M_CAR(ab_loop_list_);
	callback_index_1 = CAR(ab_loop_desetq_);
	temp = CDR(ab_loop_desetq_);
	arg1_1 = CAR(temp);
	temp = CDR(ab_loop_desetq_);
	temp = CDR(temp);
	arg2_1 = CAR(temp);
	temp = CDR(ab_loop_desetq_);
	temp = CDR(temp);
	temp = CDR(temp);
	arg3_1 = CAR(temp);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	g2int_call_gsi_callback(4,callback_index_1,arg1_1,arg2_1,arg3_1);
	goto next_loop;
      end_loop:;
    }
    gsi_run_state_change_p = FIXNUM_EQ(G2int_gsi_run_state_change,
	    callback_index);
    name_string = ISVREF(G2int_gsi_callback_name_string_array,
	    IFIX(callback_index));
    global_p = FIXNUM_EQ(callback_index,G2int_gsi_error_handler) ? ( 
	    !(G2int_current_icp_socket && G2int_enable_global_errors && 
	    g2int_gsi_application_for_socket(G2int_current_icp_socket)) ? 
	    T : Nil) : ISVREF(G2int_callback_is_global_array,
	    IFIX(callback_index));
    if ( !(FIXNUMP(callback_index) && FIXNUM_LE(FIX((SI_Long)-128L),
	    callback_index) && FIXNUM_LE(callback_index,FIX((SI_Long)127L))))
	result_1 = Nil;
    else
	switch (INTEGER_TO_CHAR(callback_index)) {
	  case 1:
	    result_1 = FIX((SI_Long)0L);
	    break;
	  case 10:
	    result_1 = FIX((SI_Long)0L);
	    break;
	  default:
	    result_1 = Nil;
	    break;
	}
    application = global_p ? G2int_default_gsi_application : 
	    g2int_current_gsi_application();
    applications_tail = global_p ? G2int_all_gsi_applications : Nil;
    function = Nil;
  next_loop_1:
    function = ISVREF(ISVREF(application,(SI_Long)3L),IFIX(callback_index));
    if (function) {
	if ( !gsi_run_state_change_p)
	    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
		    G2int_gsi_run_state_direction_leaving_gsi,
		    G2int_gsi_run_state_type_callback,name_string);
	temp = callback_index;
	if ( !(FIXNUM_LE(FIX((SI_Long)-128L),temp) && FIXNUM_LE(temp,
		FIX((SI_Long)127L)))) {
	    if (ISVREF(ISVREF(application,(SI_Long)2L),
			IFIX(G2int_gsi_non_c))) {
		temp = callback_index;
		if (! !(FIXNUM_LE(FIX((SI_Long)-128L),temp) && 
			FIXNUM_LE(temp,FIX((SI_Long)127L))))
		    switch (INTEGER_TO_CHAR(temp)) {
		      case 6:
			inline_call_gsi_read_callback(function,
				FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2));
			break;
		      case 7:
			inline_call_gsi_write_callback(function,
				FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2));
			break;
		      case 8:
			inline_call_gsi_open_fd(function,FIXNUM_TO_LONG(arg1));
			break;
		      case 9:
			inline_call_gsi_close_fd(function,
				FIXNUM_TO_LONG(arg1));
			break;
		      case 23:
			inline_call_gsi_writing_fd(function,
				FIXNUM_TO_LONG(arg1));
			break;
		      case 24:
			inline_call_gsi_not_writing_fd(function,
				FIXNUM_TO_LONG(arg1));
			break;
		      case 10:
			result_1 = 
				LONG_TO_FIXNUM(inline_call_gsi_initialize_context(function,
				ISTRING(arg1),FIXNUM_TO_LONG(arg2)));
			break;
		      case 11:
			inline_call_gsi_receive_registration(function,arg1);
			break;
		      case 12:
			inline_call_gsi_receive_deregistrations(function,
				arg1,FIXNUM_TO_LONG(arg2));
			break;
		      case 13:
			inline_call_gsi_get_data(function,arg1,
				FIXNUM_TO_LONG(arg2));
			break;
		      case 14:
			inline_call_gsi_set_data(function,arg1,
				FIXNUM_TO_LONG(arg2));
			break;
		      case 15:
			inline_call_gsi_receive_message(function,
				ISTRING(arg1),FIXNUM_TO_LONG(arg2));
			break;
		      case 16:
			inline_call_gsi_run_state_change(function,
				FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2),
				ISTRING(arg3));
			break;
		      case 17:
			inline_call_gsi_error_handler(function,
				FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2),
				ISTRING(arg3));
			break;
		      case 18:
			inline_call_gsi_missing_procedure_handler(function,
				ISTRING(arg1));
			break;
		      default:
			break;
		    }
	    }
	    else {
		temp = callback_index;
		if (! !(FIXNUM_LE(FIX((SI_Long)-128L),temp) && 
			FIXNUM_LE(temp,FIX((SI_Long)127L))))
		    switch (INTEGER_TO_CHAR(temp)) {
		      case 6:
			inline_call_gsi_read_callback(function,
				FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2));
			break;
		      case 7:
			inline_call_gsi_write_callback(function,
				FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2));
			break;
		      case 8:
			inline_call_gsi_open_fd(function,FIXNUM_TO_LONG(arg1));
			break;
		      case 9:
			inline_call_gsi_close_fd(function,
				FIXNUM_TO_LONG(arg1));
			break;
		      case 23:
			inline_call_gsi_writing_fd(function,
				FIXNUM_TO_LONG(arg1));
			break;
		      case 24:
			inline_call_gsi_not_writing_fd(function,
				FIXNUM_TO_LONG(arg1));
			break;
		      case 10:
			result_1 = 
				LONG_TO_FIXNUM(inline_call_gsi_initialize_context(function,
				ISTRING(arg1),FIXNUM_TO_LONG(arg2)));
			break;
		      case 11:
			inline_call_gsi_receive_registration(function,arg1);
			break;
		      case 12:
			inline_call_gsi_receive_deregistrations(function,
				arg1,FIXNUM_TO_LONG(arg2));
			break;
		      case 13:
			inline_call_gsi_get_data(function,arg1,
				FIXNUM_TO_LONG(arg2));
			break;
		      case 14:
			inline_call_gsi_set_data(function,arg1,
				FIXNUM_TO_LONG(arg2));
			break;
		      case 15:
			inline_call_gsi_receive_message(function,
				ISTRING(arg1),FIXNUM_TO_LONG(arg2));
			break;
		      case 16:
			inline_call_gsi_run_state_change(function,
				FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2),
				ISTRING(arg3));
			break;
		      case 17:
			inline_call_gsi_error_handler(function,
				FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2),
				ISTRING(arg3));
			break;
		      case 18:
			inline_call_gsi_missing_procedure_handler(function,
				ISTRING(arg1));
			break;
		      default:
			break;
		    }
	    }
	}
	else
	    switch (INTEGER_TO_CHAR(temp)) {
	      case 0:
		inline_call_gsi_set_up(function);
		break;
	      case 1:
		result_1 = 
			LONG_TO_FIXNUM(inline_call_gsi_get_tcp_port(function));
		break;
	      case 2:
		inline_call_gsi_pause_context(function);
		break;
	      case 3:
		inline_call_gsi_resume_context(function);
		break;
	      case 21:
		inline_call_gsi_start_context(function);
		break;
	      case 22:
		inline_call_gsi_reset_context(function);
		break;
	      case 4:
		inline_call_gsi_shutdown_context(function);
		break;
	      case 5:
		inline_call_gsi_g2_poll(function);
		break;
	      case 19:
		inline_call_gsi_watchdog_function(function);
		break;
	      case 20:
		inline_call_gsi_idle(function);
		break;
	      default:
		if (ISVREF(ISVREF(application,(SI_Long)2L),
			IFIX(G2int_gsi_non_c))) {
		    temp = callback_index;
		    if (! !(FIXNUM_LE(FIX((SI_Long)-128L),temp) && 
			    FIXNUM_LE(temp,FIX((SI_Long)127L))))
			switch (INTEGER_TO_CHAR(temp)) {
			  case 6:
			    inline_call_gsi_read_callback(function,
				    FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2));
			    break;
			  case 7:
			    inline_call_gsi_write_callback(function,
				    FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2));
			    break;
			  case 8:
			    inline_call_gsi_open_fd(function,
				    FIXNUM_TO_LONG(arg1));
			    break;
			  case 9:
			    inline_call_gsi_close_fd(function,
				    FIXNUM_TO_LONG(arg1));
			    break;
			  case 23:
			    inline_call_gsi_writing_fd(function,
				    FIXNUM_TO_LONG(arg1));
			    break;
			  case 24:
			    inline_call_gsi_not_writing_fd(function,
				    FIXNUM_TO_LONG(arg1));
			    break;
			  case 10:
			    result_1 = 
				    LONG_TO_FIXNUM(inline_call_gsi_initialize_context(function,
				    ISTRING(arg1),FIXNUM_TO_LONG(arg2)));
			    break;
			  case 11:
			    inline_call_gsi_receive_registration(function,
				    arg1);
			    break;
			  case 12:
			    inline_call_gsi_receive_deregistrations(function,
				    arg1,FIXNUM_TO_LONG(arg2));
			    break;
			  case 13:
			    inline_call_gsi_get_data(function,arg1,
				    FIXNUM_TO_LONG(arg2));
			    break;
			  case 14:
			    inline_call_gsi_set_data(function,arg1,
				    FIXNUM_TO_LONG(arg2));
			    break;
			  case 15:
			    inline_call_gsi_receive_message(function,
				    ISTRING(arg1),FIXNUM_TO_LONG(arg2));
			    break;
			  case 16:
			    inline_call_gsi_run_state_change(function,
				    FIXNUM_TO_LONG(arg1),
				    FIXNUM_TO_LONG(arg2),ISTRING(arg3));
			    break;
			  case 17:
			    inline_call_gsi_error_handler(function,
				    FIXNUM_TO_LONG(arg1),
				    FIXNUM_TO_LONG(arg2),ISTRING(arg3));
			    break;
			  case 18:
			    inline_call_gsi_missing_procedure_handler(function,
				    ISTRING(arg1));
			    break;
			  default:
			    break;
			}
		}
		else {
		    temp = callback_index;
		    if (! !(FIXNUM_LE(FIX((SI_Long)-128L),temp) && 
			    FIXNUM_LE(temp,FIX((SI_Long)127L))))
			switch (INTEGER_TO_CHAR(temp)) {
			  case 6:
			    inline_call_gsi_read_callback(function,
				    FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2));
			    break;
			  case 7:
			    inline_call_gsi_write_callback(function,
				    FIXNUM_TO_LONG(arg1),FIXNUM_TO_LONG(arg2));
			    break;
			  case 8:
			    inline_call_gsi_open_fd(function,
				    FIXNUM_TO_LONG(arg1));
			    break;
			  case 9:
			    inline_call_gsi_close_fd(function,
				    FIXNUM_TO_LONG(arg1));
			    break;
			  case 23:
			    inline_call_gsi_writing_fd(function,
				    FIXNUM_TO_LONG(arg1));
			    break;
			  case 24:
			    inline_call_gsi_not_writing_fd(function,
				    FIXNUM_TO_LONG(arg1));
			    break;
			  case 10:
			    result_1 = 
				    LONG_TO_FIXNUM(inline_call_gsi_initialize_context(function,
				    ISTRING(arg1),FIXNUM_TO_LONG(arg2)));
			    break;
			  case 11:
			    inline_call_gsi_receive_registration(function,
				    arg1);
			    break;
			  case 12:
			    inline_call_gsi_receive_deregistrations(function,
				    arg1,FIXNUM_TO_LONG(arg2));
			    break;
			  case 13:
			    inline_call_gsi_get_data(function,arg1,
				    FIXNUM_TO_LONG(arg2));
			    break;
			  case 14:
			    inline_call_gsi_set_data(function,arg1,
				    FIXNUM_TO_LONG(arg2));
			    break;
			  case 15:
			    inline_call_gsi_receive_message(function,
				    ISTRING(arg1),FIXNUM_TO_LONG(arg2));
			    break;
			  case 16:
			    inline_call_gsi_run_state_change(function,
				    FIXNUM_TO_LONG(arg1),
				    FIXNUM_TO_LONG(arg2),ISTRING(arg3));
			    break;
			  case 17:
			    inline_call_gsi_error_handler(function,
				    FIXNUM_TO_LONG(arg1),
				    FIXNUM_TO_LONG(arg2),ISTRING(arg3));
			    break;
			  case 18:
			    inline_call_gsi_missing_procedure_handler(function,
				    ISTRING(arg1));
			    break;
			  default:
			    break;
			}
		}
		break;
	    }
	if ( !gsi_run_state_change_p)
	    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
		    G2int_gsi_run_state_direction_entering_gsi,
		    G2int_gsi_run_state_type_callback,name_string);
    }
    if ( !TRUEP(applications_tail))
	goto end_loop_1;
    application = FIRST(applications_tail);
    applications_tail = CDR(applications_tail);
    goto next_loop_1;
  end_loop_1:
    return VALUES_1(result_1);
    return VALUES_1(Qnil);
}

static Object Qg2int_handle_watchdog_task;  /* handle-watchdog-task */

static Object Qg2_defstruct_structure_name_schedule_task_g2_struct;  /* g2-defstruct-structure-name::schedule-task-g2-struct */

/* SHARED-GSI-WATCHDOG */
void g2int_shared_gsi_watchdog(function,period)
    Object function;
    int period;
{
    Object application, schedule_task_qm, old_structure_being_reclaimed, temp;
    Object future_task_schedule_modify_arg_8;
    Object future_task_schedule_modify_arg_11;
    Object def_structure_schedule_task_variable, task;
    char svref_new_value;
    double future_task_schedule_modify_arg_3, aref_new_value;

    x_note_fn_call(47,73);
    application = g2int_current_gsi_application();
    schedule_task_qm = ISVREF(application,(SI_Long)6L);
    if (schedule_task_qm) {
	if (EQ(schedule_task_qm,G2int_current_schedule_task))
	    G2int_current_schedule_task = Nil;
	if (ISVREF(schedule_task_qm,(SI_Long)6L))
	    g2int_cancel_and_reclaim_scheduled_queue_element_1(schedule_task_qm);
	inline_note_reclaim_cons(schedule_task_qm,Nil);
	old_structure_being_reclaimed = G2int_structure_being_reclaimed;
	G2int_structure_being_reclaimed = schedule_task_qm;
	g2int_reclaim_schedule_task_args(ISVREF(schedule_task_qm,(SI_Long)9L));
	SVREF(schedule_task_qm,FIX((SI_Long)9L)) = Nil;
	G2int_structure_being_reclaimed = old_structure_being_reclaimed;
	temp = G2int_chain_of_available_schedule_tasks;
	SVREF(schedule_task_qm,FIX((SI_Long)0L)) = temp;
	G2int_chain_of_available_schedule_tasks = schedule_task_qm;
    }
    temp = Nil;
    SVREF(application,FIX((SI_Long)6L)) = temp;
    temp = ISVREF(application,(SI_Long)3L);
    SVREF(temp,G2int_gsi_watchdog_function) = function;
    if ((SI_Long)0L < period) {
	future_task_schedule_modify_arg_3 = (double)((float)period) + 
		DFLOAT_ISAREF_1(G2int_current_real_time,(SI_Long)0L);
	future_task_schedule_modify_arg_8 = 
		SYMBOL_FUNCTION(Qg2int_handle_watchdog_task);
	future_task_schedule_modify_arg_11 = application;
	schedule_task_qm = ISVREF(application,(SI_Long)6L);
	if (schedule_task_qm) {
	    if (EQ(schedule_task_qm,G2int_current_schedule_task))
		G2int_current_schedule_task = Nil;
	    if (ISVREF(schedule_task_qm,(SI_Long)6L))
		g2int_cancel_and_reclaim_scheduled_queue_element_1(schedule_task_qm);
	    inline_note_reclaim_cons(schedule_task_qm,Nil);
	    old_structure_being_reclaimed = G2int_structure_being_reclaimed;
	    G2int_structure_being_reclaimed = schedule_task_qm;
	    g2int_reclaim_schedule_task_args(ISVREF(schedule_task_qm,
		    (SI_Long)9L));
	    SVREF(schedule_task_qm,FIX((SI_Long)9L)) = Nil;
	    G2int_structure_being_reclaimed = old_structure_being_reclaimed;
	    temp = G2int_chain_of_available_schedule_tasks;
	    SVREF(schedule_task_qm,FIX((SI_Long)0L)) = temp;
	    G2int_chain_of_available_schedule_tasks = schedule_task_qm;
	}
	def_structure_schedule_task_variable = 
		G2int_chain_of_available_schedule_tasks;
	if (def_structure_schedule_task_variable) {
	    G2int_chain_of_available_schedule_tasks = 
		    ISVREF(def_structure_schedule_task_variable,(SI_Long)0L);
	    SVREF(def_structure_schedule_task_variable,FIX((SI_Long)0L)) = 
		    Qg2_defstruct_structure_name_schedule_task_g2_struct;
	}
	else
	    def_structure_schedule_task_variable = 
		    g2int_make_permanent_schedule_task_structure_internal();
	inline_note_allocate_cons(def_structure_schedule_task_variable,Nil);
	SVREF(def_structure_schedule_task_variable,FIX((SI_Long)2L)) = Nil;
	SVREF(def_structure_schedule_task_variable,FIX((SI_Long)9L)) = Nil;
	task = def_structure_schedule_task_variable;
	temp = ISVREF(task,(SI_Long)1L);
	DFLOAT_ISASET_1(temp,(SI_Long)0L,future_task_schedule_modify_arg_3);
	temp = ISVREF(task,(SI_Long)1L);
	aref_new_value = -1.0;
	DFLOAT_ISASET_1(temp,(SI_Long)1L,aref_new_value);
	svref_new_value =  !TRUEP(T);
	SVREF(task,FIX((SI_Long)3L)) = svref_new_value ? T : Nil;
	SVREF(task,FIX((SI_Long)4L)) = G2int_highest_system_priority;
	SVREF(task,FIX((SI_Long)5L)) = Nil;
	SVREF(task,FIX((SI_Long)9L)) = Nil;
	SVREF(task,FIX((SI_Long)7L)) = Qg2int_handle_watchdog_task;
	SVREF(task,FIX((SI_Long)8L)) = future_task_schedule_modify_arg_8;
	ISVREF(task,(SI_Long)10L) = FIX((SI_Long)1L);
	SVREF(task,FIX((SI_Long)11L)) = future_task_schedule_modify_arg_11;
	g2int_future_task_schedule_2(task);
	SVREF(application,FIX((SI_Long)6L)) = task;
    }
}

static Object string_constant_31;  /* "gsi_watchdog" */

/* GSI-WATCHDOG */
DLLEXPORT void gsi_watchdog(function,period)
    Object function;
    int period;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,74);
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_31);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_watchdog(function,period);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_watchdog(function,period);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_31);
}

/* HANDLE-WATCHDOG-TASK */
Object g2int_handle_watchdog_task(application)
    Object application;
{
    Object schedule_task_qm, old_structure_being_reclaimed, svref_new_value;

    x_note_fn_call(47,75);
    schedule_task_qm = ISVREF(application,(SI_Long)6L);
    if (schedule_task_qm) {
	if (EQ(schedule_task_qm,G2int_current_schedule_task))
	    G2int_current_schedule_task = Nil;
	if (ISVREF(schedule_task_qm,(SI_Long)6L))
	    g2int_cancel_and_reclaim_scheduled_queue_element_1(schedule_task_qm);
	inline_note_reclaim_cons(schedule_task_qm,Nil);
	old_structure_being_reclaimed = G2int_structure_being_reclaimed;
	G2int_structure_being_reclaimed = schedule_task_qm;
	g2int_reclaim_schedule_task_args(ISVREF(schedule_task_qm,(SI_Long)9L));
	SVREF(schedule_task_qm,FIX((SI_Long)9L)) = Nil;
	G2int_structure_being_reclaimed = old_structure_being_reclaimed;
	svref_new_value = G2int_chain_of_available_schedule_tasks;
	SVREF(schedule_task_qm,FIX((SI_Long)0L)) = svref_new_value;
	G2int_chain_of_available_schedule_tasks = schedule_task_qm;
    }
    svref_new_value = Nil;
    SVREF(application,FIX((SI_Long)6L)) = svref_new_value;
    g2int_call_gsi_callback(1,G2int_gsi_watchdog_function);
    return VALUES_1(Nil);
}

/* SHARED-GSI-INITIALIZE-ERROR-VARIABLE */
void g2int_shared_gsi_initialize_error_variable(error_variable_location)
    Object error_variable_location;
{
    Object svref_arg_1;

    x_note_fn_call(47,76);
    svref_arg_1 = g2int_current_gsi_application();
    SVREF(svref_arg_1,FIX((SI_Long)5L)) = error_variable_location;
}

static Object string_constant_32;  /* "gsi_initialize_error_variable" */

/* GSI-INITIALIZE-ERROR-VARIABLE */
DLLEXPORT void gsi_initialize_error_variable(error_variable_location)
    Object error_variable_location;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,77);
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_32);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_initialize_error_variable(error_variable_location);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_initialize_error_variable(error_variable_location);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_32);
}

Object G2int_gsi_use_references_p = UNBOUND;

Object G2int_gsi_references_in_use = UNBOUND;

/* SET-GSI-OPTION */
Object g2int_set_gsi_option(option_index,value)
    Object option_index, value;
{
    Object svref_arg_1;

    x_note_fn_call(47,78);
    if ( !((SI_Long)0L <= IFIX(option_index) && FIXNUM_LT(option_index,
	    G2int_gsi_number_of_options)))
	return VALUES_1(Nil);
    svref_arg_1 = EQ(Klocal,ISVREF(G2int_gsi_global_option_array,
	    IFIX(option_index))) ? ISVREF(g2int_current_gsi_application(),
	    (SI_Long)2L) : G2int_gsi_global_option_array;
    SVREF(svref_arg_1,option_index) = value;
    if (! !(FIXNUMP(option_index) && FIXNUM_LE(FIX((SI_Long)-128L),
	    option_index) && FIXNUM_LE(option_index,FIX((SI_Long)127L))))
	switch (INTEGER_TO_CHAR(option_index)) {
	  case 1:
	    Gc_silence = value;
	    break;
	  case 6:
	    G2int_gsi_wide_api_p = value;
	    break;
	  case 11:
	    G2int_gsi_use_references_p = value;
	    G2int_gsi_references_in_use = G2int_gsi_use_references_p ? 
		    FIX((SI_Long)1L) : FIX((SI_Long)0L);
	    break;
	  case 14:
	    G2int_gsi_protect_inner_calls_p = value;
	    break;
	  default:
	    break;
	}
    return VALUES_1(T);
}

static Object Qg2int_user;         /* user */

static Object Qg2int_gsi;          /* gsi */

/* DEFAULT-OWNER-FOR-GSI-OBJECTS */
Object g2int_default_owner_for_gsi_objects()
{
    x_note_fn_call(47,79);
    return VALUES_1(g2int_gsi_option_is_set_p(G2int_gsi_user_owns_gsi_items) 
	    ? Qg2int_user : Qg2int_gsi);
}

static Object Qg2int_gsi_set_option;  /* |gsi_set_option| */

/* SHARED-GSI-SET-OPTION */
void g2int_shared_gsi_set_option(option_index)
    int option_index;
{
    x_note_fn_call(47,80);
    if ( !TRUEP(g2int_set_gsi_option(INT_TO_FIXNUM(option_index),T))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_invalid_option_index,
		INT_TO_FIXNUM(option_index),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_option,Qerror,T);
	goto end_shared_gsi_set_option;
    }
  end_shared_gsi_set_option:;
}

static Object string_constant_33;  /* "gsi_set_option" */

/* GSI-SET-OPTION */
DLLEXPORT void gsi_set_option(option_index)
    int option_index;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,81);
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_33);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_option(option_index);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_option(option_index);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_33);
}

static Object Qg2int_gsi_reset_option;  /* |gsi_reset_option| */

/* SHARED-GSI-RESET-OPTION */
void g2int_shared_gsi_reset_option(option_index)
    int option_index;
{
    x_note_fn_call(47,82);
    if ( !TRUEP(g2int_set_gsi_option(INT_TO_FIXNUM(option_index),Nil))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_invalid_option_index,
		INT_TO_FIXNUM(option_index),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_reset_option,Qerror,T);
	goto end_shared_gsi_reset_option;
    }
  end_shared_gsi_reset_option:;
}

static Object string_constant_34;  /* "gsi_reset_option" */

/* GSI-RESET-OPTION */
DLLEXPORT void gsi_reset_option(option_index)
    int option_index;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,83);
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_34);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_reset_option(option_index);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_reset_option(option_index);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_34);
}

static Object Qg2int_gsi_option_is_set;  /* |gsi_option_is_set| */

/* SHARED-GSI-OPTION-IS-SET */
int g2int_shared_gsi_option_is_set(option_index)
    int option_index;
{
    int result_1, gsi_fc_result;

    x_note_fn_call(47,84);
    if ( !((SI_Long)0L <= option_index && option_index < 
	    IFIX(G2int_gsi_number_of_options))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_invalid_option_index,
		INT_TO_FIXNUM(option_index),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_option_is_set,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_option_is_set;
    }
    gsi_fc_result = ISVREF(EQ(Klocal,ISVREF(G2int_gsi_global_option_array,
	    option_index)) ? ISVREF(g2int_current_gsi_application(),
	    (SI_Long)2L) : G2int_gsi_global_option_array,option_index) ? 
	    (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_option_is_set:;
    return result_1;
}

static Object string_constant_35;  /* "gsi_option_is_set" */

/* GSI-OPTION-IS-SET */
DLLEXPORT int gsi_option_is_set(option_index)
    int option_index;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    int result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,85);
    result_1 = FIX((SI_Long)0L);
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_35);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    INT_TO_FIXNUM(g2int_shared_gsi_option_is_set(option_index));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    INT_TO_FIXNUM(g2int_shared_gsi_option_is_set(option_index));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_35);
    result_2 = FIXNUM_TO_INT(result_1);
    return result_2;
}

/* GSI-OPTION-IS-SET-P */
Object g2int_gsi_option_is_set_p(option_index)
    Object option_index;
{
    Object temp;

    x_note_fn_call(47,86);
    temp = gsi_option_is_set(FIXNUM_TO_INT(option_index)) == (SI_Long)1L ? 
	    T : Nil;
    return VALUES_1(temp);
}

/* FILTER-TEXT-FOR-GSI-P */
Object g2int_filter_text_for_gsi_p()
{
    Object temp;

    x_note_fn_call(47,87);
    temp = g2int_gsi_option_is_set_p(G2int_gsi_string_check);
    return VALUES_1(temp);
}

Object G2int_in_error_handler = UNBOUND;

static Object string_constant_36;  /* "~%~a ~a occurred in ~a" */

static Object Qg2int_warning;      /* warning */

static Object string_constant_37;  /* "Warning" */

static Object string_constant_38;  /* "Error" */

static Object string_constant_39;  /* "~%  ~a~%~%" */

static Object string_constant_40;  /* "~%Not calling the user error handler, because a user error handler is already running.~2%" */

static Object Qg2int_fatal;        /* fatal */

static Object Qg2int_connection;   /* connection */

/* GSI-HANDLE-ERROR-1 */
Object g2int_gsi_handle_error_1(originating_function,severity,
	    inhibit_non_local_exit_p)
    Object originating_function, severity, inhibit_non_local_exit_p;
{
    Object in_error_handler, scheduler_enabled_qm, temp;
    char display_events_were_enabled;
    Declare_stack_pointer;
    Declare_catch(1);
    Declare_special(2);
    Object result;

    x_note_fn_call(47,88);
    SAVE_STACK();
    if ( !TRUEP(g2int_gsi_option_is_set_p(G2int_gsi_suppress_output))) {
	g2int_notify_user_at_console(4,string_constant_36,EQ(severity,
		Qg2int_warning) ? string_constant_37 : string_constant_38,
		G2int_gsi_most_recent_error,originating_function);
	g2int_notify_user_at_console(2,string_constant_39,
		G2int_gsi_most_recent_error_message);
    }
    if (G2int_in_error_handler)
	g2int_notify_user_at_console(1,string_constant_40);
    else {
	in_error_handler = T;
	PUSH_SPECIAL(G2int_in_error_handler,in_error_handler,1);
	  display_events_were_enabled = (SI_Long)0L != 
		  ne_display_events_enabled();
	  ne_disable_display_events();
	  if (PUSH_UNWIND_PROTECT(0)) {
	      scheduler_enabled_qm = Nil;
	      PUSH_SPECIAL(G2int_starscheduler_enabledqmstar,scheduler_enabled_qm,
		      0);
		temp = g2int_gsi_current_context_number();
		g2int_call_gsi_callback(4,G2int_gsi_error_handler,temp,
			G2int_gsi_most_recent_error,
			G2int_gsi_most_recent_error_message);
	      POP_SPECIAL();
	  }
	  POP_UNWIND_PROTECT(0);
	  if (display_events_were_enabled)
	      ne_enable_display_events();
	  CONTINUE_UNWINDING(0);
	POP_SPECIAL();
    }
    if ( !TRUEP(inhibit_non_local_exit_p)) {
	if (EQ(severity,Qg2int_fatal)) {
	    result = g2int_g2_unrecoverable_error_exit();
	    RESTORE_STACK();
	    return result;
	}
	else if (EQ(severity,Qerror)) {
	    result = g2int_gsi_continue_from_error();
	    RESTORE_STACK();
	    return result;
	}
	else if (EQ(severity,Qg2int_connection)) {
	    g2int_shutdown_icp_socket_connection(1,G2int_current_icp_socket);
	    result = g2int_gsi_continue_from_error();
	    RESTORE_STACK();
	    return result;
	}
	else if (EQ(severity,Qg2int_warning) || EQ(severity,Qnil)) {
	    RESTORE_STACK();
	    return VALUES_1(Nil);
	}
	else {
	    RESTORE_STACK();
	    return VALUES_1(Qnil);
	}
    }
    else {
	RESTORE_STACK();
	return VALUES_1(Nil);
    }
}

/* CLEAR-GSI-ERROR-MESSAGE */
Object g2int_clear_gsi_error_message()
{
    x_note_fn_call(47,89);
    if (STRINGP(G2int_gsi_most_recent_error_message))
	g2int_reclaim_gensym_string(G2int_gsi_most_recent_error_message);
    else if (g2int_text_string_p(G2int_gsi_most_recent_error_message))
	g2int_reclaim_text_string(G2int_gsi_most_recent_error_message);
    G2int_gsi_most_recent_error_remote_procedure_identifier = Nil;
    G2int_gsi_most_recent_error_message = Nil;
    return VALUES_1(G2int_gsi_most_recent_error_message);
}

static Object array_constant;      /* # */

static Object Qg2int_tformat_text_string;  /* tformat-text-string */

static Object string_constant_41;  /* "~%Undefined error - please notify Gensym customer support.~%~%" */

/* SET-GSI-ERROR-MESSAGE-1 */
Object g2int_set_gsi_error_message_1(signal_or_internal_error_qm,
	    error_code,arg1,arg2,arg3,arg4,arg5,arg6)
    Object signal_or_internal_error_qm, error_code, arg1, arg2, arg3, arg4;
    Object arg5, arg6;
{
    Object error_message_qm, temp, adjusted_error_code, code;
    Object error_variable_location, temp_1;

    x_note_fn_call(47,90);
    if (FIXNUM_EQ(error_code,G2int_gsi_custom_user_error))
	error_message_qm = Nil;
    else {
	temp = g2int_assq_function(error_code,G2int_gsi_error_code_table);
	error_message_qm = SECOND(temp);
    }
    adjusted_error_code = FIXNUM_EQ(error_code,
	    G2int_gsi_custom_user_error) ? arg1 : error_code;
    code = adjusted_error_code;
    g2int_clear_gsi_error_message();
    G2int_gsi_most_recent_error = code;
    G2int_gsi_most_recent_error_remote_procedure_identifier = 
	    G2int_current_remote_procedure_identifier;
    error_variable_location = ISVREF(g2int_current_gsi_application(),
	    (SI_Long)5L);
    if (error_variable_location) {
	inline_assign_ref(error_variable_location,IFIX(code));
	temp = T;
    }
    else
	temp = Nil;
    if (signal_or_internal_error_qm)
	G2int_gsi_most_recent_error_message = 
		g2int_copy_constant_wide_string_given_length(array_constant,
		FIX((SI_Long)59L));
    else if (error_message_qm)
	G2int_gsi_most_recent_error_message = apply(8,
		SYMBOL_FUNCTION(Qg2int_tformat_text_string),
		error_message_qm,arg1,arg2,arg3,arg4,arg5,arg6);
    else if (STRINGP(arg2))
	G2int_gsi_most_recent_error_message = g2int_copy_gensym_string(arg2);
    else if (g2int_text_string_p(arg2))
	G2int_gsi_most_recent_error_message = g2int_copy_text_string(arg2);
    else
	G2int_gsi_most_recent_error_message = g2int_tformat_text_string(1,
		string_constant_41);
    if ( !(G2int_gsi_wide_api_p || 
	    STRINGP(G2int_gsi_most_recent_error_message))) {
	temp_1 = 
		g2int_wide_string_to_gensym_string_for_gsi(G2int_gsi_most_recent_error_message);
	g2int_reclaim_text_string(G2int_gsi_most_recent_error_message);
	G2int_gsi_most_recent_error_message = temp_1;
    }
    return VALUES_1(temp);
}

/* C-STRING-TO-GSI-STRING */
Object g2int_c_string_to_gsi_string(c_string)
    Object c_string;
{
    x_note_fn_call(47,91);
    if (G2int_gsi_wide_api_p)
	return g2int_c_string_to_text_string(c_string);
    else
	return g2int_c_string_to_gensym_string(c_string);
}

/* C-WIDE-STRING-TO-GSI-STRING */
Object g2int_c_wide_string_to_gsi_string(c_wide_string)
    Object c_wide_string;
{
    x_note_fn_call(47,92);
    if (G2int_gsi_wide_api_p)
	return g2int_c_wide_string_to_text_string(c_wide_string);
    else
	return g2int_c_wide_string_to_gensym_string(c_wide_string);
}

/* CONVERT-VALUE-TO-GSI-VALUE */
Object g2int_convert_value_to_gsi_value(value)
    Object value;
{
    Object temp;

    x_note_fn_call(47,93);
    if ( !(g2int_text_string_p(value) &&  !TRUEP(G2int_gsi_wide_api_p)))
	return VALUES_1(value);
    temp = g2int_wide_string_to_gensym_string_for_gsi(value);
    g2int_reclaim_text_string(value);
    return VALUES_1(temp);
}

/* CONVERT-GSI-VALUE-TO-VALUE */
Object g2int_convert_gsi_value_to_value(value)
    Object value;
{
    Object temp;

    x_note_fn_call(47,94);
    temp =  !STRINGP(value) ? value : 
	    g2int_gensym_string_to_wide_string_for_gsi(value);
    return VALUES_1(temp);
}

Object G2int_gsi_text_conversion_style_list = UNBOUND;

static Object Qg2int_wide_string;  /* wide-string */

static Object Qg2int_gensym_string;  /* gensym-string */

static Object Kunicode_line_separator_export_translation;  /* :unicode-line-separator-export-translation */

static Object Khan_unification_mode;  /* :han-unification-mode */

/* MAKE-TRANSCODE-PURPOSE-ARRAY */
Object g2int_make_transcode_purpose_array(wide_p,style_list)
    Object wide_p, style_list;
{
    Object array, string_type_for_export, style, ab_loop_list_;
    Object external_character_set, plist;
    Object unicode_line_separator_export_translation, han_unification_mode;
    Object svref_new_value, temp;
    SI_Long i;

    x_note_fn_call(47,95);
    array = make_array(1,length(style_list));
    string_type_for_export = wide_p ? Qg2int_wide_string : 
	    Qg2int_gensym_string;
    i = (SI_Long)0L;
    style = Nil;
    ab_loop_list_ = style_list;
    external_character_set = Nil;
    plist = Nil;
    unicode_line_separator_export_translation = Nil;
    han_unification_mode = Nil;
  next_loop:
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    style = M_CAR(ab_loop_list_);
    ab_loop_list_ = M_CDR(ab_loop_list_);
    external_character_set = CONSP(style) ? CAR(style) : style;
    plist = CONSP(style) ? CDR(style) : Nil;
    unicode_line_separator_export_translation = 
	    g2int_getfq_function_no_default(plist,
	    Kunicode_line_separator_export_translation);
    han_unification_mode = g2int_getfq_function_no_default(plist,
	    Khan_unification_mode);
    svref_new_value = g2int_create_transcode_text_conversion_style(Nil,Nil,
	    external_character_set,Nil,
	    unicode_line_separator_export_translation,han_unification_mode,
	    string_type_for_export);
    ISVREF(array,i) = svref_new_value;
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:
    temp = array;
    goto end;
    temp = Qnil;
  end:;
    return VALUES_1(temp);
}

Object G2int_gsi_gensym_string_text_conversion_style_array = UNBOUND;

Object G2int_gsi_wide_string_text_conversion_style_array = UNBOUND;

/* TEXT-CONVERSION-STYLE-FOR-GSI */
Object g2int_text_conversion_style_for_gsi(style_code,wide_string_p)
    Object style_code, wide_string_p;
{
    Object array, temp;

    x_note_fn_call(47,96);
    array = wide_string_p ? 
	    G2int_gsi_wide_string_text_conversion_style_array : 
	    G2int_gsi_gensym_string_text_conversion_style_array;
    temp = FIXNUMP(style_code) && (SI_Long)0L <= IFIX(style_code) && 
	    FIXNUM_LT(style_code,length(array)) ? ISVREF(array,
	    IFIX(style_code)) : Nil;
    return VALUES_1(temp);
}

Object G2int_current_gsi_string_conversion_style_code = UNBOUND;

/* CURRENT-GSI-STRING-CONVERSION-STYLE */
Object g2int_current_gsi_string_conversion_style()
{
    Object temp;

    x_note_fn_call(47,97);
    if (G2int_gsi_wide_api_p)
	temp = FIX((SI_Long)0L);
    else {
	temp = G2int_current_gsi_string_conversion_style_code;
	if (temp);
	else
	    temp = g2int_filter_text_for_gsi_p() ? FIX((SI_Long)1L) : 
		    FIX((SI_Long)0L);
    }
    return VALUES_1(temp);
}

/* SHARED-GSI-STRING-CONVERSION-STYLE */
SI_Long g2int_shared_gsi_string_conversion_style()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,98);
    gsi_fc_result = 
	    FIXNUM_TO_LONG(g2int_current_gsi_string_conversion_style());
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_42;  /* "gsi_string_conversion_style" */

/* GSI-STRING-CONVERSION-STYLE */
DLLEXPORT SI_Long gsi_string_conversion_style()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,99);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_42);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_string_conversion_style());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_42);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_string_conversion_style;  /* |gsi_set_string_conversion_style| */

/* SHARED-GSI-SET-STRING-CONVERSION-STYLE */
void g2int_shared_gsi_set_string_conversion_style(gsi_fc_outer_style)
    SI_Long gsi_fc_outer_style;
{
    Object style;
    SI_Long value;

    x_note_fn_call(47,100);
    value = gsi_fc_outer_style;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_string_conversion_style,
		Qerror,T);
	goto end_shared_gsi_set_string_conversion_style;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_string_conversion_style,
		Qerror,T);
	goto end_shared_gsi_set_string_conversion_style;
    }
    style = LONG_TO_FIXNUM(value);
    if (g2int_text_conversion_style_for_gsi(style,G2int_gsi_wide_api_p))
	G2int_current_gsi_string_conversion_style_code = style;
    else {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_unknown_string_conversion_style,Nil,Nil,Nil,Nil,
		Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_string_conversion_style,
		Qerror,T);
	goto end_shared_gsi_set_string_conversion_style;
    }
  end_shared_gsi_set_string_conversion_style:;
}

static Object string_constant_43;  /* "gsi_set_string_conversion_style" */

/* GSI-SET-STRING-CONVERSION-STYLE */
DLLEXPORT void gsi_set_string_conversion_style(style)
    SI_Long style;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,101);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_43);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_string_conversion_style(style);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_43);
}

/* GSI-LAST-CONVERTED-STRING */
Object g2int_gsi_last_converted_string()
{
    Object icp_socket, socket_extension_data_qm, temp;

    x_note_fn_call(47,102);
    icp_socket = G2int_current_icp_socket;
    socket_extension_data_qm = icp_socket ? ISVREF(icp_socket,
	    (SI_Long)29L) : Nil;
    if (socket_extension_data_qm)
	temp = ISVREF(socket_extension_data_qm,(SI_Long)10L);
    else {
	temp = G2int_current_gsi_application;
	if (temp);
	else
	    temp = G2int_default_gsi_application;
	temp = ISVREF(temp,(SI_Long)7L);
    }
    return VALUES_1(temp);
}

/* GSI-SET-LAST-CONVERTED-STRING */
Object g2int_gsi_set_last_converted_string(string_1)
    Object string_1;
{
    Object icp_socket, socket_extension_data_qm, temp, svref_arg_1;

    x_note_fn_call(47,103);
    icp_socket = G2int_current_icp_socket;
    socket_extension_data_qm = icp_socket ? ISVREF(icp_socket,
	    (SI_Long)29L) : Nil;
    if (socket_extension_data_qm)
	temp = SVREF(socket_extension_data_qm,FIX((SI_Long)10L)) = string_1;
    else {
	svref_arg_1 = G2int_current_gsi_application;
	if (svref_arg_1);
	else
	    svref_arg_1 = G2int_default_gsi_application;
	temp = SVREF(svref_arg_1,FIX((SI_Long)7L)) = string_1;
    }
    return VALUES_1(temp);
}

static Object Qg2int_gsi_convert_str_to_ustr;  /* |gsi_convert_str_to_ustr| */

/* SHARED-GSI-CONVERT-STR-TO-USTR */
Object g2int_shared_gsi_convert_str_to_ustr(wide_api_p,gsi_fc_outer_string,
	    gsi_fc_outer_style)
    Object wide_api_p, gsi_fc_outer_string;
    SI_Long gsi_fc_outer_style;
{
    Object string_1, result_1, style, old_string, gsi_fc_result;
    SI_Long value;

    x_note_fn_call(47,104);
    string_1 = g2int_c_string_to_gensym_string(gsi_fc_outer_string);
    value = gsi_fc_outer_style;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_convert_str_to_ustr,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_convert_str_to_ustr;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_convert_str_to_ustr,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_convert_str_to_ustr;
    }
    style = LONG_TO_FIXNUM(value);
    old_string = g2int_gsi_last_converted_string();
    if (old_string)
	g2int_reclaim_text_or_gensym_string(old_string);
    gsi_fc_result = 
	    g2int_gsi_set_last_converted_string(g2int_import_text_string_per_text_conversion_style(4,
	    string_1,g2int_text_conversion_style_for_gsi(style,Nil),Nil,Nil));
    g2int_reclaim_if_text_or_gensym_string_function(string_1);
    result_1 = g2int_lisp_string_to_c_wide_string(gsi_fc_result);
  end_shared_gsi_convert_str_to_ustr:;
    return result_1;
}

static Object string_constant_44;  /* "gsi_convert_str_to_ustr" */

/* GSI-CONVERT-STR-TO-USTR */
DLLEXPORT Object gsi_convert_str_to_ustr(string_1,style)
    Object string_1;
    SI_Long style;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,105);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_44);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_convert_str_to_ustr(G2int_gsi_wide_api_p,
		    string_1,style);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_convert_str_to_ustr(G2int_gsi_wide_api_p,
			    string_1,style);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_44);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_convert_wstr_to_ustr;  /* |gsi_convert_wstr_to_ustr| */

/* SHARED-GSI-CONVERT-WSTR-TO-USTR */
Object g2int_shared_gsi_convert_wstr_to_ustr(wide_api_p,
	    gsi_fc_outer_string,gsi_fc_outer_style)
    Object wide_api_p, gsi_fc_outer_string;
    SI_Long gsi_fc_outer_style;
{
    Object string_1, result_1, style, old_string, gsi_fc_result;
    SI_Long value;

    x_note_fn_call(47,106);
    string_1 = g2int_c_wide_string_to_text_string(gsi_fc_outer_string);
    value = gsi_fc_outer_style;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_convert_wstr_to_ustr,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_convert_wstr_to_ustr;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_convert_wstr_to_ustr,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_convert_wstr_to_ustr;
    }
    style = LONG_TO_FIXNUM(value);
    old_string = g2int_gsi_last_converted_string();
    if (old_string)
	g2int_reclaim_text_or_gensym_string(old_string);
    gsi_fc_result = 
	    g2int_gsi_set_last_converted_string(g2int_import_text_string_per_text_conversion_style(4,
	    string_1,g2int_text_conversion_style_for_gsi(style,T),Nil,Nil));
    g2int_reclaim_if_text_or_gensym_string_function(string_1);
    result_1 = g2int_lisp_string_to_c_wide_string(gsi_fc_result);
  end_shared_gsi_convert_wstr_to_ustr:;
    return result_1;
}

static Object string_constant_45;  /* "gsi_convert_wstr_to_ustr" */

/* GSI-CONVERT-WSTR-TO-USTR */
DLLEXPORT Object gsi_convert_wstr_to_ustr(string_1,style)
    Object string_1;
    SI_Long style;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,107);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_45);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_convert_wstr_to_ustr(G2int_gsi_wide_api_p,
		    string_1,style);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_convert_wstr_to_ustr(G2int_gsi_wide_api_p,
			    string_1,style);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_45);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_convert_ustr_to_str;  /* |gsi_convert_ustr_to_str| */

/* SHARED-GSI-CONVERT-USTR-TO-STR */
Object g2int_shared_gsi_convert_ustr_to_str(wide_api_p,gsi_fc_outer_string,
	    gsi_fc_outer_style)
    Object wide_api_p, gsi_fc_outer_string;
    SI_Long gsi_fc_outer_style;
{
    Object string_1, result_1, style, old_string, gsi_fc_result;
    SI_Long value;

    x_note_fn_call(47,108);
    string_1 = g2int_c_wide_string_to_text_string(gsi_fc_outer_string);
    value = gsi_fc_outer_style;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_convert_ustr_to_str,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_convert_ustr_to_str;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_convert_ustr_to_str,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_convert_ustr_to_str;
    }
    style = LONG_TO_FIXNUM(value);
    old_string = g2int_gsi_last_converted_string();
    if (old_string)
	g2int_reclaim_text_or_gensym_string(old_string);
    gsi_fc_result = 
	    g2int_gsi_set_last_converted_string(g2int_export_text_string_per_text_conversion_style(4,
	    string_1,g2int_text_conversion_style_for_gsi(style,Nil),Nil,Nil));
    g2int_reclaim_if_text_or_gensym_string_function(string_1);
    result_1 = g2int_lisp_string_to_c_string(gsi_fc_result);
  end_shared_gsi_convert_ustr_to_str:;
    return result_1;
}

static Object string_constant_46;  /* "gsi_convert_ustr_to_str" */

/* GSI-CONVERT-USTR-TO-STR */
DLLEXPORT Object gsi_convert_ustr_to_str(string_1,style)
    Object string_1;
    SI_Long style;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,109);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_46);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_convert_ustr_to_str(G2int_gsi_wide_api_p,
		    string_1,style);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_convert_ustr_to_str(G2int_gsi_wide_api_p,
			    string_1,style);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_46);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_convert_ustr_to_wstr;  /* |gsi_convert_ustr_to_wstr| */

/* SHARED-GSI-CONVERT-USTR-TO-WSTR */
Object g2int_shared_gsi_convert_ustr_to_wstr(wide_api_p,
	    gsi_fc_outer_string,gsi_fc_outer_style)
    Object wide_api_p, gsi_fc_outer_string;
    SI_Long gsi_fc_outer_style;
{
    Object string_1, result_1, style, old_string, gsi_fc_result;
    SI_Long value;

    x_note_fn_call(47,110);
    string_1 = g2int_c_string_to_gensym_string(gsi_fc_outer_string);
    value = gsi_fc_outer_style;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_convert_ustr_to_wstr,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_convert_ustr_to_wstr;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_convert_ustr_to_wstr,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_convert_ustr_to_wstr;
    }
    style = LONG_TO_FIXNUM(value);
    old_string = g2int_gsi_last_converted_string();
    if (old_string)
	g2int_reclaim_text_or_gensym_string(old_string);
    gsi_fc_result = 
	    g2int_gsi_set_last_converted_string(g2int_export_text_string_per_text_conversion_style(4,
	    string_1,g2int_text_conversion_style_for_gsi(style,T),Nil,Nil));
    g2int_reclaim_if_text_or_gensym_string_function(string_1);
    result_1 = g2int_lisp_string_to_c_wide_string(gsi_fc_result);
  end_shared_gsi_convert_ustr_to_wstr:;
    return result_1;
}

static Object string_constant_47;  /* "gsi_convert_ustr_to_wstr" */

/* GSI-CONVERT-USTR-TO-WSTR */
DLLEXPORT Object gsi_convert_ustr_to_wstr(string_1,style)
    Object string_1;
    SI_Long style;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,111);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_47);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_convert_ustr_to_wstr(G2int_gsi_wide_api_p,
		    string_1,style);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_convert_ustr_to_wstr(G2int_gsi_wide_api_p,
			    string_1,style);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_47);
    result_2 = result_1;
    return result_2;
}

/* GSI-DISPLACED-ARRAY-FROM-C-CONTENTS */
Object g2int_gsi_displaced_array_from_c_contents(c_array,count_1)
    Object c_array, count_1;
{
    Object temporary_array, c_pointer, svref_new_value;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,112);
    temporary_array = g2int_gsi_allocate_managed_array(FIXNUM_ADD1(count_1));
    c_pointer = c_array;
    i = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = IFIX(FIXNUM_ADD1(count_1));
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    svref_new_value = inline_dereference_c_pointer(c_pointer);
    ISVREF(temporary_array,i) = svref_new_value;
    c_pointer = inline_increment_c_pointer(c_pointer);
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    return VALUES_1(temporary_array);
}

static Object Qg2int_rpc_arg_list;  /* rpc-arg-list */

/* GSI-PUSH-ONTO-APPROPRIATE-LIST */
Object g2int_gsi_push_onto_appropriate_list varargs_1(int, n)
{
    Object new_thing;
    Object gsi_instance_qm, gensym_push_modify_macro_arg, car_1;
    Object gsi_instance_extension, cdr_1, temp, svref_new_value;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,113);
    INIT_ARGS_nonrelocating();
    new_thing = REQUIRED_ARG_nonrelocating();
    gsi_instance_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    if (gsi_instance_qm) {
	gensym_push_modify_macro_arg = new_thing;
	car_1 = gensym_push_modify_macro_arg;
	gsi_instance_extension = ISVREF(gsi_instance_qm,(SI_Long)3L);
	cdr_1 = gsi_instance_extension ? ISVREF(gsi_instance_extension,
		(SI_Long)14L) : Nil;
	temp = g2int_gensym_cons_1(car_1,cdr_1);
	gsi_instance_extension = ISVREF(gsi_instance_qm,(SI_Long)3L);
	if ( !TRUEP(gsi_instance_extension)) {
	    gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	    SVREF(gsi_instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
	}
	SVREF(gsi_instance_extension,FIX((SI_Long)14L)) = temp;
    }
    else if (EQ(G2int_gsi_reclaim_list_level,Qg2int_rpc_arg_list)) {
	temp = ISVREF(G2int_current_receiving_resumable_object,(SI_Long)9L);
	gensym_push_modify_macro_arg = new_thing;
	car_1 = gensym_push_modify_macro_arg;
	cdr_1 = ISVREF(temp,(SI_Long)7L);
	svref_new_value = g2int_gensym_cons_1(car_1,cdr_1);
	SVREF(temp,FIX((SI_Long)7L)) = svref_new_value;
    }
    else
	G2int_gsi_reclaim_listqm = g2int_gensym_cons_1(new_thing,
		G2int_gsi_reclaim_listqm);
    return VALUES_1(new_thing);
}

static Object Qg2int_gsi_icp_facility;  /* gsi_icp_facility */

/* SIGNAL-GSI-ICP-MESSAGE-TOO-LONG-ERROR */
Object g2int_signal_gsi_icp_message_too_long_error()
{
    x_note_fn_call(47,114);
    g2int_gsi_connection_error(2,Qg2int_gsi_icp_facility,
	    G2int_gsi_icp_message_too_long);
    return VALUES_1(Nil);
}

/* SIGNAL-GSI-ICP-MESSAGE-OUT-OF-SYNCH-CASE-2-ERROR */
Object g2int_signal_gsi_icp_message_out_of_synch_case_2_error()
{
    x_note_fn_call(47,115);
    g2int_gsi_connection_error(2,Qg2int_gsi_icp_facility,
	    G2int_gsi_icp_message_out_of_synch_case_2);
    return VALUES_1(Nil);
}

static Object Qg2int_gsi_string_facility;  /* gsi_string_facility */

/* SIGNAL-GSI-MAXIMUM-GENSYM-STRING-LENGTH-ERROR */
Object g2int_signal_gsi_maximum_gensym_string_length_error(length_1,
	    maximum_length)
    Object length_1, maximum_length;
{
    x_note_fn_call(47,116);
    g2int_gsi_error(4,Qg2int_gsi_string_facility,
	    G2int_gsi_maximum_text_string_length_error,length_1,
	    maximum_length);
    return VALUES_1(Nil);
}

/* SIGNAL-GSI-EXTEND-CURRENT-GENSYM-STRING-ERROR */
Object g2int_signal_gsi_extend_current_gensym_string_error()
{
    x_note_fn_call(47,117);
    g2int_gsi_error(2,Qg2int_gsi_string_facility,
	    G2int_gsi_extend_current_text_string_error);
    return VALUES_1(Nil);
}

/* SIGNAL-GSI-MAXIMUM-TEXT-STRING-LENGTH-ERROR */
Object g2int_signal_gsi_maximum_text_string_length_error(length_1,
	    maximum_length)
    Object length_1, maximum_length;
{
    x_note_fn_call(47,118);
    g2int_gsi_error(4,Qg2int_gsi_string_facility,
	    G2int_gsi_maximum_text_string_length_error,length_1,
	    maximum_length);
    return VALUES_1(Nil);
}

/* SIGNAL-GSI-EXTEND-CURRENT-TEXT-STRING-ERROR */
Object g2int_signal_gsi_extend_current_text_string_error()
{
    x_note_fn_call(47,119);
    g2int_gsi_error(2,Qg2int_gsi_string_facility,
	    G2int_gsi_extend_current_text_string_error);
    return VALUES_1(Nil);
}

static Object Qg2int_gsi_structure_facility;  /* gsi_structure_facility */

/* SIGNAL-GSI-UNDEFINED-STRUCTURE-METHOD-ERROR */
Object g2int_signal_gsi_undefined_structure_method_error()
{
    x_note_fn_call(47,120);
    g2int_gsi_error(2,Qg2int_gsi_structure_facility,
	    G2int_gsi_undefined_structure_method_error);
    return VALUES_1(Nil);
}

/* SIGNAL-GSI-INDEX-SPACE-FULL-ERROR */
Object g2int_signal_gsi_index_space_full_error()
{
    x_note_fn_call(47,121);
    g2int_gsi_error(2,Qg2int_gsi_icp_facility,
	    G2int_gsi_index_space_full_error);
    return VALUES_1(Nil);
}

/* SIGNAL-GSI-NETWORK-ERROR */
Object g2int_signal_gsi_network_error(event_socket_handle,event_status_code)
    Object event_socket_handle, event_status_code;
{
    x_note_fn_call(47,122);
    g2int_gsi_error(4,Qg2int_gsi_icp_facility,G2int_gsi_network_error,
	    event_socket_handle,event_status_code);
    return VALUES_1(Nil);
}

static Object Qg2int_gensym;       /* gensym */

static Object Qg2_defstruct_structure_name_gsi_instance_g2_struct;  /* g2-defstruct-structure-name::gsi-instance-g2-struct */

static Object Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct;  /* g2-defstruct-structure-name::gsi-transfer-wrapper-g2-struct */

static Object Qg2_defstruct_structure_name_gsi_attribute_g2_struct;  /* g2-defstruct-structure-name::gsi-attribute-g2-struct */

static Object Qg2_defstruct_structure_name_gsi_history_g2_struct;  /* g2-defstruct-structure-name::gsi-history-g2-struct */

static Object Qg2_defstruct_structure_name_gsi_array_wrapper_g2_struct;  /* g2-defstruct-structure-name::gsi-array-wrapper-g2-struct */

static Object Qg2int_managed_array;  /* managed-array */

static Object Qg2int_managed_string_array;  /* managed-string-array */

static Object Qg2int_simple_integer_vector;  /* simple-integer-vector */

static Object Qg2int_simple_float_array;  /* simple-float-array */

static Object Qg2int_gsi_reclaim_facility;  /* gsi_reclaim_facility */

/* GSI-RECLAIM-CONTENTS */
Object g2int_gsi_reclaim_contents(reclaim_list_qm,user_or_gsi)
    Object reclaim_list_qm, user_or_gsi;
{
    Object list_entry, gensym_pop_store, cons_1, next_cons, cdr_new_value;
    Object array, temp, c_string, string_1;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,123);
    list_entry = Nil;
  next_loop:
    if ( !TRUEP(reclaim_list_qm))
	goto end_loop;
    gensym_pop_store = Nil;
    cons_1 = reclaim_list_qm;
    if (cons_1) {
	gensym_pop_store = M_CAR(cons_1);
	next_cons = M_CDR(cons_1);
	inline_note_reclaim_cons(cons_1,Qg2int_gensym);
	cdr_new_value = G2int_available_gensym_conses;
	M_CDR(cons_1) = cdr_new_value;
	G2int_available_gensym_conses = cons_1;
    }
    else
	next_cons = Nil;
    reclaim_list_qm = next_cons;
    list_entry = gensym_pop_store;
    if (SIMPLE_VECTOR_P(list_entry) && EQ(ISVREF(list_entry,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_instance_g2_struct))
	g2int_reclaim_gsi_instance(list_entry,user_or_gsi);
    else if (SIMPLE_VECTOR_P(list_entry) && EQ(ISVREF(list_entry,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct))
	g2int_reclaim_gsi_transfer_wrapper(list_entry);
    else if (SIMPLE_VECTOR_P(list_entry) && EQ(ISVREF(list_entry,
	    (SI_Long)0L),Qg2_defstruct_structure_name_gsi_attribute_g2_struct))
	g2int_reclaim_gsi_attribute(list_entry);
    else if (SIMPLE_VECTOR_P(list_entry) && EQ(ISVREF(list_entry,
	    (SI_Long)0L),Qg2_defstruct_structure_name_gsi_history_g2_struct))
	g2int_reclaim_gsi_history(list_entry);
    else if (SIMPLE_VECTOR_P(list_entry) && EQ(ISVREF(list_entry,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_array_wrapper_g2_struct)) {
	array = ISVREF(list_entry,(SI_Long)2L);
	temp = ISVREF(list_entry,(SI_Long)1L);
	if (EQ(temp,Qg2int_managed_array))
	    g2int_gsi_reclaim_managed_array(array);
	else if (EQ(temp,Qg2int_managed_string_array)) {
	    i = (SI_Long)0L;
	    ab_loop_bind_ = IFIX(g2int_gsi_managed_array_length(array));
	    c_string = Nil;
	    string_1 = Nil;
	  next_loop_1:
	    if (i >= ab_loop_bind_)
		goto end_loop_1;
	    c_string = ISVREF(array,i);
	    string_1 = inline_restore_lisp_gensym_string(c_string);
	    g2int_reclaim_text_or_gensym_string(string_1);
	    i = i + (SI_Long)1L;
	    goto next_loop_1;
	  end_loop_1:
	    g2int_gsi_reclaim_managed_array(array);
	}
	else if (EQ(temp,Qg2int_simple_integer_vector))
	    g2int_gsi_reclaim_managed_array(array);
	else if (EQ(temp,Qg2int_simple_float_array))
	    g2int_reclaim_managed_simple_float_array(array);
	g2int_reclaim_gsi_array_wrapper_1(list_entry);
    }
    else
	g2int_gsi_error(2,Qg2int_gsi_reclaim_facility,
		G2int_gsi_internal_memory_inconsistency);
    goto next_loop;
  end_loop:;
    return VALUES_1(Qnil);
}

/* GSI-SYMBOL-NAME-LENGTH */
Object g2int_gsi_symbol_name_length(symbol)
    Object symbol;
{
    x_note_fn_call(47,124);
    return g2int_text_string_length(g2int_symbol_name_text_string(symbol));
}

/* MAKE-GSI-INSTANCE */
Object g2int_make_gsi_instance varargs_1(int, n)
{
    Object instance_type, instance_value, instance_attributes, instance_class;
    Object instance_name, gsi_instance_owner, sensor_collection_interval;
    Object existing_instance, new_instance, temp, gsi_instance_extension;
    Object svref_new_value;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,125);
    INIT_ARGS_nonrelocating();
    instance_type = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    instance_value = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    instance_attributes = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    instance_class = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    instance_name = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    gsi_instance_owner = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    sensor_collection_interval = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    existing_instance = G2int_make_gsi_instance_existing_instance;
    new_instance = existing_instance;
    if (new_instance);
    else
	new_instance = g2int_make_gsi_instance_1_1();
    temp = instance_type;
    if (temp);
    else
	temp = G2int_gsi_null_type_tag;
    g2int_set_gsi_instance_value_type(new_instance,temp);
    if (instance_value)
	SVREF(new_instance,FIX((SI_Long)2L)) = instance_value;
    if (instance_class) {
	gsi_instance_extension = ISVREF(new_instance,(SI_Long)3L);
	if ( !TRUEP(gsi_instance_extension)) {
	    gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	    SVREF(new_instance,FIX((SI_Long)3L)) = gsi_instance_extension;
	}
	SVREF(gsi_instance_extension,FIX((SI_Long)2L)) = instance_class;
    }
    if (instance_name) {
	gsi_instance_extension = ISVREF(new_instance,(SI_Long)3L);
	if ( !TRUEP(gsi_instance_extension)) {
	    gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	    SVREF(new_instance,FIX((SI_Long)3L)) = gsi_instance_extension;
	}
	SVREF(gsi_instance_extension,FIX((SI_Long)4L)) = instance_name;
    }
    if (instance_attributes) {
	gsi_instance_extension = ISVREF(new_instance,(SI_Long)3L);
	if ( !TRUEP(gsi_instance_extension)) {
	    gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	    SVREF(new_instance,FIX((SI_Long)3L)) = gsi_instance_extension;
	}
	SVREF(gsi_instance_extension,FIX((SI_Long)8L)) = instance_attributes;
	gsi_instance_extension = ISVREF(new_instance,(SI_Long)3L);
	if ( !TRUEP(gsi_instance_extension)) {
	    gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	    SVREF(new_instance,FIX((SI_Long)3L)) = gsi_instance_extension;
	}
	svref_new_value = FIXNUM_SUB1(length(instance_attributes));
	SVREF(gsi_instance_extension,FIX((SI_Long)9L)) = svref_new_value;
    }
    if (sensor_collection_interval) {
	gsi_instance_extension = ISVREF(new_instance,(SI_Long)3L);
	if ( !TRUEP(gsi_instance_extension)) {
	    gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	    SVREF(new_instance,FIX((SI_Long)3L)) = gsi_instance_extension;
	}
	SVREF(gsi_instance_extension,FIX((SI_Long)11L)) = 
		sensor_collection_interval;
    }
    if ( !TRUEP(existing_instance)) {
	if ( !TRUEP(gsi_instance_owner))
	    gsi_instance_owner = g2int_default_owner_for_gsi_objects();
	g2int_set_gsi_instance_owner(new_instance,gsi_instance_owner);
	if (EQ(gsi_instance_owner,Qg2int_gsi))
	    g2int_gsi_push_onto_appropriate_list(1,new_instance);
    }
    return VALUES_1(new_instance);
}

/* MAKE-GSI-INSTANCE-FOR-USER-OR-GSI */
Object g2int_make_gsi_instance_for_user_or_gsi(user_or_gsi)
    Object user_or_gsi;
{
    Object temp;

    x_note_fn_call(47,126);
    temp = g2int_make_gsi_instance(6,G2int_gsi_null_type_tag,Nil,Nil,Nil,
	    Nil,user_or_gsi);
    return VALUES_1(temp);
}

static Object Qg2int_context;      /* context */

static Object Qg2int_gsi_event_queue;  /* gsi-event-queue */

static Object Qg2int_gsi_input_queue;  /* gsi-input-queue */

/* RECLAIM-GSI-INSTANCE */
Object g2int_reclaim_gsi_instance(gsi_instance,user_or_gsi)
    Object gsi_instance, user_or_gsi;
{
    Object temp_1, value_qm;
    SI_Long temp;

    x_note_fn_call(47,127);
    temp = IFIX(ISVREF(gsi_instance,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    if (EQ(temp_1,user_or_gsi)) {
	value_qm = ISVREF(gsi_instance,(SI_Long)2L);
	if (value_qm)
	    g2int_reclaim_gsi_instance_value(FIX(IFIX(ISVREF(gsi_instance,
		    (SI_Long)1L)) >>  -  - (SI_Long)3L),value_qm,
		    gsi_instance,user_or_gsi);
	g2int_reclaim_gsi_instance_extension(gsi_instance,user_or_gsi);
	g2int_reclaim_gsi_instance_1_1(gsi_instance);
    }
    return VALUES_1(Nil);
}

/* RECLAIM-GSI-INSTANCE-EXTENSION */
Object g2int_reclaim_gsi_instance_extension(gsi_instance,user_or_gsi)
    Object gsi_instance, user_or_gsi;
{
    Object extension_qm, history_qm, reclaim_list_qm;

    x_note_fn_call(47,128);
    extension_qm = ISVREF(gsi_instance,(SI_Long)3L);
    if (extension_qm) {
	g2int_reclaim_icp_object_map_for_gsi_instance(gsi_instance);
	history_qm = ISVREF(extension_qm,(SI_Long)12L);
	reclaim_list_qm = ISVREF(extension_qm,(SI_Long)14L);
	if (history_qm)
	    g2int_reclaim_gsi_history(history_qm);
	if (reclaim_list_qm)
	    g2int_gsi_reclaim_contents(reclaim_list_qm,user_or_gsi);
	g2int_reclaim_gsi_instance_extension_1_1(extension_qm);
    }
    SVREF(gsi_instance,FIX((SI_Long)3L)) = Nil;
    return VALUES_1(Nil);
}

/* GSI-RECLAIM-INSTANCE-VALUE-ARRAY */
Object g2int_gsi_reclaim_instance_value_array(value,instance,user_or_gsi)
    Object value, instance, user_or_gsi;
{
    Object prev, gsi_instance_extension, current, next, list_element;
    char temp;

    x_note_fn_call(47,129);
    prev = Nil;
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    current = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)14L) : Nil;
    next = Nil;
  next_loop:
    next = CDR(current);
    temp =  !TRUEP(current);
    if (temp);
    else {
	list_element = CAR(current);
	temp = SIMPLE_VECTOR_P(list_element) && EQ(ISVREF(list_element,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_array_wrapper_g2_struct) ?
		 EQ(value,ISVREF(list_element,(SI_Long)2L)) : TRUEP(Qnil);
    }
    if (temp)
	goto end_loop;
    prev = current;
    current = next;
    goto next_loop;
  end_loop:
    if ( !TRUEP(current))
	error((SI_Long)1L,"Bug in gsi-reclaim-instance-value-array");
    else if (prev)
	M_CDR(prev) = next;
    else {
	gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
	if ( !TRUEP(gsi_instance_extension)) {
	    gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	    SVREF(instance,FIX((SI_Long)3L)) = gsi_instance_extension;
	}
	SVREF(gsi_instance_extension,FIX((SI_Long)14L)) = next;
    }
    M_CDR(current) = Nil;
    g2int_gsi_reclaim_contents(current,user_or_gsi);
    return VALUES_1(Nil);
}

static Object Qg2int_reclaim_gsi_instance_value;  /* reclaim-gsi-instance-value */

/* RECLAIM-GSI-INSTANCE-VALUE */
Object g2int_reclaim_gsi_instance_value(type,value,instance,user_or_gsi)
    Object type, value, instance, user_or_gsi;
{
    x_note_fn_call(47,130);
    if (value) {
	if ( !(FIXNUMP(type) && FIXNUM_LE(FIX((SI_Long)-128L),type) && 
		FIXNUM_LE(type,FIX((SI_Long)127L))))
	    g2int_gsi_error(2,Qg2int_reclaim_gsi_instance_value,
		    G2int_gsi_internal_memory_inconsistency);
	else
	    switch (INTEGER_TO_CHAR(type)) {
	      case 6:
		g2int_reclaim_managed_simple_float_array_of_length_1(value);
		break;
	      case 51:
		g2int_reclaim_managed_simple_long_array_of_length_1(value);
		break;
	      case 4:
	      case 11:
		g2int_reclaim_text_or_gensym_string(value);
		break;
	      case 1:
	      case 5:
	      case 3:
		break;
	      case 22:
	      case 38:
	      case 20:
	      case 36:
	      case 17:
	      case 33:
	      case 21:
	      case 37:
	      case 19:
	      case 35:
		g2int_gsi_reclaim_instance_value_array(value,instance,
			user_or_gsi);
		break;
	      case 25:
	      case 41:
	      case 26:
	      case 42:
	      case 23:
	      case 39:
	      case 24:
	      case 40:
	      case 49:
		break;
	      case 50:
		break;
	      case 0:
		break;
	      case 9:
		break;
	      default:
		g2int_gsi_error(2,Qg2int_reclaim_gsi_instance_value,
			G2int_gsi_internal_memory_inconsistency);
		break;
	    }
    }
    return VALUES_1(Nil);
}

/* MAKE-GSI-TRANSFER-WRAPPER */
Object g2int_make_gsi_transfer_wrapper()
{
    Object temp;

    x_note_fn_call(47,131);
    temp = g2int_gsi_push_onto_appropriate_list(1,
	    g2int_make_gsi_transfer_wrapper_1_1(Nil,FIX((SI_Long)0L),Nil,
	    Nil,g2int_default_owner_for_gsi_objects()));
    return VALUES_1(temp);
}

/* RECLAIM-GSI-TRANSFER-WRAPPER */
Object g2int_reclaim_gsi_transfer_wrapper(transfer_wrapper)
    Object transfer_wrapper;
{
    x_note_fn_call(47,132);
    g2int_reclaim_gsi_transfer_wrapper_1_1(transfer_wrapper);
    return VALUES_1(Nil);
}

static Object Qg2int_reclaim_gsi_user_transfer_wrapper;  /* reclaim-gsi-user-transfer-wrapper */

/* RECLAIM-GSI-USER-TRANSFER-WRAPPER */
Object g2int_reclaim_gsi_user_transfer_wrapper(transfer_wrapper)
    Object transfer_wrapper;
{
    x_note_fn_call(47,133);
    if ( !EQ(ISVREF(transfer_wrapper,(SI_Long)5L),Qg2int_user))
	g2int_gsi_error(2,Qg2int_reclaim_gsi_user_transfer_wrapper,
		G2int_gsi_ownerous_reclamation_violation);
    g2int_reclaim_gsi_transfer_wrapper_1_1(transfer_wrapper);
    return VALUES_1(Nil);
}

/* MAKE-GSI-SEQUENCE */
Object g2int_make_gsi_sequence(list_1)
    Object list_1;
{
    Object length_1, gsi_item, gsi_instance_extension, gsi_items, item;
    Object ab_loop_list_, ab_loop_iter_flag_;
    SI_Long j;

    x_note_fn_call(47,134);
    length_1 = length(list_1);
    gsi_item = g2int_make_gsi_instance(1,G2int_gsi_sequence_type_tag);
    gsi_instance_extension = ISVREF(gsi_item,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(gsi_item,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = length_1;
    if ((SI_Long)0L < IFIX(length_1)) {
	gsi_items = g2int_gsi_allocate_managed_array(FIXNUM_ADD1(length_1));
	g2int_gsi_push_onto_appropriate_list(2,
		g2int_make_gsi_array_wrapper_1(Qg2int_managed_array,
		gsi_items),gsi_item);
	SVREF(gsi_item,FIX((SI_Long)2L)) = gsi_items;
	item = Nil;
	ab_loop_list_ = list_1;
	j = IFIX(G2int_gsi_magic_offset);
	ab_loop_iter_flag_ = T;
      next_loop:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	item = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	if ( !TRUEP(ab_loop_iter_flag_))
	    j = j + (SI_Long)1L;
	ISVREF(gsi_items,j) = item;
	ab_loop_iter_flag_ = Nil;
	goto next_loop;
      end_loop:;
    }
    g2int_reclaim_gensym_list_1(list_1);
    return VALUES_1(gsi_item);
}

/* MAKE-GSI-STRUCTURE */
Object g2int_make_gsi_structure(list_1)
    Object list_1;
{
    Object length_1, gsi_item, attributes, gsi_instance_extension;
    Object svref_new_value, attribute_name, attribute_value, ab_loop_list_;
    Object attribute, temp;
    SI_Long attribute_count, attribute_count_with_offset, i, ab_loop_bind_;

    x_note_fn_call(47,135);
    length_1 = length(list_1);
    attribute_count = IFIX(length_1) >>  -  - (SI_Long)1L;
    gsi_item = g2int_make_gsi_instance(1,G2int_gsi_structure_type_tag);
    attribute_count_with_offset = attribute_count + (SI_Long)1L;
    attributes = 
	    g2int_gsi_allocate_managed_array(FIX(attribute_count_with_offset));
    g2int_gsi_push_onto_appropriate_list(2,
	    g2int_make_gsi_array_wrapper_1(Qg2int_managed_array,
	    attributes),gsi_item);
    gsi_instance_extension = ISVREF(gsi_item,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(gsi_item,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)8L)) = attributes;
    gsi_instance_extension = ISVREF(gsi_item,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(gsi_item,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    ISVREF(gsi_instance_extension,(SI_Long)9L) = FIX(attribute_count);
    svref_new_value = G2int_gsi_magic_number;
    SVREF(attributes,FIX((SI_Long)0L)) = svref_new_value;
    attribute_name = Nil;
    attribute_value = Nil;
    ab_loop_list_ = list_1;
    i = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = attribute_count_with_offset;
    attribute = Nil;
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    attribute_name = CAR(ab_loop_list_);
    temp = CDR(ab_loop_list_);
    attribute_value = CAR(temp);
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    attribute = g2int_make_gsi_attribute(1,attribute_name);
    ISVREF(attributes,i) = attribute;
    SVREF(attribute,FIX((SI_Long)4L)) = attribute_value;
    ab_loop_list_ = CDDR(ab_loop_list_);
    if ( !TRUEP(ab_loop_list_))
	goto end_loop;
    attribute_name = CAR(ab_loop_list_);
    temp = CDR(ab_loop_list_);
    attribute_value = CAR(temp);
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    g2int_reclaim_gensym_list_1(list_1);
    return VALUES_1(gsi_item);
}

static Object Qg2int_attribute;    /* attribute */

/* MAKE-GSI-ATTRIBUTE */
Object g2int_make_gsi_attribute varargs_1(int, n)
{
    Object base_name, class_qualifier, temp;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,136);
    INIT_ARGS_nonrelocating();
    base_name = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    class_qualifier = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    temp = g2int_gensym_list_3(Qg2int_attribute,class_qualifier,base_name);
    return g2int_gsi_push_onto_appropriate_list(1,
	    g2int_make_gsi_attribute_1_1(temp,Nil,
	    g2int_default_owner_for_gsi_objects()));
}

/* MAKE-GSI-ATTRIBUTE-FOR-USER-OR-GSI */
Object g2int_make_gsi_attribute_for_user_or_gsi(user_or_gsi)
    Object user_or_gsi;
{
    Object attribute;

    x_note_fn_call(47,137);
    attribute = 
	    g2int_make_gsi_attribute_1_1(g2int_gensym_list_3(Qg2int_attribute,
	    Nil,Nil),Nil,user_or_gsi);
    if (EQ(user_or_gsi,Qg2int_gsi) || EQ(user_or_gsi,Qg2int_context))
	g2int_gsi_push_onto_appropriate_list(1,attribute);
    return VALUES_1(attribute);
}

/* RECLAIM-GSI-ATTRIBUTE */
Object g2int_reclaim_gsi_attribute(attribute)
    Object attribute;
{
    Object spec;

    x_note_fn_call(47,138);
    spec = ISVREF(attribute,(SI_Long)1L);
    if (CONSP(spec))
	g2int_reclaim_resumable_attribute_spec_function(spec);
    else if (CONSP(spec))
	g2int_reclaim_gensym_list_1(spec);
    g2int_reclaim_gsi_attribute_1_1(attribute);
    return VALUES_1(Nil);
}

/* RECLAIM-GSI-USER-ATTRIBUTE */
Object g2int_reclaim_gsi_user_attribute(attribute)
    Object attribute;
{
    x_note_fn_call(47,139);
    if (EQ(ISVREF(attribute,(SI_Long)5L),Qg2int_user))
	g2int_reclaim_gsi_attribute(attribute);
    return VALUES_1(Nil);
}

static Object Qab_g2int_make_gsi_history;  /* make_gsi_history */

/* MAKE-GSI-HISTORY */
Object g2int_make_gsi_history varargs_1(int, n)
{
    Object gsi_instance, length_1;
    Object values_qm, timestamps_qm, base_time_qm, max_count_qm, max_age_qm;
    Object granularity_qm, amf_available_array_cons_qm, amf_array, temp;
    Object svref_new_value, amf_result, incff_1_arg, new_float, history;
    SI_Long value_type;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,140);
    INIT_ARGS_nonrelocating();
    gsi_instance = REQUIRED_ARG_nonrelocating();
    length_1 = REQUIRED_ARG_nonrelocating();
    values_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    timestamps_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    base_time_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    max_count_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    max_age_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    granularity_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    value_type = IFIX(ISVREF(gsi_instance,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !TRUEP(values_qm)) {
	if ( !((SI_Long)-128L <= value_type && value_type <= (SI_Long)127L))
	    values_qm = g2int_gsi_error(2,Qab_g2int_make_gsi_history,
		    G2int_gsi_invalid_history_type);
	else
	    switch ((char)value_type) {
	      case 1:
	      case 5:
		values_qm = g2int_gsi_make_appropriate_array(3,
			G2int_gsi_integer_array_type_tag,length_1,
			gsi_instance);
		break;
	      case 6:
		values_qm = g2int_gsi_make_appropriate_array(3,
			G2int_gsi_64bit_float_array_type_tag,length_1,
			gsi_instance);
		break;
	      case 4:
	      case 11:
		values_qm = g2int_gsi_make_appropriate_array(3,
			G2int_gsi_string_array_type_tag,length_1,gsi_instance);
		break;
	      case 3:
		values_qm = g2int_gsi_make_appropriate_array(3,
			G2int_gsi_symbol_array_type_tag,length_1,gsi_instance);
		break;
	      case 8:
	      case 10:
		values_qm = g2int_gsi_make_appropriate_array(3,
			G2int_gsi_value_array_type_tag,length_1,gsi_instance);
		break;
	      default:
		values_qm = g2int_gsi_error(2,Qab_g2int_make_gsi_history,
			G2int_gsi_invalid_history_type);
		break;
	    }
    }
    if ( !TRUEP(timestamps_qm))
	timestamps_qm = g2int_allocate_managed_simple_float_array(length_1);
    if ( !TRUEP(base_time_qm)) {
	amf_available_array_cons_qm = 
		ISVREF(G2int_vector_of_simple_float_array_pools,(SI_Long)1L);
	if (amf_available_array_cons_qm) {
	    amf_array = M_CAR(amf_available_array_cons_qm);
	    temp = G2int_vector_of_simple_float_array_pools;
	    svref_new_value = M_CDR(amf_available_array_cons_qm);
	    SVREF(temp,FIX((SI_Long)1L)) = svref_new_value;
	    inline_note_reclaim_cons(amf_available_array_cons_qm,
		    Qg2int_gensym);
	    temp = G2int_available_gensym_conses;
	    M_CDR(amf_available_array_cons_qm) = temp;
	    G2int_available_gensym_conses = amf_available_array_cons_qm;
	    amf_result = amf_array;
	}
	else {
	    temp = FIXNUM_ADD1(G2int_created_simple_float_array_pool_arrays);
	    G2int_created_simple_float_array_pool_arrays = temp;
	    incff_1_arg = 
		    g2int_bytes_per_double_float_simple_array(FIX((SI_Long)1L));
	    temp = FIXNUM_ADD(G2int_simple_float_array_pool_memory_usage,
		    incff_1_arg);
	    G2int_simple_float_array_pool_memory_usage = temp;
	    amf_result = g2int_generate_float_vector(FIX((SI_Long)1L));
	}
	new_float = amf_result;
	DFLOAT_ISASET_1(new_float,(SI_Long)0L,0.0);
	base_time_qm = new_float;
    }
    history = g2int_make_gsi_history_1_1(length_1,values_qm,timestamps_qm,
	    FIX((SI_Long)0L));
    temp = g2int_gensym_list_4(Nil,max_count_qm,max_age_qm,granularity_qm);
    SVREF(history,FIX((SI_Long)4L)) = temp;
    temp = g2int_gensym_list_3(base_time_qm,Nil,Nil);
    SVREF(history,FIX((SI_Long)5L)) = temp;
    return VALUES_1(history);
}

/* GSI-SET-HISTORY-TYPE */
Object g2int_gsi_set_history_type(gsi_instance,history_type)
    Object gsi_instance, history_type;
{
    Object gsi_instance_extension;

    x_note_fn_call(47,141);
    gsi_instance_extension = ISVREF(gsi_instance,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(gsi_instance,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)3L)) = history_type;
    return VALUES_1(history_type);
}

/* MAKE-GSI-HISTORY-FROM-SPECIFICATION */
Object g2int_make_gsi_history_from_specification(max_count_qm,max_age_qm,
	    granularity_qm)
    Object max_count_qm, max_age_qm, granularity_qm;
{
    Object history, temp, amf_available_array_cons_qm, amf_array;
    Object svref_new_value, amf_result, incff_1_arg, new_float;

    x_note_fn_call(47,142);
    history = g2int_make_gsi_history_1_1(Nil,Nil,Nil,FIX((SI_Long)0L));
    temp = g2int_gensym_list_4(Nil,max_count_qm,max_age_qm,granularity_qm);
    SVREF(history,FIX((SI_Long)4L)) = temp;
    amf_available_array_cons_qm = 
	    ISVREF(G2int_vector_of_simple_float_array_pools,(SI_Long)1L);
    if (amf_available_array_cons_qm) {
	amf_array = M_CAR(amf_available_array_cons_qm);
	temp = G2int_vector_of_simple_float_array_pools;
	svref_new_value = M_CDR(amf_available_array_cons_qm);
	SVREF(temp,FIX((SI_Long)1L)) = svref_new_value;
	inline_note_reclaim_cons(amf_available_array_cons_qm,Qg2int_gensym);
	temp = G2int_available_gensym_conses;
	M_CDR(amf_available_array_cons_qm) = temp;
	G2int_available_gensym_conses = amf_available_array_cons_qm;
	amf_result = amf_array;
    }
    else {
	temp = FIXNUM_ADD1(G2int_created_simple_float_array_pool_arrays);
	G2int_created_simple_float_array_pool_arrays = temp;
	incff_1_arg = 
		g2int_bytes_per_double_float_simple_array(FIX((SI_Long)1L));
	temp = FIXNUM_ADD(G2int_simple_float_array_pool_memory_usage,
		incff_1_arg);
	G2int_simple_float_array_pool_memory_usage = temp;
	amf_result = g2int_generate_float_vector(FIX((SI_Long)1L));
    }
    new_float = amf_result;
    DFLOAT_ISASET_1(new_float,(SI_Long)0L,0.0);
    temp = g2int_gensym_list_3(new_float,Nil,Nil);
    SVREF(history,FIX((SI_Long)5L)) = temp;
    return VALUES_1(history);
}

/* ADD-VECTORS-TO-GSI-HISTORY */
Object g2int_add_vectors_to_gsi_history(length_1,history,gsi_instance)
    Object length_1, history, gsi_instance;
{
    Object gsi_instance_extension, temp, svref_new_value;

    x_note_fn_call(47,143);
    SVREF(history,FIX((SI_Long)1L)) = length_1;
    gsi_instance_extension = ISVREF(gsi_instance,(SI_Long)3L);
    temp = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)3L) : FIX((SI_Long)0L);
    if ( !(FIXNUMP(temp) && FIXNUM_LE(FIX((SI_Long)-128L),temp) && 
	    FIXNUM_LE(temp,FIX((SI_Long)127L))))
	svref_new_value = g2int_gsi_error(2,Qab_g2int_make_gsi_history,
		G2int_gsi_invalid_history_type);
    else
	switch (INTEGER_TO_CHAR(temp)) {
	  case 1:
	  case 5:
	    svref_new_value = g2int_gsi_make_appropriate_array(3,
		    G2int_gsi_integer_array_type_tag,length_1,gsi_instance);
	    break;
	  case 6:
	    svref_new_value = g2int_gsi_make_appropriate_array(3,
		    G2int_gsi_64bit_float_array_type_tag,length_1,
		    gsi_instance);
	    break;
	  case 4:
	  case 11:
	    svref_new_value = g2int_gsi_make_appropriate_array(3,
		    G2int_gsi_string_array_type_tag,length_1,gsi_instance);
	    break;
	  case 3:
	    svref_new_value = g2int_gsi_make_appropriate_array(3,
		    G2int_gsi_symbol_array_type_tag,length_1,gsi_instance);
	    break;
	  case 8:
	  case 10:
	    svref_new_value = g2int_gsi_make_appropriate_array(3,
		    G2int_gsi_value_array_type_tag,length_1,gsi_instance);
	    break;
	  default:
	    svref_new_value = g2int_gsi_error(2,Qab_g2int_make_gsi_history,
		    G2int_gsi_invalid_history_type);
	    break;
	}
    SVREF(history,FIX((SI_Long)2L)) = svref_new_value;
    svref_new_value = g2int_allocate_managed_simple_float_array(length_1);
    SVREF(history,FIX((SI_Long)3L)) = svref_new_value;
    return VALUES_1(history);
}

/* RECLAIM-GSI-HISTORY */
Object g2int_reclaim_gsi_history(history)
    Object history;
{
    Object timestamps_qm, internals_qm, dynamic_info_qm, managed_float;

    x_note_fn_call(47,144);
    timestamps_qm = ISVREF(history,(SI_Long)3L);
    internals_qm = ISVREF(history,(SI_Long)4L);
    dynamic_info_qm = ISVREF(history,(SI_Long)5L);
    if (timestamps_qm)
	g2int_reclaim_managed_simple_float_array(timestamps_qm);
    if (internals_qm)
	g2int_reclaim_gensym_list_1(internals_qm);
    if (dynamic_info_qm) {
	managed_float = FIRST(dynamic_info_qm);
	g2int_reclaim_managed_simple_float_array_of_length_1(managed_float);
	g2int_reclaim_gensym_list_1(dynamic_info_qm);
    }
    g2int_reclaim_gsi_history_1_1(history);
    return VALUES_1(Nil);
}

/* GSI-ATTRIBUTE-QUALIFIED-NAME */
Object g2int_gsi_attribute_qualified_name(gsi_attribute)
    Object gsi_attribute;
{
    Object temp, resumable_attribute_spec, class_qualifier_qm, svref_new_value;

    x_note_fn_call(47,145);
    temp = ISVREF(gsi_attribute,(SI_Long)2L);
    if (temp)
	return VALUES_1(temp);
    else {
	resumable_attribute_spec = ISVREF(gsi_attribute,(SI_Long)1L);
	class_qualifier_qm = CONSP(resumable_attribute_spec) ? 
		SECOND(resumable_attribute_spec) : Nil;
	svref_new_value = 
		g2int_gsi_intern(g2int_simple_text_string_copy_from_attribute_name_1(CONSP(resumable_attribute_spec) 
		? THIRD(resumable_attribute_spec) : 
		resumable_attribute_spec,class_qualifier_qm,T));
	return VALUES_1(SVREF(gsi_attribute,FIX((SI_Long)2L)) = 
		svref_new_value);
    }
}

/* GSI-INTERN */
Object g2int_gsi_intern(string_1)
    Object string_1;
{
    Object package, temp;

    x_note_fn_call(47,146);
    if (string_1) {
	package = g2int_position_of_two_colons(string_1) ? 
		G2int_keyword_package_1 : G2int_ab_package_1;
	temp = INLINE_UNSIGNED_BYTE_16_VECTOR_P(string_1) != (SI_Long)0L ? 
		g2int_intern_text_string(2,string_1,package) : 
		g2int_intern_gensym_string(2,string_1,package);
    }
    else
	temp = Nil;
    return VALUES_1(temp);
}

/* GSI-FAILURE-P */
Object g2int_gsi_failure_p(value)
    Object value;
{
    Object temp;

    x_note_fn_call(47,147);
    temp =  !FIXNUM_EQ(value,G2int_gsi_success) ? T : Nil;
    return VALUES_1(temp);
}

/* SHUTDOWN-DATA-SERVER-WRAPPER */
Object g2int_shutdown_data_server_wrapper()
{
    x_note_fn_call(47,148);
    return g2int_shutdown_icp_socket_connection(1,G2int_current_icp_socket);
}

Object G2int_gsi_transfer_array_for_deregistration = UNBOUND;

Object G2int_gsi_sensor_to_deregisterqm = UNBOUND;

Object G2int_index_of_gsi_sensor_to_deregisterqm = UNBOUND;

/* GSI-DEREGISTER-ITEMS-WRAPPER-FOR-KNOWN-SENSOR */
Object g2int_gsi_deregister_items_wrapper_for_known_sensor(sensor,index_1)
    Object sensor, index_1;
{
    Object transfer_wrapper_array, transfer_wrapper, current_icp_socket;
    Object gsi_sensor_to_deregister_qm, index_of_gsi_sensor_to_deregister_qm;
    Object temp;
    Declare_special(3);

    x_note_fn_call(47,149);
    transfer_wrapper_array = G2int_gsi_transfer_array_for_deregistration;
    if (transfer_wrapper_array);
    else {
	G2int_gsi_transfer_array_for_deregistration = 
		g2int_create_transfer_wrapper_array(FIX((SI_Long)1L));
	transfer_wrapper_array = G2int_gsi_transfer_array_for_deregistration;
    }
    transfer_wrapper = ISVREF(transfer_wrapper_array,
	    IFIX(G2int_gsi_magic_offset));
    SVREF(transfer_wrapper,FIX((SI_Long)1L)) = sensor;
    current_icp_socket = G2int_icp_socket_for_reclaimqm;
    PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,2);
      gsi_sensor_to_deregister_qm = sensor;
      PUSH_SPECIAL(G2int_gsi_sensor_to_deregisterqm,gsi_sensor_to_deregister_qm,
	      1);
	index_of_gsi_sensor_to_deregister_qm = index_1;
	PUSH_SPECIAL(G2int_index_of_gsi_sensor_to_deregisterqm,index_of_gsi_sensor_to_deregister_qm,
		0);
	  g2int_call_gsi_callback(3,G2int_gsi_receive_deregistrations,
		  inline_extract_c_array(transfer_wrapper_array,
		  G2int_gsi_magic_offset),FIX((SI_Long)1L));
	POP_SPECIAL();
      POP_SPECIAL();
    POP_SPECIAL();
    temp = g2int_reclaim_gsi_instance_for_context(sensor);
    return VALUES_1(temp);
}

/* RECLAIM-GSI-TRANSFER-WRAPPER-ARRAY */
Object g2int_reclaim_gsi_transfer_wrapper_array(transfer_wrapper_array)
    Object transfer_wrapper_array;
{
    Object transfer_wrapper, old_value;
    SI_Long array_index, ab_loop_bind_;

    x_note_fn_call(47,150);
    array_index = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = 
	    IFIX(FIXNUM_ADD1(G2int_size_of_array_of_transfer_wrappers));
    transfer_wrapper = Nil;
  next_loop:
    if (array_index >= ab_loop_bind_)
	goto end_loop;
    transfer_wrapper = ISVREF(transfer_wrapper_array,array_index);
    if (SIMPLE_VECTOR_P(transfer_wrapper) && EQ(ISVREF(transfer_wrapper,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	old_value = ISVREF(transfer_wrapper,(SI_Long)4L);
	if (old_value)
	    g2int_reclaim_gsi_instance_for_gsi(old_value);
	g2int_reclaim_gsi_transfer_wrapper(transfer_wrapper);
	ISVREF(transfer_wrapper_array,array_index) = Nil;
    }
    array_index = array_index + (SI_Long)1L;
    goto next_loop;
  end_loop:
    g2int_gsi_reclaim_managed_array(transfer_wrapper_array);
    return VALUES_1(Nil);
}

/* RECLAIM-GSI-REMOTE-PROCEDURES */
Object g2int_reclaim_gsi_remote_procedures(list_of_procedures_qm)
    Object list_of_procedures_qm;
{
    Object procedure, gensym_pop_store, cons_1, next_cons, cdr_new_value;

    x_note_fn_call(47,151);
    procedure = Nil;
  next_loop:
    if ( !TRUEP(list_of_procedures_qm))
	goto end_loop;
    gensym_pop_store = Nil;
    cons_1 = list_of_procedures_qm;
    if (cons_1) {
	gensym_pop_store = M_CAR(cons_1);
	next_cons = M_CDR(cons_1);
	inline_note_reclaim_cons(cons_1,Qg2int_gensym);
	cdr_new_value = G2int_available_gensym_conses;
	M_CDR(cons_1) = cdr_new_value;
	G2int_available_gensym_conses = cons_1;
    }
    else
	next_cons = Nil;
    list_of_procedures_qm = next_cons;
    procedure = gensym_pop_store;
    g2int_reclaim_gsi_remote_procedure(procedure);
    goto next_loop;
  end_loop:;
    return VALUES_1(Qnil);
}

/* GSI-CURRENT-CONTEXT-NUMBER */
Object g2int_gsi_current_context_number()
{
    Object temp, socket_extension_data_qm;

    x_note_fn_call(47,152);
    if ( !TRUEP(G2int_current_icp_socket))
	temp = G2int_gsi_undefined_context;
    else {
	socket_extension_data_qm = ISVREF(G2int_current_icp_socket,
		(SI_Long)29L);
	temp = socket_extension_data_qm ? ISVREF(socket_extension_data_qm,
		(SI_Long)1L) : G2int_gsi_undefined_context;
    }
    return VALUES_1(temp);
}

/* INVALID-GSI-CONTEXT-P */
Object g2int_invalid_gsi_context_p(context_init,for_writing_p)
    Object context_init, for_writing_p;
{
    Object vector_1, socket_1, extension_data_qm, temp_1;
    SI_Long context, index_1;
    char temp;

    x_note_fn_call(47,153);
    context = IFIX(context_init);
    if (context < (SI_Long)0L)
	return VALUES_1(G2int_gsi_context_undefined);
    vector_1 = ISVREF(G2int_gsi_context_to_socket_map,(SI_Long)2L);
    index_1 = context >>  -  - (SI_Long)10L;
    vector_1 = vector_1 && index_1 < 
	    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(vector_1)) ? ISVREF(vector_1,
	    index_1) : Qnil;
    index_1 = context & (SI_Long)1023L;
    socket_1 = vector_1 && index_1 < 
	    IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(vector_1)) ? ISVREF(vector_1,
	    index_1) : Qnil;
    if (socket_1) {
	extension_data_qm = ISVREF(socket_1,(SI_Long)29L);
	temp = extension_data_qm ? IFIX(ISVREF(extension_data_qm,
		(SI_Long)1L)) == context : TRUEP(Qnil);
    }
    else
	temp = TRUEP(Nil);
    if ( !temp)
	return VALUES_1(G2int_gsi_invalid_context);
    if ( !(FIXNUM_NE(ISVREF(socket_1,(SI_Long)15L),
	    G2int_icp_connection_closed) || context == 
	    IFIX(g2int_gsi_current_context_number())))
	return VALUES_1(G2int_gsi_context_has_been_shut_down);
    if ( !( !TRUEP(for_writing_p) || FIXNUM_EQ(ISVREF(socket_1,
	    (SI_Long)15L),G2int_icp_connection_running)))
	return VALUES_1(G2int_gsi_context_has_been_killed);
    else
	temp_1 = Nil;
    return VALUES_1(temp_1);
}

static Object Qg2int_get_icp_socket_from_context;  /* get-icp-socket-from-context */

/* GET-ICP-SOCKET-FROM-CONTEXT */
Object g2int_get_icp_socket_from_context(context,for_writing_p)
    Object context, for_writing_p;
{
    Object code, socket_1, icp_socket;

    x_note_fn_call(47,154);
    code = g2int_invalid_gsi_context_p(context,for_writing_p);
    if (code)
	g2int_gsi_error(3,Qg2int_get_icp_socket_from_context,code,context);
    if (FIXNUM_GE(context,ISVREF(G2int_gsi_context_to_socket_map,(SI_Long)4L)))
	g2int_enlarge_index_space(G2int_gsi_context_to_socket_map,context);
    socket_1 = ISVREF(ISVREF(ISVREF(G2int_gsi_context_to_socket_map,
	    (SI_Long)2L),IFIX(context) >>  -  - (SI_Long)10L),
	    IFIX(context) & (SI_Long)1023L);
    if (socket_1 && for_writing_p) {
	icp_socket = socket_1;
	if (FIXNUM_EQ(G2int_gsi_connection_initializing,ISVREF(icp_socket,
		(SI_Long)28L)))
	    g2int_gsi_send_reply_to_initial_ping_internal(icp_socket);
    }
    return VALUES_1(socket_1);
}

Object G2int_gsi_io_unblocked = UNBOUND;

Object G2int_gsi_io_blocked = UNBOUND;

/* GSI-READ-STATE-CHANGE */
Object g2int_gsi_read_state_change(socket_1,state_1)
    Object socket_1, state_1;
{
    Object extension_data_qm, context_number, scheduler_enabled_qm;
    char display_events_were_enabled;
    Declare_stack_pointer;
    Declare_catch(1);
    Declare_special(1);
    Object result;

    x_note_fn_call(47,155);
    SAVE_STACK();
    if (G2int_starscheduler_enabledqmstar) {
	extension_data_qm = ISVREF(socket_1,(SI_Long)29L);
	if (extension_data_qm) {
	    context_number = ISVREF(extension_data_qm,(SI_Long)1L);
	    if (context_number) {
		display_events_were_enabled = (SI_Long)0L != 
			ne_display_events_enabled();
		ne_disable_display_events();
		if (PUSH_UNWIND_PROTECT(0)) {
		    scheduler_enabled_qm = Nil;
		    PUSH_SPECIAL(G2int_starscheduler_enabledqmstar,scheduler_enabled_qm,
			    0);
		      SAVE_VALUES(g2int_call_gsi_callback(3,
			      G2int_gsi_read_callback,context_number,
			      state_1 ? G2int_gsi_io_unblocked : 
			      G2int_gsi_io_blocked));
		    POP_SPECIAL();
		}
		POP_UNWIND_PROTECT(0);
		if (display_events_were_enabled)
		    ne_enable_display_events();
		CONTINUE_UNWINDING(0);
		result = RESTORE_VALUES();
		RESTORE_STACK();
		return result;
	    }
	    else {
		RESTORE_STACK();
		return VALUES_1(Nil);
	    }
	}
	else {
	    RESTORE_STACK();
	    return VALUES_1(Nil);
	}
    }
    else {
	RESTORE_STACK();
	return VALUES_1(Nil);
    }
}

/* GSI-WRITE-STATE-CHANGE */
Object g2int_gsi_write_state_change(socket_1,state_1)
    Object socket_1, state_1;
{
    Object extension_data_qm, context_number, scheduler_enabled_qm;
    char display_events_were_enabled;
    Declare_stack_pointer;
    Declare_catch(1);
    Declare_special(1);
    Object result;

    x_note_fn_call(47,156);
    SAVE_STACK();
    if (G2int_starscheduler_enabledqmstar) {
	extension_data_qm = ISVREF(socket_1,(SI_Long)29L);
	if (extension_data_qm) {
	    context_number = ISVREF(extension_data_qm,(SI_Long)1L);
	    if (context_number) {
		display_events_were_enabled = (SI_Long)0L != 
			ne_display_events_enabled();
		ne_disable_display_events();
		if (PUSH_UNWIND_PROTECT(0)) {
		    scheduler_enabled_qm = Nil;
		    PUSH_SPECIAL(G2int_starscheduler_enabledqmstar,scheduler_enabled_qm,
			    0);
		      SAVE_VALUES(g2int_call_gsi_callback(3,
			      G2int_gsi_write_callback,context_number,
			      state_1 ? G2int_gsi_io_unblocked : 
			      G2int_gsi_io_blocked));
		    POP_SPECIAL();
		}
		POP_UNWIND_PROTECT(0);
		if (display_events_were_enabled)
		    ne_enable_display_events();
		CONTINUE_UNWINDING(0);
		result = RESTORE_VALUES();
		RESTORE_STACK();
		return result;
	    }
	    else {
		RESTORE_STACK();
		return VALUES_1(Nil);
	    }
	}
	else {
	    RESTORE_STACK();
	    return VALUES_1(Nil);
	}
    }
    else {
	RESTORE_STACK();
	return VALUES_1(Nil);
    }
}

static Object Qg2int_gsi_connection_loss_notifier;  /* gsi-connection-loss-notifier */

static Object Qg2int_gsi_read_state_change;  /* gsi-read-state-change */

static Object Qg2int_gsi_write_state_change;  /* gsi-write-state-change */

/* REGISTER-GSI-CONNECTION-CALLBACKS */
Object g2int_register_gsi_connection_callbacks(listener_socket_qm,
	    nascent_socket)
    Object listener_socket_qm, nascent_socket;
{
    x_note_fn_call(47,157);
    if (listener_socket_qm)
	SVREF(nascent_socket,FIX((SI_Long)33L)) = listener_socket_qm;
    g2int_register_icp_connection_loss_callback(Qg2int_gsi_connection_loss_notifier,
	    nascent_socket);
    g2int_register_icp_read_callback(Qg2int_gsi_read_state_change,
	    nascent_socket);
    g2int_register_icp_write_callback(Qg2int_gsi_write_state_change,
	    nascent_socket);
    return VALUES_1(Nil);
}

static Object string_constant_48;  /* "Connection closed - context ~a~%" */

static Object Qg2int_gsi_internals;  /* gsi_internals */

/* GSI-CONNECTION-LOSS-NOTIFIER */
Object g2int_gsi_connection_loss_notifier(icp_socket,clean_qm)
    Object icp_socket, clean_qm;
{
    Object gsi_extension_data_qm, gsi_shutdown_reason, current_icp_socket;
    Declare_special(2);
    Object result;

    x_note_fn_call(47,158);
    gsi_extension_data_qm = ISVREF(icp_socket,(SI_Long)29L);
    if (gsi_extension_data_qm && ISVREF(gsi_extension_data_qm,(SI_Long)8L)) {
	gsi_shutdown_reason = ISVREF(icp_socket,(SI_Long)9L);
	current_icp_socket = icp_socket;
	PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,1);
	  PUSH_SPECIAL(G2int_gsi_shutdown_reason,gsi_shutdown_reason,0);
	    if ( 
		    !TRUEP(g2int_gsi_maybe_notice_delayed_connection_failure(icp_socket)))
		g2int_gsi_message(2,string_constant_48,
			g2int_gsi_current_context_number());
	    if (G2int_gsi_shutdown_reason) {
		g2int_set_gsi_error_message_1(Nil,
			G2int_gsi_connection_lost,
			G2int_gsi_shutdown_reason,Nil,Nil,Nil,Nil,Nil);
		result = g2int_gsi_handle_error_1(Qg2int_gsi_internals,Nil,
			Nil);
	    }
	    else
		result = VALUES_1(Nil);
	  POP_SPECIAL();
	POP_SPECIAL();
	return result;
    }
    else
	return VALUES_1(Nil);
}

/* MAYBE-CALL-GSI-SHUTDOWN-CONTEXT-CALLBACK */
Object g2int_maybe_call_gsi_shutdown_context_callback(icp_socket)
    Object icp_socket;
{
    Object current_icp_socket, gsi_extension_data_qm;
    Declare_special(1);

    x_note_fn_call(47,159);
    current_icp_socket = icp_socket;
    PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,0);
      gsi_extension_data_qm = ISVREF(icp_socket,(SI_Long)29L);
      if (gsi_extension_data_qm && ISVREF(gsi_extension_data_qm,(SI_Long)8L))
	  g2int_call_gsi_callback(1,G2int_gsi_shutdown_context);
    POP_SPECIAL();
    return VALUES_1(Nil);
}

static Object Qg2int_run_gsi;      /* run-gsi */

/* RUN-GSI-PROCESS-TOP-LEVEL */
Object g2int_run_gsi_process_top_level(native_window)
    Object native_window;
{
    x_note_fn_call(47,160);
    return g2int_run_system_process(Qg2int_gsi,native_window,Qg2int_run_gsi);
}

/* LAUNCH-GSI */
Object launch_gsi()
{
    x_note_fn_call(47,161);
    return g2int_launch_system_process(Qg2int_gsi);
}

static Object Qg2int_gsi_error_handler;  /* gsi-error-handler */

/* ABORT-GSI-TOP-LEVEL */
Object g2int_abort_gsi_top_level()
{
    Object temp;

    x_note_fn_call(47,162);
    g2int_set_gsi_error_message_1(T,Nil,Nil,Nil,Nil,Nil,Nil,Nil);
    temp = g2int_gsi_handle_error_1(Qg2int_gsi_error_handler,Qerror,Nil);
    return VALUES_1(temp);
}

static Object string_constant_49;  /* "from" */

static Object string_constant_50;  /* "to" */

/* GSI-CONTINUE-FROM-ERROR */
Object g2int_gsi_continue_from_error()
{
    x_note_fn_call(47,163);
    if ( !TRUEP(g2int_gsi_option_is_set_p(G2int_gsi_one_cycle)) && 
	    G2int_within_run_loop_extent &&  
	    !TRUEP(G2int_unrecoverable_error_p))
	return g2int_gsi_continue_run_loop();
    else if (G2int_unrecoverable_error_p)
	return g2int_g2_unrecoverable_error_exit();
    else {
	if (G2int_in_unprotected_gsi_api_call_p && 
		G2int_gsi_throw_to_run_loop_may_be_harmful_p)
	    format((SI_Long)3L,T,
		    "~%Warning: error in an unprotected GSI API call.~%Returning ~A the run loop.~%(Use gsi_set_option(GSI_PROTECT_INNER_CALLS))~%",
		    g2int_gsi_option_is_set_p(G2int_gsi_one_cycle) ? 
		    string_constant_49 : string_constant_50);
	return g2int_shutdown_or_exit(0);
    }
}

/* GSI-CONTINUE-RUN-LOOP */
Object g2int_gsi_continue_run_loop()
{
    Object temp;

    x_note_fn_call(47,164);
    temp = g2int_abort(1,FIX((SI_Long)0L));
    return VALUES_1(temp);
}

Object G2int_default_gsi_extension_tcp_address = UNBOUND;

Object G2int_gsi_extension_tcp_addressqm = UNBOUND;

Object G2int_gsi_is_not_initialized = UNBOUND;

static Object Qg2int_vector_element;  /* vector-element */

static Object Qg2int_list_element;  /* list-element */

static Object Qg2int_name;         /* name */

static Object Qg2int_current_value;  /* current-value */

/* INITIALIZE-GSI */
Object g2int_initialize_gsi()
{
    x_note_fn_call(47,165);
    g2int_initialize_gsi_context_number_table(G2int_initial_maximum_number_of_contexts);
    G2int_next_available_context_number = FIX((SI_Long)0L);
    G2int_reusable_circularity_table = g2int_make_gsi_circularity_table();
    G2int_array_element_attribute_spec = 
	    g2int_gensym_list_2(Qg2int_vector_element,Nil);
    G2int_list_element_attribute_spec = 
	    g2int_gensym_list_2(Qg2int_list_element,Nil);
    G2int_item_name_attribute_spec = g2int_gensym_list_3(Qg2int_attribute,
	    Nil,Qg2int_name);
    G2int_simple_item_value_attribute_spec = 
	    g2int_gensym_list_3(Qg2int_attribute,Nil,Qg2int_current_value);
    G2int_reusable_name_instance = g2int_make_gsi_instance_1_1();
    g2int_set_gsi_instance_value_type(G2int_reusable_name_instance,
	    G2int_gsi_symbol_type_tag);
    G2int_reusable_value_instance = g2int_make_gsi_instance_1_1();
    G2int_gsi_is_not_initialized = Nil;
    return VALUES_1(G2int_gsi_is_not_initialized);
}

/* RUN-GSI-1 */
Object g2int_run_gsi_1()
{
    Object interface_name, class_name, network, host, port;
    Object remote_process_initialization_string, listeners_exist_p, temp;
    char temp_1;
    Object result;

    x_note_fn_call(47,166);
    if (g2int_gsi_option_is_set_p(G2int_gsi_trace_run_loop))
	format((SI_Long)2L,T,"Entering gsi_start~%");
    g2int_initialize_gsi();
    g2int_initialize_scheduler();
    g2int_initialize_gensym_time();
    g2int_cache_command_line_if_necessary();
    g2int_set_up_lisp_memory_management(Qg2int_gsi);
    if ( !TRUEP(g2int_gsi_option_is_set_p(G2int_gsi_suppress_output))) {
	g2int_announce_system_presence(Qg2int_gsi);
	g2int_report_memory_usage(Qg2int_gsi);
    }
    result = g2int_get_connect_address_from_command_line();
    MVS_6(result,interface_name,class_name,network,host,port,
	    remote_process_initialization_string);
    G2int_gsi_use_references_p = 
	    g2int_gsi_option_is_set_p(G2int_gsi_use_references);
    G2int_gsi_references_in_use = G2int_gsi_use_references_p ? 
	    FIX((SI_Long)1L) : FIX((SI_Long)0L);
    g2int_call_gsi_callback(1,G2int_gsi_set_up);
    G2int_gsi_references_in_use = G2int_gsi_use_references_p ? 
	    FIX((SI_Long)1L) : FIX((SI_Long)0L);
    if ( !(g2int_gsi_option_is_set_p(G2int_gsi_no_signal_handlers) || 
	    g2int_do_not_catch_aborts_p())) {
	g2ext_inhibit_core_dumping();
	g2int_register_all_signal_handlers_unconditionally();
    }
    if ( !TRUEP(g2int_gsi_no_listener_p())) {
	g2int_derive_network_listeners();
	listeners_exist_p = g2int_establish_gsi_listeners();
    }
    else
	listeners_exist_p = Nil;
    if ( !TRUEP(g2int_gsi_no_connect_p()) && (g2int_gsi_connect_p() || 
	    interface_name || class_name || network || host || port || 
	    remote_process_initialization_string)) {
	temp = g2int_initiate_gsi_connection(interface_name,class_name,Nil,
		network,host,port,remote_process_initialization_string,Nil,
		G2int_secure_icp_default_p);
	temp_1 = EQUAL(G2int_gsi_undefined_context,temp);
    }
    else
	temp_1 = TRUEP(Nil);
    if ( !temp_1 ? listeners_exist_p || G2int_active_icp_sockets : TRUEP(Nil))
	return g2int_enter_abyss();
    else
	return VALUES_1(Nil);
}

Object G2int_enable_run_gsi = UNBOUND;

static Object Qg2int_top_level_error_catcher;  /* top-level-error-catcher */

/* RUN-GSI */
Object g2int_run_gsi(gensym_window)
    Object gensym_window;
{
    Object top_level_error_catcher_tag, error_occurred_p;
    Declare_catch(1);
    Declare_special(1);

    x_note_fn_call(47,167);
    if (g2int_gsi_option_is_set_p(G2int_gsi_trace_run_loop))
	format((SI_Long)2L,T,"Entering gsi_start");
    Gc_silence = Nil;
    if (G2int_enable_run_gsi) {
	if (G2int_do_error_trappingqm) {
	    top_level_error_catcher_tag = Qg2int_top_level_error_catcher;
	    PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
		    0);
	      if (PUSH_CATCH(G2int_top_level_error_catcher_tag,0)) {
		  G2int_top_level_error_seen = Nil;
		  g2int_register_all_signal_handlers();
		  g2int_run_gsi_1();
		  error_occurred_p = Nil;
	      }
	      else
		  error_occurred_p = CATCH_VALUES();
	      POP_CATCH(0);
	    POP_SPECIAL();
	    if (error_occurred_p) {
		g2int_minimal_internal_error_given_format_info(G2int_gensym_error_format_string,
			G2int_gensym_error_argument_list,
			G2int_gensym_error_sure_of_format_info_p);
		g2int_abort_gsi_top_level();
	    }
	}
	else
	    g2int_run_gsi_1();
    }
    if (g2int_gsi_option_is_set_p(G2int_gsi_trace_run_loop))
	format((SI_Long)2L,T,"Leaving gsi_start~%");
    return g2int_shutdown_or_exit(0);
}

static Object Qg2int_gsi_start;    /* |gsi_start| */

/* SHARED-GSI-START */
void g2int_shared_gsi_start(gsi_fc_outer_argc,argv)
    Object argv;
    SI_Long gsi_fc_outer_argc;
{
    Object argc, enable_run_gsi, write_console_p;
    SI_Long value;
    Declare_special(2);

    x_note_fn_call(47,168);
    value = gsi_fc_outer_argc;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_start,Qerror,T);
	goto end_shared_gsi_start;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_start,Qerror,T);
	goto end_shared_gsi_start;
    }
    argc = LONG_TO_FIXNUM(value);
    gsi_log_command_line(FIXNUM_TO_INT(argc),argv);
    enable_run_gsi = T;
    write_console_p = T;
    PUSH_SPECIAL(G2int_starwrite_console_pstar,write_console_p,1);
      PUSH_SPECIAL(G2int_enable_run_gsi,enable_run_gsi,0);
	g2int_run_gsi(Nil);
      POP_SPECIAL();
    POP_SPECIAL();
  end_shared_gsi_start:;
}

static Object string_constant_51;  /* "gsi_start" */

/* GSI-START */
DLLEXPORT void gsi_start(argc,argv)
    Object argv;
    SI_Long argc;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,169);
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_51);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_start(argc,argv);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_start(argc,argv);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_51);
}

/* GSI-INIT-ERROR */
Object g2int_gsi_init_error varargs_1(int, n)
{
    Object originating_function, error_code;
    Object arg1, arg2, arg3, arg4, arg5, arg6;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,170);
    INIT_ARGS_nonrelocating();
    originating_function = REQUIRED_ARG_nonrelocating();
    error_code = REQUIRED_ARG_nonrelocating();
    arg1 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg2 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg3 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg4 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg5 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg6 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    g2int_set_gsi_error_message_1(Nil,error_code,arg1,arg2,arg3,arg4,arg5,
	    arg6);
    g2int_gsi_handle_error_1(Qg2int_gsi_start,Qerror,T);
    return VALUES_1(Nil);
}

/* GSI-ERROR */
Object g2int_gsi_error varargs_1(int, n)
{
    Object originating_function, error_code;
    Object arg1, arg2, arg3, arg4, arg5, arg6;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,171);
    INIT_ARGS_nonrelocating();
    originating_function = REQUIRED_ARG_nonrelocating();
    error_code = REQUIRED_ARG_nonrelocating();
    arg1 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg2 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg3 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg4 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg5 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg6 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    g2int_set_gsi_error_message_1(Nil,error_code,arg1,arg2,arg3,arg4,arg5,
	    arg6);
    return g2int_gsi_handle_error_1(originating_function,Qerror,Nil);
}

/* GSI-ERROR-NO-EXIT */
Object g2int_gsi_error_no_exit varargs_1(int, n)
{
    Object originating_function, error_code;
    Object arg1, arg2, arg3, arg4, arg5, arg6;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,172);
    INIT_ARGS_nonrelocating();
    originating_function = REQUIRED_ARG_nonrelocating();
    error_code = REQUIRED_ARG_nonrelocating();
    arg1 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg2 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg3 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg4 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg5 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg6 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    g2int_set_gsi_error_message_1(Nil,error_code,arg1,arg2,arg3,arg4,arg5,
	    arg6);
    return g2int_gsi_handle_error_1(originating_function,Qerror,T);
}

/* GSI-CONNECTION-ERROR */
Object g2int_gsi_connection_error varargs_1(int, n)
{
    Object originating_function, error_code;
    Object arg1, arg2, arg3, arg4, arg5, arg6;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,173);
    INIT_ARGS_nonrelocating();
    originating_function = REQUIRED_ARG_nonrelocating();
    error_code = REQUIRED_ARG_nonrelocating();
    arg1 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg2 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg3 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg4 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg5 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg6 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    g2int_set_gsi_error_message_1(Nil,error_code,arg1,arg2,arg3,arg4,arg5,
	    arg6);
    return g2int_gsi_handle_error_1(originating_function,Qg2int_connection,
	    Nil);
}

/* GSI-CONNECTION-ERROR-NO-EXIT */
Object g2int_gsi_connection_error_no_exit varargs_1(int, n)
{
    Object originating_function, error_code;
    Object arg1, arg2, arg3, arg4, arg5, arg6;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,174);
    INIT_ARGS_nonrelocating();
    originating_function = REQUIRED_ARG_nonrelocating();
    error_code = REQUIRED_ARG_nonrelocating();
    arg1 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg2 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg3 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg4 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg5 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg6 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    g2int_set_gsi_error_message_1(Nil,error_code,arg1,arg2,arg3,arg4,arg5,
	    arg6);
    return g2int_gsi_handle_error_1(originating_function,Qg2int_connection,T);
}

/* GSI-FATAL-ERROR */
Object g2int_gsi_fatal_error varargs_1(int, n)
{
    Object originating_function, error_code;
    Object arg1, arg2, arg3, arg4, arg5, arg6;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,175);
    INIT_ARGS_nonrelocating();
    originating_function = REQUIRED_ARG_nonrelocating();
    error_code = REQUIRED_ARG_nonrelocating();
    arg1 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg2 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg3 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg4 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg5 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg6 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    g2int_set_gsi_error_message_1(Nil,error_code,arg1,arg2,arg3,arg4,arg5,
	    arg6);
    return g2int_gsi_handle_error_1(originating_function,Qg2int_fatal,Nil);
}

/* GSI-WARNING */
Object g2int_gsi_warning varargs_1(int, n)
{
    Object originating_function, error_code;
    Object arg1, arg2, arg3, arg4, arg5, arg6;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,176);
    INIT_ARGS_nonrelocating();
    originating_function = REQUIRED_ARG_nonrelocating();
    error_code = REQUIRED_ARG_nonrelocating();
    arg1 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg2 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg3 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg4 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg5 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    arg6 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : Nil;
    END_ARGS_nonrelocating();
    g2int_set_gsi_error_message_1(Nil,error_code,arg1,arg2,arg3,arg4,arg5,
	    arg6);
    g2int_gsi_handle_error_1(originating_function,Qg2int_warning,Nil);
    return VALUES_1(Nil);
}

/* GSI-MESSAGE */
Object g2int_gsi_message varargs_1(int, n)
{
    Object message_as_format_string;
    Object arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,177);
    INIT_ARGS_nonrelocating();
    message_as_format_string = REQUIRED_ARG_nonrelocating();
    arg1 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : 
	    G2int_no_arg;
    arg2 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : 
	    G2int_no_arg;
    arg3 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : 
	    G2int_no_arg;
    arg4 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : 
	    G2int_no_arg;
    arg5 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : 
	    G2int_no_arg;
    arg6 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : 
	    G2int_no_arg;
    arg7 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : 
	    G2int_no_arg;
    arg8 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : 
	    G2int_no_arg;
    arg9 = OPTIONAL_ARG_P_nonrelocating() ? OPTIONAL_ARG_nonrelocating() : 
	    G2int_no_arg;
    END_ARGS_nonrelocating();
    if ( !TRUEP(g2int_gsi_option_is_set_p(G2int_gsi_suppress_output)))
	return g2int_notify_user_at_console(10,message_as_format_string,
		arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9);
    else
	return VALUES_1(Nil);
}

static Object array_constant_1;    /* # */

static Object Qab_g2int_derive_network_listeners;  /* derive_network_listeners */

/* DERIVE-NETWORK-LISTENERS */
Object g2int_derive_network_listeners()
{
    Object command_line_index, network_1_qm, address_1_qm;
    Object result;

    x_note_fn_call(47,178);
    command_line_index = FIX((SI_Long)1L);
    network_1_qm = Nil;
    address_1_qm = Nil;
    G2int_gsi_extension_tcp_addressqm = g2int_get_preset_tcp_port_number();
    result = g2int_get_listener_from_command_line(command_line_index);
    MVS_3(result,command_line_index,network_1_qm,address_1_qm);
    if (address_1_qm || network_1_qm) {
	if (g2int_equalw(network_1_qm,array_constant_1))
	    return g2int_gsi_store_desired_tcp_port_number(address_1_qm);
	else if ( !TRUEP(network_1_qm)) {
	    if (g2int_suitable_string_for_tcp_addressqm(address_1_qm)) {
		G2int_gsi_extension_tcp_addressqm = 
			g2int_text_string_parse_integer_function(address_1_qm,
			FIX((SI_Long)0L),Nil,Nil);
		return VALUES_1(T);
	    }
	    else {
		g2int_gsi_init_error(3,Qab_g2int_derive_network_listeners,
			G2int_gsi_invalid_protocol,address_1_qm);
		return VALUES_1(Nil);
	    }
	}
	else {
	    g2int_gsi_init_error(3,Qab_g2int_derive_network_listeners,
		    G2int_gsi_invalid_protocol,network_1_qm);
	    return VALUES_1(Nil);
	}
    }
    return VALUES_1(T);
}

Object G2int_gsi_flag_arguments = UNBOUND;

Object G2int_gsi_keyword_arguments = UNBOUND;

/* GET-GENSYM-COMMAND-LINE-ARGUMENT-COUNT */
Object g2int_get_gensym_command_line_argument_count()
{
    x_note_fn_call(47,179);
    return VALUES_1(G2int_unix_command_line_argument_count);
}

static Object array_constant_2;    /* # */

static Object Qg2int_string_equalw;  /* string-equalw */

/* GET-LISTENER-FROM-COMMAND-LINE */
Object g2int_get_listener_from_command_line(command_line_index)
    Object command_line_index;
{
    Object argument_count, token, network_qm, address_qm;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,180);
    argument_count = g2int_get_gensym_command_line_argument_count();
    token = Nil;
    network_qm = Nil;
    address_qm = Nil;
    i = IFIX(command_line_index);
    ab_loop_bind_ = IFIX(argument_count);
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    if (network_qm)
	goto end_loop;
    token = g2int_get_gensym_command_line_argument_as_text_string(FIX(i));
    if (g2int_string_equalw(token,array_constant_2))
	network_qm = g2int_get_gensym_command_line_argument(FIX(i + 
		(SI_Long)1L));
    else if (member(4,token,G2int_gsi_flag_arguments,Ktest,
	    SYMBOL_FUNCTION(Qg2int_string_equalw)));
    else if (member(4,token,G2int_gsi_keyword_arguments,Ktest,
	    SYMBOL_FUNCTION(Qg2int_string_equalw)))
	i = i + (SI_Long)1L;
    else if (address_qm)
	return VALUES_3(FIX(i),network_qm,address_qm);
    else
	address_qm = token;
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:
    return VALUES_3(FIX(i + (SI_Long)1L),network_qm,address_qm);
    return VALUES_1(Qnil);
}

static Object array_constant_3;    /* # */

/* GSI-NO-LISTENER-P */
Object g2int_gsi_no_listener_p()
{
    x_note_fn_call(47,181);
    return g2int_get_command_line_flag_argument(1,array_constant_3);
}

static Object array_constant_4;    /* # */

/* GSI-NO-CONNECT-P */
Object g2int_gsi_no_connect_p()
{
    x_note_fn_call(47,182);
    return g2int_get_command_line_flag_argument(1,array_constant_4);
}

static Object array_constant_5;    /* # */

/* GSI-CONNECT-P */
Object g2int_gsi_connect_p()
{
    x_note_fn_call(47,183);
    return g2int_get_command_line_flag_argument(1,array_constant_5);
}

Object G2int_gsi_command_line_network = UNBOUND;

Object G2int_gsi_command_line_host = UNBOUND;

Object G2int_gsi_command_line_port = UNBOUND;

static Object array_constant_6;    /* # */

static Object array_constant_7;    /* # */

static Object array_constant_8;    /* # */

static Object array_constant_9;    /* # */

static Object array_constant_10;   /* # */

static Object array_constant_11;   /* # */

static Object array_constant_12;   /* # */

/* GET-CONNECT-ADDRESS-FROM-COMMAND-LINE */
Object g2int_get_connect_address_from_command_line()
{
    Object interface_name, class_name, network, host, port, init_string;

    x_note_fn_call(47,184);
    interface_name = g2int_get_command_line_keyword_argument(1,
	    array_constant_6);
    class_name = g2int_get_command_line_keyword_argument(1,array_constant_7);
    network = g2int_get_command_line_keyword_argument(1,array_constant_8);
    host = g2int_get_command_line_keyword_argument(1,array_constant_9);
    port = g2int_get_command_line_keyword_argument(1,array_constant_10);
    init_string = g2int_get_command_line_keyword_argument(1,array_constant_11);
    if (g2int_equalw(interface_name,array_constant_12))
	interface_name = Nil;
    if (interface_name)
	interface_name = 
		g2int_gsi_intern(g2int_copy_text_string(interface_name));
    if (g2int_equalw(class_name,array_constant_12))
	class_name = Nil;
    if (class_name)
	class_name = g2int_gsi_intern(g2int_copy_text_string(class_name));
    if (interface_name || class_name || network || host || port || 
		init_string) {
	G2int_gsi_command_line_network = network;
	G2int_gsi_command_line_host = host;
	G2int_gsi_command_line_port = port;
	return VALUES_6(interface_name,class_name,network,host,port,
		init_string);
    }
    else
	return VALUES_1(Nil);
}

static Object array_constant_13;   /* # */

static Object array_constant_14;   /* # */

static Object Qg2int_tcp_ip;       /* tcp-ip */

static Object string_constant_52;  /* "~%Unknown network type ~A~%" */

static Object array_constant_15;   /* # */

static Object array_constant_16;   /* # */

/* GSI-GET-NETWORK-CONFIGURATION */
Object g2int_gsi_get_network_configuration varargs_1(int, n)
{
    Object network, host, port;
    Object secure_qm, temp, temp_1, network_symbol, code_1;
    SI_Long code;
    char temp_2;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,185);
    INIT_ARGS_nonrelocating();
    network = REQUIRED_ARG_nonrelocating();
    host = REQUIRED_ARG_nonrelocating();
    port = REQUIRED_ARG_nonrelocating();
    secure_qm = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : G2int_secure_icp_default_p;
    END_ARGS_nonrelocating();
    if (g2int_equalw(host,array_constant_12))
	host = Nil;
    if ( !TRUEP(host))
	host = G2int_gsi_command_line_host;
    if ( !(host &&  !TRUEP(g2int_equalw(host,array_constant_12))))
	host = array_constant_13;
    if (g2int_equalw(network,array_constant_12))
	network = Nil;
    if ( !TRUEP(network))
	network = G2int_gsi_command_line_network;
    if ( !(network &&  !TRUEP(g2int_equalw(network,array_constant_12))))
	network = array_constant_14;
    code = UBYTE_16_ISAREF_1(network,(SI_Long)0L);
    if (code < (SI_Long)127L)
	temp = (SI_Long)65L <= code && code <= (SI_Long)90L ? FIX(code + 
		(SI_Long)32L) : FIX(code);
    else {
	temp = g2int_unicode_lowercase_if_uppercase(FIX(code));
	if (temp);
	else
	    temp = FIX(code);
    }
    code = (SI_Long)84L;
    if (code < (SI_Long)127L)
	temp_1 = (SI_Long)65L <= code && code <= (SI_Long)90L ? FIX(code + 
		(SI_Long)32L) : FIX(code);
    else {
	temp_1 = g2int_unicode_lowercase_if_uppercase(FIX(code));
	if (temp_1);
	else
	    temp_1 = FIX(code);
    }
    if (NUM_EQ(temp,temp_1))
	network_symbol = Qg2int_tcp_ip;
    else {
	g2int_gsi_message(2,string_constant_52,network);
	return VALUES_1(Nil);
    }
    if (g2int_equalw(port,array_constant_12))
	port = Nil;
    if ( !TRUEP(port) && G2int_gsi_command_line_port &&  
	    !TRUEP(g2int_equalw(array_constant_12,
	    G2int_gsi_command_line_port))) {
	temp_2 =  !TRUEP(G2int_gsi_command_line_network);
	if (temp_2);
	else {
	    code_1 = aref1(G2int_gsi_command_line_network,FIX((SI_Long)0L));
	    if (IFIX(code_1) < (SI_Long)127L)
		temp_1 = (SI_Long)65L <= IFIX(code_1) && IFIX(code_1) <= 
			(SI_Long)90L ? FIX(IFIX(code_1) + (SI_Long)32L) : 
			code_1;
	    else {
		temp_1 = g2int_unicode_lowercase_if_uppercase(code_1);
		if (temp_1);
		else
		    temp_1 = code_1;
	    }
	    code_1 = aref1(network,FIX((SI_Long)0L));
	    if (IFIX(code_1) < (SI_Long)127L)
		temp = (SI_Long)65L <= IFIX(code_1) && IFIX(code_1) <= 
			(SI_Long)90L ? FIX(IFIX(code_1) + (SI_Long)32L) : 
			code_1;
	    else {
		temp = g2int_unicode_lowercase_if_uppercase(code_1);
		if (temp);
		else
		    temp = code_1;
	    }
	    temp_2 = NUM_EQ(temp_1,temp);
	}
    }
    else
	temp_2 = TRUEP(Nil);
    if (temp_2)
	port = G2int_gsi_command_line_port;
    if ( !TRUEP(port))
	port = EQ(network_symbol,Qg2int_tcp_ip) ? array_constant_15 : 
		array_constant_16;
    return g2int_gensym_list_4(network_symbol,host,port,secure_qm);
}

/* SUITABLE-STRING-FOR-TCP-ADDRESS? */
Object g2int_suitable_string_for_tcp_addressqm(string_qm)
    Object string_qm;
{
    SI_Long index_1, ab_loop_bind_, gensymed_symbol;
    char temp;

    x_note_fn_call(47,186);
    if (string_qm) {
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(g2int_text_string_length(string_qm));
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	gensymed_symbol = UBYTE_16_ISAREF_1(string_qm,index_1);
	if ( !((SI_Long)48L <= gensymed_symbol && gensymed_symbol <= 
		(SI_Long)57L ? TRUEP(FIX(gensymed_symbol - (SI_Long)48L)) :
		 TRUEP(Nil))) {
	    temp = TRUEP(Nil);
	    goto end;
	}
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:
	temp = TRUEP(T);
	goto end;
	temp = TRUEP(Qnil);
      end:;
    }
    else
	temp = TRUEP(Nil);
    return VALUES_1(temp ? string_qm : Nil);
}

static Object Qg2int_get_preset_tcp_port;  /* get_preset_tcp_port */

/* GET-PRESET-TCP-PORT-NUMBER */
Object g2int_get_preset_tcp_port_number()
{
    Object tcp_address_qm, temp;

    x_note_fn_call(47,187);
    tcp_address_qm = g2int_call_gsi_callback(1,G2int_gsi_get_tcp_port);
    if (minusp(tcp_address_qm))
	g2int_gsi_error(3,Qg2int_get_preset_tcp_port,
		G2int_gsi_invalid_tcp_port_number,tcp_address_qm);
    temp = FIX((SI_Long)0L);
    return VALUES_1(NUM_EQ(tcp_address_qm,temp) ? Nil : tcp_address_qm);
}

/* GSI-STORE-DESIRED-TCP-PORT-NUMBER */
Object g2int_gsi_store_desired_tcp_port_number(port_number_qm)
    Object port_number_qm;
{
    Object temp;

    x_note_fn_call(47,188);
    if (port_number_qm) {
	if (g2int_suitable_string_for_tcp_addressqm(port_number_qm)) {
	    G2int_gsi_extension_tcp_addressqm = 
		    g2int_text_string_parse_integer_function(port_number_qm,
		    FIX((SI_Long)0L),Nil,Nil);
	    temp = G2int_gsi_extension_tcp_addressqm;
	}
	else
	    temp = g2int_gsi_init_error(3,
		    Qab_g2int_derive_network_listeners,
		    G2int_gsi_invalid_tcp_port_number,port_number_qm);
    }
    else {
	temp = g2int_get_preset_tcp_port_number();
	if (temp);
	else
	    temp = G2int_default_gsi_extension_tcp_address;
	G2int_gsi_extension_tcp_addressqm = temp;
	temp = G2int_gsi_extension_tcp_addressqm;
    }
    return VALUES_1(temp);
}

static Object array_constant_17;   /* # */

static Object Qg2int_do_not_use;   /* do-not-use */

static Object string_constant_53;  /* "Waiting to accept a connection on:~%" */

static Object string_constant_54;  /* "~a:~a:~a~a~%" */

static Object Ksecure_p;           /* :secure-p */

/* ESTABLISH-GSI-LISTENERS */
Object g2int_establish_gsi_listeners()
{
    Object specified_tcp_address, listener_count, listeners;
    Object current_wide_string_list, wide_string_bv16, current_wide_string;
    Object fill_pointer_for_current_wide_string;
    Object total_length_of_current_wide_string, current_twriting_output_type;
    Object host_name, listener, ab_loop_list_, temp, temp_1, message;
    SI_Long bv16_length, aref_arg_2, aref_new_value, length_1;
    char allow_default_addresses_p;
    Declare_special(5);

    x_note_fn_call(47,189);
    specified_tcp_address = G2int_gsi_extension_tcp_addressqm;
    if (specified_tcp_address);
    else
	specified_tcp_address = 
		g2int_get_command_line_keyword_argument_as_integer(1,
		array_constant_17);
    allow_default_addresses_p =  !TRUEP(specified_tcp_address);
    listener_count = 
	    g2int_establish_initial_gsi_listener(specified_tcp_address,
	    allow_default_addresses_p ? T : Nil);
    if (IFIX(listener_count) == (SI_Long)0L) {
	g2int_gsi_init_error(2,Nil,G2int_gsi_noop_code_accessed);
	g2int_shutdown_or_exit(0);
    }
    listeners = g2int_get_local_host_addresses();
    if (listeners) {
	current_wide_string_list = Qg2int_do_not_use;
	PUSH_SPECIAL(G2int_current_wide_string_list,current_wide_string_list,
		4);
	  wide_string_bv16 = 
		  g2int_allocate_byte_vector_16(FIX((SI_Long)2048L + 
		  (SI_Long)3L));
	  bv16_length = IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(wide_string_bv16));
	  aref_arg_2 = bv16_length - (SI_Long)2L;
	  aref_new_value = (SI_Long)2048L & (SI_Long)65535L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  aref_arg_2 = bv16_length - (SI_Long)1L;
	  aref_new_value = (SI_Long)57344L | (SI_Long)0L;
	  UBYTE_16_ISASET_1(wide_string_bv16,aref_arg_2,aref_new_value);
	  UBYTE_16_ISASET_1(wide_string_bv16,(SI_Long)2048L,(SI_Long)0L);
	  current_wide_string = wide_string_bv16;
	  PUSH_SPECIAL(G2int_current_wide_string,current_wide_string,3);
	    fill_pointer_for_current_wide_string = FIX((SI_Long)0L);
	    PUSH_SPECIAL(G2int_fill_pointer_for_current_wide_string,fill_pointer_for_current_wide_string,
		    2);
	      length_1 = 
		      IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(G2int_current_wide_string));
	      total_length_of_current_wide_string = 
		      FIX(UBYTE_16_ISAREF_1(G2int_current_wide_string,
		      length_1 - (SI_Long)2L) + 
		      ((UBYTE_16_ISAREF_1(G2int_current_wide_string,
		      length_1 - (SI_Long)1L) & (SI_Long)8191L) << 
		      (SI_Long)16L));
	      PUSH_SPECIAL(G2int_total_length_of_current_wide_string,total_length_of_current_wide_string,
		      1);
		current_twriting_output_type = Qg2int_wide_string;
		PUSH_SPECIAL(G2int_current_twriting_output_type,current_twriting_output_type,
			0);
		  g2int_tformat(1,string_constant_53);
		  host_name = g2int_get_local_host_name();
		  listener = Nil;
		  ab_loop_list_ = listeners;
		next_loop:
		  if ( !TRUEP(ab_loop_list_))
		      goto end_loop;
		  listener = M_CAR(ab_loop_list_);
		  ab_loop_list_ = M_CDR(ab_loop_list_);
		  temp = FIRST(listener);
		  temp_1 = SECOND(listener);
		  g2int_tformat(5,string_constant_54,temp,host_name,temp_1,
			  g2int_secure_icp_string(2,Ksecure_p,
			  THIRD(listener)));
		  goto next_loop;
		end_loop:;
		  message = g2int_copy_out_current_wide_string();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
	g2int_reclaim_network_addresses(listeners);
	g2int_gsi_message(1,message);
	g2int_reclaim_text_string(message);
    }
    return VALUES_1(T);
}

static Object array_constant_18;   /* # */

/* ESTABLISH-INITIAL-GSI-LISTENER */
Object g2int_establish_initial_gsi_listener(specified_address,
	    allow_default_addresses_p)
    Object specified_address, allow_default_addresses_p;
{
    Object temp, temp_1, error_code;

    x_note_fn_call(47,190);
    if (specified_address || allow_default_addresses_p) {
	if (g2int_secure_icp_requested_p())
	    g2int_set_up_secure_icp(1,Qg2int_default);
	temp = specified_address;
	if (temp);
	else
	    temp = G2int_default_gsi_extension_tcp_address;
	temp_1 = g2int_get_command_line_flag_argument(1,array_constant_18);
	error_code = g2int_establish_gsi_listener(3,temp,temp_1,
		g2int_secure_icp_requested_p());
	if ( !TRUEP(error_code))
	    temp_1 = FIX((SI_Long)1L);
	else if (FIXNUM_EQ(error_code,G2int_gsi_noop_code_accessed))
	    temp_1 = FIX((SI_Long)0L);
	else {
	    g2int_gsi_init_error(2,Nil,error_code);
	    temp_1 = g2int_shutdown_or_exit(0);
	}
    }
    else
	temp_1 = FIX((SI_Long)0L);
    return VALUES_1(temp_1);
}

static Object Qg2int_register_gsi_connection_callbacks;  /* register-gsi-connection-callbacks */

/* ESTABLISH-GSI-LISTENER */
Object g2int_establish_gsi_listener varargs_1(int, n)
{
    Object address, exact_p;
    Object secure_p, temp_1, error_code, connection_name;
    SI_Long temp, listen_status;
    Declare_varargs_nonrelocating;

    x_note_fn_call(47,191);
    INIT_ARGS_nonrelocating();
    address = REQUIRED_ARG_nonrelocating();
    exact_p = REQUIRED_ARG_nonrelocating();
    secure_p = OPTIONAL_ARG_P_nonrelocating() ? 
	    OPTIONAL_ARG_nonrelocating() : G2int_secure_icp_default_p;
    END_ARGS_nonrelocating();
    if (FIXNUMP(address))
	temp = IFIX(address);
    else {
	temp_1 = g2int_text_string_parse_integer_function(address,
		FIX((SI_Long)0L),Nil,Nil);
	if (temp_1);
	else
	    temp_1 = G2int_default_gsi_extension_tcp_address;
	temp = IFIX(temp_1);
    }
    listen_status = 
	    g2ext_network_listen(IFIX(G2int_use_tcpip_protocol_only),temp,
	    exact_p ? (SI_Long)1L : (SI_Long)0L,
	    IFIX(G2int_gsi_product_tag),secure_p ? (SI_Long)1L : (SI_Long)0L);
    if (EQ(FIX(listen_status),FIX((SI_Long)-2L)))
	error_code = G2int_gsi_noop_code_accessed;
    else if ( !EQ(FIX(listen_status),FIX((SI_Long)1L)) && exact_p)
	error_code = G2int_gsi_cannot_establish_listener;
    else
	error_code = Qnil;
    if (error_code)
	return VALUES_1(error_code);
    connection_name = g2int_get_network_listener(FIX((SI_Long)0L));
    if ( !TRUEP(G2int_tcp_listener_port_number))
	G2int_tcp_listener_port_number = 
		g2int_get_tcp_listener_port_number(connection_name);
    g2int_register_icp_accept_callback(Qg2int_register_gsi_connection_callbacks,
	    g2int_make_and_install_network_listener(FIX(ne_get_listener_handle((SI_Long)0L)),
	    connection_name));
    return VALUES_1(Nil);
}

static Object Qg2int_gsi_establish_listener;  /* |gsi_establish_listener| */

/* SHARED-GSI-ESTABLISH-LISTENER */
SI_Long g2int_shared_gsi_establish_listener(wide_api_p,
	    gsi_fc_outer_network,gsi_fc_outer_port,gsi_fc_outer_exact)
    Object wide_api_p, gsi_fc_outer_network, gsi_fc_outer_port;
    SI_Long gsi_fc_outer_exact;
{
    Object network, port, exact, error_code;
    SI_Long value, result_1, gsi_fc_result;

    x_note_fn_call(47,192);
    network = wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_network) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_network);
    port = wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_port) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_port);
    value = gsi_fc_outer_exact;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_establish_listener,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_establish_listener;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_establish_listener,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_establish_listener;
    }
    exact = LONG_TO_FIXNUM(value);
    error_code = g2int_establish_gsi_listener(3,port, !(IFIX(exact) == 
	    (SI_Long)0L) ? T : Nil,Nil);
    if (error_code) {
	g2int_set_gsi_error_message_1(Nil,error_code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_establish_listener,Qerror,T);
	g2int_reclaim_text_or_gensym_string(network);
	g2int_reclaim_text_or_gensym_string(port);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_establish_listener;
    }
    gsi_fc_result = (SI_Long)1L;
    g2int_reclaim_text_or_gensym_string(network);
    g2int_reclaim_text_or_gensym_string(port);
    result_1 = gsi_fc_result;
  end_shared_gsi_establish_listener:;
    return result_1;
}

static Object string_constant_55;  /* "gsi_establish_listener" */

/* GSI-ESTABLISH-LISTENER */
DLLEXPORT SI_Long gsi_establish_listener(network,port,exact)
    Object network, port;
    SI_Long exact;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,193);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_55);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_establish_listener(G2int_gsi_wide_api_p,
		    network,port,exact));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_establish_listener(G2int_gsi_wide_api_p,
			    network,port,exact));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_55);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_establish_secure_listener;  /* |gsi_establish_secure_listener| */

/* SHARED-GSI-ESTABLISH-SECURE-LISTENER */
SI_Long g2int_shared_gsi_establish_secure_listener(wide_api_p,
	    gsi_fc_outer_network,gsi_fc_outer_port,gsi_fc_outer_exact,
	    gsi_fc_outer_cert)
    Object wide_api_p, gsi_fc_outer_network, gsi_fc_outer_port;
    Object gsi_fc_outer_cert;
    SI_Long gsi_fc_outer_exact;
{
    Object network, port, exact, cert, error_code;
    SI_Long value, result_1, gsi_fc_result;

    x_note_fn_call(47,194);
    network = wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_network) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_network);
    port = wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_port) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_port);
    value = gsi_fc_outer_exact;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_establish_secure_listener,
		Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_establish_secure_listener;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_establish_secure_listener,
		Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_establish_secure_listener;
    }
    exact = LONG_TO_FIXNUM(value);
    cert =  !TRUEP(gsi_fc_outer_cert) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_cert) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_cert);
    if (cert &&  !TRUEP(G2int_secure_icp_initialized_p)) {
	if (cert)
	    g2int_update_server_certificate(cert);
	g2int_set_up_secure_icp(0);
    }
    error_code = g2int_establish_gsi_listener(3,port, !(IFIX(exact) == 
	    (SI_Long)0L) ? T : Nil,FIX((SI_Long)1L));
    if (error_code) {
	g2int_set_gsi_error_message_1(Nil,error_code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_establish_secure_listener,
		Qerror,T);
	g2int_reclaim_text_or_gensym_string(network);
	g2int_reclaim_text_or_gensym_string(port);
	g2int_reclaim_if_text_or_gensym_string_function(cert);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_establish_secure_listener;
    }
    gsi_fc_result = (SI_Long)1L;
    g2int_reclaim_text_or_gensym_string(network);
    g2int_reclaim_text_or_gensym_string(port);
    g2int_reclaim_if_text_or_gensym_string_function(cert);
    result_1 = gsi_fc_result;
  end_shared_gsi_establish_secure_listener:;
    return result_1;
}

static Object string_constant_56;  /* "gsi_establish_secure_listener" */

/* GSI-ESTABLISH-SECURE-LISTENER */
DLLEXPORT SI_Long gsi_establish_secure_listener(network,port,exact,cert)
    Object network, port, cert;
    SI_Long exact;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,195);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_56);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_establish_secure_listener(G2int_gsi_wide_api_p,
		    network,port,exact,cert));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_establish_secure_listener(G2int_gsi_wide_api_p,
			    network,port,exact,cert));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_56);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

/* SHARED-GSI-CLOSE-LISTENERS */
void g2int_shared_gsi_close_listeners()
{
    Object list_1, icp_socket, next_list;

    x_note_fn_call(47,196);
    list_1 = G2int_active_icp_sockets;
    icp_socket = Nil;
    next_list = Nil;
  next_loop:
    icp_socket = CAR(list_1);
    next_list = CDR(list_1);
    if ( !TRUEP(list_1))
	goto end_loop;
    if (FIXNUM_EQ(ISVREF(icp_socket,(SI_Long)15L),G2int_icp_socket_listening))
	g2int_close_and_disconnect_icp_socket_handle(icp_socket);
    list_1 = next_list;
    goto next_loop;
  end_loop:
    goto end;
  end:;
}

static Object string_constant_57;  /* "gsi_close_listeners" */

/* GSI-CLOSE-LISTENERS */
DLLEXPORT void gsi_close_listeners()
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,197);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_57);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_close_listeners();
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_close_listeners();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_57);
}

Object G2int_gsi_icp_sockets_waiting_for_connect = UNBOUND;

static Object array_constant_19;   /* # */

static Object Qg2int_g2;           /* g2 */

static Object Qg2int_gsi_maybe_notice_delayed_connection_failure;  /* gsi-maybe-notice-delayed-connection-failure */

static Object Qg2int_requested;    /* requested */

static Object Qg2int_gsi_maybe_initiate_delayed_connection;  /* gsi-maybe-initiate-delayed-connection */

/* INITIATE-GSI-CONNECTION */
Object g2int_initiate_gsi_connection(interface_name,class_name,
	    keep_connection_on_g2_reset,network,host,port,
	    remote_process_initialization_string,context_user_data,secure)
    Object interface_name, class_name, keep_connection_on_g2_reset, network;
    Object host, port, remote_process_initialization_string, context_user_data;
    Object secure;
{
    Object application, localp, network_configuration;
    Object network_plus_host_plus_port, icp_socket, current_icp_socket;
    Object gsi_extension_data, temp, svref_new_value, gensymed_symbol;
    Object gensymed_symbol_1;
    Declare_special(2);
    Object result;

    x_note_fn_call(47,198);
    application = g2int_current_gsi_application();
    localp = g2int_string_equalw(array_constant_19,network);
    network_configuration = g2int_gsi_get_network_configuration(4,network,
	    host,port,secure);
    network_plus_host_plus_port = localp ? 
	    g2int_copy_constant_wide_string_given_length(array_constant_19,
	    FIX((SI_Long)5L)) : 
	    g2int_make_network_pathname(network_configuration);
    if (network_plus_host_plus_port);
    else {
	g2int_reclaim_gensym_list_1(network_configuration);
	return VALUES_1(G2int_gsi_undefined_context);
    }
    icp_socket =  !(IFIX(G2int_gsi_maximum_number_of_contexts) >= 
	    (SI_Long)0L && FIXNUM_GE(G2int_number_of_contexts_allocated,
	    G2int_gsi_maximum_number_of_contexts)) ? (localp ? 
	    g2int_make_localnet_connection(2,
	    g2int_copy_constant_wide_string_given_length(array_constant_19,
	    FIX((SI_Long)5L)),Qg2int_g2) : g2int_make_network_connection(1,
	    network_configuration)) : Nil;
    if (icp_socket);
    else {
	g2int_reclaim_wide_string(network_plus_host_plus_port);
	g2int_reclaim_gensym_list_1(network_configuration);
	return VALUES_1(G2int_gsi_undefined_context);
    }
    current_icp_socket = icp_socket;
    PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,1);
      gsi_extension_data = ISVREF(icp_socket,(SI_Long)29L);
      remote_process_initialization_string = 
	      remote_process_initialization_string ? 
	      g2int_copy_text_string(remote_process_initialization_string) 
	      : Nil;
      g2int_reclaim_gensym_list_1(network_configuration);
      temp = ISVREF(application,(SI_Long)1L);
      SVREF(icp_socket,FIX((SI_Long)52L)) = temp;
      SVREF(gsi_extension_data,FIX((SI_Long)9L)) = application;
      temp = ISVREF(icp_socket,(SI_Long)29L);
      current_icp_socket = icp_socket;
      PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,0);
	svref_new_value = g2int_allocate_gsi_context_number();
      POP_SPECIAL();
      SVREF(temp,FIX((SI_Long)1L)) = svref_new_value;
      SVREF(gsi_extension_data,FIX((SI_Long)2L)) = context_user_data;
      gensymed_symbol = g2int_make_gensym_list_1(FIX((SI_Long)6L));
      gensymed_symbol_1 = gensymed_symbol;
      M_CAR(gensymed_symbol_1) = icp_socket;
      gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
      M_CAR(gensymed_symbol_1) = network_plus_host_plus_port;
      gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
      M_CAR(gensymed_symbol_1) = interface_name;
      gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
      M_CAR(gensymed_symbol_1) = class_name;
      gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
      M_CAR(gensymed_symbol_1) = keep_connection_on_g2_reset;
      gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
      M_CAR(gensymed_symbol_1) = remote_process_initialization_string;
      G2int_gsi_icp_sockets_waiting_for_connect = 
	      g2int_gensym_cons_1(gensymed_symbol,
	      G2int_gsi_icp_sockets_waiting_for_connect);
      g2int_register_icp_connection_loss_callback(Qg2int_gsi_maybe_notice_delayed_connection_failure,
	      icp_socket);
      if (g2int_gsi_option_is_set_p(G2int_gsi_disable_interleaving))
	  SVREF(icp_socket,FIX((SI_Long)53L)) = Qg2int_requested;
      g2int_setup_network_connection_for_connect(2,icp_socket,
	      Qg2int_gsi_maybe_initiate_delayed_connection);
      result = g2int_gsi_current_context_number();
    POP_SPECIAL();
    return result;
}

static Object string_constant_58;  /* "~%Connected to: ~A~A~%" */

static Object array_constant_20;   /* # */

/* INITIATE-GSI-CONNECTION-AFTER-CONNECT */
Object g2int_initiate_gsi_connection_after_connect(network_plus_host_plus_port,
	    icp_socket,interface_name,class_name,
	    keep_connection_on_g2_reset,remote_process_initialization_string)
    Object network_plus_host_plus_port, icp_socket, interface_name, class_name;
    Object keep_connection_on_g2_reset, remote_process_initialization_string;
{
    Object current_icp_socket, listeners, listener, listener_protocol;
    Object listener_port_name, temp, temp_1, current_icp_port;
    Object disable_resumability, number_of_icp_bytes_for_message_series;
    Object icp_buffers_for_message_group;
    Object icp_buffer_of_start_of_message_series_qm;
    Object icp_byte_position_of_start_of_message_series_qm;
    Object number_of_icp_bytes_to_fill_buffer, current_icp_buffer;
    Object current_write_icp_byte_position;
    Object number_of_icp_bytes_in_message_group, writing_icp_message_group;
    Object gensymed_symbol, temp_3, temp_4;
    SI_Long connect_protocol_char, code;
    char temp_2;
    double gensymed_symbol_1;
    Declare_special(13);
    Object result;

    x_note_fn_call(47,199);
    current_icp_socket = icp_socket;
    PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,12);
      connect_protocol_char = 
	      UBYTE_16_ISAREF_1(network_plus_host_plus_port,(SI_Long)0L);
      listeners = g2int_get_local_host_addresses();
      listener = listeners ? FIRST(listeners) : Nil;
      listener_protocol = Nil;
      listener_port_name = Nil;
      SVREF(icp_socket,FIX((SI_Long)25L)) = Qg2int_g2;
      g2int_register_gsi_connection_callbacks(Nil,icp_socket);
      g2int_gsi_message(3,string_constant_58,network_plus_host_plus_port,
	      g2int_secure_icp_string(2,Ksecure_p,
	      g2int_icp_connection_is_secure(G2int_current_icp_socket)));
      g2int_reclaim_text_string(network_plus_host_plus_port);
      if (listener) {
	  code = connect_protocol_char;
	  if (code < (SI_Long)127L)
	      temp = (SI_Long)65L <= code && code <= (SI_Long)90L ? 
		      FIX(code + (SI_Long)32L) : FIX(code);
	  else {
	      temp = g2int_unicode_lowercase_if_uppercase(FIX(code));
	      if (temp);
	      else
		  temp = FIX(code);
	  }
	  code = UBYTE_16_ISAREF_1(FIRST(listener),(SI_Long)0L);
	  if (code < (SI_Long)127L)
	      temp_1 = (SI_Long)65L <= code && code <= (SI_Long)90L ? 
		      FIX(code + (SI_Long)32L) : FIX(code);
	  else {
	      temp_1 = g2int_unicode_lowercase_if_uppercase(FIX(code));
	      if (temp_1);
	      else
		  temp_1 = FIX(code);
	  }
	  temp_2 = NUM_EQ(temp,temp_1);
	  if (temp_2);
	  else
	      temp_2 =  !TRUEP(CDR(listeners));
	  if ( !temp_2)
	      listener = SECOND(listeners);
	  listener_protocol = g2int_equalw(FIRST(listener),
		  array_constant_20) ? Qg2int_tcp_ip : Nil;
	  listener_port_name = SECOND(listener);
      }
      current_icp_port = ISVREF(icp_socket,(SI_Long)4L);
      PUSH_SPECIAL(G2int_current_icp_port,current_icp_port,11);
	current_icp_socket = ISVREF(G2int_current_icp_port,(SI_Long)2L);
	PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,10);
	  temp_1 = IFIX(ISVREF(G2int_current_icp_socket,(SI_Long)22L)) >= 
		  (SI_Long)17L ? ISVREF(G2int_current_icp_socket,
		  (SI_Long)53L) : Nil;
	  if (temp_1);
	  else
	      temp_1 = Nil;
	  disable_resumability = temp_1;
	  PUSH_SPECIAL(G2int_disable_resumability,disable_resumability,9);
	    number_of_icp_bytes_for_message_series = FIX((SI_Long)0L);
	    PUSH_SPECIAL(G2int_number_of_icp_bytes_for_message_series,number_of_icp_bytes_for_message_series,
		    8);
	      icp_buffers_for_message_group = Nil;
	      PUSH_SPECIAL(G2int_icp_buffers_for_message_group,icp_buffers_for_message_group,
		      7);
		icp_buffer_of_start_of_message_series_qm = Nil;
		PUSH_SPECIAL(G2int_icp_buffer_of_start_of_message_seriesqm,icp_buffer_of_start_of_message_series_qm,
			6);
		  icp_byte_position_of_start_of_message_series_qm = Nil;
		  PUSH_SPECIAL(G2int_icp_byte_position_of_start_of_message_seriesqm,icp_byte_position_of_start_of_message_series_qm,
			  5);
		    number_of_icp_bytes_to_fill_buffer = FIX((SI_Long)0L);
		    PUSH_SPECIAL(G2int_number_of_icp_bytes_to_fill_buffer,number_of_icp_bytes_to_fill_buffer,
			    4);
		      current_icp_buffer = Nil;
		      PUSH_SPECIAL(G2int_current_icp_buffer,current_icp_buffer,
			      3);
			current_write_icp_byte_position = Nil;
			PUSH_SPECIAL(G2int_current_write_icp_byte_position,current_write_icp_byte_position,
				2);
			  number_of_icp_bytes_in_message_group = 
				  FIX((SI_Long)0L);
			  PUSH_SPECIAL(G2int_number_of_icp_bytes_in_message_group,number_of_icp_bytes_in_message_group,
				  1);
			    writing_icp_message_group = 
				    FIXNUM_ADD1(G2int_writing_icp_message_group);
			    PUSH_SPECIAL(G2int_writing_icp_message_group,writing_icp_message_group,
				    0);
			      gensymed_symbol = Nil;
			      gensymed_symbol_1 = 0.0;
			      gensymed_symbol_1 = 0.0;
			      if (g2int_icp_connection_open_p(G2int_current_icp_socket) 
				      &&  
				      !TRUEP(g2int_icp_connection_being_shutdownqm(G2int_current_icp_socket))) 
					  {
				  temp_1 = listener_protocol;
				  temp = g2int_get_local_host_name();
				  temp_3 = listener_port_name;
				  if (temp_3);
				  else
				      temp_3 = array_constant_12;
				  temp_4 = 
					  remote_process_initialization_string;
				  if (temp_4);
				  else
				      temp_4 = array_constant_12;
				  g2int_send_icp_initialize_gsi_interface(interface_name,
					  class_name,
					  keep_connection_on_g2_reset,
					  temp_1,temp,temp_3,temp_4);
				  g2int_end_icp_message_group();
			      }
			    POP_SPECIAL();
			  POP_SPECIAL();
			POP_SPECIAL();
		      POP_SPECIAL();
		    POP_SPECIAL();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
      POP_SPECIAL();
      g2int_reclaim_network_addresses(listeners);
      if (remote_process_initialization_string)
	  g2int_reclaim_text_string(remote_process_initialization_string);
      result = g2int_gsi_current_context_number();
    POP_SPECIAL();
    return result;
}

/* GSI-MAYBE-INITIATE-DELAYED-CONNECTION */
Object g2int_gsi_maybe_initiate_delayed_connection(icp_socket)
    Object icp_socket;
{
    Object a, gensymed_symbol, network_plus_host_plus_port, interface_name;
    Object class_name, keep_connection_on_g2_reset;
    Object remote_process_initialization_string;

    x_note_fn_call(47,200);
    a = g2int_assq_function(icp_socket,
	    G2int_gsi_icp_sockets_waiting_for_connect);
    if (a) {
	G2int_gsi_icp_sockets_waiting_for_connect = 
		g2int_delete_gensym_element_1(a,
		G2int_gsi_icp_sockets_waiting_for_connect);
	gensymed_symbol = a;
	icp_socket = CAR(gensymed_symbol);
	gensymed_symbol = CDR(gensymed_symbol);
	network_plus_host_plus_port = CAR(gensymed_symbol);
	gensymed_symbol = CDR(gensymed_symbol);
	interface_name = CAR(gensymed_symbol);
	gensymed_symbol = CDR(gensymed_symbol);
	class_name = CAR(gensymed_symbol);
	gensymed_symbol = CDR(gensymed_symbol);
	keep_connection_on_g2_reset = CAR(gensymed_symbol);
	gensymed_symbol = CDR(gensymed_symbol);
	remote_process_initialization_string = CAR(gensymed_symbol);
	g2int_reclaim_gensym_list_1(a);
	g2int_initiate_gsi_connection_after_connect(network_plus_host_plus_port,
		icp_socket,interface_name,class_name,
		keep_connection_on_g2_reset,
		remote_process_initialization_string);
    }
    return VALUES_1(Nil);
}

static Object Qab_g2int_gsi_initiate_connection;  /* |gsi_initiate_connection| */

/* GSI-MAYBE-NOTICE-DELAYED-CONNECTION-FAILURE */
Object g2int_gsi_maybe_notice_delayed_connection_failure(icp_socket)
    Object icp_socket;
{
    Object a, network_plus_host_plus_port;
    Object remote_process_initialization_string, current_icp_socket;
    Declare_special(1);

    x_note_fn_call(47,201);
    a = g2int_assq_function(icp_socket,
	    G2int_gsi_icp_sockets_waiting_for_connect);
    if (a) {
	G2int_gsi_icp_sockets_waiting_for_connect = 
		g2int_delete_gensym_element_1(a,
		G2int_gsi_icp_sockets_waiting_for_connect);
	network_plus_host_plus_port = SECOND(a);
	remote_process_initialization_string = SIXTH(a);
	current_icp_socket = icp_socket;
	PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,0);
	  g2int_reclaim_gensym_list_1(a);
	  g2int_gsi_error_no_exit(3,Qab_g2int_gsi_initiate_connection,
		  G2int_gsi_error_in_connect,ISVREF(icp_socket,(SI_Long)9L));
	  g2int_reclaim_text_string(network_plus_host_plus_port);
	  if (remote_process_initialization_string)
	      g2int_reclaim_text_string(remote_process_initialization_string);
	POP_SPECIAL();
    }
    return VALUES_1(Nil);
}

Object G2int_gsi_wakeup_icp_socket = UNBOUND;

Object G2int_gsi_wakeup_icp_socket_active_p = UNBOUND;

static Object Qg2int_gsi_wakeup_maybe_notice_delayed_connection_failure;  /* gsi-wakeup-maybe-notice-delayed-connection-failure */

static Object Qg2int_gsi_wakeup_maybe_initiate_delayed_connection;  /* gsi-wakeup-maybe-initiate-delayed-connection */

/* INITIATE-GSI-WAKEUP-CONNECTION */
Object g2int_initiate_gsi_wakeup_connection()
{
    Object listeners, listener, temp, temp_1, connection_configuration;
    Object icp_socket;

    x_note_fn_call(47,202);
    if ( !TRUEP(G2int_gsi_wakeup_icp_socket)) {
	listeners = g2int_get_local_host_addresses();
	listener = listeners ? FIRST(listeners) : Nil;
	temp = FIRST(listener);
	temp_1 = g2int_get_local_host_name();
	connection_configuration = g2int_gensym_list_3(temp,temp_1,
		SECOND(listener));
	icp_socket = g2int_make_network_connection(1,connection_configuration);
	if (icp_socket);
	else
	    return VALUES_1(Nil);
	g2int_reclaim_gensym_list_1(connection_configuration);
	G2int_gsi_wakeup_icp_socket = icp_socket;
	g2int_register_icp_connection_loss_callback(Qg2int_gsi_wakeup_maybe_notice_delayed_connection_failure,
		icp_socket);
	g2int_setup_network_connection_for_connect(2,icp_socket,
		Qg2int_gsi_wakeup_maybe_initiate_delayed_connection);
    }
    return VALUES_1(G2int_gsi_wakeup_icp_socket);
}

/* GSI-WAKEUP-MAYBE-INITIATE-DELAYED-CONNECTION */
Object g2int_gsi_wakeup_maybe_initiate_delayed_connection(icp_socket)
    Object icp_socket;
{
    x_note_fn_call(47,203);
    SVREF(icp_socket,FIX((SI_Long)25L)) = Qg2int_gsi;
    G2int_gsi_wakeup_icp_socket_active_p = T;
    return VALUES_1(Nil);
}

/* GSI-WAKEUP-MAYBE-NOTICE-DELAYED-CONNECTION-FAILURE */
Object g2int_gsi_wakeup_maybe_notice_delayed_connection_failure(icp_socket)
    Object icp_socket;
{
    x_note_fn_call(47,204);
    G2int_gsi_wakeup_icp_socket = Nil;
    G2int_gsi_wakeup_icp_socket_active_p = Nil;
    return VALUES_1(Nil);
}

static Object Qg2int_gsi_set_context_limit;  /* |gsi_set_context_limit| */

/* SHARED-GSI-SET-CONTEXT-LIMIT */
void g2int_shared_gsi_set_context_limit(gsi_fc_outer_limit)
    SI_Long gsi_fc_outer_limit;
{
    Object limit;
    SI_Long value;

    x_note_fn_call(47,205);
    value = gsi_fc_outer_limit;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_context_limit,Qerror,T);
	goto end_shared_gsi_set_context_limit;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_context_limit,Qerror,T);
	goto end_shared_gsi_set_context_limit;
    }
    limit = LONG_TO_FIXNUM(value);
    G2int_gsi_maximum_number_of_contexts = limit;
  end_shared_gsi_set_context_limit:;
}

static Object string_constant_59;  /* "gsi_set_context_limit" */

/* GSI-SET-CONTEXT-LIMIT */
DLLEXPORT void gsi_set_context_limit(limit)
    SI_Long limit;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,206);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_59);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_context_limit(limit);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_59);
}

/* SHARED-GSI-SET-LOCAL-HOME */
void g2int_shared_gsi_set_local_home(home)
    Object home;
{
    x_note_fn_call(47,207);
    G2int_gsi_local_home = home;
}

static Object string_constant_60;  /* "gsi_set_local_home" */

/* GSI-SET-LOCAL-HOME */
DLLEXPORT void gsi_set_local_home(home)
    Object home;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,208);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_60);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_local_home(home);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_60);
}

static Object Qg2int_gsi_flush;    /* |gsi_flush| */

/* SHARED-GSI-FLUSH */
void g2int_shared_gsi_flush(gsi_fc_outer_context)
    SI_Long gsi_fc_outer_context;
{
    Object context, code, derived_socket;
    SI_Long value;

    x_note_fn_call(47,209);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_flush,Qerror,T);
	goto end_shared_gsi_flush;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_flush,Qerror,T);
	goto end_shared_gsi_flush;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,T);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_flush,Qerror,T);
	goto end_shared_gsi_flush;
    }
    derived_socket = g2int_get_icp_socket_from_context(context,T);
    g2int_gsi_flush_internal_1(derived_socket,T);
  end_shared_gsi_flush:;
}

static Object string_constant_61;  /* "gsi_flush" */

/* GSI-FLUSH */
DLLEXPORT void gsi_flush(context)
    SI_Long context;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,210);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_61);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_flush(context);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_flush(context);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_61);
}

static Object Qg2int_gsi_kill_context;  /* |gsi_kill_context| */

/* SHARED-GSI-KILL-CONTEXT */
void g2int_shared_gsi_kill_context(gsi_fc_outer_context)
    SI_Long gsi_fc_outer_context;
{
    Object context, code, derived_socket;
    SI_Long value;

    x_note_fn_call(47,211);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_kill_context,Qerror,T);
	goto end_shared_gsi_kill_context;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_kill_context,Qerror,T);
	goto end_shared_gsi_kill_context;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,T);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_kill_context,Qerror,T);
	goto end_shared_gsi_kill_context;
    }
    derived_socket = g2int_get_icp_socket_from_context(context,T);
    g2int_flush_and_shutdown_icp_socket(derived_socket);
  end_shared_gsi_kill_context:;
}

static Object string_constant_62;  /* "gsi_kill_context" */

/* GSI-KILL-CONTEXT */
DLLEXPORT void gsi_kill_context(context)
    SI_Long context;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,212);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_62);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_kill_context(context);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_kill_context(context);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_62);
}

static Object Qg2int_gsi_context_received_data;  /* |gsi_context_received_data| */

/* SHARED-GSI-CONTEXT-RECEIVED-DATA */
SI_Long g2int_shared_gsi_context_received_data(gsi_fc_outer_context)
    SI_Long gsi_fc_outer_context;
{
    Object context, code, derived_socket;
    SI_Long value, result_1, gsi_fc_result;

    x_note_fn_call(47,213);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_received_data,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_received_data;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_received_data,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_received_data;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,Nil);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_received_data,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_received_data;
    }
    derived_socket = g2int_get_icp_socket_from_context(context,Nil);
    gsi_fc_result = ISVREF(derived_socket,(SI_Long)7L) ? (SI_Long)1L : 
	    (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_context_received_data:;
    return result_1;
}

static Object string_constant_63;  /* "gsi_context_received_data" */

/* GSI-CONTEXT-RECEIVED-DATA */
DLLEXPORT SI_Long gsi_context_received_data(context)
    SI_Long context;
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,214);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_63);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = 
	      LONG_TO_FIXNUM(g2int_shared_gsi_context_received_data(context));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_63);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

/* SHARED-GSI-LISTENER-SOCKET */
SI_Long g2int_shared_gsi_listener_socket()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,215);
    gsi_fc_result = g2ext_network_get_listener_fd();
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_64;  /* "gsi_listener_socket" */

/* GSI-LISTENER-SOCKET */
DLLEXPORT SI_Long gsi_listener_socket()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,216);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_64);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_listener_socket());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_64);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_context_socket;  /* |gsi_context_socket| */

/* SHARED-GSI-CONTEXT-SOCKET */
SI_Long g2int_shared_gsi_context_socket(gsi_fc_outer_context)
    SI_Long gsi_fc_outer_context;
{
    Object context, code, derived_socket, connection_handle;
    SI_Long value, result_1, gsi_fc_result;

    x_note_fn_call(47,217);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_socket,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_socket;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_socket,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_socket;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,Nil);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_socket,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_socket;
    }
    derived_socket = g2int_get_icp_socket_from_context(context,Nil);
    connection_handle = ISVREF(ISVREF(derived_socket,(SI_Long)3L),(SI_Long)1L);
    gsi_fc_result = g2ext_network_get_fd_from_handle(IFIX(connection_handle));
    result_1 = gsi_fc_result;
  end_shared_gsi_context_socket:;
    return result_1;
}

static Object string_constant_65;  /* "gsi_context_socket" */

/* GSI-CONTEXT-SOCKET */
DLLEXPORT SI_Long gsi_context_socket(context)
    SI_Long context;
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,218);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_65);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_context_socket(context));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_65);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_context_remote_start_time;  /* |gsi_context_remote_start_time| */

/* SHARED-GSI-CONTEXT-REMOTE-START-TIME */
double g2int_shared_gsi_context_remote_start_time(gsi_fc_outer_context)
    SI_Long gsi_fc_outer_context;
{
    Object context, code, remote_g2_time_at_start;
    SI_Long value;
    double result_1, gsi_fc_result;

    x_note_fn_call(47,219);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_start_time,
		Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_context_remote_start_time;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_start_time,
		Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_context_remote_start_time;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,Nil);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_start_time,
		Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_context_remote_start_time;
    }
    remote_g2_time_at_start = 
	    g2int_get_remote_g2_time_at_start(g2int_get_icp_socket_from_context(context,
	    Nil));
    gsi_fc_result = remote_g2_time_at_start ? 
	    DFLOAT_ISAREF_1(remote_g2_time_at_start,(SI_Long)0L) : 0.0;
    result_1 = 
	    inline_maybe_swap_float_bytes_for_alpha_gfloats(gsi_fc_result,
	    g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? (SI_Long)1L 
	    : (SI_Long)0L);
  end_shared_gsi_context_remote_start_time:;
    return result_1;
}

static Object string_constant_66;  /* "gsi_context_remote_start_time" */

/* GSI-CONTEXT-REMOTE-START-TIME */
DLLEXPORT double gsi_context_remote_start_time(context)
    SI_Long context;
{
    Object in_recursive_gsi_context;
    double result_1, result_2;
    Declare_special(1);

    x_note_fn_call(47,220);
    result_1 = 0.0;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_66);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsi_context_remote_start_time(context);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_66);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_context_remote_host;  /* |gsi_context_remote_host| */

/* SHARED-GSI-CONTEXT-REMOTE-HOST */
Object g2int_shared_gsi_context_remote_host(wide_api_p,gsi_fc_outer_context)
    Object wide_api_p;
    SI_Long gsi_fc_outer_context;
{
    Object result_1, context, code, gsi_fc_result;
    SI_Long value;

    x_note_fn_call(47,221);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_host,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_context_remote_host;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_host,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_context_remote_host;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,Nil);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_host,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_context_remote_host;
    }
    gsi_fc_result = 
	    g2int_get_remote_host_name(g2int_get_icp_socket_from_context(context,
	    Nil));
    result_1 =  !TRUEP(gsi_fc_result) ? Nil : wide_api_p ? 
	    g2int_lisp_string_to_c_wide_string(gsi_fc_result) : 
	    g2int_lisp_string_to_c_string(gsi_fc_result);
  end_shared_gsi_context_remote_host:;
    return result_1;
}

static Object string_constant_67;  /* "gsi_context_remote_host" */

/* GSI-CONTEXT-REMOTE-HOST */
DLLEXPORT Object gsi_context_remote_host(context)
    SI_Long context;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,222);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_67);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_context_remote_host(G2int_gsi_wide_api_p,
		    context);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_context_remote_host(G2int_gsi_wide_api_p,
			    context);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_67);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_context_remote_port;  /* |gsi_context_remote_port| */

/* SHARED-GSI-CONTEXT-REMOTE-PORT */
SI_Long g2int_shared_gsi_context_remote_port(gsi_fc_outer_context)
    SI_Long gsi_fc_outer_context;
{
    Object context, code;
    SI_Long value, result_1, gsi_fc_result;

    x_note_fn_call(47,223);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_port,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_remote_port;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_port,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_remote_port;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,Nil);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_port,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_remote_port;
    }
    gsi_fc_result = 
	    FIXNUM_TO_LONG(g2int_get_remote_listener_port(g2int_get_icp_socket_from_context(context,
	    Nil)));
    result_1 = gsi_fc_result;
  end_shared_gsi_context_remote_port:;
    return result_1;
}

static Object string_constant_68;  /* "gsi_context_remote_port" */

/* GSI-CONTEXT-REMOTE-PORT */
DLLEXPORT SI_Long gsi_context_remote_port(context)
    SI_Long context;
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,224);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_68);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_context_remote_port(context));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_68);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_context_remote_home;  /* |gsi_context_remote_home| */

/* SHARED-GSI-CONTEXT-REMOTE-HOME */
Object g2int_shared_gsi_context_remote_home(gsi_fc_outer_context)
    SI_Long gsi_fc_outer_context;
{
    Object result_1, context, code, icp_socket, extension_data, gsi_fc_result;
    Object name, type;
    SI_Long value;

    x_note_fn_call(47,225);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_home,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_context_remote_home;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_home,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_context_remote_home;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,Nil);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_remote_home,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_context_remote_home;
    }
    icp_socket = g2int_get_icp_socket_from_context(context,Nil);
    extension_data = ISVREF(icp_socket,(SI_Long)29L);
    gsi_fc_result = ISVREF(extension_data,(SI_Long)14L);
    if (gsi_fc_result);
    else {
	name = g2int_get_remote_home_name(icp_socket);
	if ( !TRUEP(name))
	    type = G2int_gsi_null_type_tag;
	else if (SYMBOLP(name))
	    type = G2int_gsi_symbol_type_tag;
	else if (STRINGP(name) || g2int_text_string_p(name))
	    type = G2int_gsi_string_type_tag;
	else {
	    name = Nil;
	    type = G2int_gsi_null_type_tag;
	}
	gsi_fc_result = type ? g2int_make_gsi_instance(6,type,name,Nil,Nil,
		Nil,Qg2int_context) : Nil;
	SVREF(extension_data,FIX((SI_Long)14L)) = gsi_fc_result;
    }
    result_1 = gsi_fc_result;
  end_shared_gsi_context_remote_home:;
    return result_1;
}

static Object string_constant_69;  /* "gsi_context_remote_home" */

/* GSI-CONTEXT-REMOTE-HOME */
DLLEXPORT Object gsi_context_remote_home(context)
    SI_Long context;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,226);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_69);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_context_remote_home(context);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_context_remote_home(context);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_69);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_context_user_data;  /* |gsi_context_user_data| */

/* SHARED-GSI-CONTEXT-USER-DATA */
Object g2int_shared_gsi_context_user_data(gsi_fc_outer_context)
    SI_Long gsi_fc_outer_context;
{
    Object result_1, context, code, gsi_fc_result;
    SI_Long value;

    x_note_fn_call(47,227);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_user_data,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_context_user_data;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_user_data,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_context_user_data;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,Nil);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_user_data,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_context_user_data;
    }
    gsi_fc_result = 
	    ISVREF(ISVREF(g2int_get_icp_socket_from_context(context,Nil),
	    (SI_Long)29L),(SI_Long)2L);
    result_1 = gsi_fc_result;
  end_shared_gsi_context_user_data:;
    return result_1;
}

static Object string_constant_70;  /* "gsi_context_user_data" */

/* GSI-CONTEXT-USER-DATA */
DLLEXPORT Object gsi_context_user_data(context)
    SI_Long context;
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,228);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_70);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsi_context_user_data(context);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_70);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_context_user_data;  /* |gsi_set_context_user_data| */

/* SHARED-GSI-SET-CONTEXT-USER-DATA */
void g2int_shared_gsi_set_context_user_data(gsi_fc_outer_context,user_data)
    Object user_data;
    SI_Long gsi_fc_outer_context;
{
    Object context, code, svref_arg_1;
    SI_Long value;

    x_note_fn_call(47,229);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_context_user_data,Qerror,T);
	goto end_shared_gsi_set_context_user_data;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_context_user_data,Qerror,T);
	goto end_shared_gsi_set_context_user_data;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,Nil);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_context_user_data,Qerror,T);
	goto end_shared_gsi_set_context_user_data;
    }
    svref_arg_1 = ISVREF(g2int_get_icp_socket_from_context(context,Nil),
	    (SI_Long)29L);
    SVREF(svref_arg_1,FIX((SI_Long)2L)) = user_data;
  end_shared_gsi_set_context_user_data:;
}

static Object string_constant_71;  /* "gsi_set_context_user_data" */

/* GSI-SET-CONTEXT-USER-DATA */
DLLEXPORT void gsi_set_context_user_data(context,user_data)
    Object user_data;
    SI_Long context;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,230);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_71);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_context_user_data(context,user_data);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_71);
}

/* SHARED-GSI-INITIATE-CONNECTION */
SI_Long g2int_shared_gsi_initiate_connection(wide_api_p,
	    gsi_fc_outer_interface_name,gsi_fc_outer_class_name,
	    gsi_fc_outer_keep_connection_on_g2_reset,gsi_fc_outer_network,
	    gsi_fc_outer_host,gsi_fc_outer_port,
	    gsi_fc_outer_remote_process_initialization_string)
    Object wide_api_p, gsi_fc_outer_interface_name, gsi_fc_outer_class_name;
    Object gsi_fc_outer_network, gsi_fc_outer_host, gsi_fc_outer_port;
    Object gsi_fc_outer_remote_process_initialization_string;
    SI_Long gsi_fc_outer_keep_connection_on_g2_reset;
{
    Object interface_name, class_name, keep_connection_on_g2_reset, network;
    Object host, port, remote_process_initialization_string;
    SI_Long value, result_1, gsi_fc_result;

    x_note_fn_call(47,231);
    interface_name =  !TRUEP(gsi_fc_outer_interface_name) ? Nil : 
	    g2int_symbol_for_gsi_string(wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_interface_name) 
	    : g2int_c_string_to_gensym_string(gsi_fc_outer_interface_name));
    class_name =  !TRUEP(gsi_fc_outer_class_name) ? Nil : 
	    g2int_symbol_for_gsi_string(wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_class_name) : 
	    g2int_c_string_to_gensym_string(gsi_fc_outer_class_name));
    value = gsi_fc_outer_keep_connection_on_g2_reset;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qab_g2int_gsi_initiate_connection,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_initiate_connection;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qab_g2int_gsi_initiate_connection,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_initiate_connection;
    }
    keep_connection_on_g2_reset = LONG_TO_FIXNUM(value);
    network =  !TRUEP(gsi_fc_outer_network) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_network) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_network);
    host =  !TRUEP(gsi_fc_outer_host) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_host) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_host);
    port =  !TRUEP(gsi_fc_outer_port) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_port) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_port);
    remote_process_initialization_string =  
	    !TRUEP(gsi_fc_outer_remote_process_initialization_string) ? 
	    Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_remote_process_initialization_string) 
	    : 
	    g2int_c_string_to_text_string(gsi_fc_outer_remote_process_initialization_string);
    gsi_fc_result = FIXNUM_EQ(G2int_gsi_undefined_context,
	    g2int_initiate_gsi_connection(interface_name,class_name,
	    (SI_Long)0L != IFIX(keep_connection_on_g2_reset) ? T : Nil,
	    network,host,port,remote_process_initialization_string,Nil,
	    Nil)) ? FIXNUM_TO_LONG(G2int_gsi_failure) : 
	    FIXNUM_TO_LONG(G2int_gsi_success);
    g2int_reclaim_if_text_or_gensym_string_function(network);
    g2int_reclaim_if_text_or_gensym_string_function(host);
    g2int_reclaim_if_text_or_gensym_string_function(port);
    g2int_reclaim_if_text_or_gensym_string_function(remote_process_initialization_string);
    result_1 = gsi_fc_result;
  end_shared_gsi_initiate_connection:;
    return result_1;
}

static Object string_constant_72;  /* "gsi_initiate_connection" */

/* GSI-INITIATE-CONNECTION */
DLLEXPORT SI_Long gsi_initiate_connection(interface_name,class_name,
	    keep_connection_on_g2_reset,network,host,port,
	    remote_process_initialization_string)
    Object interface_name, class_name, network, host, port;
    Object remote_process_initialization_string;
    SI_Long keep_connection_on_g2_reset;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,232);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_72);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_initiate_connection(G2int_gsi_wide_api_p,
		    interface_name,class_name,keep_connection_on_g2_reset,
		    network,host,port,remote_process_initialization_string));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_initiate_connection(G2int_gsi_wide_api_p,
			    interface_name,class_name,
			    keep_connection_on_g2_reset,network,host,port,
			    remote_process_initialization_string));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_72);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_initiate_connection_w_u_d;  /* |gsi_initiate_connection_w_u_d| */

/* SHARED-GSI-INITIATE-CONNECTION-W-U-D */
SI_Long g2int_shared_gsi_initiate_connection_w_u_d(wide_api_p,
	    gsi_fc_outer_interface_name,gsi_fc_outer_class_name,
	    gsi_fc_outer_keep_connection_on_g2_reset,gsi_fc_outer_network,
	    gsi_fc_outer_host,gsi_fc_outer_port,
	    gsi_fc_outer_remote_process_initialization_string,
	    context_user_data)
    Object wide_api_p, gsi_fc_outer_interface_name, gsi_fc_outer_class_name;
    Object gsi_fc_outer_network, gsi_fc_outer_host, gsi_fc_outer_port;
    Object gsi_fc_outer_remote_process_initialization_string;
    Object context_user_data;
    SI_Long gsi_fc_outer_keep_connection_on_g2_reset;
{
    Object interface_name, class_name, keep_connection_on_g2_reset, network;
    Object host, port, remote_process_initialization_string;
    SI_Long value, result_1, gsi_fc_result;

    x_note_fn_call(47,233);
    interface_name =  !TRUEP(gsi_fc_outer_interface_name) ? Nil : 
	    g2int_symbol_for_gsi_string(wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_interface_name) 
	    : g2int_c_string_to_gensym_string(gsi_fc_outer_interface_name));
    class_name =  !TRUEP(gsi_fc_outer_class_name) ? Nil : 
	    g2int_symbol_for_gsi_string(wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_class_name) : 
	    g2int_c_string_to_gensym_string(gsi_fc_outer_class_name));
    value = gsi_fc_outer_keep_connection_on_g2_reset;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_initiate_connection_w_u_d,
		Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_initiate_connection_w_u_d;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_initiate_connection_w_u_d,
		Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_initiate_connection_w_u_d;
    }
    keep_connection_on_g2_reset = LONG_TO_FIXNUM(value);
    network =  !TRUEP(gsi_fc_outer_network) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_network) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_network);
    host =  !TRUEP(gsi_fc_outer_host) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_host) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_host);
    port =  !TRUEP(gsi_fc_outer_port) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_port) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_port);
    remote_process_initialization_string =  
	    !TRUEP(gsi_fc_outer_remote_process_initialization_string) ? 
	    Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_remote_process_initialization_string) 
	    : 
	    g2int_c_string_to_text_string(gsi_fc_outer_remote_process_initialization_string);
    gsi_fc_result = FIXNUM_EQ(G2int_gsi_undefined_context,
	    g2int_initiate_gsi_connection(interface_name,class_name,
	    (SI_Long)0L != IFIX(keep_connection_on_g2_reset) ? T : Nil,
	    network,host,port,remote_process_initialization_string,
	    context_user_data,Nil)) ? FIXNUM_TO_LONG(G2int_gsi_failure) : 
	    FIXNUM_TO_LONG(G2int_gsi_success);
    g2int_reclaim_if_text_or_gensym_string_function(network);
    g2int_reclaim_if_text_or_gensym_string_function(host);
    g2int_reclaim_if_text_or_gensym_string_function(port);
    g2int_reclaim_if_text_or_gensym_string_function(remote_process_initialization_string);
    result_1 = gsi_fc_result;
  end_shared_gsi_initiate_connection_w_u_d:;
    return result_1;
}

static Object string_constant_73;  /* "gsi_initiate_connection_w_u_d" */

/* GSI-INITIATE-CONNECTION-W-U-D */
DLLEXPORT SI_Long gsi_initiate_connection_w_u_d(interface_name,class_name,
	    keep_connection_on_g2_reset,network,host,port,
	    remote_process_initialization_string,context_user_data)
    Object interface_name, class_name, network, host, port;
    Object remote_process_initialization_string, context_user_data;
    SI_Long keep_connection_on_g2_reset;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,234);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_73);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_initiate_connection_w_u_d(G2int_gsi_wide_api_p,
		    interface_name,class_name,keep_connection_on_g2_reset,
		    network,host,port,remote_process_initialization_string,
		    context_user_data));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_initiate_connection_w_u_d(G2int_gsi_wide_api_p,
			    interface_name,class_name,
			    keep_connection_on_g2_reset,network,host,port,
			    remote_process_initialization_string,
			    context_user_data));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_73);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_initiate_secure_connection;  /* |gsi_initiate_secure_connection| */

static Object Qg2int_secure;       /* secure */

/* SHARED-GSI-INITIATE-SECURE-CONNECTION */
SI_Long g2int_shared_gsi_initiate_secure_connection(wide_api_p,
	    gsi_fc_outer_interface_name,gsi_fc_outer_class_name,
	    gsi_fc_outer_keep_connection_on_g2_reset,gsi_fc_outer_network,
	    gsi_fc_outer_host,gsi_fc_outer_port,
	    gsi_fc_outer_remote_process_initialization_string)
    Object wide_api_p, gsi_fc_outer_interface_name, gsi_fc_outer_class_name;
    Object gsi_fc_outer_network, gsi_fc_outer_host, gsi_fc_outer_port;
    Object gsi_fc_outer_remote_process_initialization_string;
    SI_Long gsi_fc_outer_keep_connection_on_g2_reset;
{
    Object interface_name, class_name, keep_connection_on_g2_reset, network;
    Object host, port, remote_process_initialization_string;
    SI_Long value, result_1, gsi_fc_result;

    x_note_fn_call(47,235);
    interface_name =  !TRUEP(gsi_fc_outer_interface_name) ? Nil : 
	    g2int_symbol_for_gsi_string(wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_interface_name) 
	    : g2int_c_string_to_gensym_string(gsi_fc_outer_interface_name));
    class_name =  !TRUEP(gsi_fc_outer_class_name) ? Nil : 
	    g2int_symbol_for_gsi_string(wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_class_name) : 
	    g2int_c_string_to_gensym_string(gsi_fc_outer_class_name));
    value = gsi_fc_outer_keep_connection_on_g2_reset;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_initiate_secure_connection,
		Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_initiate_secure_connection;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_initiate_secure_connection,
		Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_initiate_secure_connection;
    }
    keep_connection_on_g2_reset = LONG_TO_FIXNUM(value);
    network =  !TRUEP(gsi_fc_outer_network) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_network) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_network);
    host =  !TRUEP(gsi_fc_outer_host) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_host) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_host);
    port =  !TRUEP(gsi_fc_outer_port) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_port) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_port);
    remote_process_initialization_string =  
	    !TRUEP(gsi_fc_outer_remote_process_initialization_string) ? 
	    Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_remote_process_initialization_string) 
	    : 
	    g2int_c_string_to_text_string(gsi_fc_outer_remote_process_initialization_string);
    gsi_fc_result = FIXNUM_EQ(G2int_gsi_undefined_context,
	    g2int_initiate_gsi_connection(interface_name,class_name,
	    (SI_Long)0L != IFIX(keep_connection_on_g2_reset) ? T : Nil,
	    network,host,port,remote_process_initialization_string,Nil,
	    Qg2int_secure)) ? FIXNUM_TO_LONG(G2int_gsi_failure) : 
	    FIXNUM_TO_LONG(G2int_gsi_success);
    g2int_reclaim_if_text_or_gensym_string_function(network);
    g2int_reclaim_if_text_or_gensym_string_function(host);
    g2int_reclaim_if_text_or_gensym_string_function(port);
    g2int_reclaim_if_text_or_gensym_string_function(remote_process_initialization_string);
    result_1 = gsi_fc_result;
  end_shared_gsi_initiate_secure_connection:;
    return result_1;
}

static Object string_constant_74;  /* "gsi_initiate_secure_connection" */

/* GSI-INITIATE-SECURE-CONNECTION */
DLLEXPORT SI_Long gsi_initiate_secure_connection(interface_name,class_name,
	    keep_connection_on_g2_reset,network,host,port,
	    remote_process_initialization_string)
    Object interface_name, class_name, network, host, port;
    Object remote_process_initialization_string;
    SI_Long keep_connection_on_g2_reset;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,236);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_74);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_initiate_secure_connection(G2int_gsi_wide_api_p,
		    interface_name,class_name,keep_connection_on_g2_reset,
		    network,host,port,remote_process_initialization_string));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_initiate_secure_connection(G2int_gsi_wide_api_p,
			    interface_name,class_name,
			    keep_connection_on_g2_reset,network,host,port,
			    remote_process_initialization_string));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_74);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_initiate_secure_conn_w_u_d;  /* |gsi_initiate_secure_conn_w_u_d| */

/* SHARED-GSI-INITIATE-SECURE-CONN-W-U-D */
SI_Long g2int_shared_gsi_initiate_secure_conn_w_u_d(wide_api_p,
	    gsi_fc_outer_interface_name,gsi_fc_outer_class_name,
	    gsi_fc_outer_keep_connection_on_g2_reset,gsi_fc_outer_network,
	    gsi_fc_outer_host,gsi_fc_outer_port,
	    gsi_fc_outer_remote_process_initialization_string,
	    context_user_data)
    Object wide_api_p, gsi_fc_outer_interface_name, gsi_fc_outer_class_name;
    Object gsi_fc_outer_network, gsi_fc_outer_host, gsi_fc_outer_port;
    Object gsi_fc_outer_remote_process_initialization_string;
    Object context_user_data;
    SI_Long gsi_fc_outer_keep_connection_on_g2_reset;
{
    Object interface_name, class_name, keep_connection_on_g2_reset, network;
    Object host, port, remote_process_initialization_string;
    SI_Long value, result_1, gsi_fc_result;

    x_note_fn_call(47,237);
    interface_name =  !TRUEP(gsi_fc_outer_interface_name) ? Nil : 
	    g2int_symbol_for_gsi_string(wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_interface_name) 
	    : g2int_c_string_to_gensym_string(gsi_fc_outer_interface_name));
    class_name =  !TRUEP(gsi_fc_outer_class_name) ? Nil : 
	    g2int_symbol_for_gsi_string(wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_class_name) : 
	    g2int_c_string_to_gensym_string(gsi_fc_outer_class_name));
    value = gsi_fc_outer_keep_connection_on_g2_reset;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_initiate_secure_conn_w_u_d,
		Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_initiate_secure_conn_w_u_d;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_initiate_secure_conn_w_u_d,
		Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_initiate_secure_conn_w_u_d;
    }
    keep_connection_on_g2_reset = LONG_TO_FIXNUM(value);
    network =  !TRUEP(gsi_fc_outer_network) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_network) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_network);
    host =  !TRUEP(gsi_fc_outer_host) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_host) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_host);
    port =  !TRUEP(gsi_fc_outer_port) ? Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_port) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_port);
    remote_process_initialization_string =  
	    !TRUEP(gsi_fc_outer_remote_process_initialization_string) ? 
	    Nil : wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_remote_process_initialization_string) 
	    : 
	    g2int_c_string_to_text_string(gsi_fc_outer_remote_process_initialization_string);
    gsi_fc_result = FIXNUM_EQ(G2int_gsi_undefined_context,
	    g2int_initiate_gsi_connection(interface_name,class_name,
	    (SI_Long)0L != IFIX(keep_connection_on_g2_reset) ? T : Nil,
	    network,host,port,remote_process_initialization_string,
	    context_user_data,Qg2int_secure)) ? 
	    FIXNUM_TO_LONG(G2int_gsi_failure) : 
	    FIXNUM_TO_LONG(G2int_gsi_success);
    g2int_reclaim_if_text_or_gensym_string_function(network);
    g2int_reclaim_if_text_or_gensym_string_function(host);
    g2int_reclaim_if_text_or_gensym_string_function(port);
    g2int_reclaim_if_text_or_gensym_string_function(remote_process_initialization_string);
    result_1 = gsi_fc_result;
  end_shared_gsi_initiate_secure_conn_w_u_d:;
    return result_1;
}

static Object string_constant_75;  /* "gsi_initiate_secure_conn_w_u_d" */

/* GSI-INITIATE-SECURE-CONN-W-U-D */
DLLEXPORT SI_Long gsi_initiate_secure_conn_w_u_d(interface_name,class_name,
	    keep_connection_on_g2_reset,network,host,port,
	    remote_process_initialization_string,context_user_data)
    Object interface_name, class_name, network, host, port;
    Object remote_process_initialization_string, context_user_data;
    SI_Long keep_connection_on_g2_reset;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,238);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_75);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_initiate_secure_conn_w_u_d(G2int_gsi_wide_api_p,
		    interface_name,class_name,keep_connection_on_g2_reset,
		    network,host,port,remote_process_initialization_string,
		    context_user_data));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_initiate_secure_conn_w_u_d(G2int_gsi_wide_api_p,
			    interface_name,class_name,
			    keep_connection_on_g2_reset,network,host,port,
			    remote_process_initialization_string,
			    context_user_data));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_75);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

/* WAKEUP-GSI-INTERNAL */
Object g2int_wakeup_gsi_internal()
{
    Object current_icp_port, current_icp_socket, temp, disable_resumability;
    Object number_of_icp_bytes_for_message_series;
    Object icp_buffers_for_message_group;
    Object icp_buffer_of_start_of_message_series_qm;
    Object icp_byte_position_of_start_of_message_series_qm;
    Object number_of_icp_bytes_to_fill_buffer, current_icp_buffer;
    Object current_write_icp_byte_position;
    Object number_of_icp_bytes_in_message_group, writing_icp_message_group;
    Object gensymed_symbol;
    double gensymed_symbol_1;
    Declare_special(12);

    x_note_fn_call(47,239);
    current_icp_port = ISVREF(G2int_gsi_wakeup_icp_socket,(SI_Long)4L);
    PUSH_SPECIAL(G2int_current_icp_port,current_icp_port,11);
      current_icp_socket = ISVREF(G2int_current_icp_port,(SI_Long)2L);
      PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,10);
	temp = IFIX(ISVREF(G2int_current_icp_socket,(SI_Long)22L)) >= 
		(SI_Long)17L ? ISVREF(G2int_current_icp_socket,
		(SI_Long)53L) : Nil;
	if (temp);
	else
	    temp = Nil;
	disable_resumability = temp;
	PUSH_SPECIAL(G2int_disable_resumability,disable_resumability,9);
	  number_of_icp_bytes_for_message_series = FIX((SI_Long)0L);
	  PUSH_SPECIAL(G2int_number_of_icp_bytes_for_message_series,number_of_icp_bytes_for_message_series,
		  8);
	    icp_buffers_for_message_group = Nil;
	    PUSH_SPECIAL(G2int_icp_buffers_for_message_group,icp_buffers_for_message_group,
		    7);
	      icp_buffer_of_start_of_message_series_qm = Nil;
	      PUSH_SPECIAL(G2int_icp_buffer_of_start_of_message_seriesqm,icp_buffer_of_start_of_message_series_qm,
		      6);
		icp_byte_position_of_start_of_message_series_qm = Nil;
		PUSH_SPECIAL(G2int_icp_byte_position_of_start_of_message_seriesqm,icp_byte_position_of_start_of_message_series_qm,
			5);
		  number_of_icp_bytes_to_fill_buffer = FIX((SI_Long)0L);
		  PUSH_SPECIAL(G2int_number_of_icp_bytes_to_fill_buffer,number_of_icp_bytes_to_fill_buffer,
			  4);
		    current_icp_buffer = Nil;
		    PUSH_SPECIAL(G2int_current_icp_buffer,current_icp_buffer,
			    3);
		      current_write_icp_byte_position = Nil;
		      PUSH_SPECIAL(G2int_current_write_icp_byte_position,current_write_icp_byte_position,
			      2);
			number_of_icp_bytes_in_message_group = 
				FIX((SI_Long)0L);
			PUSH_SPECIAL(G2int_number_of_icp_bytes_in_message_group,number_of_icp_bytes_in_message_group,
				1);
			  writing_icp_message_group = 
				  FIXNUM_ADD1(G2int_writing_icp_message_group);
			  PUSH_SPECIAL(G2int_writing_icp_message_group,writing_icp_message_group,
				  0);
			    gensymed_symbol = Nil;
			    gensymed_symbol_1 = 0.0;
			    gensymed_symbol_1 = 0.0;
			    if (g2int_icp_connection_open_p(G2int_current_icp_socket) 
				    &&  
				    !TRUEP(g2int_icp_connection_being_shutdownqm(G2int_current_icp_socket))) 
					{
				g2int_send_icp_nop(FIX((SI_Long)0L));
				g2int_end_icp_message_group();
			    }
			  POP_SPECIAL();
			POP_SPECIAL();
		      POP_SPECIAL();
		    POP_SPECIAL();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
      POP_SPECIAL();
    POP_SPECIAL();
    g2int_flush_icp_output_ports();
    return VALUES_1(Nil);
}

/* SHARED-GSI-WAKEUP */
SI_Long g2int_shared_gsi_wakeup()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,240);
    if ( !TRUEP(G2int_gsi_wakeup_icp_socket))
	gsi_fc_result = g2int_initiate_gsi_wakeup_connection() ? 
		(SI_Long)0L : (SI_Long)-1L;
    else if (G2int_gsi_wakeup_icp_socket_active_p) {
	g2int_wakeup_gsi_internal();
	gsi_fc_result = (SI_Long)1L;
    }
    else
	gsi_fc_result = (SI_Long)-1L;
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_76;  /* "gsi_wakeup" */

/* GSI-WAKEUP */
DLLEXPORT SI_Long gsi_wakeup()
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,241);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_76);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_wakeup());
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_wakeup());
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_76);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

/* SHARED-GSI-LAST-ERROR */
SI_Long g2int_shared_gsi_last_error()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,242);
    gsi_fc_result = FIXNUM_TO_LONG(G2int_gsi_most_recent_error);
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_77;  /* "gsi_last_error" */

/* GSI-LAST-ERROR */
DLLEXPORT SI_Long gsi_last_error()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,243);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_77);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_last_error());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_77);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object string_constant_78;  /* "" */

/* SHARED-GSI-LAST-ERROR-MESSAGE */
Object g2int_shared_gsi_last_error_message(wide_api_p)
    Object wide_api_p;
{
    Object gsi_fc_result, result_1;

    x_note_fn_call(47,244);
    gsi_fc_result = G2int_gsi_most_recent_error_message;
    if (gsi_fc_result);
    else
	gsi_fc_result = string_constant_78;
    result_1 = wide_api_p ? 
	    g2int_lisp_string_to_c_wide_string(gsi_fc_result) : 
	    g2int_lisp_string_to_c_string(gsi_fc_result);
    return result_1;
}

static Object string_constant_79;  /* "gsi_last_error_message" */

/* GSI-LAST-ERROR-MESSAGE */
DLLEXPORT Object gsi_last_error_message()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,245);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_79);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsi_last_error_message(G2int_gsi_wide_api_p);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_79);
    result_2 = result_1;
    return result_2;
}

/* SHARED-GSI-LAST-ERROR-CALL-HANDLE */
Object g2int_shared_gsi_last_error_call_handle()
{
    Object gsi_fc_result, result_1;

    x_note_fn_call(47,246);
    gsi_fc_result = G2int_gsi_most_recent_error_remote_procedure_identifier;
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_80;  /* "gsi_last_error_call_handle" */

/* GSI-LAST-ERROR-CALL-HANDLE */
DLLEXPORT Object gsi_last_error_call_handle()
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,247);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_80);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsi_last_error_call_handle();
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_80);
    result_2 = result_1;
    return result_2;
}

/* SHARED-GSI-CLEAR-LAST-ERROR */
void g2int_shared_gsi_clear_last_error()
{
    Object error_variable_location;
    SI_Long code;

    x_note_fn_call(47,248);
    code = (SI_Long)0L;
    g2int_clear_gsi_error_message();
    G2int_gsi_most_recent_error = FIX(code);
    G2int_gsi_most_recent_error_remote_procedure_identifier = 
	    G2int_current_remote_procedure_identifier;
    error_variable_location = ISVREF(g2int_current_gsi_application(),
	    (SI_Long)5L);
    if (error_variable_location)
	inline_assign_ref(error_variable_location,code);
}

static Object string_constant_81;  /* "gsi_clear_last_error" */

/* GSI-CLEAR-LAST-ERROR */
DLLEXPORT void gsi_clear_last_error()
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,249);
    internal_gsi_start();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_81);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_clear_last_error();
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_81);
}

static Object Qg2int_gsi_error_message;  /* |gsi_error_message| */

/* SHARED-GSI-ERROR-MESSAGE */
Object g2int_shared_gsi_error_message(wide_api_p,gsi_fc_outer_error_code)
    Object wide_api_p;
    SI_Long gsi_fc_outer_error_code;
{
    Object result_1, error_code, temp, gsi_fc_result;
    SI_Long value;

    x_note_fn_call(47,250);
    value = gsi_fc_outer_error_code;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_error_message,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_error_message;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_error_message,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_error_message;
    }
    error_code = LONG_TO_FIXNUM(value);
    if ( !(IFIX(error_code) > (SI_Long)0L && FIXNUM_LT(error_code,
	    G2int_gsi_base_user_error_code)))
	error_code = G2int_gsi_error_code_out_of_range;
    temp = g2int_assq_function(error_code,G2int_gsi_error_code_table);
    temp = CDR(temp);
    gsi_fc_result = CAR(temp);
    result_1 = wide_api_p ? 
	    g2int_lisp_string_to_c_wide_string(gsi_fc_result) : 
	    g2int_lisp_string_to_c_string(gsi_fc_result);
  end_shared_gsi_error_message:;
    return result_1;
}

static Object string_constant_82;  /* "gsi_error_message" */

/* GSI-ERROR-MESSAGE */
DLLEXPORT Object gsi_error_message(error_code)
    SI_Long error_code;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,251);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_82);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_error_message(G2int_gsi_wide_api_p,
		    error_code);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_error_message(G2int_gsi_wide_api_p,
			    error_code);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_82);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_signal_error;  /* |gsi_signal_error| */

static Object Qab_g2int_gsi_signal_error;  /* gsi_signal_error */

/* SHARED-GSI-SIGNAL-ERROR */
void g2int_shared_gsi_signal_error(wide_api_p,
	    gsi_fc_outer_originating_user_function,
	    gsi_fc_outer_user_error_code,gsi_fc_outer_user_message)
    Object wide_api_p, gsi_fc_outer_originating_user_function;
    Object gsi_fc_outer_user_message;
    SI_Long gsi_fc_outer_user_error_code;
{
    Object originating_user_function, user_error_code, user_message;
    SI_Long value;

    x_note_fn_call(47,252);
    originating_user_function = wide_api_p ? 
	    g2int_c_wide_string_to_gensym_string(gsi_fc_outer_originating_user_function) 
	    : 
	    g2int_c_string_to_gensym_string(gsi_fc_outer_originating_user_function);
    value = gsi_fc_outer_user_error_code;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_signal_error,Qerror,T);
	goto end_shared_gsi_signal_error;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_signal_error,Qerror,T);
	goto end_shared_gsi_signal_error;
    }
    user_error_code = LONG_TO_FIXNUM(value);
    user_message = wide_api_p ? 
	    g2int_c_wide_string_to_gensym_string(gsi_fc_outer_user_message) 
	    : g2int_c_string_to_gensym_string(gsi_fc_outer_user_message);
    if (FIXNUM_GT(user_error_code,G2int_gsi_base_user_error_code))
	g2int_gsi_error_no_exit(4,originating_user_function,
		G2int_gsi_custom_user_error,user_error_code,user_message);
    else
	g2int_gsi_error_no_exit(4,Qab_g2int_gsi_signal_error,
		G2int_gsi_reserved_error_code,user_error_code,
		G2int_gsi_base_user_error_code);
    g2int_reclaim_text_or_gensym_string(originating_user_function);
    g2int_reclaim_text_or_gensym_string(user_message);
  end_shared_gsi_signal_error:;
}

static Object string_constant_83;  /* "gsi_signal_error" */

/* GSI-SIGNAL-ERROR */
DLLEXPORT void gsi_signal_error(originating_user_function,user_error_code,
	    user_message)
    Object originating_user_function, user_message;
    SI_Long user_error_code;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,253);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_83);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_signal_error(G2int_gsi_wide_api_p,
		    originating_user_function,user_error_code,user_message);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_signal_error(G2int_gsi_wide_api_p,
			    originating_user_function,user_error_code,
			    user_message);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_83);
}

/* RUN-ONE-GSI-SCHEDULER-CYCLE */
Object g2int_run_one_gsi_scheduler_cycle()
{
    Object task_scheduling_start_time, time_slice_start_time;
    Object no_tasks_were_executed_this_pass, current_fixnum_time, temp_1;
    SI_Long gensymed_symbol;
    char temp;
    Declare_special(1);
    XDeclare_area(2);
    XDeclare_frontier(2);

    x_note_fn_call(47,254);
    g2int_schedule_processing_for_inhibited_messages();
    if (PUSH_LOCAL_ALLOCATION(Local_area,1,1)) {
	task_scheduling_start_time = 
		g2int_c_native_clock_ticks_or_cache(Nil,Nil);
	time_slice_start_time = task_scheduling_start_time;
	PUSH_SPECIAL(G2int_time_slice_start_time,time_slice_start_time,0);
	  no_tasks_were_executed_this_pass = Nil;
	  current_fixnum_time = Nil;
	next_loop:
	  if (PUSH_LOCAL_ALLOCATION(Local_area,0,0))
	      no_tasks_were_executed_this_pass =  
		      !TRUEP(g2int_dequeue_and_execute_next_task()) ? T : Nil;
	  POP_LOCAL_ALLOCATION(0,0);
	  current_fixnum_time = g2int_c_native_clock_ticks_or_cache(Nil,Nil);
	  temp = TRUEP(no_tasks_were_executed_this_pass);
	  if (temp);
	  else {
	      if (FIXNUM_GE(current_fixnum_time,task_scheduling_start_time))
		  temp_1 = FIXNUM_MINUS(current_fixnum_time,
			  task_scheduling_start_time);
	      else {
		  gensymed_symbol = IFIX(FIXNUM_MINUS(current_fixnum_time,
			  task_scheduling_start_time));
		  gensymed_symbol = gensymed_symbol + 
			  IFIX(Most_positive_fixnum);
		  temp_1 = FIX(gensymed_symbol + (SI_Long)1L);
	      }
	      temp = FIXNUM_GE(temp_1,G2int_gsi_scheduled_tasks_time_limit);
	  }
	  if (temp)
	      goto end_loop;
	  G2int_time_slice_start_time = current_fixnum_time;
	  goto next_loop;
	end_loop:;
	POP_SPECIAL();
    }
    POP_LOCAL_ALLOCATION(1,1);
    temp_1 = g2int_enqueue_scheduler_events_if_necessary(Nil);
    return VALUES_1(temp_1);
}

/* GSI-FLUSH-INTERNAL-1 */
Object g2int_gsi_flush_internal_1(derived_socket,gsi_flush_p)
    Object derived_socket, gsi_flush_p;
{
    Object icp_output_port, scheduler_enabled_qm;
    Object inhibit_icp_message_processing, temp;
    char display_events_were_enabled;
    Declare_stack_pointer;
    Declare_catch(1);
    Declare_special(2);
    Object result;

    x_note_fn_call(47,255);
    SAVE_STACK();
    if ((gsi_flush_p ||  
	    !TRUEP(g2int_gsi_option_is_set_p(G2int_gsi_no_flush))) && 
	    FIXNUM_NE(ISVREF(derived_socket,(SI_Long)15L),
	    G2int_icp_connection_closed)) {
	icp_output_port = ISVREF(derived_socket,(SI_Long)4L);
	if (FIXNUM_EQ(ISVREF(derived_socket,(SI_Long)15L),
		G2int_icp_connection_running) && ISVREF(icp_output_port,
		(SI_Long)4L)) {
	    display_events_were_enabled = (SI_Long)0L != 
		    ne_display_events_enabled();
	    ne_enable_display_events();
	    if (PUSH_UNWIND_PROTECT(0)) {
		scheduler_enabled_qm = T;
		PUSH_SPECIAL(G2int_starscheduler_enabledqmstar,scheduler_enabled_qm,
			1);
		  inhibit_icp_message_processing = 
			  G2int_inhibit_icp_message_processing_enabled;
		  PUSH_SPECIAL(G2int_inhibit_icp_message_processing,inhibit_icp_message_processing,
			  0);
		    g2int_reclaim_icp_sockets();
		  next_loop:
		    g2int_gsi_event_cycle_handling_windows_quit();
		    if ( !(FIXNUM_EQ(ISVREF(derived_socket,(SI_Long)15L),
			    G2int_icp_connection_running) && 
			    ISVREF(icp_output_port,(SI_Long)4L)))
			goto end_loop;
		    if (G2int_gsi_wakeup_icp_socket_active_p)
			g2int_wakeup_gsi_internal();
		    g2int_gsi_event_wait();
		    goto next_loop;
		  end_loop:
		    temp = Qnil;
		    g2int_reclaim_icp_sockets();
		    SAVE_VALUES(VALUES_1(temp));
		    g2int_schedule_processing_for_inhibited_messages();
		  POP_SPECIAL();
		POP_SPECIAL();
	    }
	    POP_UNWIND_PROTECT(0);
	    if ( !display_events_were_enabled)
		ne_disable_display_events();
	    CONTINUE_UNWINDING(0);
	    result = RESTORE_VALUES();
	    RESTORE_STACK();
	    return result;
	}
	else if (G2int_gsi_wakeup_icp_socket_active_p) {
	    result = g2int_wakeup_gsi_internal();
	    RESTORE_STACK();
	    return result;
	}
	else {
	    RESTORE_STACK();
	    return VALUES_1(Nil);
	}
    }
    else {
	RESTORE_STACK();
	return VALUES_1(Nil);
    }
}

static Object string_constant_84;  /* "gsi_wait" */

/* GSI-EVENT-WAIT */
Object g2int_gsi_event_wait()
{
    Object top_level_error_catcher_tag, temp;
    Declare_special(1);

    x_note_fn_call(47,256);
    g2int_enqueue_scheduler_events_if_necessary(Nil);
    top_level_error_catcher_tag = Nil;
    PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
	    0);
    next_loop:
      if (g2int_g2_event_ready_p() ||  
	      !TRUEP(g2int_milliseconds_to_next_scheduler_event()))
	  goto end_loop;
      g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	      G2int_gsi_run_state_direction_leaving_gsi,
	      G2int_gsi_run_state_type_wait,string_constant_84);
      g2_event_wait();
      g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	      G2int_gsi_run_state_direction_entering_gsi,
	      G2int_gsi_run_state_type_wait,string_constant_84);
      goto next_loop;
    end_loop:
      temp = Nil;
    POP_SPECIAL();
    return VALUES_1(temp);
}

/* SHARED-GSI-IS-IDLE */
SI_Long g2int_shared_gsi_is_idle()
{
    Object temp;
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,257);
    if (g2int_g2_event_ready_p())
	gsi_fc_result = (SI_Long)0L;
    else {
	temp = g2int_milliseconds_to_next_scheduler_event();
	if (temp);
	else
	    temp = FIX((SI_Long)0L);
	gsi_fc_result = FIXNUM_TO_LONG(temp);
    }
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_85;  /* "gsi_is_idle" */

/* GSI-IS-IDLE */
DLLEXPORT SI_Long gsi_is_idle()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,258);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_85);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_is_idle());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_85);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_localnet;     /* localnet */

/* SHARED-GSI-HAS-NETWORK-CONNECTIONS */
SI_Long g2int_shared_gsi_has_network_connections()
{
    Object icp_socket, ab_loop_list_;
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,259);
    if (g2int_visible_window_is_present_p())
	gsi_fc_result = (SI_Long)1L;
    else {
	icp_socket = Nil;
	ab_loop_list_ = G2int_active_icp_sockets;
      next_loop:
	if ( !TRUEP(ab_loop_list_))
	    goto end_loop;
	icp_socket = M_CAR(ab_loop_list_);
	ab_loop_list_ = M_CDR(ab_loop_list_);
	if ( !(EQ(ISVREF(icp_socket,(SI_Long)1L),Qg2int_localnet) || 
		FIXNUM_EQ(ISVREF(icp_socket,(SI_Long)15L),
		G2int_icp_connection_closed) || 
		FIXNUM_EQ(ISVREF(icp_socket,(SI_Long)15L),
		G2int_icp_socket_listening))) {
	    gsi_fc_result = (SI_Long)1L;
	    goto end;
	}
	goto next_loop;
      end_loop:
	gsi_fc_result = (SI_Long)0L;
	goto end;
	gsi_fc_result = FIXNUM_TO_LONG(Qnil);
      end:;
    }
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_86;  /* "gsi_has_network_connections" */

/* GSI-HAS-NETWORK-CONNECTIONS */
DLLEXPORT SI_Long gsi_has_network_connections()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,260);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_86);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_has_network_connections());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_86);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_pause_timeout;  /* |gsi_set_pause_timeout| */

/* SHARED-GSI-SET-PAUSE-TIMEOUT */
void g2int_shared_gsi_set_pause_timeout(gsi_fc_outer_max_idle_time)
    SI_Long gsi_fc_outer_max_idle_time;
{
    Object max_idle_time;
    SI_Long value;

    x_note_fn_call(47,261);
    value = gsi_fc_outer_max_idle_time;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_pause_timeout,Qerror,T);
	goto end_shared_gsi_set_pause_timeout;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_pause_timeout,Qerror,T);
	goto end_shared_gsi_set_pause_timeout;
    }
    max_idle_time = LONG_TO_FIXNUM(value);
    G2int_gsi_maximum_idle_interval = max_idle_time;
  end_shared_gsi_set_pause_timeout:;
}

static Object string_constant_87;  /* "gsi_set_pause_timeout" */

/* GSI-SET-PAUSE-TIMEOUT */
DLLEXPORT void gsi_set_pause_timeout(max_idle_time)
    SI_Long max_idle_time;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,262);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_87);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_pause_timeout(max_idle_time);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_87);
}

/* SHARED-GSI-PAUSE */
void g2int_shared_gsi_pause()
{
    x_note_fn_call(47,263);
    g2int_gsi_event_wait();
}

static Object string_constant_88;  /* "gsi_pause" */

/* GSI-PAUSE */
DLLEXPORT void gsi_pause()
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,264);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_88);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_pause();
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_88);
}

static Object Qg2int_gsi_set_run_loop_timeout;  /* |gsi_set_run_loop_timeout| */

/* SHARED-GSI-SET-RUN-LOOP-TIMEOUT */
void g2int_shared_gsi_set_run_loop_timeout(gsi_fc_outer_max_run_time)
    SI_Long gsi_fc_outer_max_run_time;
{
    Object max_run_time;
    SI_Long value;

    x_note_fn_call(47,265);
    value = gsi_fc_outer_max_run_time;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_run_loop_timeout,Qerror,T);
	goto end_shared_gsi_set_run_loop_timeout;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_run_loop_timeout,Qerror,T);
	goto end_shared_gsi_set_run_loop_timeout;
    }
    max_run_time = LONG_TO_FIXNUM(value);
    G2int_gsi_scheduled_tasks_time_limit = max_run_time;
  end_shared_gsi_set_run_loop_timeout:;
}

static Object string_constant_89;  /* "gsi_set_run_loop_timeout" */

/* GSI-SET-RUN-LOOP-TIMEOUT */
DLLEXPORT void gsi_set_run_loop_timeout(max_run_time)
    SI_Long max_run_time;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,266);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_89);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_run_loop_timeout(max_run_time);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_89);
}

static Object Qg2int_gsi_run_loop;  /* |gsi_run_loop| */

/* SHARED-GSI-RUN-LOOP */
void g2int_shared_gsi_run_loop()
{
    Object top_level_error_catcher_tag, error_occurred_p;
    Declare_catch(1);
    Declare_special(1);

    x_note_fn_call(47,267);
    if (g2int_gsi_option_is_set_p(G2int_gsi_trace_run_loop))
	format((SI_Long)2L,T,"Entering gsi_run_loop~%");
    if (G2int_within_run_loop_extent) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_illegal_nesting_of_run_loop,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_run_loop,Qerror,T);
	goto end_shared_gsi_run_loop;
    }
    top_level_error_catcher_tag = Qg2int_top_level_error_catcher;
    PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
	    0);
      if (PUSH_CATCH(G2int_top_level_error_catcher_tag,0)) {
	  G2int_top_level_error_seen = Nil;
	  g2int_register_all_signal_handlers();
	  g2int_enter_abyss();
	  error_occurred_p = Nil;
      }
      else
	  error_occurred_p = CATCH_VALUES();
      POP_CATCH(0);
    POP_SPECIAL();
    if (error_occurred_p) {
	g2int_minimal_internal_error_given_format_info(G2int_gensym_error_format_string,
		G2int_gensym_error_argument_list,
		G2int_gensym_error_sure_of_format_info_p);
	g2int_abort_gsi_top_level();
    }
    if (g2int_gsi_option_is_set_p(G2int_gsi_trace_run_loop))
	format((SI_Long)2L,T,"Leaving gsi_run_loop~%");
  end_shared_gsi_run_loop:;
}

static Object string_constant_90;  /* "gsi_run_loop" */

/* GSI-RUN-LOOP */
DLLEXPORT void gsi_run_loop()
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,268);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_90);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_run_loop();
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_run_loop();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_90);
}

static Object Qg2int_outer_loop;   /* outer-loop */

static Object Qg2int_handle_icp_messages;  /* handle-icp-messages */

static Object Qg2int_abort_level_0;  /* abort-level-0 */

/* ENTER-ABYSS */
Object g2int_enter_abyss()
{
    Object within_run_loop_extent, tag_temp, inner_abort_level_tag;
    Object scheduler_enabled_qm;
    char display_events_were_enabled;
    Declare_stack_pointer;
    Declare_catch(5);
    Declare_special(3);
    Object result;

    x_note_fn_call(47,269);
    SAVE_STACK();
    g2int_reset_counters_for_all_icp_sockets();
    within_run_loop_extent = T;
    PUSH_SPECIAL(G2int_within_run_loop_extent,within_run_loop_extent,2);
      tag_temp = UNIQUE_TAG(Qg2int_outer_loop);
      if (PUSH_CATCH(tag_temp,4)) {
	next_loop:
	  if (PUSH_UNWIND_PROTECT(3)) {
	      if (PUSH_CATCH(Qg2int_handle_icp_messages,2)) {
		  g2int_reclaim_icp_sockets();
		  if (PUSH_CATCH(Qg2int_abort_level_0,1)) {
		      inner_abort_level_tag = Qg2int_abort_level_0;
		      PUSH_SPECIAL(G2int_inner_abort_level_tag,inner_abort_level_tag,
			      1);
			if (G2int_starscheduler_enabledqmstar)
			    g2int_enqueue_scheduler_events_if_necessary(Nil);
		      next_loop_1:
			display_events_were_enabled = (SI_Long)0L != 
				ne_display_events_enabled();
			ne_enable_display_events();
			if (PUSH_UNWIND_PROTECT(0)) {
			    scheduler_enabled_qm = T;
			    PUSH_SPECIAL(G2int_starscheduler_enabledqmstar,scheduler_enabled_qm,
				    0);
			      g2int_gsi_event_cycle_handling_windows_quit();
			    POP_SPECIAL();
			}
			POP_UNWIND_PROTECT(0);
			if ( !display_events_were_enabled)
			    ne_disable_display_events();
			CONTINUE_UNWINDING(0);
			if (g2int_gsi_option_is_set_p(G2int_gsi_one_cycle)) {
			    result = VALUES_1(Nil);
			    THROW(tag_temp,result);
			}
			if ( !(g2int_g2_event_ready_p() ||  
				!TRUEP(g2int_milliseconds_to_next_scheduler_event())))
			    g2int_call_gsi_callback(1,G2int_gsi_idle);
			g2int_gsi_event_wait();
			goto next_loop_1;
		      end_loop:;
		      POP_SPECIAL();
		  }
		  POP_CATCH(1);
		  g2int_reclaim_icp_sockets();
	      }
	      POP_CATCH(2);
	  }
	  POP_UNWIND_PROTECT(3);
	  if (G2int_icp_socket_for_handle_icp_messages && 
		  FIXNUM_EQ(ISVREF(G2int_icp_socket_for_handle_icp_messages,
		  (SI_Long)15L),G2int_icp_connection_closed))
	      g2int_finalize_and_reclaim_icp_socket(G2int_icp_socket_for_handle_icp_messages);
	  CONTINUE_UNWINDING(3);
	  goto next_loop;
	end_loop_1:
	  result = VALUES_1(Qnil);
      }
      else
	  result = CATCH_VALUES();
      POP_CATCH(4);
    POP_SPECIAL();
    RESTORE_STACK();
    return result;
}

static Object Qg2int_gsi_return_message;  /* |gsi_return_message| */

/* SHARED-GSI-RETURN-MESSAGE */
void g2int_shared_gsi_return_message(wide_api_p,gsi_fc_outer_message,
	    gsi_fc_outer_context)
    Object wide_api_p, gsi_fc_outer_message;
    SI_Long gsi_fc_outer_context;
{
    Object message, context, code, derived_socket, current_icp_port;
    Object current_icp_socket, temp, disable_resumability;
    Object number_of_icp_bytes_for_message_series;
    Object icp_buffers_for_message_group;
    Object icp_buffer_of_start_of_message_series_qm;
    Object icp_byte_position_of_start_of_message_series_qm;
    Object number_of_icp_bytes_to_fill_buffer, current_icp_buffer;
    Object current_write_icp_byte_position;
    Object number_of_icp_bytes_in_message_group, writing_icp_message_group;
    Object gensymed_symbol;
    SI_Long value;
    double gensymed_symbol_1;
    Declare_special(12);

    x_note_fn_call(47,270);
    message = wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_message) : 
	    g2int_c_string_to_text_string(gsi_fc_outer_message);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_message,Qerror,T);
	goto end_shared_gsi_return_message;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_message,Qerror,T);
	goto end_shared_gsi_return_message;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,T);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_message,Qerror,T);
	g2int_reclaim_text_or_gensym_string(message);
	goto end_shared_gsi_return_message;
    }
    derived_socket = g2int_get_icp_socket_from_context(context,T);
    current_icp_port = ISVREF(derived_socket,(SI_Long)4L);
    PUSH_SPECIAL(G2int_current_icp_port,current_icp_port,11);
      current_icp_socket = ISVREF(G2int_current_icp_port,(SI_Long)2L);
      PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,10);
	temp = IFIX(ISVREF(G2int_current_icp_socket,(SI_Long)22L)) >= 
		(SI_Long)17L ? ISVREF(G2int_current_icp_socket,
		(SI_Long)53L) : Nil;
	if (temp);
	else
	    temp = Nil;
	disable_resumability = temp;
	PUSH_SPECIAL(G2int_disable_resumability,disable_resumability,9);
	  number_of_icp_bytes_for_message_series = FIX((SI_Long)0L);
	  PUSH_SPECIAL(G2int_number_of_icp_bytes_for_message_series,number_of_icp_bytes_for_message_series,
		  8);
	    icp_buffers_for_message_group = Nil;
	    PUSH_SPECIAL(G2int_icp_buffers_for_message_group,icp_buffers_for_message_group,
		    7);
	      icp_buffer_of_start_of_message_series_qm = Nil;
	      PUSH_SPECIAL(G2int_icp_buffer_of_start_of_message_seriesqm,icp_buffer_of_start_of_message_series_qm,
		      6);
		icp_byte_position_of_start_of_message_series_qm = Nil;
		PUSH_SPECIAL(G2int_icp_byte_position_of_start_of_message_seriesqm,icp_byte_position_of_start_of_message_series_qm,
			5);
		  number_of_icp_bytes_to_fill_buffer = FIX((SI_Long)0L);
		  PUSH_SPECIAL(G2int_number_of_icp_bytes_to_fill_buffer,number_of_icp_bytes_to_fill_buffer,
			  4);
		    current_icp_buffer = Nil;
		    PUSH_SPECIAL(G2int_current_icp_buffer,current_icp_buffer,
			    3);
		      current_write_icp_byte_position = Nil;
		      PUSH_SPECIAL(G2int_current_write_icp_byte_position,current_write_icp_byte_position,
			      2);
			number_of_icp_bytes_in_message_group = 
				FIX((SI_Long)0L);
			PUSH_SPECIAL(G2int_number_of_icp_bytes_in_message_group,number_of_icp_bytes_in_message_group,
				1);
			  writing_icp_message_group = 
				  FIXNUM_ADD1(G2int_writing_icp_message_group);
			  PUSH_SPECIAL(G2int_writing_icp_message_group,writing_icp_message_group,
				  0);
			    gensymed_symbol = Nil;
			    gensymed_symbol_1 = 0.0;
			    gensymed_symbol_1 = 0.0;
			    if (g2int_icp_connection_open_p(G2int_current_icp_socket) 
				    &&  
				    !TRUEP(g2int_icp_connection_being_shutdownqm(G2int_current_icp_socket))) 
					{
				g2int_send_icp_write_user_message_string(message,
					Nil,Nil,
					g2int_gsi_option_is_set_p(G2int_gsi_do_not_reformat_messages));
				g2int_end_icp_message_group();
			    }
			  POP_SPECIAL();
			POP_SPECIAL();
		      POP_SPECIAL();
		    POP_SPECIAL();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
      POP_SPECIAL();
    POP_SPECIAL();
    g2int_gsi_flush_internal_1(derived_socket,Nil);
    g2int_reclaim_text_or_gensym_string(message);
  end_shared_gsi_return_message:;
}

static Object string_constant_91;  /* "gsi_return_message" */

/* GSI-RETURN-MESSAGE */
DLLEXPORT void gsi_return_message(message,context)
    Object message;
    SI_Long context;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,271);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_91);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_return_message(G2int_gsi_wide_api_p,message,
		    context);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_return_message(G2int_gsi_wide_api_p,
			    message,context);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_91);
}

/* CHECK-GSI-VALUE-VECTOR */
Object g2int_check_gsi_value_vector(gsi_value_vector)
    Object gsi_value_vector;
{
    Object length_1, attribute_qm, value_qm;
    SI_Long index_1, ab_loop_bind_;

    x_note_fn_call(47,272);
    length_1 = FIXNUM_SUB1(g2int_gsi_managed_array_length(gsi_value_vector));
    index_1 = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = IFIX(FIXNUM_ADD1(length_1));
    attribute_qm = Nil;
    value_qm = Nil;
  next_loop:
    if (index_1 >= ab_loop_bind_)
	goto end_loop;
    attribute_qm = ISVREF(gsi_value_vector,index_1);
    if (SIMPLE_VECTOR_P(attribute_qm) && EQ(ISVREF(attribute_qm,
	    (SI_Long)0L),Qg2_defstruct_structure_name_gsi_attribute_g2_struct))
	value_qm = ISVREF(attribute_qm,(SI_Long)4L);
    else
	return VALUES_1(G2int_gsi_incompatible_structure);
    if ( !(SIMPLE_VECTOR_P(value_qm) && EQ(ISVREF(value_qm,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_instance_g2_struct)))
	return VALUES_1(G2int_gsi_incompatible_structure);
    index_1 = index_1 + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    return VALUES_1(Nil);
}

static Object Qg2int_write_icp_gsi_value_vector;  /* write-icp-gsi-value-vector */

static Object string_constant_92;  /* "resumable icp synch error: ~S expected, ~S found" */

static Object Qg2int_true;         /* true */

static Object Qg2int_false;        /* false */

/* WRITE-ICP-GSI-VALUE-VECTOR */
Object g2int_write_icp_gsi_value_vector(gsi_value_vector)
    Object gsi_value_vector;
{
    Object length_1, attribute_qm, value_qm, type_tag, timestamped_p;
    Object write_value_of_gsi_item_p, gsi_instance_extension, spec, temp;
    Object resumable_icp_state_1, icp_suspend_1, top, test;
    SI_Long index_1, ab_loop_bind_;
    char temp_1;
    Declare_special(1);
    Object result;

    x_note_fn_call(47,273);
    if (G2int_disable_resumability) {
	length_1 = 
		FIXNUM_SUB1(g2int_gsi_managed_array_length(gsi_value_vector));
	index_1 = IFIX(G2int_gsi_magic_offset);
	ab_loop_bind_ = IFIX(FIXNUM_ADD1(length_1));
	attribute_qm = Nil;
	value_qm = Nil;
	type_tag = Nil;
	timestamped_p = Nil;
	write_value_of_gsi_item_p = Nil;
	PUSH_SPECIAL(G2int_write_value_of_gsi_item_p,write_value_of_gsi_item_p,
		0);
	  g2int_write_icp_byte(length_1);
	next_loop:
	  if (index_1 >= ab_loop_bind_)
	      goto end_loop;
	  attribute_qm = ISVREF(gsi_value_vector,index_1);
	  value_qm = SIMPLE_VECTOR_P(attribute_qm) && 
		  EQ(ISVREF(attribute_qm,(SI_Long)0L),
		  Qg2_defstruct_structure_name_gsi_attribute_g2_struct) ? 
		  ISVREF(attribute_qm,(SI_Long)4L) : Nil;
	  type_tag = FIX(IFIX(ISVREF(value_qm,(SI_Long)1L)) >>  -  - 
		  (SI_Long)3L);
	  if (SIMPLE_VECTOR_P(value_qm) && EQ(ISVREF(value_qm,(SI_Long)0L),
		  Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	      gsi_instance_extension = ISVREF(value_qm,(SI_Long)3L);
	      timestamped_p =  ! !(gsi_instance_extension ? 
		      TRUEP(ISVREF(gsi_instance_extension,(SI_Long)10L)) : 
		      TRUEP(Nil)) ? T : Nil;
	  }
	  else
	      timestamped_p = Nil;
	  G2int_write_value_of_gsi_item_p =  !(EQ(type_tag,
		  G2int_gsi_sequence_type_tag) || EQ(type_tag,
		  G2int_gsi_structure_type_tag)) ? T : Nil;
	  if (IFIX(ISVREF(G2int_current_icp_socket,(SI_Long)22L)) >= 
		  (SI_Long)8L) {
	      spec = ISVREF(attribute_qm,(SI_Long)1L);
	      g2int_write_icp_icp_tree(CONSP(spec) && EQ(CAR(spec),
		      Qg2int_attribute) &&  !(CONSP(spec) ? 
		      TRUEP(SECOND(spec)) : TRUEP(Nil)) ? (CONSP(spec) ? 
		      THIRD(spec) : spec) : spec);
	  }
	  else
	      g2int_write_icp_text_string(g2int_symbol_name_text_string(g2int_gsi_attribute_qualified_name(attribute_qm)));
	  g2int_write_icp_remote_value(value_qm);
	  g2int_write_icp_boolean(timestamped_p);
	  if (timestamped_p) {
	      gsi_instance_extension = ISVREF(value_qm,(SI_Long)3L);
	      g2int_write_icp_gsi_timestamp(gsi_instance_extension ? 
		      ISVREF(gsi_instance_extension,(SI_Long)10L) : Nil);
	  }
	  index_1 = index_1 + (SI_Long)1L;
	  goto next_loop;
	end_loop:
	  temp = Qnil;
	POP_SPECIAL();
    }
    else {
	resumable_icp_state_1 = G2int_starresumable_icp_statestar;
	icp_suspend_1 = G2int_icp_suspend;
	if (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	    top = g2int_resumable_icp_pop();
	    if ( !EQ(Qg2int_write_icp_gsi_value_vector,top)) {
		result = g2int_icp_error_internal(Qerror,
			string_constant_92,
			Qg2int_write_icp_gsi_value_vector,top,Nil);
		goto end_write_icp_gsi_value_vector;
	    }
	}
	gsi_value_vector = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : gsi_value_vector;
	length_1 = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : 
		FIXNUM_SUB1(g2int_gsi_managed_array_length(gsi_value_vector));
	index_1 = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		IFIX(g2int_resumable_icp_pop()) : IFIX(G2int_gsi_magic_offset);
	ab_loop_bind_ = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		IFIX(g2int_resumable_icp_pop()) : IFIX(FIXNUM_ADD1(length_1));
	attribute_qm = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : Nil;
	value_qm = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : Nil;
	type_tag = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : Nil;
	timestamped_p = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : Nil;
	write_value_of_gsi_item_p = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : Nil;
	PUSH_SPECIAL(G2int_write_value_of_gsi_item_p,write_value_of_gsi_item_p,
		0);
	  if (resumable_icp_state_1 ? 
		  TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	      temp = g2int_resumable_icp_pop();
	      if (! !(FIXNUMP(temp) && FIXNUM_LE(FIX((SI_Long)-128L),temp) 
		      && FIXNUM_LE(temp,FIX((SI_Long)127L))))
		  switch (INTEGER_TO_CHAR(temp)) {
		    case 1:
		      goto l1;
		      break;
		    case 2:
		      goto l2;
		      break;
		    default:
		      break;
		  }
	  }
	l1:
	  if (EQ(icp_suspend_1,g2int_write_icp_byte(length_1))) {
	      g2int_resumable_icp_push(FIX((SI_Long)1L));
	      g2int_resumable_icp_push(G2int_write_value_of_gsi_item_p);
	      g2int_resumable_icp_push(timestamped_p);
	      g2int_resumable_icp_push(type_tag);
	      g2int_resumable_icp_push(value_qm);
	      g2int_resumable_icp_push(attribute_qm);
	      g2int_resumable_icp_push(FIX(ab_loop_bind_));
	      g2int_resumable_icp_push(FIX(index_1));
	      g2int_resumable_icp_push(length_1);
	      g2int_resumable_icp_push(gsi_value_vector);
	      g2int_resumable_icp_push(Qg2int_write_icp_gsi_value_vector);
	      result = VALUES_1(G2int_icp_suspend);
	      POP_SPECIAL();
	      goto end_write_icp_gsi_value_vector;
	  }
	next_loop_1:
	  if (index_1 >= ab_loop_bind_)
	      goto end_loop_1;
	  attribute_qm = ISVREF(gsi_value_vector,index_1);
	  value_qm = SIMPLE_VECTOR_P(attribute_qm) && 
		  EQ(ISVREF(attribute_qm,(SI_Long)0L),
		  Qg2_defstruct_structure_name_gsi_attribute_g2_struct) ? 
		  ISVREF(attribute_qm,(SI_Long)4L) : Nil;
	  type_tag = FIX(IFIX(ISVREF(value_qm,(SI_Long)1L)) >>  -  - 
		  (SI_Long)3L);
	  if (SIMPLE_VECTOR_P(value_qm) && EQ(ISVREF(value_qm,(SI_Long)0L),
		  Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	      gsi_instance_extension = ISVREF(value_qm,(SI_Long)3L);
	      timestamped_p =  ! !(gsi_instance_extension ? 
		      TRUEP(ISVREF(gsi_instance_extension,(SI_Long)10L)) : 
		      TRUEP(Nil)) ? T : Nil;
	  }
	  else
	      timestamped_p = Nil;
	  G2int_write_value_of_gsi_item_p =  !(EQ(type_tag,
		  G2int_gsi_sequence_type_tag) || EQ(type_tag,
		  G2int_gsi_structure_type_tag)) ? T : Nil;
	l2:
	  if (resumable_icp_state_1 ? 
		  TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	      temp = g2int_resumable_icp_pop();
	      if (! !(FIXNUMP(temp) && FIXNUM_LE(FIX((SI_Long)-128L),temp) 
		      && FIXNUM_LE(temp,FIX((SI_Long)127L))))
		  switch (INTEGER_TO_CHAR(temp)) {
		    case 1:
		      goto l1_1;
		      break;
		    case 2:
		      goto l2_1;
		      break;
		    case 3:
		      goto l3;
		      break;
		    case 4:
		      goto l4;
		      break;
		    default:
		      break;
		  }
	  }
	l1_1:
	  test = Nil;
	  if (resumable_icp_state_1 ? 
		  TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	      test = g2int_resumable_icp_pop();
	      temp_1 = TRUEP(test);
	  }
	  else
	      temp_1 = TRUEP(Nil);
	  if (temp_1 ? EQ(test,Qg2int_true) : 
		  IFIX(ISVREF(G2int_current_icp_socket,(SI_Long)22L)) >= 
		  (SI_Long)8L) {
	      spec = ISVREF(attribute_qm,(SI_Long)1L);
	      if (EQ(icp_suspend_1,g2int_write_icp_icp_tree(CONSP(spec) && 
		      EQ(CAR(spec),Qg2int_attribute) &&  !(CONSP(spec) ? 
		      TRUEP(SECOND(spec)) : TRUEP(Nil)) ? (CONSP(spec) ? 
		      THIRD(spec) : spec) : spec))) {
		  g2int_resumable_icp_push(Qg2int_true);
		  g2int_resumable_icp_push(FIX((SI_Long)1L));
		  temp = G2int_icp_suspend;
		  goto end_block;
	      }
	  }
	  else if (EQ(icp_suspend_1,
		  g2int_write_icp_text_string(g2int_symbol_name_text_string(g2int_gsi_attribute_qualified_name(attribute_qm))))) 
		      {
	      g2int_resumable_icp_push(Qg2int_false);
	      g2int_resumable_icp_push(FIX((SI_Long)1L));
	      temp = G2int_icp_suspend;
	      goto end_block;
	  }
	l2_1:
	  if (EQ(icp_suspend_1,g2int_write_icp_remote_value(value_qm))) {
	      g2int_resumable_icp_push(FIX((SI_Long)2L));
	      temp = G2int_icp_suspend;
	      goto end_block;
	  }
	l3:
	  if (EQ(icp_suspend_1,g2int_write_icp_boolean(timestamped_p))) {
	      g2int_resumable_icp_push(FIX((SI_Long)3L));
	      temp = G2int_icp_suspend;
	      goto end_block;
	  }
	l4:
	  if ((resumable_icp_state_1 ? 
		  TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) 
		  || timestamped_p) {
	      gsi_instance_extension = ISVREF(value_qm,(SI_Long)3L);
	      if (EQ(icp_suspend_1,
		      g2int_write_icp_gsi_timestamp(gsi_instance_extension 
		      ? ISVREF(gsi_instance_extension,(SI_Long)10L) : Nil))) {
		  g2int_resumable_icp_push(FIX((SI_Long)4L));
		  temp = G2int_icp_suspend;
		  goto end_block;
	      }
	      else
		  temp = Nil;
	  }
	  else
	      temp = Nil;
	  goto end_block;
	end_block:
	  if (EQ(icp_suspend_1,temp)) {
	      g2int_resumable_icp_push(FIX((SI_Long)2L));
	      g2int_resumable_icp_push(G2int_write_value_of_gsi_item_p);
	      g2int_resumable_icp_push(timestamped_p);
	      g2int_resumable_icp_push(type_tag);
	      g2int_resumable_icp_push(value_qm);
	      g2int_resumable_icp_push(attribute_qm);
	      g2int_resumable_icp_push(FIX(ab_loop_bind_));
	      g2int_resumable_icp_push(FIX(index_1));
	      g2int_resumable_icp_push(length_1);
	      g2int_resumable_icp_push(gsi_value_vector);
	      g2int_resumable_icp_push(Qg2int_write_icp_gsi_value_vector);
	      result = VALUES_1(G2int_icp_suspend);
	      POP_SPECIAL();
	      goto end_write_icp_gsi_value_vector;
	  }
	  index_1 = index_1 + (SI_Long)1L;
	  goto next_loop_1;
	end_loop_1:
	  temp = Qnil;
	POP_SPECIAL();
    }
    result = VALUES_1(temp);
  end_write_icp_gsi_value_vector:
    return result;
}

static Object Qg2int_gsi_reference_flag;  /* gsi-reference-flag */

static Object Qg2int_item_index_space;  /* item-index-space */

/* CHECK-TRANSFER-WRAPPER */
Object g2int_check_transfer_wrapper(transfer_wrapper,timestamp_p,icp_socket)
    Object transfer_wrapper, timestamp_p, icp_socket;
{
    Object input_port, transfer_wrapper_p, temp, temp_1, handle, value;
    Object gsi_instance_extension, thing;
    char temp_2;
    Object result;

    x_note_fn_call(47,274);
    input_port = ISVREF(icp_socket,(SI_Long)3L);
    transfer_wrapper_p = Nil;
    transfer_wrapper_p = SIMPLE_VECTOR_P(transfer_wrapper) ? 
	    (EQ(ISVREF(transfer_wrapper,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct) ? 
	    T : Nil) : Qnil;
    if (transfer_wrapper_p) {
	temp = ISVREF(transfer_wrapper,(SI_Long)1L);
	temp_1 = ISVREF(transfer_wrapper,(SI_Long)4L);
	result = VALUES_2(temp,temp_1);
    }
    else if (SIMPLE_VECTOR_P(transfer_wrapper) && 
	    EQ(ISVREF(transfer_wrapper,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	temp_1 = (IFIX(ISVREF(icp_socket,(SI_Long)22L)) >= (SI_Long)18L ? 
		TRUEP(T) : TRUEP(Nil)) && 
		g2int_get_gsi_instance_plist_value(transfer_wrapper,
		Qg2int_gsi_reference_flag) ? transfer_wrapper : 
		g2int_get_icp_object_index_for_gsi_instance(transfer_wrapper,
		input_port);
	result = VALUES_2(temp_1,transfer_wrapper);
    }
    else
	return VALUES_1(G2int_gsi_incompatible_structure);
    MVS_2(result,handle,value);
    if ( !(handle && SIMPLE_VECTOR_P(value) && EQ(ISVREF(value,
	    (SI_Long)0L),Qg2_defstruct_structure_name_gsi_instance_g2_struct)))
	return VALUES_1(G2int_gsi_incompatible_structure);
    if (SIMPLE_VECTOR_P(transfer_wrapper) && EQ(ISVREF(transfer_wrapper,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	if (SIMPLE_VECTOR_P(handle) && EQ(ISVREF(handle,(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(handle,(SI_Long)3L);
	    temp_2 =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp_2 = TRUEP(Nil);
	if (temp_2);
	else if ( !TRUEP(g2int_get_from_icp_port_if_any(input_port,handle,
		Qg2int_item_index_space)))
	    return VALUES_1(G2int_gsi_incompatible_structure);
    }
    if (timestamp_p) {
	gsi_instance_extension = ISVREF(value,(SI_Long)3L);
	thing = gsi_instance_extension ? ISVREF(gsi_instance_extension,
		(SI_Long)10L) : Nil;
	if ( !(INLINE_DOUBLE_FLOAT_VECTOR_P(thing) != (SI_Long)0L && 
		IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(thing)) == (SI_Long)1L))
	    return VALUES_1(G2int_gsi_invalid_timestamp);
    }
    return VALUES_1(Nil);
}

/* TRANSFER-WRAPPER-COMPONENTS */
Object g2int_transfer_wrapper_components(transfer_wrapper,timestamp_p,
	    icp_socket)
    Object transfer_wrapper, timestamp_p, icp_socket;
{
    Object input_port, transfer_wrapper_p, temp, temp_1, temp_2, handle;
    Object status, value, gsi_instance_extension;
    char temp_3;
    Object result;

    x_note_fn_call(47,275);
    input_port = ISVREF(icp_socket,(SI_Long)3L);
    transfer_wrapper_p = Nil;
    transfer_wrapper_p = SIMPLE_VECTOR_P(transfer_wrapper) ? 
	    (EQ(ISVREF(transfer_wrapper,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct) ? 
	    T : Nil) : Qnil;
    if (transfer_wrapper_p) {
	temp = ISVREF(transfer_wrapper,(SI_Long)1L);
	temp_1 = ISVREF(transfer_wrapper,(SI_Long)2L);
	temp_2 = ISVREF(transfer_wrapper,(SI_Long)4L);
	result = VALUES_3(temp,temp_1,temp_2);
    }
    else if (SIMPLE_VECTOR_P(transfer_wrapper) && 
	    EQ(ISVREF(transfer_wrapper,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	temp_2 = (IFIX(ISVREF(icp_socket,(SI_Long)22L)) >= (SI_Long)18L ? 
		TRUEP(T) : TRUEP(Nil)) && 
		g2int_get_gsi_instance_plist_value(transfer_wrapper,
		Qg2int_gsi_reference_flag) ? transfer_wrapper : 
		g2int_get_icp_object_index_for_gsi_instance(transfer_wrapper,
		input_port);
	result = VALUES_3(temp_2,G2int_no_error,transfer_wrapper);
    }
    else
	result = VALUES_1(Qnil);
    MVS_3(result,handle,status,value);
    if (SIMPLE_VECTOR_P(transfer_wrapper) && EQ(ISVREF(transfer_wrapper,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	if (SIMPLE_VECTOR_P(handle) && EQ(ISVREF(handle,(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(handle,(SI_Long)3L);
	    temp_3 =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp_3 = TRUEP(Nil);
    }
    else
	temp_3 = TRUEP(Nil);
    if (temp_3)
	handle = g2int_gsi_sensor_index(handle);
    temp_1 = handle;
    if (timestamp_p) {
	gsi_instance_extension = ISVREF(value,(SI_Long)3L);
	temp_2 = gsi_instance_extension ? ISVREF(gsi_instance_extension,
		(SI_Long)10L) : Nil;
    }
    else
	temp_2 = Nil;
    return VALUES_4(temp_1,status,value,temp_2);
}

Object G2int_send_timestamp_with_gsi_sensor_p = UNBOUND;

static Object Qg2int_send_icp_receive_values_for_gsi_sensors_with_timestamp;  /* send-icp-receive-values-for-gsi-sensors-with-timestamp */

/* SEND-ICP-RECEIVE-VALUES-FOR-GSI-SENSORS-WITH-TIMESTAMP */
Object g2int_send_icp_receive_values_for_gsi_sensors_with_timestamp(gsi_values)
    Object gsi_values;
{
    Object send_timestamp_with_gsi_sensor_p, temp, resumable_icp_state_1;
    Object icp_suspend_1, top, value;
    Declare_special(1);
    Object result;

    x_note_fn_call(47,276);
    if (G2int_disable_resumability) {
	send_timestamp_with_gsi_sensor_p = T;
	PUSH_SPECIAL(G2int_send_timestamp_with_gsi_sensor_p,send_timestamp_with_gsi_sensor_p,
		0);
	  temp = g2int_send_icp_receive_values_for_gsi_sensors(gsi_values);
	POP_SPECIAL();
    }
    else {
	resumable_icp_state_1 = G2int_starresumable_icp_statestar;
	icp_suspend_1 = G2int_icp_suspend;
	if (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	    top = g2int_resumable_icp_pop();
	    if ( 
		    !EQ(Qg2int_send_icp_receive_values_for_gsi_sensors_with_timestamp,
		    top)) {
		result = g2int_icp_error_internal(Qerror,
			string_constant_92,
			Qg2int_send_icp_receive_values_for_gsi_sensors_with_timestamp,
			top,Nil);
		goto end_send_icp_receive_values_for_gsi_sensors_with_timestamp;
	    }
	}
	gsi_values = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : gsi_values;
	send_timestamp_with_gsi_sensor_p = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : T;
	PUSH_SPECIAL(G2int_send_timestamp_with_gsi_sensor_p,send_timestamp_with_gsi_sensor_p,
		0);
	  value = g2int_send_icp_receive_values_for_gsi_sensors(gsi_values);
	  if (EQ(icp_suspend_1,value)) {
	      g2int_resumable_icp_push(G2int_send_timestamp_with_gsi_sensor_p);
	      g2int_resumable_icp_push(gsi_values);
	      g2int_resumable_icp_push(Qg2int_send_icp_receive_values_for_gsi_sensors_with_timestamp);
	      result = VALUES_1(G2int_icp_suspend);
	      POP_SPECIAL();
	      goto end_send_icp_receive_values_for_gsi_sensors_with_timestamp;
	  }
	  temp = value;
	POP_SPECIAL();
    }
    result = VALUES_1(temp);
  end_send_icp_receive_values_for_gsi_sensors_with_timestamp:
    return result;
}

static Object Qg2int_send_icp_receive_values_for_gsi_sensors_without_timestamp;  /* send-icp-receive-values-for-gsi-sensors-without-timestamp */

/* SEND-ICP-RECEIVE-VALUES-FOR-GSI-SENSORS-WITHOUT-TIMESTAMP */
Object g2int_send_icp_receive_values_for_gsi_sensors_without_timestamp(gsi_values)
    Object gsi_values;
{
    Object send_timestamp_with_gsi_sensor_p, temp, resumable_icp_state_1;
    Object icp_suspend_1, top, value;
    Declare_special(1);
    Object result;

    x_note_fn_call(47,277);
    if (G2int_disable_resumability) {
	send_timestamp_with_gsi_sensor_p = Nil;
	PUSH_SPECIAL(G2int_send_timestamp_with_gsi_sensor_p,send_timestamp_with_gsi_sensor_p,
		0);
	  temp = g2int_send_icp_receive_values_for_gsi_sensors(gsi_values);
	POP_SPECIAL();
    }
    else {
	resumable_icp_state_1 = G2int_starresumable_icp_statestar;
	icp_suspend_1 = G2int_icp_suspend;
	if (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	    top = g2int_resumable_icp_pop();
	    if ( 
		    !EQ(Qg2int_send_icp_receive_values_for_gsi_sensors_without_timestamp,
		    top)) {
		result = g2int_icp_error_internal(Qerror,
			string_constant_92,
			Qg2int_send_icp_receive_values_for_gsi_sensors_without_timestamp,
			top,Nil);
		goto end_send_icp_receive_values_for_gsi_sensors_without_timestamp;
	    }
	}
	gsi_values = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : gsi_values;
	send_timestamp_with_gsi_sensor_p = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : Nil;
	PUSH_SPECIAL(G2int_send_timestamp_with_gsi_sensor_p,send_timestamp_with_gsi_sensor_p,
		0);
	  value = g2int_send_icp_receive_values_for_gsi_sensors(gsi_values);
	  if (EQ(icp_suspend_1,value)) {
	      g2int_resumable_icp_push(G2int_send_timestamp_with_gsi_sensor_p);
	      g2int_resumable_icp_push(gsi_values);
	      g2int_resumable_icp_push(Qg2int_send_icp_receive_values_for_gsi_sensors_without_timestamp);
	      result = VALUES_1(G2int_icp_suspend);
	      POP_SPECIAL();
	      goto end_send_icp_receive_values_for_gsi_sensors_without_timestamp;
	  }
	  temp = value;
	POP_SPECIAL();
    }
    result = VALUES_1(temp);
  end_send_icp_receive_values_for_gsi_sensors_without_timestamp:
    return result;
}

static Object Qg2int_write_icp_gsi_values;  /* write-icp-gsi-values */

/* WRITE-ICP-GSI-VALUES */
Object g2int_write_icp_gsi_values(gsi_values)
    Object gsi_values;
{
    Object count_1, timestamp_p, transfer_wrapper, handle, status, value;
    Object timestamp, write_value_of_gsi_item_p, saved_reference_p, temp;
    Object resumable_icp_state_1, icp_suspend_1, top, temp_1, temp_2, temp_3;
    Object v1, v2, v3;
    SI_Long index_1, ab_loop_bind_;
    Declare_special(1);
    Object result;

    x_note_fn_call(47,278);
    if (G2int_disable_resumability) {
	count_1 = FIXNUM_SUB1(g2int_gsi_managed_array_length(gsi_values));
	timestamp_p = G2int_send_timestamp_with_gsi_sensor_p;
	g2int_write_icp_boolean(timestamp_p);
	g2int_write_icp_fixnum(count_1);
	index_1 = IFIX(G2int_gsi_magic_offset);
	ab_loop_bind_ = IFIX(count_1);
	transfer_wrapper = Nil;
      next_loop:
	if (index_1 > ab_loop_bind_)
	    goto end_loop;
	transfer_wrapper = ISVREF(gsi_values,index_1);
	result = g2int_transfer_wrapper_components(transfer_wrapper,
		timestamp_p,G2int_current_icp_socket);
	MVS_4(result,handle,status,value,timestamp);
	g2int_write_icp_returned_gsi_sensor(handle);
	g2int_write_icp_unsigned_integer(status);
	write_value_of_gsi_item_p = IFIX(ISVREF(G2int_current_icp_socket,
		(SI_Long)22L)) >= (SI_Long)11L ? Nil : T;
	saved_reference_p = g2int_get_gsi_instance_plist_value(value,
		Qg2int_gsi_reference_flag);
	PUSH_SPECIAL(G2int_write_value_of_gsi_item_p,write_value_of_gsi_item_p,
		0);
	  if (saved_reference_p)
	      g2int_set_gsi_instance_plist_value(value,
		      Qg2int_gsi_reference_flag,Nil);
	  g2int_write_icp_remote_value(value);
	  if (saved_reference_p)
	      g2int_set_gsi_instance_plist_value(value,
		      Qg2int_gsi_reference_flag,T);
	  if (timestamp_p && (G2int_write_value_of_gsi_item_p || 
		  g2int_gsi_item_is_value_p(value)))
	      g2int_write_icp_gsi_timestamp(timestamp);
	POP_SPECIAL();
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:
	temp = Qnil;
    }
    else {
	resumable_icp_state_1 = G2int_starresumable_icp_statestar;
	icp_suspend_1 = G2int_icp_suspend;
	if (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	    top = g2int_resumable_icp_pop();
	    if ( !EQ(Qg2int_write_icp_gsi_values,top))
		return g2int_icp_error_internal(Qerror,string_constant_92,
			Qg2int_write_icp_gsi_values,top,Nil);
	}
	gsi_values = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : gsi_values;
	count_1 = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : 
		FIXNUM_SUB1(g2int_gsi_managed_array_length(gsi_values));
	timestamp_p = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : 
		G2int_send_timestamp_with_gsi_sensor_p;
	if (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	    temp = g2int_resumable_icp_pop();
	    if (! !(FIXNUMP(temp) && FIXNUM_LE(FIX((SI_Long)-128L),temp) 
		    && FIXNUM_LE(temp,FIX((SI_Long)127L))))
		switch (INTEGER_TO_CHAR(temp)) {
		  case 1:
		    goto l1;
		    break;
		  case 2:
		    goto l2;
		    break;
		  case 3:
		    goto l3;
		    break;
		  default:
		    break;
		}
	}
      l1:
	if (EQ(icp_suspend_1,g2int_write_icp_boolean(timestamp_p))) {
	    g2int_resumable_icp_push(FIX((SI_Long)1L));
	    result = VALUES_1(G2int_icp_suspend);
	    goto end_block;
	}
      l2:
	if (EQ(icp_suspend_1,g2int_write_icp_fixnum(count_1))) {
	    g2int_resumable_icp_push(FIX((SI_Long)2L));
	    result = VALUES_1(G2int_icp_suspend);
	    goto end_block;
	}
      l3:
	index_1 = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		IFIX(g2int_resumable_icp_pop()) : IFIX(G2int_gsi_magic_offset);
	ab_loop_bind_ = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		IFIX(g2int_resumable_icp_pop()) : IFIX(count_1);
	transfer_wrapper = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : Nil;
	if (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil))
	    goto resume;
      next_loop_1:
	if (index_1 > ab_loop_bind_)
	    goto end_loop_1;
	transfer_wrapper = ISVREF(gsi_values,index_1);
      resume:
	if (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	    temp_1 = g2int_resumable_icp_pop();
	    temp_2 = g2int_resumable_icp_pop();
	    temp_3 = g2int_resumable_icp_pop();
	    temp = g2int_resumable_icp_pop();
	    result = VALUES_4(temp_1,temp_2,temp_3,temp);
	}
	else
	    result = g2int_transfer_wrapper_components(transfer_wrapper,
		    timestamp_p,G2int_current_icp_socket);
	MVS_4(result,handle,status,value,timestamp);
	if (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	    temp = g2int_resumable_icp_pop();
	    if (! !(FIXNUMP(temp) && FIXNUM_LE(FIX((SI_Long)-128L),temp) 
		    && FIXNUM_LE(temp,FIX((SI_Long)127L))))
		switch (INTEGER_TO_CHAR(temp)) {
		  case 1:
		    goto l1_1;
		    break;
		  case 2:
		    goto l2_1;
		    break;
		  case 3:
		    goto l3_1;
		    break;
		  default:
		    break;
		}
	}
      l1_1:
	if (EQ(icp_suspend_1,g2int_write_icp_returned_gsi_sensor(handle))) {
	    g2int_resumable_icp_push(FIX((SI_Long)1L));
	    temp = G2int_icp_suspend;
	    goto end_block_1;
	}
      l2_1:
	if (EQ(icp_suspend_1,g2int_write_icp_unsigned_integer(status))) {
	    g2int_resumable_icp_push(FIX((SI_Long)2L));
	    temp = G2int_icp_suspend;
	    goto end_block_1;
	}
      l3_1:
	write_value_of_gsi_item_p = (resumable_icp_state_1 ? 
		TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) &&  
		!TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) ? 
		g2int_resumable_icp_pop() : 
		IFIX(ISVREF(G2int_current_icp_socket,(SI_Long)22L)) >= 
		(SI_Long)11L ? Nil : T;
	PUSH_SPECIAL(G2int_write_value_of_gsi_item_p,write_value_of_gsi_item_p,
		0);
	  saved_reference_p = (resumable_icp_state_1 ? 
		  TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) 
		  &&  !TRUEP(g2int_resumable_icp_pop_list_if_end_marker()) 
		  ? g2int_resumable_icp_pop() : 
		  g2int_get_gsi_instance_plist_value(value,
		  Qg2int_gsi_reference_flag);
	  if (resumable_icp_state_1 ? 
		  TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) {
	      temp = g2int_resumable_icp_pop();
	      if (! !(FIXNUMP(temp) && FIXNUM_LE(FIX((SI_Long)-128L),temp) 
		      && FIXNUM_LE(temp,FIX((SI_Long)127L))))
		  switch (INTEGER_TO_CHAR(temp)) {
		    case 1:
		      goto l1_2;
		      break;
		    case 2:
		      goto l2_2;
		      break;
		    default:
		      break;
		  }
	  }
	  if (saved_reference_p)
	      g2int_set_gsi_instance_plist_value(value,
		      Qg2int_gsi_reference_flag,Nil);
	l1_2:
	  if (EQ(icp_suspend_1,g2int_write_icp_remote_value(value))) {
	      g2int_resumable_icp_push(FIX((SI_Long)1L));
	      temp = G2int_icp_suspend;
	      goto end_block_2;
	  }
	  if (saved_reference_p)
	      g2int_set_gsi_instance_plist_value(value,
		      Qg2int_gsi_reference_flag,T);
	l2_2:
	  if ((resumable_icp_state_1 ? 
		  TRUEP(G2int_starresumable_icp_statestar) : TRUEP(Nil)) 
		  || timestamp_p && (G2int_write_value_of_gsi_item_p || 
		  g2int_gsi_item_is_value_p(value))) {
	      if (EQ(icp_suspend_1,g2int_write_icp_gsi_timestamp(timestamp))) {
		  g2int_resumable_icp_push(FIX((SI_Long)2L));
		  temp = G2int_icp_suspend;
		  goto end_block_2;
	      }
	      else
		  temp = Nil;
	  }
	  else
	      temp = Nil;
	  goto end_block_2;
	end_block_2:
	  if (EQ(icp_suspend_1,temp)) {
	      g2int_resumable_icp_push(saved_reference_p);
	      g2int_resumable_icp_push(G2int_write_value_of_gsi_item_p);
	      g2int_resumable_icp_push(FIX((SI_Long)3L));
	      temp = G2int_icp_suspend;
	      POP_SPECIAL();
	      goto end_block_1;
	  }
	  else
	      temp = Nil;
	POP_SPECIAL();
	goto end_block_1;
      end_block_1:
	if (EQ(icp_suspend_1,temp)) {
	    g2int_resumable_icp_push(timestamp);
	    g2int_resumable_icp_push(value);
	    g2int_resumable_icp_push(status);
	    g2int_resumable_icp_push(handle);
	    g2int_resumable_icp_push(transfer_wrapper);
	    g2int_resumable_icp_push(FIX(ab_loop_bind_));
	    g2int_resumable_icp_push(FIX(index_1));
	    g2int_resumable_icp_push(FIX((SI_Long)3L));
	    result = VALUES_1(G2int_icp_suspend);
	    goto end_block;
	}
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop_1;
      end_loop_1:
	result = VALUES_1(Qnil);
	goto end_block;
      end_block:
	MVS_3(result,v1,v2,v3);
	if (EQ(icp_suspend_1,v1)) {
	    g2int_resumable_icp_push(timestamp_p);
	    g2int_resumable_icp_push(count_1);
	    g2int_resumable_icp_push(gsi_values);
	    g2int_resumable_icp_push(Qg2int_write_icp_gsi_values);
	    return VALUES_1(G2int_icp_suspend);
	}
	temp = v1;
    }
    return VALUES_1(temp);
}

/* GSI-RETURN-VALUES-INTERNAL */
Object g2int_gsi_return_values_internal(transfer_wrappers,context,timestamp_p)
    Object transfer_wrappers, context, timestamp_p;
{
    Object derived_socket, temp, temp_1, current_icp_port, current_icp_socket;
    Object disable_resumability, number_of_icp_bytes_for_message_series;
    Object icp_buffers_for_message_group;
    Object icp_buffer_of_start_of_message_series_qm;
    Object icp_byte_position_of_start_of_message_series_qm;
    Object number_of_icp_bytes_to_fill_buffer, current_icp_buffer;
    Object current_write_icp_byte_position;
    Object number_of_icp_bytes_in_message_group, writing_icp_message_group;
    Object gensymed_symbol, count_1, message_count, transfer_wrapper, handle;
    Object status, value, timestamp;
    SI_Long index_1, ab_loop_bind_;
    double gensymed_symbol_1;
    Declare_special(12);
    Object result;

    x_note_fn_call(47,279);
    derived_socket = g2int_get_icp_socket_from_context(context,T);
    temp = ISVREF(derived_socket,(SI_Long)21L);
    temp_1 = ISVREF(derived_socket,(SI_Long)22L);
    if (IFIX(FIXNUM_MIN(temp,temp_1)) >= (SI_Long)9L)
	g2int_send_or_enqueue_icp_write_task(ISVREF(derived_socket,
		(SI_Long)4L),G2int_resumable_priority_of_gsi_data_service,
		timestamp_p ? 
		SYMBOL_FUNCTION(Qg2int_send_icp_receive_values_for_gsi_sensors_with_timestamp) 
		: 
		SYMBOL_FUNCTION(Qg2int_send_icp_receive_values_for_gsi_sensors_without_timestamp),
		g2int_gensym_cons_1(transfer_wrappers,Nil),Nil,Nil);
    else {
	current_icp_port = ISVREF(derived_socket,(SI_Long)4L);
	PUSH_SPECIAL(G2int_current_icp_port,current_icp_port,11);
	  current_icp_socket = ISVREF(G2int_current_icp_port,(SI_Long)2L);
	  PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,10);
	    temp = IFIX(ISVREF(G2int_current_icp_socket,(SI_Long)22L)) >= 
		    (SI_Long)17L ? ISVREF(G2int_current_icp_socket,
		    (SI_Long)53L) : Nil;
	    if (temp);
	    else
		temp = Nil;
	    disable_resumability = temp;
	    PUSH_SPECIAL(G2int_disable_resumability,disable_resumability,9);
	      number_of_icp_bytes_for_message_series = FIX((SI_Long)0L);
	      PUSH_SPECIAL(G2int_number_of_icp_bytes_for_message_series,number_of_icp_bytes_for_message_series,
		      8);
		icp_buffers_for_message_group = Nil;
		PUSH_SPECIAL(G2int_icp_buffers_for_message_group,icp_buffers_for_message_group,
			7);
		  icp_buffer_of_start_of_message_series_qm = Nil;
		  PUSH_SPECIAL(G2int_icp_buffer_of_start_of_message_seriesqm,icp_buffer_of_start_of_message_series_qm,
			  6);
		    icp_byte_position_of_start_of_message_series_qm = Nil;
		    PUSH_SPECIAL(G2int_icp_byte_position_of_start_of_message_seriesqm,icp_byte_position_of_start_of_message_series_qm,
			    5);
		      number_of_icp_bytes_to_fill_buffer = FIX((SI_Long)0L);
		      PUSH_SPECIAL(G2int_number_of_icp_bytes_to_fill_buffer,number_of_icp_bytes_to_fill_buffer,
			      4);
			current_icp_buffer = Nil;
			PUSH_SPECIAL(G2int_current_icp_buffer,current_icp_buffer,
				3);
			  current_write_icp_byte_position = Nil;
			  PUSH_SPECIAL(G2int_current_write_icp_byte_position,current_write_icp_byte_position,
				  2);
			    number_of_icp_bytes_in_message_group = 
				    FIX((SI_Long)0L);
			    PUSH_SPECIAL(G2int_number_of_icp_bytes_in_message_group,number_of_icp_bytes_in_message_group,
				    1);
			      writing_icp_message_group = 
				      FIXNUM_ADD1(G2int_writing_icp_message_group);
			      PUSH_SPECIAL(G2int_writing_icp_message_group,writing_icp_message_group,
				      0);
				gensymed_symbol = Nil;
				gensymed_symbol_1 = 0.0;
				gensymed_symbol_1 = 0.0;
				if (g2int_icp_connection_open_p(G2int_current_icp_socket) 
					&&  
					!TRUEP(g2int_icp_connection_being_shutdownqm(G2int_current_icp_socket))) 
					    {
				    count_1 = 
					    FIXNUM_SUB1(g2int_gsi_managed_array_length(transfer_wrappers));
				    message_count = FIX((SI_Long)0L);
				    index_1 = IFIX(G2int_gsi_magic_offset);
				    ab_loop_bind_ = IFIX(count_1);
				    transfer_wrapper = Nil;
				  next_loop:
				    if (index_1 > ab_loop_bind_)
					goto end_loop;
				    transfer_wrapper = 
					    ISVREF(transfer_wrappers,index_1);
				    message_count = FIXNUM_ADD1(message_count);
				    if ((SI_Long)50L == IFIX(message_count)) {
					message_count = FIX((SI_Long)0L);
					g2int_next_icp_message_group();
				    }
				    result = g2int_transfer_wrapper_components(transfer_wrapper,
					    timestamp_p,derived_socket);
				    MVS_4(result,handle,status,value,
					    timestamp);
				    if (timestamp_p)
					g2int_send_icp_receive_value_for_gsi_sensor_with_timestamp(handle,
						status,value,timestamp);
				    else
					g2int_send_icp_receive_value_for_gsi_sensor(handle,
						status,value);
				    index_1 = index_1 + (SI_Long)1L;
				    goto next_loop;
				  end_loop:;
				    g2int_end_icp_message_group();
				}
			      POP_SPECIAL();
			    POP_SPECIAL();
			  POP_SPECIAL();
			POP_SPECIAL();
		      POP_SPECIAL();
		    POP_SPECIAL();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
    }
    return g2int_gsi_flush_internal_1(derived_socket,Nil);
}

static Object Qg2int_send_icp_receive_timestamped_gsi_sensor_value_vector;  /* send-icp-receive-timestamped-gsi-sensor-value-vector */

static Object Qg2int_send_icp_receive_gsi_sensor_value_vector;  /* send-icp-receive-gsi-sensor-value-vector */

/* GSI-RETURN-ATTRS-INTERNAL */
Object g2int_gsi_return_attrs_internal(transfer_wrapper,attributes,context,
	    timestamp_p)
    Object transfer_wrapper, attributes, context, timestamp_p;
{
    Object derived_socket, handle, status, value, timestamp, temp, temp_1;
    Object gensymed_symbol, gensymed_symbol_1, temp_2, current_icp_port;
    Object current_icp_socket, disable_resumability;
    Object number_of_icp_bytes_for_message_series;
    Object icp_buffers_for_message_group;
    Object icp_buffer_of_start_of_message_series_qm;
    Object icp_byte_position_of_start_of_message_series_qm;
    Object number_of_icp_bytes_to_fill_buffer, current_icp_buffer;
    Object current_write_icp_byte_position;
    Object number_of_icp_bytes_in_message_group, writing_icp_message_group;
    double gensymed_symbol_2;
    Declare_special(12);
    Object result;

    x_note_fn_call(47,280);
    derived_socket = g2int_get_icp_socket_from_context(context,T);
    result = g2int_transfer_wrapper_components(transfer_wrapper,
	    timestamp_p,derived_socket);
    MVS_4(result,handle,status,value,timestamp);
    temp = ISVREF(derived_socket,(SI_Long)21L);
    temp_1 = ISVREF(derived_socket,(SI_Long)22L);
    if (IFIX(FIXNUM_MIN(temp,temp_1)) >= (SI_Long)9L) {
	temp = ISVREF(derived_socket,(SI_Long)4L);
	temp_1 = G2int_resumable_priority_of_gsi_data_service;
	if (timestamp_p) {
	    gensymed_symbol = g2int_make_gensym_list_1(FIX((SI_Long)5L));
	    gensymed_symbol_1 = gensymed_symbol;
	    M_CAR(gensymed_symbol_1) = handle;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    M_CAR(gensymed_symbol_1) = status;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    M_CAR(gensymed_symbol_1) = value;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    M_CAR(gensymed_symbol_1) = timestamp;
	    gensymed_symbol_1 = M_CDR(gensymed_symbol_1);
	    M_CAR(gensymed_symbol_1) = attributes;
	    temp_2 = gensymed_symbol;
	}
	else
	    temp_2 = g2int_gensym_list_4(handle,status,value,attributes);
	g2int_send_or_enqueue_icp_write_task(temp,temp_1,timestamp_p ? 
		SYMBOL_FUNCTION(Qg2int_send_icp_receive_timestamped_gsi_sensor_value_vector) 
		: 
		SYMBOL_FUNCTION(Qg2int_send_icp_receive_gsi_sensor_value_vector),
		temp_2,Nil,Nil);
    }
    else {
	current_icp_port = ISVREF(derived_socket,(SI_Long)4L);
	PUSH_SPECIAL(G2int_current_icp_port,current_icp_port,11);
	  current_icp_socket = ISVREF(G2int_current_icp_port,(SI_Long)2L);
	  PUSH_SPECIAL(G2int_current_icp_socket,current_icp_socket,10);
	    temp = IFIX(ISVREF(G2int_current_icp_socket,(SI_Long)22L)) >= 
		    (SI_Long)17L ? ISVREF(G2int_current_icp_socket,
		    (SI_Long)53L) : Nil;
	    if (temp);
	    else
		temp = Nil;
	    disable_resumability = temp;
	    PUSH_SPECIAL(G2int_disable_resumability,disable_resumability,9);
	      number_of_icp_bytes_for_message_series = FIX((SI_Long)0L);
	      PUSH_SPECIAL(G2int_number_of_icp_bytes_for_message_series,number_of_icp_bytes_for_message_series,
		      8);
		icp_buffers_for_message_group = Nil;
		PUSH_SPECIAL(G2int_icp_buffers_for_message_group,icp_buffers_for_message_group,
			7);
		  icp_buffer_of_start_of_message_series_qm = Nil;
		  PUSH_SPECIAL(G2int_icp_buffer_of_start_of_message_seriesqm,icp_buffer_of_start_of_message_series_qm,
			  6);
		    icp_byte_position_of_start_of_message_series_qm = Nil;
		    PUSH_SPECIAL(G2int_icp_byte_position_of_start_of_message_seriesqm,icp_byte_position_of_start_of_message_series_qm,
			    5);
		      number_of_icp_bytes_to_fill_buffer = FIX((SI_Long)0L);
		      PUSH_SPECIAL(G2int_number_of_icp_bytes_to_fill_buffer,number_of_icp_bytes_to_fill_buffer,
			      4);
			current_icp_buffer = Nil;
			PUSH_SPECIAL(G2int_current_icp_buffer,current_icp_buffer,
				3);
			  current_write_icp_byte_position = Nil;
			  PUSH_SPECIAL(G2int_current_write_icp_byte_position,current_write_icp_byte_position,
				  2);
			    number_of_icp_bytes_in_message_group = 
				    FIX((SI_Long)0L);
			    PUSH_SPECIAL(G2int_number_of_icp_bytes_in_message_group,number_of_icp_bytes_in_message_group,
				    1);
			      writing_icp_message_group = 
				      FIXNUM_ADD1(G2int_writing_icp_message_group);
			      PUSH_SPECIAL(G2int_writing_icp_message_group,writing_icp_message_group,
				      0);
				gensymed_symbol = Nil;
				gensymed_symbol_2 = 0.0;
				gensymed_symbol_2 = 0.0;
				if (g2int_icp_connection_open_p(G2int_current_icp_socket) 
					&&  
					!TRUEP(g2int_icp_connection_being_shutdownqm(G2int_current_icp_socket))) 
					    {
				    if (timestamp_p)
					g2int_send_icp_receive_timestamped_gsi_sensor_value_vector(handle,
						status,value,timestamp,
						attributes);
				    else
					g2int_send_icp_receive_gsi_sensor_value_vector(handle,
						status,value,attributes);
				    g2int_end_icp_message_group();
				}
			      POP_SPECIAL();
			    POP_SPECIAL();
			  POP_SPECIAL();
			POP_SPECIAL();
		      POP_SPECIAL();
		    POP_SPECIAL();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	    POP_SPECIAL();
	  POP_SPECIAL();
	POP_SPECIAL();
    }
    return g2int_gsi_flush_internal_1(derived_socket,Nil);
}

static Object Qg2int_gsi_return_values;  /* |gsi_return_values| */

/* SHARED-GSI-RETURN-VALUES */
void g2int_shared_gsi_return_values(gsi_fc_outer_transfer_wrappers,
	    gsi_fc_outer_count,gsi_fc_outer_context)
    Object gsi_fc_outer_transfer_wrappers;
    SI_Long gsi_fc_outer_count, gsi_fc_outer_context;
{
    Object count_1, context, transfer_wrappers, code, icp_socket;
    Object transfer_wrapper, error_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_;

    x_note_fn_call(47,281);
    value = gsi_fc_outer_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_values,Qerror,T);
	goto end_shared_gsi_return_values;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_values,Qerror,T);
	goto end_shared_gsi_return_values;
    }
    count_1 = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_values,Qerror,T);
	goto end_shared_gsi_return_values;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_values,Qerror,T);
	goto end_shared_gsi_return_values;
    }
    context = LONG_TO_FIXNUM(value);
    transfer_wrappers = gsi_fc_outer_transfer_wrappers ? 
	    g2int_gsi_displaced_array_from_c_contents(gsi_fc_outer_transfer_wrappers,
	    count_1) : Nil;
    code = g2int_invalid_gsi_context_p(context,T);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_values,Qerror,T);
	g2int_gsi_reclaim_displaced_array(transfer_wrappers);
	goto end_shared_gsi_return_values;
    }
    icp_socket = g2int_get_icp_socket_from_context(context,T);
    index_1 = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = IFIX(count_1);
    transfer_wrapper = Nil;
    error_1 = Nil;
  next_loop:
    if (index_1 > ab_loop_bind_)
	goto end_loop;
    transfer_wrapper = ISVREF(transfer_wrappers,index_1);
    error_1 = g2int_check_transfer_wrapper(transfer_wrapper,Nil,icp_socket);
    if (error_1) {
	g2int_set_gsi_error_message_1(Nil,error_1,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_values,Qerror,T);
	g2int_gsi_reclaim_displaced_array(transfer_wrappers);
	goto end_shared_gsi_return_values;
    }
    index_1 = index_1 + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    g2int_gsi_return_values_internal(transfer_wrappers,context,Nil);
    g2int_gsi_reclaim_displaced_array(transfer_wrappers);
  end_shared_gsi_return_values:;
}

static Object string_constant_93;  /* "gsi_return_values" */

/* GSI-RETURN-VALUES */
DLLEXPORT void gsi_return_values(transfer_wrappers,count_1,context)
    Object transfer_wrappers;
    SI_Long count_1, context;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,282);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_93);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_return_values(transfer_wrappers,count_1,context);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_return_values(transfer_wrappers,
			    count_1,context);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_93);
}

static Object Qg2int_gsi_return_timed_values;  /* |gsi_return_timed_values| */

/* SHARED-GSI-RETURN-TIMED-VALUES */
void g2int_shared_gsi_return_timed_values(gsi_fc_outer_transfer_wrappers,
	    gsi_fc_outer_count,gsi_fc_outer_context)
    Object gsi_fc_outer_transfer_wrappers;
    SI_Long gsi_fc_outer_count, gsi_fc_outer_context;
{
    Object count_1, context, transfer_wrappers, code, icp_socket;
    Object transfer_wrapper, error_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_;

    x_note_fn_call(47,283);
    value = gsi_fc_outer_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_values,Qerror,T);
	goto end_shared_gsi_return_timed_values;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_values,Qerror,T);
	goto end_shared_gsi_return_timed_values;
    }
    count_1 = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_values,Qerror,T);
	goto end_shared_gsi_return_timed_values;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_values,Qerror,T);
	goto end_shared_gsi_return_timed_values;
    }
    context = LONG_TO_FIXNUM(value);
    transfer_wrappers = gsi_fc_outer_transfer_wrappers ? 
	    g2int_gsi_displaced_array_from_c_contents(gsi_fc_outer_transfer_wrappers,
	    count_1) : Nil;
    code = g2int_invalid_gsi_context_p(context,T);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_values,Qerror,T);
	g2int_gsi_reclaim_displaced_array(transfer_wrappers);
	goto end_shared_gsi_return_timed_values;
    }
    icp_socket = g2int_get_icp_socket_from_context(context,T);
    index_1 = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = IFIX(count_1);
    transfer_wrapper = Nil;
    error_1 = Nil;
  next_loop:
    if (index_1 > ab_loop_bind_)
	goto end_loop;
    transfer_wrapper = ISVREF(transfer_wrappers,index_1);
    error_1 = g2int_check_transfer_wrapper(transfer_wrapper,T,icp_socket);
    if (error_1) {
	g2int_set_gsi_error_message_1(Nil,error_1,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_values,Qerror,T);
	g2int_gsi_reclaim_displaced_array(transfer_wrappers);
	goto end_shared_gsi_return_timed_values;
    }
    index_1 = index_1 + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    g2int_gsi_return_values_internal(transfer_wrappers,context,T);
    g2int_gsi_reclaim_displaced_array(transfer_wrappers);
  end_shared_gsi_return_timed_values:;
}

static Object string_constant_94;  /* "gsi_return_timed_values" */

/* GSI-RETURN-TIMED-VALUES */
DLLEXPORT void gsi_return_timed_values(transfer_wrappers,count_1,context)
    Object transfer_wrappers;
    SI_Long count_1, context;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,284);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_94);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_return_timed_values(transfer_wrappers,count_1,
		    context);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_return_timed_values(transfer_wrappers,
			    count_1,context);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_94);
}

static Object Qg2int_gsi_return_attrs;  /* |gsi_return_attrs| */

/* SHARED-GSI-RETURN-ATTRS */
void g2int_shared_gsi_return_attrs(transfer_wrapper,
	    gsi_fc_outer_attributes,gsi_fc_outer_count,gsi_fc_outer_context)
    Object transfer_wrapper, gsi_fc_outer_attributes;
    SI_Long gsi_fc_outer_count, gsi_fc_outer_context;
{
    Object count_1, context, attributes, code, icp_socket, error_1;
    SI_Long value;

    x_note_fn_call(47,285);
    value = gsi_fc_outer_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_attrs,Qerror,T);
	goto end_shared_gsi_return_attrs;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_attrs,Qerror,T);
	goto end_shared_gsi_return_attrs;
    }
    count_1 = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_attrs,Qerror,T);
	goto end_shared_gsi_return_attrs;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_attrs,Qerror,T);
	goto end_shared_gsi_return_attrs;
    }
    context = LONG_TO_FIXNUM(value);
    attributes = gsi_fc_outer_attributes ? 
	    g2int_gsi_displaced_array_from_c_contents(gsi_fc_outer_attributes,
	    count_1) : Nil;
    code = g2int_invalid_gsi_context_p(context,T);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_attrs,Qerror,T);
	g2int_gsi_reclaim_displaced_array(attributes);
	goto end_shared_gsi_return_attrs;
    }
    icp_socket = g2int_get_icp_socket_from_context(context,T);
    error_1 = g2int_check_transfer_wrapper(transfer_wrapper,Nil,icp_socket);
    if (error_1);
    else
	error_1 = g2int_check_gsi_value_vector(attributes);
    if (error_1) {
	g2int_set_gsi_error_message_1(Nil,error_1,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_attrs,Qerror,T);
	g2int_gsi_reclaim_displaced_array(attributes);
	goto end_shared_gsi_return_attrs;
    }
    g2int_gsi_return_attrs_internal(transfer_wrapper,attributes,context,Nil);
    g2int_gsi_reclaim_displaced_array(attributes);
  end_shared_gsi_return_attrs:;
}

static Object string_constant_95;  /* "gsi_return_attrs" */

/* GSI-RETURN-ATTRS */
DLLEXPORT void gsi_return_attrs(transfer_wrapper,attributes,count_1,context)
    Object transfer_wrapper, attributes;
    SI_Long count_1, context;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,286);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_95);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_return_attrs(transfer_wrapper,attributes,
		    count_1,context);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_return_attrs(transfer_wrapper,
			    attributes,count_1,context);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_95);
}

static Object Qg2int_gsi_return_timed_attrs;  /* |gsi_return_timed_attrs| */

/* SHARED-GSI-RETURN-TIMED-ATTRS */
void g2int_shared_gsi_return_timed_attrs(transfer_wrapper,
	    gsi_fc_outer_attributes,gsi_fc_outer_count,gsi_fc_outer_context)
    Object transfer_wrapper, gsi_fc_outer_attributes;
    SI_Long gsi_fc_outer_count, gsi_fc_outer_context;
{
    Object count_1, context, attributes, code, icp_socket, error_1;
    SI_Long value;

    x_note_fn_call(47,287);
    value = gsi_fc_outer_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_attrs,Qerror,T);
	goto end_shared_gsi_return_timed_attrs;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_attrs,Qerror,T);
	goto end_shared_gsi_return_timed_attrs;
    }
    count_1 = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_attrs,Qerror,T);
	goto end_shared_gsi_return_timed_attrs;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_attrs,Qerror,T);
	goto end_shared_gsi_return_timed_attrs;
    }
    context = LONG_TO_FIXNUM(value);
    attributes = gsi_fc_outer_attributes ? 
	    g2int_gsi_displaced_array_from_c_contents(gsi_fc_outer_attributes,
	    count_1) : Nil;
    code = g2int_invalid_gsi_context_p(context,T);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_attrs,Qerror,T);
	g2int_gsi_reclaim_displaced_array(attributes);
	goto end_shared_gsi_return_timed_attrs;
    }
    icp_socket = g2int_get_icp_socket_from_context(context,T);
    error_1 = g2int_check_transfer_wrapper(transfer_wrapper,T,icp_socket);
    if (error_1);
    else
	error_1 = g2int_check_gsi_value_vector(attributes);
    if (error_1) {
	g2int_set_gsi_error_message_1(Nil,error_1,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_return_timed_attrs,Qerror,T);
	g2int_gsi_reclaim_displaced_array(attributes);
	goto end_shared_gsi_return_timed_attrs;
    }
    g2int_gsi_return_attrs_internal(transfer_wrapper,attributes,context,T);
    g2int_gsi_reclaim_displaced_array(attributes);
  end_shared_gsi_return_timed_attrs:;
}

static Object string_constant_96;  /* "gsi_return_timed_attrs" */

/* GSI-RETURN-TIMED-ATTRS */
DLLEXPORT void gsi_return_timed_attrs(transfer_wrapper,attributes,count_1,
	    context)
    Object transfer_wrapper, attributes;
    SI_Long count_1, context;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,288);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_96);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_return_timed_attrs(transfer_wrapper,
		    attributes,count_1,context);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_return_timed_attrs(transfer_wrapper,
			    attributes,count_1,context);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_96);
}

/* GSI-MAKE-ARRAY-FOR-USER-OR-GSI */
Object g2int_gsi_make_array_for_user_or_gsi(count_1,user_or_gsi)
    Object count_1, user_or_gsi;
{
    Object array, svref_new_value;

    x_note_fn_call(47,289);
    array = g2int_gsi_allocate_managed_array(FIXNUM_ADD1(count_1));
    if (EQ(user_or_gsi,Qg2int_gsi) || EQ(user_or_gsi,Qg2int_context))
	g2int_gsi_push_onto_appropriate_list(1,
		g2int_make_gsi_array_wrapper_1(Qg2int_managed_array,array));
    svref_new_value = G2int_gsi_magic_number;
    SVREF(array,FIX((SI_Long)0L)) = svref_new_value;
    return VALUES_1(array);
}

/* GSI-MAKE-ITEMS-FOR-USER-OR-GSI */
Object g2int_gsi_make_items_for_user_or_gsi(count_1,user_or_gsi)
    Object count_1, user_or_gsi;
{
    Object items, svref_new_value;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,290);
    items = g2int_gsi_make_array_for_user_or_gsi(count_1,user_or_gsi);
    i = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = IFIX(FIXNUM_ADD1(count_1));
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    svref_new_value = g2int_make_gsi_instance_for_user_or_gsi(user_or_gsi);
    ISVREF(items,i) = svref_new_value;
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    return VALUES_1(items);
}

/* GSI-MAKE-ATTRIBUTES-FOR-USER-OR-GSI */
Object g2int_gsi_make_attributes_for_user_or_gsi(count_1,user_or_gsi)
    Object count_1, user_or_gsi;
{
    Object attributes, svref_new_value;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,291);
    attributes = g2int_gsi_make_array_for_user_or_gsi(count_1,user_or_gsi);
    i = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = IFIX(FIXNUM_ADD1(count_1));
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    svref_new_value = g2int_make_gsi_attribute_for_user_or_gsi(user_or_gsi);
    ISVREF(attributes,i) = svref_new_value;
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    return VALUES_1(attributes);
}

/* GSI-MAKE-ATTRIBUTES-WITH-ITEMS-FOR-USER-OR-GSI */
Object g2int_gsi_make_attributes_with_items_for_user_or_gsi(count_1,
	    user_or_gsi)
    Object count_1, user_or_gsi;
{
    Object attributes, attribute, svref_new_value;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,292);
    attributes = g2int_gsi_make_array_for_user_or_gsi(count_1,user_or_gsi);
    i = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = IFIX(FIXNUM_ADD1(count_1));
    attribute = Nil;
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    attribute = g2int_make_gsi_attribute_for_user_or_gsi(user_or_gsi);
    ISVREF(attributes,i) = attribute;
    svref_new_value = g2int_make_gsi_instance_for_user_or_gsi(user_or_gsi);
    SVREF(attribute,FIX((SI_Long)4L)) = svref_new_value;
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    return VALUES_1(attributes);
}

static Object Qg2int_gsi_make_array;  /* |gsi_make_array| */

/* SHARED-GSI-MAKE-ARRAY */
Object g2int_shared_gsi_make_array(gsi_fc_outer_count)
    SI_Long gsi_fc_outer_count;
{
    Object result_1, count_1, gsi_fc_result, svref_new_value;
    SI_Long value;

    x_note_fn_call(47,293);
    value = gsi_fc_outer_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_make_array,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_make_array;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_make_array,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_make_array;
    }
    count_1 = LONG_TO_FIXNUM(value);
    gsi_fc_result = (SI_Long)0L < IFIX(count_1) ? 
	    g2int_gsi_allocate_managed_array(FIXNUM_ADD1(count_1)) : Nil;
    if (IFIX(count_1) > (SI_Long)0L) {
	svref_new_value = G2int_gsi_magic_number;
	SVREF(gsi_fc_result,FIX((SI_Long)0L)) = svref_new_value;
	result_1 = inline_extract_c_array(gsi_fc_result,
		G2int_gsi_magic_offset);
    }
    else
	result_1 = Nil;
  end_shared_gsi_make_array:;
    return result_1;
}

static Object string_constant_97;  /* "gsi_make_array" */

/* GSI-MAKE-ARRAY */
DLLEXPORT Object gsi_make_array(count_1)
    SI_Long count_1;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,294);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_97);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_make_array(count_1);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_make_array(count_1);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_97);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_reclaim_array;  /* |gsi_reclaim_array| */

/* SHARED-GSI-RECLAIM-ARRAY */
void g2int_shared_gsi_reclaim_array(gsi_fc_outer_array)
    Object gsi_fc_outer_array;
{
    Object array, magic_number;

    x_note_fn_call(47,295);
    if ( !TRUEP(gsi_fc_outer_array))
	array = Nil;
    else {
	magic_number = inline_gsi_get_magic_header(gsi_fc_outer_array);
	if (IFIX(magic_number) == (SI_Long)5472500L)
	    array = inline_get_array_from_c(gsi_fc_outer_array,
		    G2int_gsi_magic_offset);
	else {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_bad_magic_number,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_reclaim_array,Qerror,T);
	    goto end_shared_gsi_reclaim_array;
	}
    }
    if (array)
	g2int_gsi_reclaim_managed_array(array);
  end_shared_gsi_reclaim_array:;
}

static Object string_constant_98;  /* "gsi_reclaim_array" */

/* GSI-RECLAIM-ARRAY */
DLLEXPORT void gsi_reclaim_array(array)
    Object array;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,296);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_98);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_reclaim_array(array);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_reclaim_array(array);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_98);
}

/* SHARED-GSI-MAKE-ITEM */
Object g2int_shared_gsi_make_item()
{
    Object gsi_fc_result, result_1;

    x_note_fn_call(47,297);
    gsi_fc_result = g2int_make_gsi_instance_for_user_or_gsi(Qg2int_user);
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_99;  /* "gsi_make_item" */

/* GSI-MAKE-ITEM */
DLLEXPORT Object gsi_make_item()
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,298);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_99);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_make_item();
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_make_item();
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_99);
    result_2 = result_1;
    return result_2;
}

/* SHARED-GSI-RECLAIM-ITEM */
void g2int_shared_gsi_reclaim_item(item)
    Object item;
{
    x_note_fn_call(47,299);
    if (item)
	g2int_reclaim_gsi_instance_for_user(item);
}

static Object string_constant_100;  /* "gsi_reclaim_item" */

/* GSI-RECLAIM-ITEM */
DLLEXPORT void gsi_reclaim_item(item)
    Object item;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,300);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_100);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_reclaim_item(item);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_reclaim_item(item);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_100);
}

static Object Qg2int_gsi_make_items;  /* |gsi_make_items| */

/* SHARED-GSI-MAKE-ITEMS */
Object g2int_shared_gsi_make_items(gsi_fc_outer_count)
    SI_Long gsi_fc_outer_count;
{
    Object result_1, count_1, gsi_fc_result, svref_new_value;
    SI_Long value;

    x_note_fn_call(47,301);
    value = gsi_fc_outer_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_make_items,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_make_items;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_make_items,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_make_items;
    }
    count_1 = LONG_TO_FIXNUM(value);
    gsi_fc_result = (SI_Long)0L < IFIX(count_1) ? 
	    g2int_gsi_make_items_for_user_or_gsi(count_1,Qg2int_user) : Nil;
    if (IFIX(count_1) > (SI_Long)0L) {
	svref_new_value = G2int_gsi_magic_number;
	SVREF(gsi_fc_result,FIX((SI_Long)0L)) = svref_new_value;
	result_1 = inline_extract_c_array(gsi_fc_result,
		G2int_gsi_magic_offset);
    }
    else
	result_1 = Nil;
  end_shared_gsi_make_items:;
    return result_1;
}

static Object string_constant_101;  /* "gsi_make_items" */

/* GSI-MAKE-ITEMS */
DLLEXPORT Object gsi_make_items(count_1)
    SI_Long count_1;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,302);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_101);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_make_items(count_1);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_make_items(count_1);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_101);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_reclaim_items;  /* |gsi_reclaim_items| */

/* SHARED-GSI-RECLAIM-ITEMS */
void g2int_shared_gsi_reclaim_items(gsi_fc_outer_items)
    Object gsi_fc_outer_items;
{
    Object items, magic_number, instance;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,303);
    if ( !TRUEP(gsi_fc_outer_items))
	items = Nil;
    else {
	magic_number = inline_gsi_get_magic_header(gsi_fc_outer_items);
	if (IFIX(magic_number) == (SI_Long)5472500L)
	    items = inline_get_array_from_c(gsi_fc_outer_items,
		    G2int_gsi_magic_offset);
	else {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_bad_magic_number,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_reclaim_items,Qerror,T);
	    goto end_shared_gsi_reclaim_items;
	}
    }
    if (items) {
	i = IFIX(G2int_gsi_magic_offset);
	ab_loop_bind_ = IFIX(g2int_gsi_managed_array_length(items));
	instance = Nil;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	instance = ISVREF(items,i);
	if (instance)
	    g2int_reclaim_gsi_instance_for_user(instance);
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:
	g2int_gsi_reclaim_managed_array(items);
    }
  end_shared_gsi_reclaim_items:;
}

static Object string_constant_102;  /* "gsi_reclaim_items" */

/* GSI-RECLAIM-ITEMS */
DLLEXPORT void gsi_reclaim_items(items)
    Object items;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,304);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_102);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_reclaim_items(items);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_reclaim_items(items);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_102);
}

static Object Qg2int_gsi_make_registered_items;  /* |gsi_make_registered_items| */

/* SHARED-GSI-MAKE-REGISTERED-ITEMS */
Object g2int_shared_gsi_make_registered_items(gsi_fc_outer_count)
    SI_Long gsi_fc_outer_count;
{
    Object result_1, count_1, registered_items, transfer_wrapper;
    Object svref_new_value, gsi_fc_result;
    SI_Long value;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,305);
    value = gsi_fc_outer_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_make_registered_items,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_make_registered_items;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_make_registered_items,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_make_registered_items;
    }
    count_1 = LONG_TO_FIXNUM(value);
    registered_items = g2int_gsi_allocate_managed_array(FIXNUM_ADD1(count_1));
    i = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = IFIX(FIXNUM_ADD1(count_1));
    transfer_wrapper = Nil;
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    transfer_wrapper = g2int_make_gsi_user_transfer_wrapper();
    svref_new_value = g2int_make_gsi_instance_for_user_or_gsi(Qg2int_user);
    SVREF(transfer_wrapper,FIX((SI_Long)4L)) = svref_new_value;
    ISVREF(registered_items,i) = transfer_wrapper;
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    gsi_fc_result = registered_items;
    if (IFIX(count_1) > (SI_Long)0L) {
	svref_new_value = G2int_gsi_magic_number;
	SVREF(gsi_fc_result,FIX((SI_Long)0L)) = svref_new_value;
	result_1 = inline_extract_c_array(gsi_fc_result,
		G2int_gsi_magic_offset);
    }
    else
	result_1 = Nil;
  end_shared_gsi_make_registered_items:;
    return result_1;
}

static Object string_constant_103;  /* "gsi_make_registered_items" */

/* GSI-MAKE-REGISTERED-ITEMS */
DLLEXPORT Object gsi_make_registered_items(count_1)
    SI_Long count_1;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,306);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_103);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_make_registered_items(count_1);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_make_registered_items(count_1);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_103);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_reclaim_registered_items;  /* |gsi_reclaim_registered_items| */

/* SHARED-GSI-RECLAIM-REGISTERED-ITEMS */
void g2int_shared_gsi_reclaim_registered_items(gsi_fc_outer_registered_items)
    Object gsi_fc_outer_registered_items;
{
    Object registered_items, magic_number, transfer_wrapper;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,307);
    if ( !TRUEP(gsi_fc_outer_registered_items))
	registered_items = Nil;
    else {
	magic_number = 
		inline_gsi_get_magic_header(gsi_fc_outer_registered_items);
	if (IFIX(magic_number) == (SI_Long)5472500L)
	    registered_items = 
		    inline_get_array_from_c(gsi_fc_outer_registered_items,
		    G2int_gsi_magic_offset);
	else {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_bad_magic_number,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_reclaim_registered_items,
		    Qerror,T);
	    goto end_shared_gsi_reclaim_registered_items;
	}
    }
    if (registered_items) {
	i = IFIX(G2int_gsi_magic_offset);
	ab_loop_bind_ = IFIX(g2int_gsi_managed_array_length(registered_items));
	transfer_wrapper = Nil;
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	transfer_wrapper = ISVREF(registered_items,i);
	g2int_reclaim_gsi_instance_for_user(ISVREF(transfer_wrapper,
		(SI_Long)4L));
	g2int_reclaim_gsi_user_transfer_wrapper(transfer_wrapper);
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:
	g2int_gsi_reclaim_managed_array(registered_items);
    }
  end_shared_gsi_reclaim_registered_items:;
}

static Object string_constant_104;  /* "gsi_reclaim_registered_items" */

/* GSI-RECLAIM-REGISTERED-ITEMS */
DLLEXPORT void gsi_reclaim_registered_items(registered_items)
    Object registered_items;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,308);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_104);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_reclaim_registered_items(registered_items);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_reclaim_registered_items(registered_items);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_104);
}

static Object Qg2int_gsi_make_attrs;  /* |gsi_make_attrs| */

/* SHARED-GSI-MAKE-ATTRS */
Object g2int_shared_gsi_make_attrs(gsi_fc_outer_count)
    SI_Long gsi_fc_outer_count;
{
    Object result_1, count_1, gsi_fc_result, svref_new_value;
    SI_Long value;

    x_note_fn_call(47,309);
    value = gsi_fc_outer_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_make_attrs,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_make_attrs;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_make_attrs,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_make_attrs;
    }
    count_1 = LONG_TO_FIXNUM(value);
    gsi_fc_result = g2int_gsi_make_attributes_for_user_or_gsi(count_1,
	    Qg2int_user);
    if (IFIX(count_1) > (SI_Long)0L) {
	svref_new_value = G2int_gsi_magic_number;
	SVREF(gsi_fc_result,FIX((SI_Long)0L)) = svref_new_value;
	result_1 = inline_extract_c_array(gsi_fc_result,
		G2int_gsi_magic_offset);
    }
    else
	result_1 = Nil;
  end_shared_gsi_make_attrs:;
    return result_1;
}

static Object string_constant_105;  /* "gsi_make_attrs" */

/* GSI-MAKE-ATTRS */
DLLEXPORT Object gsi_make_attrs(count_1)
    SI_Long count_1;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,310);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_105);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_make_attrs(count_1);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_make_attrs(count_1);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_105);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_reclaim_attrs;  /* |gsi_reclaim_attrs| */

/* SHARED-GSI-RECLAIM-ATTRS */
void g2int_shared_gsi_reclaim_attrs(gsi_fc_outer_attributes)
    Object gsi_fc_outer_attributes;
{
    Object attributes, magic_number;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,311);
    if ( !TRUEP(gsi_fc_outer_attributes))
	attributes = Nil;
    else {
	magic_number = inline_gsi_get_magic_header(gsi_fc_outer_attributes);
	if (IFIX(magic_number) == (SI_Long)5472500L)
	    attributes = inline_get_array_from_c(gsi_fc_outer_attributes,
		    G2int_gsi_magic_offset);
	else {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_bad_magic_number,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_reclaim_attrs,Qerror,T);
	    goto end_shared_gsi_reclaim_attrs;
	}
    }
    if (attributes) {
	i = IFIX(G2int_gsi_magic_offset);
	ab_loop_bind_ = IFIX(length(attributes));
      next_loop:
	if (i >= ab_loop_bind_)
	    goto end_loop;
	g2int_reclaim_gsi_user_attribute(ISVREF(attributes,i));
	i = i + (SI_Long)1L;
	goto next_loop;
      end_loop:
	g2int_gsi_reclaim_managed_array(attributes);
    }
  end_shared_gsi_reclaim_attrs:;
}

static Object string_constant_106;  /* "gsi_reclaim_attrs" */

/* GSI-RECLAIM-ATTRS */
DLLEXPORT void gsi_reclaim_attrs(attributes)
    Object attributes;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,312);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_106);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_reclaim_attrs(attributes);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_reclaim_attrs(attributes);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_106);
}

static Object Qg2int_gsi_make_attrs_with_items;  /* |gsi_make_attrs_with_items| */

/* SHARED-GSI-MAKE-ATTRS-WITH-ITEMS */
Object g2int_shared_gsi_make_attrs_with_items(gsi_fc_outer_count)
    SI_Long gsi_fc_outer_count;
{
    Object result_1, count_1, gsi_fc_result, svref_new_value;
    SI_Long value;

    x_note_fn_call(47,313);
    value = gsi_fc_outer_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_make_attrs_with_items,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_make_attrs_with_items;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_make_attrs_with_items,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_make_attrs_with_items;
    }
    count_1 = LONG_TO_FIXNUM(value);
    gsi_fc_result = 
	    g2int_gsi_make_attributes_with_items_for_user_or_gsi(count_1,
	    Qg2int_user);
    if (IFIX(count_1) > (SI_Long)0L) {
	svref_new_value = G2int_gsi_magic_number;
	SVREF(gsi_fc_result,FIX((SI_Long)0L)) = svref_new_value;
	result_1 = inline_extract_c_array(gsi_fc_result,
		G2int_gsi_magic_offset);
    }
    else
	result_1 = Nil;
  end_shared_gsi_make_attrs_with_items:;
    return result_1;
}

static Object string_constant_107;  /* "gsi_make_attrs_with_items" */

/* GSI-MAKE-ATTRS-WITH-ITEMS */
DLLEXPORT Object gsi_make_attrs_with_items(count_1)
    SI_Long count_1;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,314);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_107);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_make_attrs_with_items(count_1);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_make_attrs_with_items(count_1);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_107);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_reclaim_attrs_with_items;  /* |gsi_reclaim_attrs_with_items| */

/* SHARED-GSI-RECLAIM-ATTRS-WITH-ITEMS */
void g2int_shared_gsi_reclaim_attrs_with_items(gsi_fc_outer_attributes)
    Object gsi_fc_outer_attributes;
{
    Object attributes, magic_number;
    SI_Long i, ab_loop_bind_;

    x_note_fn_call(47,315);
    if ( !TRUEP(gsi_fc_outer_attributes))
	attributes = Nil;
    else {
	magic_number = inline_gsi_get_magic_header(gsi_fc_outer_attributes);
	if (IFIX(magic_number) == (SI_Long)5472500L)
	    attributes = inline_get_array_from_c(gsi_fc_outer_attributes,
		    G2int_gsi_magic_offset);
	else {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_bad_magic_number,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_reclaim_attrs_with_items,
		    Qerror,T);
	    goto end_shared_gsi_reclaim_attrs_with_items;
	}
    }
    i = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = IFIX(g2int_gsi_managed_array_length(attributes));
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    g2int_reclaim_gsi_instance_for_user(ISVREF(ISVREF(attributes,i),
	    (SI_Long)4L));
    g2int_reclaim_gsi_user_attribute(ISVREF(attributes,i));
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:
    g2int_gsi_reclaim_managed_array(attributes);
  end_shared_gsi_reclaim_attrs_with_items:;
}

static Object string_constant_108;  /* "gsi_reclaim_attrs_with_items" */

/* GSI-RECLAIM-ATTRS-WITH-ITEMS */
DLLEXPORT void gsi_reclaim_attrs_with_items(attributes)
    Object attributes;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,316);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_108);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_reclaim_attrs_with_items(attributes);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_reclaim_attrs_with_items(attributes);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_108);
}

/* SHARED-GSI-MAKE-SYMBOL */
Object g2int_shared_gsi_make_symbol(wide_api_p,gsi_fc_outer_symbol)
    Object wide_api_p, gsi_fc_outer_symbol;
{
    Object symbol, gsi_fc_result, result_1, string_1;

    x_note_fn_call(47,317);
    symbol =  !TRUEP(gsi_fc_outer_symbol) ? Nil : 
	    g2int_symbol_for_gsi_string(wide_api_p ? 
	    g2int_c_wide_string_to_text_string(gsi_fc_outer_symbol) : 
	    g2int_c_string_to_gensym_string(gsi_fc_outer_symbol));
    gsi_fc_result = symbol;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
    return result_1;
}

static Object string_constant_109;  /* "gsi_make_symbol" */

/* GSI-MAKE-SYMBOL */
DLLEXPORT Object gsi_make_symbol(symbol)
    Object symbol;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,318);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_109);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_make_symbol(G2int_gsi_wide_api_p,
		    symbol);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_make_symbol(G2int_gsi_wide_api_p,
			    symbol);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_109);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_symbol_name;  /* |gsi_symbol_name| */

/* SHARED-GSI-SYMBOL-NAME */
Object g2int_shared_gsi_symbol_name(wide_api_p,gsi_fc_outer_symbol)
    Object wide_api_p, gsi_fc_outer_symbol;
{
    Object arg_symbol, result_1, symbol, gsi_fc_result, string_1;

    x_note_fn_call(47,319);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_symbol,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_symbol_name,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_symbol_name;
    }
    symbol = arg_symbol;
    gsi_fc_result = symbol;
    if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
  end_shared_gsi_symbol_name:;
    return result_1;
}

static Object string_constant_110;  /* "gsi_symbol_name" */

/* GSI-SYMBOL-NAME */
DLLEXPORT Object gsi_symbol_name(symbol)
    Object symbol;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,320);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_110);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_symbol_name(G2int_gsi_wide_api_p,
		    symbol);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_symbol_name(G2int_gsi_wide_api_p,
			    symbol);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_110);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_symbol_user_data;  /* |gsi_symbol_user_data| */

static Object Qg2int_gsi_user_data_of_symbol;  /* gsi-user-data-of-symbol */

/* SHARED-GSI-SYMBOL-USER-DATA */
Object g2int_shared_gsi_symbol_user_data(wide_api_p,gsi_fc_outer_symbol)
    Object wide_api_p, gsi_fc_outer_symbol;
{
    Object arg_symbol, result_1, symbol, gsi_fc_result;

    x_note_fn_call(47,321);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_symbol,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_symbol_user_data,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_symbol_user_data;
    }
    symbol = arg_symbol;
    gsi_fc_result = 
	    g2int_getfq_function_no_default(INLINE_SYMBOL_PLIST(symbol),
	    Qg2int_gsi_user_data_of_symbol);
    result_1 = gsi_fc_result;
  end_shared_gsi_symbol_user_data:;
    return result_1;
}

static Object string_constant_111;  /* "gsi_symbol_user_data" */

/* GSI-SYMBOL-USER-DATA */
DLLEXPORT Object gsi_symbol_user_data(symbol)
    Object symbol;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,322);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_111);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_symbol_user_data(G2int_gsi_wide_api_p,
		    symbol);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_symbol_user_data(G2int_gsi_wide_api_p,
			    symbol);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_111);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_symbol_user_data;  /* |gsi_set_symbol_user_data| */

/* SHARED-GSI-SET-SYMBOL-USER-DATA */
void g2int_shared_gsi_set_symbol_user_data(wide_api_p,gsi_fc_outer_symbol,
	    user_data)
    Object wide_api_p, gsi_fc_outer_symbol, user_data;
{
    Object arg_symbol, symbol;

    x_note_fn_call(47,323);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_symbol,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_symbol_user_data,Qerror,T);
	goto end_shared_gsi_set_symbol_user_data;
    }
    symbol = arg_symbol;
    g2int_mutate_global_property(symbol,user_data,
	    Qg2int_gsi_user_data_of_symbol);
  end_shared_gsi_set_symbol_user_data:;
}

static Object string_constant_112;  /* "gsi_set_symbol_user_data" */

/* GSI-SET-SYMBOL-USER-DATA */
DLLEXPORT void gsi_set_symbol_user_data(symbol,user_data)
    Object symbol, user_data;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,324);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_112);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_symbol_user_data(G2int_gsi_wide_api_p,
		    symbol,user_data);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_symbol_user_data(G2int_gsi_wide_api_p,
			    symbol,user_data);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_112);
}

/* SHARED-GSI-CURRENT-CONTEXT */
SI_Long g2int_shared_gsi_current_context()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,325);
    gsi_fc_result = FIXNUM_TO_LONG(g2int_gsi_current_context_number());
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_113;  /* "gsi_current_context" */

/* GSI-CURRENT-CONTEXT */
DLLEXPORT SI_Long gsi_current_context()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,326);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_113);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_current_context());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_113);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

/* SHARED-GSI-CURRENT-CONTEXT-IS-SECURE */
SI_Long g2int_shared_gsi_current_context_is_secure()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,327);
    gsi_fc_result = 
	    g2int_icp_connection_is_secure(G2int_current_icp_socket) ? 
	    (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_114;  /* "gsi_current_context_is_secure" */

/* GSI-CURRENT-CONTEXT-IS-SECURE */
DLLEXPORT SI_Long gsi_current_context_is_secure()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,328);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_114);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_current_context_is_secure());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_114);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_context_is_secure;  /* |gsi_context_is_secure| */

/* SHARED-GSI-CONTEXT-IS-SECURE */
SI_Long g2int_shared_gsi_context_is_secure(gsi_fc_outer_context)
    SI_Long gsi_fc_outer_context;
{
    Object context, code;
    SI_Long value, result_1, gsi_fc_result;

    x_note_fn_call(47,329);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_is_secure,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_is_secure;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_is_secure,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_is_secure;
    }
    context = LONG_TO_FIXNUM(value);
    code = g2int_invalid_gsi_context_p(context,T);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_is_secure,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_is_secure;
    }
    code = g2int_invalid_gsi_context_p(context,Nil);
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_context_is_secure,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_context_is_secure;
    }
    gsi_fc_result = 
	    g2int_icp_connection_is_secure(g2int_get_icp_socket_from_context(context,
	    Nil)) ? (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_context_is_secure:;
    return result_1;
}

static Object string_constant_115;  /* "gsi_context_is_secure" */

/* GSI-CONTEXT-IS-SECURE */
DLLEXPORT SI_Long gsi_context_is_secure(context)
    SI_Long context;
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,330);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_115);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_context_is_secure(context));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_115);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_registration_of_handle;  /* |gsi_registration_of_handle| */

/* SHARED-GSI-REGISTRATION-OF-HANDLE */
Object g2int_shared_gsi_registration_of_handle(gsi_fc_outer_item_index,
	    gsi_fc_outer_context)
    SI_Long gsi_fc_outer_item_index, gsi_fc_outer_context;
{
    Object result_1, item_index, context, gsi_fc_result, code, gsi_instance;
    SI_Long value;

    x_note_fn_call(47,331);
    value = gsi_fc_outer_item_index;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_registration_of_handle,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_registration_of_handle;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_registration_of_handle,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_registration_of_handle;
    }
    item_index = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_context;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_registration_of_handle,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_registration_of_handle;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_registration_of_handle,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_registration_of_handle;
    }
    context = LONG_TO_FIXNUM(value);
    if ((SI_Long)0L <= IFIX(item_index)) {
	gsi_fc_result = (SI_Long)0L <= IFIX(context) && FIXNUM_EQ(context,
		g2int_gsi_current_context_number()) && 
		FIXNUM_EQ(item_index,
		G2int_index_of_gsi_sensor_to_deregisterqm) ? 
		G2int_gsi_sensor_to_deregisterqm : Nil;
	if (gsi_fc_result);
	else {
	    code = g2int_invalid_gsi_context_p(context,T);
	    if (code) {
		g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,
			Nil,Nil);
		g2int_gsi_handle_error_1(Qg2int_gsi_registration_of_handle,
			Qerror,T);
		result_1 = Qnil;
		goto end_shared_gsi_registration_of_handle;
	    }
	    code = g2int_invalid_gsi_context_p(context,Nil);
	    if (code) {
		g2int_set_gsi_error_message_1(Nil,code,context,Nil,Nil,Nil,
			Nil,Nil);
		g2int_gsi_handle_error_1(Qg2int_gsi_registration_of_handle,
			Qerror,T);
		result_1 = Qnil;
		goto end_shared_gsi_registration_of_handle;
	    }
	    gsi_instance = 
		    g2int_get_from_icp_port_if_any(ISVREF(g2int_get_icp_socket_from_context(context,
		    Nil),(SI_Long)3L),item_index,Qg2int_item_index_space);
	    gsi_fc_result = SIMPLE_VECTOR_P(gsi_instance) && 
		    EQ(ISVREF(gsi_instance,(SI_Long)0L),
		    Qg2_defstruct_structure_name_gsi_instance_g2_struct) ? 
		    gsi_instance : Nil;
	}
    }
    else
	gsi_fc_result = Nil;
    result_1 = gsi_fc_result;
  end_shared_gsi_registration_of_handle:;
    return result_1;
}

static Object string_constant_116;  /* "gsi_registration_of_handle" */

/* GSI-REGISTRATION-OF-HANDLE */
DLLEXPORT Object gsi_registration_of_handle(item_index,context)
    SI_Long item_index, context;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,332);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_116);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_registration_of_handle(item_index,
		    context);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_registration_of_handle(item_index,
			    context);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_116);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_user_data_of;  /* |gsi_user_data_of| */

/* SHARED-GSI-USER-DATA-OF */
Object g2int_shared_gsi_user_data_of(gsi_sensor)
    Object gsi_sensor;
{
    Object result_1, gsi_instance_extension, gsi_fc_result;

    x_note_fn_call(47,333);
    if ( !(SIMPLE_VECTOR_P(gsi_sensor) && EQ(ISVREF(gsi_sensor,
	    (SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_structure,
		Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_user_data_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_user_data_of;
    }
    gsi_instance_extension = ISVREF(gsi_sensor,(SI_Long)3L);
    gsi_fc_result = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)6L) : Nil;
    result_1 = gsi_fc_result;
  end_shared_gsi_user_data_of:;
    return result_1;
}

static Object string_constant_117;  /* "gsi_user_data_of" */

/* GSI-USER-DATA-OF */
DLLEXPORT Object gsi_user_data_of(gsi_sensor)
    Object gsi_sensor;
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,334);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_117);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsi_user_data_of(gsi_sensor);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_117);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_user_data;  /* |gsi_set_user_data| */

/* SHARED-GSI-SET-USER-DATA */
void g2int_shared_gsi_set_user_data(gsi_sensor,ptr_or_immediate)
    Object gsi_sensor, ptr_or_immediate;
{
    Object gsi_instance_extension;

    x_note_fn_call(47,335);
    if ( !(SIMPLE_VECTOR_P(gsi_sensor) && EQ(ISVREF(gsi_sensor,
	    (SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_structure,
		Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_user_data,Qerror,T);
	goto end_shared_gsi_set_user_data;
    }
    gsi_instance_extension = ISVREF(gsi_sensor,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(gsi_sensor,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)6L)) = ptr_or_immediate;
  end_shared_gsi_set_user_data:;
}

static Object string_constant_118;  /* "gsi_set_user_data" */

/* GSI-SET-USER-DATA */
DLLEXPORT void gsi_set_user_data(gsi_sensor,ptr_or_immediate)
    Object gsi_sensor, ptr_or_immediate;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,336);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_118);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_user_data(gsi_sensor,ptr_or_immediate);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_118);
}

static Object Qg2int_gsi_item_of_identifying_attr_of;  /* |gsi_item_of_identifying_attr_of| */

/* SHARED-GSI-ITEM-OF-IDENTIFYING-ATTR-OF */
Object g2int_shared_gsi_item_of_identifying_attr_of(gsi_sensor,
	    gsi_fc_outer_index)
    Object gsi_sensor;
    SI_Long gsi_fc_outer_index;
{
    Object result_1, index_1, gsi_instance_extension, attribute_count;
    Object attributes, gsi_fc_result;
    SI_Long value;
    char temp;

    x_note_fn_call(47,337);
    value = gsi_fc_outer_index;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_identifying_attr_of,
		Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_item_of_identifying_attr_of;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_identifying_attr_of,
		Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_item_of_identifying_attr_of;
    }
    index_1 = LONG_TO_FIXNUM(value);
    if (SIMPLE_VECTOR_P(gsi_sensor) && EQ(ISVREF(gsi_sensor,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	gsi_instance_extension = ISVREF(gsi_sensor,(SI_Long)3L);
	temp =  ! !(gsi_instance_extension ? 
		TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		TRUEP(Nil));
    }
    else
	temp = TRUEP(Nil);
    if ( !temp) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_structure_has_no_identifying_attrs,Nil,Nil,Nil,
		Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_identifying_attr_of,
		Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_item_of_identifying_attr_of;
    }
    gsi_instance_extension = ISVREF(gsi_sensor,(SI_Long)3L);
    attribute_count = gsi_instance_extension ? 
	    ISVREF(gsi_instance_extension,(SI_Long)9L) : FIX((SI_Long)0L);
    if (IFIX(index_1) < (SI_Long)1L || FIXNUM_GT(index_1,attribute_count)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_identifying_attribute_index_out_of_range,index_1,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_identifying_attr_of,
		Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_item_of_identifying_attr_of;
    }
    gsi_instance_extension = ISVREF(gsi_sensor,(SI_Long)3L);
    attributes = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)8L) : Nil;
    gsi_fc_result = ISVREF(ISVREF(attributes,
	    IFIX(FIXNUM_ADD1(FIXNUM_SUB1(index_1)))),(SI_Long)4L);
    result_1 = gsi_fc_result;
  end_shared_gsi_item_of_identifying_attr_of:;
    return result_1;
}

static Object string_constant_119;  /* "gsi_item_of_identifying_attr_of" */

/* GSI-ITEM-OF-IDENTIFYING-ATTR-OF */
DLLEXPORT Object gsi_item_of_identifying_attr_of(gsi_sensor,index_1)
    Object gsi_sensor;
    SI_Long index_1;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,338);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_119);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_item_of_identifying_attr_of(gsi_sensor,
		    index_1);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_item_of_identifying_attr_of(gsi_sensor,
			    index_1);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_119);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_item_of_attr;  /* |gsi_item_of_attr| */

/* SHARED-GSI-ITEM-OF-ATTR */
Object g2int_shared_gsi_item_of_attr(attribute)
    Object attribute;
{
    Object result_1, item_qm, gsi_fc_result;

    x_note_fn_call(47,339);
    if ( !(SIMPLE_VECTOR_P(attribute) && EQ(ISVREF(attribute,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_structure,
		Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_attr,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_item_of_attr;
    }
    item_qm = ISVREF(attribute,(SI_Long)4L);
    if ( !TRUEP(item_qm)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_missing_instance_structure,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_attr,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_item_of_attr;
    }
    gsi_fc_result = item_qm;
    result_1 = gsi_fc_result;
  end_shared_gsi_item_of_attr:;
    return result_1;
}

static Object string_constant_120;  /* "gsi_item_of_attr" */

/* GSI-ITEM-OF-ATTR */
DLLEXPORT Object gsi_item_of_attr(attribute)
    Object attribute;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,340);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_120);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_item_of_attr(attribute);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_item_of_attr(attribute);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_120);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_item_of_attr;  /* |gsi_set_item_of_attr| */

/* SHARED-GSI-SET-ITEM-OF-ATTR */
void g2int_shared_gsi_set_item_of_attr(attribute,item)
    Object attribute, item;
{
    x_note_fn_call(47,341);
    if ( !(SIMPLE_VECTOR_P(attribute) && EQ(ISVREF(attribute,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct) && 
	    SIMPLE_VECTOR_P(item) && EQ(ISVREF(item,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_instance_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_structure,
		Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_item_of_attr,Qerror,T);
	goto end_shared_gsi_set_item_of_attr;
    }
    SVREF(attribute,FIX((SI_Long)4L)) = item;
  end_shared_gsi_set_item_of_attr:;
}

static Object string_constant_121;  /* "gsi_set_item_of_attr" */

/* GSI-SET-ITEM-OF-ATTR */
DLLEXPORT void gsi_set_item_of_attr(attribute,item)
    Object attribute, item;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,342);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_121);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_item_of_attr(attribute,item);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_item_of_attr(attribute,item);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_121);
}

static Object Qg2int_gsi_item_of_registered_item;  /* |gsi_item_of_registered_item| */

/* SHARED-GSI-ITEM-OF-REGISTERED-ITEM */
Object g2int_shared_gsi_item_of_registered_item(registered_item)
    Object registered_item;
{
    Object result_1, item_qm, gsi_fc_result;

    x_note_fn_call(47,343);
    if ( !(SIMPLE_VECTOR_P(registered_item) && EQ(ISVREF(registered_item,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_structure,
		Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_registered_item,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_item_of_registered_item;
    }
    item_qm = ISVREF(registered_item,(SI_Long)4L);
    if ( !TRUEP(item_qm)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_missing_instance_structure,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_registered_item,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_item_of_registered_item;
    }
    gsi_fc_result = item_qm;
    result_1 = gsi_fc_result;
  end_shared_gsi_item_of_registered_item:;
    return result_1;
}

static Object string_constant_122;  /* "gsi_item_of_registered_item" */

/* GSI-ITEM-OF-REGISTERED-ITEM */
DLLEXPORT Object gsi_item_of_registered_item(registered_item)
    Object registered_item;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,344);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_122);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_item_of_registered_item(registered_item);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_item_of_registered_item(registered_item);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_122);
    result_2 = result_1;
    return result_2;
}

/* GET-INSTANCE-FOR-READ-1 */
Object g2int_get_instance_for_read_1(gsi_structure,nil_is_ok_p)
    Object gsi_structure, nil_is_ok_p;
{
    Object temp, gsi_instance_extension;
    char temp_1;

    x_note_fn_call(47,345);
    if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	temp = ISVREF(gsi_structure,(SI_Long)4L);
	if (temp);
	else
	    temp = G2int_gsi_missing_instance_structure;
    }
    else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),Qg2_defstruct_structure_name_gsi_instance_g2_struct))
	temp = gsi_structure;
    else {
	if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	    temp_1 =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp_1 = TRUEP(Nil);
	if (temp_1) {
	    if (EQ(nil_is_ok_p,Qt))
		temp = Nil;
	    else {
		temp = nil_is_ok_p;
		if (temp);
		else
		    temp = G2int_gsi_structure_has_no_instance;
	    }
	}
	else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) {
	    temp = ISVREF(gsi_structure,(SI_Long)4L);
	    if (temp);
	    else
		temp = G2int_gsi_missing_instance_structure;
	}
	else
	    temp = G2int_gsi_structure_has_no_instance;
    }
    return VALUES_1(temp);
}

/* GET-INSTANCE-FOR-WRITE-1 */
Object g2int_get_instance_for_write_1(gsi_structure)
    Object gsi_structure;
{
    Object temp, gsi_instance_extension;
    char temp_1;

    x_note_fn_call(47,346);
    if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	temp = ISVREF(gsi_structure,(SI_Long)4L);
	if (temp);
	else
	    temp = G2int_gsi_missing_instance_structure;
    }
    else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),Qg2_defstruct_structure_name_gsi_instance_g2_struct))
	temp = gsi_structure;
    else {
	if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	    temp_1 =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp_1 = TRUEP(Nil);
	if (temp_1)
	    temp = G2int_gsi_item_definitions_are_read_only;
	else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) {
	    temp = ISVREF(gsi_structure,(SI_Long)4L);
	    if (temp);
	    else
		temp = G2int_gsi_missing_instance_structure;
	}
	else
	    temp = G2int_gsi_structure_has_no_instance;
    }
    return VALUES_1(temp);
}

/* GSI-SIMPLE-CONTENT-COPY-INTERNAL */
Object g2int_gsi_simple_content_copy_internal(destination_item,source_item)
    Object destination_item, source_item;
{
    Object managed_float, value_type, svref_new_value, value;
    SI_Long temp;

    x_note_fn_call(47,347);
    temp = IFIX(ISVREF(destination_item,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if (! !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	switch ((char)temp) {
	  case 4:
	  case 11:
	    g2int_reclaim_text_or_gensym_string(ISVREF(destination_item,
		    (SI_Long)2L));
	    break;
	  case 6:
	    managed_float = ISVREF(destination_item,(SI_Long)2L);
	    g2int_reclaim_managed_simple_float_array_of_length_1(managed_float);
	    break;
	  default:
	    break;
	}
    value_type = FIX(IFIX(ISVREF(source_item,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L);
    g2int_set_gsi_instance_value_type(destination_item,value_type);
    if ( !TRUEP(ISVREF(source_item,(SI_Long)2L)))
	value_type = FIX((SI_Long)0L);
    if (! !(FIXNUMP(value_type) && FIXNUM_LE(FIX((SI_Long)-128L),
	    value_type) && FIXNUM_LE(value_type,FIX((SI_Long)127L))))
	switch (INTEGER_TO_CHAR(value_type)) {
	  case 1:
	  case 5:
	  case 3:
	    svref_new_value = ISVREF(source_item,(SI_Long)2L);
	    SVREF(destination_item,FIX((SI_Long)2L)) = svref_new_value;
	    break;
	  case 4:
	  case 11:
	    value = ISVREF(source_item,(SI_Long)2L);
	    svref_new_value = INLINE_UNSIGNED_BYTE_16_VECTOR_P(value) != 
		    (SI_Long)0L ? g2int_copy_text_string(value) : 
		    g2int_copy_gensym_string(value);
	    SVREF(destination_item,FIX((SI_Long)2L)) = svref_new_value;
	    break;
	  case 6:
	    svref_new_value = g2int_copy_managed_float(ISVREF(source_item,
		    (SI_Long)2L));
	    SVREF(destination_item,FIX((SI_Long)2L)) = svref_new_value;
	    break;
	  default:
	    break;
	}
    return VALUES_1(Nil);
}

static Object Qg2int_gsi_simple_content_copy;  /* |gsi_simple_content_copy| */

/* SHARED-GSI-SIMPLE-CONTENT-COPY */
void g2int_shared_gsi_simple_content_copy(destination,source)
    Object destination, source;
{
    Object instance, destination_item_qm, source_item_qm;

    x_note_fn_call(47,348);
    instance = g2int_get_instance_for_write_1(destination);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_simple_content_copy,Qerror,T);
	goto end_shared_gsi_simple_content_copy;
    }
    destination_item_qm = instance;
    instance = g2int_get_instance_for_read_1(source,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_simple_content_copy,Qerror,T);
	goto end_shared_gsi_simple_content_copy;
    }
    source_item_qm = instance;
    if ( 
	    !TRUEP(g2int_simple_or_null_value_type_p(FIX(IFIX(ISVREF(source_item_qm,
	    (SI_Long)1L)) >>  -  - (SI_Long)3L)))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_simple_content_copy,Qerror,T);
	goto end_shared_gsi_simple_content_copy;
    }
    g2int_gsi_simple_content_copy_internal(destination_item_qm,source_item_qm);
  end_shared_gsi_simple_content_copy:;
}

static Object string_constant_123;  /* "gsi_simple_content_copy" */

/* GSI-SIMPLE-CONTENT-COPY */
DLLEXPORT void gsi_simple_content_copy(destination,source)
    Object destination, source;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,349);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_123);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_simple_content_copy(destination,source);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_simple_content_copy(destination,source);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_123);
}

static Object Qg2int_gsi_clear_item;  /* |gsi_clear_item| */

/* SHARED-GSI-CLEAR-ITEM */
void g2int_shared_gsi_clear_item(gsi_structure)
    Object gsi_structure;
{
    Object instance, instance_qm, temp, temp_1, temp_3;
    SI_Long temp_2;

    x_note_fn_call(47,350);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_clear_item,Qerror,T);
	goto end_shared_gsi_clear_item;
    }
    instance_qm = instance;
    if (instance_qm) {
	temp = FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L);
	temp_1 = ISVREF(instance_qm,(SI_Long)2L);
	temp_2 = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
	if ( !((SI_Long)-128L <= temp_2 && temp_2 <= (SI_Long)127L))
	    temp_3 = Nil;
	else
	    switch ((char)temp_2) {
	      case 0:
		temp_3 = Qg2int_gsi;
		break;
	      case 1:
		temp_3 = Qg2int_user;
		break;
	      case 2:
		temp_3 = Qg2int_context;
		break;
	      case 3:
		temp_3 = Qg2int_gsi_event_queue;
		break;
	      case 4:
		temp_3 = Qg2int_gsi_input_queue;
		break;
	      default:
		temp_3 = Nil;
		break;
	    }
	g2int_reclaim_gsi_instance_value(temp,temp_1,instance_qm,temp_3);
	g2int_set_gsi_instance_value_type(instance_qm,G2int_gsi_null_type_tag);
	SVREF(instance_qm,FIX((SI_Long)2L)) = Nil;
	temp_2 = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
	if ( !((SI_Long)-128L <= temp_2 && temp_2 <= (SI_Long)127L))
	    temp = Nil;
	else
	    switch ((char)temp_2) {
	      case 0:
		temp = Qg2int_gsi;
		break;
	      case 1:
		temp = Qg2int_user;
		break;
	      case 2:
		temp = Qg2int_context;
		break;
	      case 3:
		temp = Qg2int_gsi_event_queue;
		break;
	      case 4:
		temp = Qg2int_gsi_input_queue;
		break;
	      default:
		temp = Nil;
		break;
	    }
	g2int_reclaim_gsi_instance_extension(instance_qm,temp);
    }
  end_shared_gsi_clear_item:;
}

static Object string_constant_124;  /* "gsi_clear_item" */

/* GSI-CLEAR-ITEM */
DLLEXPORT void gsi_clear_item(gsi_structure)
    Object gsi_structure;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,351);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_124);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_clear_item(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_clear_item(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_124);
}

static Object Qg2int_gsi_owner_of;  /* |gsi_owner_of| */

/* SHARED-GSI-OWNER-OF */
SI_Long g2int_shared_gsi_owner_of(gsi_structure)
    Object gsi_structure;
{
    Object temp;
    SI_Long temp_1;
    SI_Long result_1, gsi_fc_result;

    x_note_fn_call(47,352);
    if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct))
	temp = ISVREF(gsi_structure,(SI_Long)5L);
    else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	temp_1 = IFIX(ISVREF(gsi_structure,(SI_Long)1L)) & (SI_Long)7L;
	if ( !((SI_Long)-128L <= temp_1 && temp_1 <= (SI_Long)127L))
	    temp = Nil;
	else
	    switch ((char)temp_1) {
	      case 0:
		temp = Qg2int_gsi;
		break;
	      case 1:
		temp = Qg2int_user;
		break;
	      case 2:
		temp = Qg2int_context;
		break;
	      case 3:
		temp = Qg2int_gsi_event_queue;
		break;
	      case 4:
		temp = Qg2int_gsi_input_queue;
		break;
	      default:
		temp = Nil;
		break;
	    }
    }
    else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),Qg2_defstruct_structure_name_gsi_attribute_g2_struct))
	temp = ISVREF(gsi_structure,(SI_Long)5L);
    else {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_structure,
		Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_owner_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_owner_of;
    }
    if (EQ(temp,Qg2int_gsi))
	gsi_fc_result = FIXNUM_TO_LONG(G2int_gsi_owner_is_gsi);
    else if (EQ(temp,Qg2int_user))
	gsi_fc_result = FIXNUM_TO_LONG(G2int_gsi_owner_is_user);
    else if (EQ(temp,Qg2int_context))
	gsi_fc_result = FIXNUM_TO_LONG(G2int_gsi_owner_is_context);
    else
	gsi_fc_result = FIXNUM_TO_LONG(G2int_gsi_owner_is_gsi);
    result_1 = gsi_fc_result;
  end_shared_gsi_owner_of:;
    return result_1;
}

static Object string_constant_125;  /* "gsi_owner_of" */

/* GSI-OWNER-OF */
DLLEXPORT SI_Long gsi_owner_of(gsi_structure)
    Object gsi_structure;
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,353);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_125);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_owner_of(gsi_structure));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_125);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_class_name_of;  /* |gsi_class_name_of| */

/* SHARED-GSI-CLASS-NAME-OF */
Object g2int_shared_gsi_class_name_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object result_1, gsi_instance_extension, gsi_fc_result, instance_qm;
    Object string_1;
    char temp;

    x_note_fn_call(47,354);
    if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_no_class_in_registered_item,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_class_name_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_class_name_of;
    }
    else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	gsi_fc_result = gsi_instance_extension ? 
		ISVREF(gsi_instance_extension,(SI_Long)2L) : Nil;
    }
    else {
	if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	    temp =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	    gsi_fc_result = gsi_instance_extension ? 
		    ISVREF(gsi_instance_extension,(SI_Long)2L) : Nil;
	}
	else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) {
	    instance_qm = ISVREF(gsi_structure,(SI_Long)4L);
	    if (instance_qm) {
		gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
		gsi_fc_result = gsi_instance_extension ? 
			ISVREF(gsi_instance_extension,(SI_Long)2L) : Nil;
	    }
	    else {
		g2int_set_gsi_error_message_1(Nil,
			G2int_gsi_structure_has_no_instance,Nil,Nil,Nil,
			Nil,Nil,Nil);
		g2int_gsi_handle_error_1(Qg2int_gsi_class_name_of,Qerror,T);
		result_1 = Qnil;
		goto end_shared_gsi_class_name_of;
	    }
	}
	else {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_incompatible_structure,Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_class_name_of,Qerror,T);
	    result_1 = Qnil;
	    goto end_shared_gsi_class_name_of;
	}
    }
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
  end_shared_gsi_class_name_of:;
    return result_1;
}

static Object string_constant_126;  /* "gsi_class_name_of" */

/* GSI-CLASS-NAME-OF */
DLLEXPORT Object gsi_class_name_of(gsi_structure)
    Object gsi_structure;
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,355);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_126);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsi_class_name_of(G2int_gsi_wide_api_p,
	      gsi_structure);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_126);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_class_name;  /* |gsi_set_class_name| */

/* SHARED-GSI-SET-CLASS-NAME */
void g2int_shared_gsi_set_class_name(wide_api_p,gsi_structure,
	    gsi_fc_outer_class_name_qm)
    Object wide_api_p, gsi_structure, gsi_fc_outer_class_name_qm;
{
    Object arg_symbol, class_name_qm, gsi_instance_extension, instance_qm;
    char temp;

    x_note_fn_call(47,356);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_class_name_qm,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_class_name,Qerror,T);
	goto end_shared_gsi_set_class_name;
    }
    class_name_qm = arg_symbol;
    if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_structure,
		Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_class_name,Qerror,T);
	goto end_shared_gsi_set_class_name;
    }
    else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	if ( !TRUEP(gsi_instance_extension)) {
	    gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	    SVREF(gsi_structure,FIX((SI_Long)3L)) = gsi_instance_extension;
	}
	SVREF(gsi_instance_extension,FIX((SI_Long)2L)) = class_name_qm;
    }
    else {
	if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	    temp =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_item_definitions_are_read_only,Nil,Nil,Nil,
		    Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_class_name,Qerror,T);
	    goto end_shared_gsi_set_class_name;
	}
	else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) {
	    instance_qm = ISVREF(gsi_structure,(SI_Long)4L);
	    if (instance_qm) {
		gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
		if ( !TRUEP(gsi_instance_extension)) {
		    gsi_instance_extension = 
			    g2int_make_gsi_instance_extension_1();
		    SVREF(instance_qm,FIX((SI_Long)3L)) = 
			    gsi_instance_extension;
		}
		SVREF(gsi_instance_extension,FIX((SI_Long)2L)) = class_name_qm;
	    }
	    else {
		g2int_set_gsi_error_message_1(Nil,
			G2int_gsi_structure_has_no_instance,Nil,Nil,Nil,
			Nil,Nil,Nil);
		g2int_gsi_handle_error_1(Qg2int_gsi_set_class_name,Qerror,T);
		goto end_shared_gsi_set_class_name;
	    }
	}
	else {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_incompatible_structure,Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_class_name,Qerror,T);
	    goto end_shared_gsi_set_class_name;
	}
    }
  end_shared_gsi_set_class_name:;
}

static Object string_constant_127;  /* "gsi_set_class_name" */

/* GSI-SET-CLASS-NAME */
DLLEXPORT void gsi_set_class_name(gsi_structure,class_name_qm)
    Object gsi_structure, class_name_qm;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,357);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_127);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_class_name(G2int_gsi_wide_api_p,
		    gsi_structure,class_name_qm);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_class_name(G2int_gsi_wide_api_p,
			    gsi_structure,class_name_qm);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_127);
}

static Object Qg2int_gsi_name_of;  /* |gsi_name_of| */

/* SHARED-GSI-NAME-OF */
Object g2int_shared_gsi_name_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object result_1, gsi_instance_extension, gsi_fc_result, instance_qm;
    Object string_1;
    char temp;

    x_note_fn_call(47,358);
    if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_no_name_in_registered_item,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_name_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_name_of;
    }
    else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	gsi_fc_result = gsi_instance_extension ? 
		ISVREF(gsi_instance_extension,(SI_Long)4L) : Nil;
    }
    else {
	if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	    temp =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	    gsi_fc_result = gsi_instance_extension ? 
		    ISVREF(gsi_instance_extension,(SI_Long)4L) : Nil;
	}
	else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) {
	    instance_qm = ISVREF(gsi_structure,(SI_Long)4L);
	    if (instance_qm) {
		gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
		gsi_fc_result = gsi_instance_extension ? 
			ISVREF(gsi_instance_extension,(SI_Long)4L) : Nil;
	    }
	    else {
		g2int_set_gsi_error_message_1(Nil,
			G2int_gsi_structure_has_no_instance,Nil,Nil,Nil,
			Nil,Nil,Nil);
		g2int_gsi_handle_error_1(Qg2int_gsi_name_of,Qerror,T);
		result_1 = Qnil;
		goto end_shared_gsi_name_of;
	    }
	}
	else {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_incompatible_structure,Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_name_of,Qerror,T);
	    result_1 = Qnil;
	    goto end_shared_gsi_name_of;
	}
    }
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
  end_shared_gsi_name_of:;
    return result_1;
}

static Object string_constant_128;  /* "gsi_name_of" */

/* GSI-NAME-OF */
DLLEXPORT Object gsi_name_of(gsi_structure)
    Object gsi_structure;
{
    Object result_1, in_recursive_gsi_context, result_2;
    Declare_special(1);

    x_note_fn_call(47,359);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_128);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = g2int_shared_gsi_name_of(G2int_gsi_wide_api_p,gsi_structure);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_128);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_name;  /* |gsi_set_name| */

/* SHARED-GSI-SET-NAME */
void g2int_shared_gsi_set_name(wide_api_p,gsi_structure,gsi_fc_outer_name_qm)
    Object wide_api_p, gsi_structure, gsi_fc_outer_name_qm;
{
    Object arg_symbol, name_qm, gsi_instance_extension, instance_qm;
    char temp;

    x_note_fn_call(47,360);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_name_qm,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_name,Qerror,T);
	goto end_shared_gsi_set_name;
    }
    name_qm = arg_symbol;
    if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_structure,
		Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_name,Qerror,T);
	goto end_shared_gsi_set_name;
    }
    else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	if ( !TRUEP(gsi_instance_extension)) {
	    gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	    SVREF(gsi_structure,FIX((SI_Long)3L)) = gsi_instance_extension;
	}
	SVREF(gsi_instance_extension,FIX((SI_Long)4L)) = name_qm;
    }
    else {
	if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	    temp =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_item_definitions_are_read_only,Nil,Nil,Nil,
		    Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_name,Qerror,T);
	    goto end_shared_gsi_set_name;
	}
	else if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) {
	    instance_qm = ISVREF(gsi_structure,(SI_Long)4L);
	    if (instance_qm) {
		gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
		if ( !TRUEP(gsi_instance_extension)) {
		    gsi_instance_extension = 
			    g2int_make_gsi_instance_extension_1();
		    SVREF(instance_qm,FIX((SI_Long)3L)) = 
			    gsi_instance_extension;
		}
		SVREF(gsi_instance_extension,FIX((SI_Long)4L)) = name_qm;
	    }
	    else {
		g2int_set_gsi_error_message_1(Nil,
			G2int_gsi_structure_has_no_instance,Nil,Nil,Nil,
			Nil,Nil,Nil);
		g2int_gsi_handle_error_1(Qg2int_gsi_set_name,Qerror,T);
		goto end_shared_gsi_set_name;
	    }
	}
	else {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_incompatible_structure,Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_name,Qerror,T);
	    goto end_shared_gsi_set_name;
	}
    }
  end_shared_gsi_set_name:;
}

static Object string_constant_129;  /* "gsi_set_name" */

/* GSI-SET-NAME */
DLLEXPORT void gsi_set_name(gsi_structure,name_qm)
    Object gsi_structure, name_qm;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,361);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_129);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_name(G2int_gsi_wide_api_p,gsi_structure,
		    name_qm);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_name(G2int_gsi_wide_api_p,
			    gsi_structure,name_qm);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_129);
}

static Object Qg2int_gsi_type_of;  /* |gsi_type_of| */

/* SHARED-GSI-TYPE-OF */
SI_Long g2int_shared_gsi_type_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, gsi_instance_extension;
    SI_Long result_1, gsi_fc_result;
    char temp;

    x_note_fn_call(47,362);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_type_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_type_of;
    }
    if (SIMPLE_VECTOR_P(instance) && EQ(ISVREF(instance,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
	temp =  ! !(gsi_instance_extension ? 
		TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		TRUEP(Nil));
    }
    else
	temp = TRUEP(Nil);
    if (temp ?  !TRUEP(G2int_gsi_use_references_p) : TRUEP(Nil)) {
	gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	gsi_fc_result = gsi_instance_extension ? 
		FIXNUM_TO_LONG(ISVREF(gsi_instance_extension,(SI_Long)3L)) 
		: (SI_Long)0L;
    }
    else
	gsi_fc_result = IFIX(ISVREF(instance,(SI_Long)1L)) >>  -  - 
		(SI_Long)3L;
    result_1 = gsi_fc_result;
  end_shared_gsi_type_of:;
    return result_1;
}

static Object string_constant_130;  /* "gsi_type_of" */

/* GSI-TYPE-OF */
DLLEXPORT SI_Long gsi_type_of(gsi_structure)
    Object gsi_structure;
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,363);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_130);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_type_of(gsi_structure));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_130);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_item_has_a_value;  /* |gsi_item_has_a_value| */

/* SHARED-GSI-ITEM-HAS-A-VALUE */
SI_Long g2int_shared_gsi_item_has_a_value(gsi_structure)
    Object gsi_structure;
{
    Object instance, instance_qm;
    SI_Long result_1, gsi_fc_result;

    x_note_fn_call(47,364);
    instance = g2int_get_instance_for_read_1(gsi_structure,T);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_has_a_value,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_item_has_a_value;
    }
    instance_qm = instance;
    gsi_fc_result = instance_qm && ISVREF(instance_qm,(SI_Long)2L) ? 
	    (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_item_has_a_value:;
    return result_1;
}

static Object string_constant_131;  /* "gsi_item_has_a_value" */

/* GSI-ITEM-HAS-A-VALUE */
DLLEXPORT SI_Long gsi_item_has_a_value(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,365);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_131);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_item_has_a_value(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_item_has_a_value(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_131);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_type;  /* |gsi_set_type| */

static Object string_constant_132;  /* "gsi_set_sym" */

static Object string_constant_133;  /* "gsi_set_type with GSI_NULL_TAG" */

static Object string_constant_134;  /* "gsi_set_handle" */

static Object string_constant_135;  /* "error in gsi_set_type: use ~A instead" */

/* SHARED-GSI-SET-TYPE */
void g2int_shared_gsi_set_type(gsi_structure,gsi_fc_outer_type)
    Object gsi_structure;
    SI_Long gsi_fc_outer_type;
{
    Object type, instance, instance_qm, arrayp_1, value_1;
    Object amf_available_array_cons_qm, amf_array, temp, svref_new_value;
    Object amf_result, incff_1_arg, new_float, fn;
    Object old_gsi_instance_value_type_qm, old_gsi_instance_value_qm;
    Object gsi_instance_extension, temp_2;
    SI_Long value;
    SI_Long temp_1;

    x_note_fn_call(47,366);
    value = gsi_fc_outer_type;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_type,Qerror,T);
	goto end_shared_gsi_set_type;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_type,Qerror,T);
	goto end_shared_gsi_set_type;
    }
    type = LONG_TO_FIXNUM(value);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_type,Qerror,T);
	goto end_shared_gsi_set_type;
    }
    instance_qm = instance;
    if (instance_qm &&  !(IFIX(type) == IFIX(ISVREF(instance_qm,
	    (SI_Long)1L)) >>  -  - (SI_Long)3L)) {
	arrayp_1 = FIXNUM_EQ(type,G2int_gsi_sequence_type_tag) ? T : Nil;
	if (arrayp_1);
	else
	    arrayp_1 = g2int_element_type_for_gsi_type(type);
	if (FIXNUM_EQ(type,G2int_gsi_null_type_tag))
	    value_1 = Nil;
	else if (FIXNUM_EQ(type,G2int_gsi_integer_type_tag))
	    value_1 = FIX((SI_Long)0L);
	else if (FIXNUM_EQ(type,G2int_gsi_string_type_tag))
	    value_1 = G2int_gsi_wide_api_p ? 
		    g2int_obtain_simple_text_string(FIX((SI_Long)0L)) : 
		    g2int_obtain_simple_gensym_string(FIX((SI_Long)0L));
	else if (FIXNUM_EQ(type,G2int_gsi_unsigned_short_vector_type_tag))
	    value_1 = g2int_obtain_simple_text_string(FIX((SI_Long)0L));
	else if (FIXNUM_EQ(type,G2int_gsi_logical_type_tag))
	    value_1 = FIX((SI_Long)0L);
	else if (FIXNUM_EQ(type,G2int_gsi_64bit_float_type_tag)) {
	    amf_available_array_cons_qm = 
		    ISVREF(G2int_vector_of_simple_float_array_pools,
		    (SI_Long)1L);
	    if (amf_available_array_cons_qm) {
		amf_array = M_CAR(amf_available_array_cons_qm);
		temp = G2int_vector_of_simple_float_array_pools;
		svref_new_value = M_CDR(amf_available_array_cons_qm);
		SVREF(temp,FIX((SI_Long)1L)) = svref_new_value;
		inline_note_reclaim_cons(amf_available_array_cons_qm,
			Qg2int_gensym);
		temp = G2int_available_gensym_conses;
		M_CDR(amf_available_array_cons_qm) = temp;
		G2int_available_gensym_conses = amf_available_array_cons_qm;
		amf_result = amf_array;
	    }
	    else {
		temp = 
			FIXNUM_ADD1(G2int_created_simple_float_array_pool_arrays);
		G2int_created_simple_float_array_pool_arrays = temp;
		incff_1_arg = 
			g2int_bytes_per_double_float_simple_array(FIX((SI_Long)1L));
		temp = 
			FIXNUM_ADD(G2int_simple_float_array_pool_memory_usage,
			incff_1_arg);
		G2int_simple_float_array_pool_memory_usage = temp;
		amf_result = g2int_generate_float_vector(FIX((SI_Long)1L));
	    }
	    new_float = amf_result;
	    DFLOAT_ISASET_1(new_float,(SI_Long)0L,0.0);
	    value_1 = new_float;
	}
	else if (FIXNUM_EQ(type,G2int_gsi_structure_type_tag))
	    value_1 = Nil;
	else if (arrayp_1)
	    value_1 = Nil;
	else {
	    if (FIXNUM_EQ(type,G2int_gsi_symbol_type_tag))
		fn = string_constant_132;
	    else if (FIXNUM_EQ(type,G2int_gsi_item_type_tag))
		fn = string_constant_133;
	    else if (FIXNUM_EQ(type,G2int_gsi_item_handle_type_tag))
		fn = string_constant_134;
	    else
		fn = Qnil;
	    if (fn)
		g2int_gsi_message(2,string_constant_135,fn);
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_invalid_type,type,
		    Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_type,Qerror,T);
	    goto end_shared_gsi_set_type;
	}
	old_gsi_instance_value_type_qm = instance_qm ? 
		FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
		(SI_Long)3L) : Nil;
	old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
		ISVREF(instance_qm,(SI_Long)2L) : Nil;
	g2int_set_gsi_instance_value_type(instance_qm,type);
	SVREF(instance_qm,FIX((SI_Long)2L)) = value_1;
	if (arrayp_1) {
	    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
	    if ( !TRUEP(gsi_instance_extension)) {
		gsi_instance_extension = g2int_make_gsi_instance_extension_1();
		SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
	    }
	    ISVREF(gsi_instance_extension,(SI_Long)7L) = FIX((SI_Long)0L);
	}
	temp_1 = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
	if ( !((SI_Long)-128L <= temp_1 && temp_1 <= (SI_Long)127L))
	    temp_2 = Nil;
	else
	    switch ((char)temp_1) {
	      case 0:
		temp_2 = Qg2int_gsi;
		break;
	      case 1:
		temp_2 = Qg2int_user;
		break;
	      case 2:
		temp_2 = Qg2int_context;
		break;
	      case 3:
		temp_2 = Qg2int_gsi_event_queue;
		break;
	      case 4:
		temp_2 = Qg2int_gsi_input_queue;
		break;
	      default:
		temp_2 = Nil;
		break;
	    }
	g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
		old_gsi_instance_value_qm,instance_qm,temp_2);
    }
  end_shared_gsi_set_type:;
}

static Object string_constant_136;  /* "gsi_set_type" */

/* GSI-SET-TYPE */
DLLEXPORT void gsi_set_type(gsi_structure,type)
    Object gsi_structure;
    SI_Long type;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,367);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_136);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_type(gsi_structure,type);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_type(gsi_structure,type);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_136);
}

static Object Qg2int_gsi_handle_of;  /* |gsi_handle_of| */

/* SHARED-GSI-HANDLE-OF */
SI_Long g2int_shared_gsi_handle_of(gsi_structure)
    Object gsi_structure;
{
    Object type_qm, sensor_or_index, handle_qm, gsi_instance_extension;
    Object instance, instance_qm;
    SI_Long result_1, gsi_fc_result;
    char temp;

    x_note_fn_call(47,368);
    type_qm = Nil;
    if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	sensor_or_index = ISVREF(gsi_structure,(SI_Long)1L);
	if (FIXNUMP(sensor_or_index))
	    handle_qm = sensor_or_index;
	else if (sensor_or_index && EQ(sensor_or_index,
		G2int_gsi_sensor_to_deregisterqm))
	    handle_qm = G2int_index_of_gsi_sensor_to_deregisterqm;
	else {
	    if (SIMPLE_VECTOR_P(sensor_or_index) && 
		    EQ(ISVREF(sensor_or_index,(SI_Long)0L),
		    Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
		gsi_instance_extension = ISVREF(sensor_or_index,(SI_Long)3L);
		temp =  ! !(gsi_instance_extension ? 
			TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) 
			: TRUEP(Nil));
	    }
	    else
		temp = TRUEP(Nil);
	    if (temp) {
		handle_qm = g2int_gsi_sensor_index(sensor_or_index);
		if (handle_qm);
		else
		    handle_qm = FIX((SI_Long)0L);
	    }
	    else
		handle_qm = Qnil;
	}
    }
    else {
	instance = g2int_get_instance_for_read_1(gsi_structure,
		G2int_gsi_structure_has_no_handle);
	if (FIXNUMP(instance)) {
	    g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,
		    Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_handle_of,Qerror,T);
	    result_1 = (SI_Long)0L;
	    goto end_shared_gsi_handle_of;
	}
	instance_qm = instance;
	type_qm = FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
		(SI_Long)3L);
	if (EQ(type_qm,G2int_gsi_item_handle_type_tag))
	    handle_qm = ISVREF(instance_qm,(SI_Long)2L);
	else if (EQL(instance_qm,G2int_gsi_sensor_to_deregisterqm))
	    handle_qm = G2int_index_of_gsi_sensor_to_deregisterqm;
	else {
	    handle_qm = g2int_gsi_sensor_index(instance_qm);
	    if (handle_qm);
	    else
		handle_qm = FIX((SI_Long)0L);
	}
    }
    if ( !TRUEP(handle_qm)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		type_qm,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_handle_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_handle_of;
    }
    gsi_fc_result = FIXNUM_TO_LONG(handle_qm);
    result_1 = gsi_fc_result;
  end_shared_gsi_handle_of:;
    return result_1;
}

static Object string_constant_137;  /* "gsi_handle_of" */

/* GSI-HANDLE-OF */
DLLEXPORT SI_Long gsi_handle_of(gsi_structure)
    Object gsi_structure;
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,369);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_137);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_handle_of(gsi_structure));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_137);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_handle;  /* |gsi_set_handle| */

/* SHARED-GSI-SET-HANDLE */
void g2int_shared_gsi_set_handle(gsi_structure,gsi_fc_outer_handle_value)
    Object gsi_structure;
    SI_Long gsi_fc_outer_handle_value;
{
    Object handle_value, gsi_instance_extension, instance, instance_qm;
    Object old_gsi_instance_value_type_qm, old_gsi_instance_value_qm, temp_2;
    SI_Long value;
    SI_Long temp_1;
    char temp;

    x_note_fn_call(47,370);
    value = gsi_fc_outer_handle_value;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_handle,Qerror,T);
	goto end_shared_gsi_set_handle;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_handle,Qerror,T);
	goto end_shared_gsi_set_handle;
    }
    handle_value = LONG_TO_FIXNUM(value);
    if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct))
	SVREF(gsi_structure,FIX((SI_Long)1L)) = handle_value;
    else {
	if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	    temp =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp = TRUEP(Nil);
	if (temp) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_item_definitions_are_read_only,Nil,Nil,Nil,
		    Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_handle,Qerror,T);
	    goto end_shared_gsi_set_handle;
	}
	else {
	    instance = g2int_get_instance_for_write_1(gsi_structure);
	    if (FIXNUMP(instance)) {
		g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,
			Nil,Nil);
		g2int_gsi_handle_error_1(Qg2int_gsi_set_handle,Qerror,T);
		goto end_shared_gsi_set_handle;
	    }
	    instance_qm = instance;
	    old_gsi_instance_value_type_qm = instance_qm ? 
		    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
		    (SI_Long)3L) : Nil;
	    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
		    ISVREF(instance_qm,(SI_Long)2L) : Nil;
	    g2int_set_gsi_instance_value_type(instance_qm,
		    G2int_gsi_item_handle_type_tag);
	    SVREF(instance_qm,FIX((SI_Long)2L)) = handle_value;
	    temp_1 = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
	    if ( !((SI_Long)-128L <= temp_1 && temp_1 <= (SI_Long)127L))
		temp_2 = Nil;
	    else
		switch ((char)temp_1) {
		  case 0:
		    temp_2 = Qg2int_gsi;
		    break;
		  case 1:
		    temp_2 = Qg2int_user;
		    break;
		  case 2:
		    temp_2 = Qg2int_context;
		    break;
		  case 3:
		    temp_2 = Qg2int_gsi_event_queue;
		    break;
		  case 4:
		    temp_2 = Qg2int_gsi_input_queue;
		    break;
		  default:
		    temp_2 = Nil;
		    break;
		}
	    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
		    old_gsi_instance_value_qm,instance_qm,temp_2);
	}
    }
  end_shared_gsi_set_handle:;
}

/* GSI-SET-HANDLE */
DLLEXPORT void gsi_set_handle(gsi_structure,handle_value)
    Object gsi_structure;
    SI_Long handle_value;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,371);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_134);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_handle(gsi_structure,handle_value);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_handle(gsi_structure,handle_value);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_134);
}

/* SHARED-GSI-REGISTRATION-OF-ITEM */
Object g2int_shared_gsi_registration_of_item(gsi_structure)
    Object gsi_structure;
{
    Object sensor_or_index, gsi_fc_result, gsi_instance_extension, result_1;
    char temp;

    x_note_fn_call(47,372);
    if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	sensor_or_index = ISVREF(gsi_structure,(SI_Long)1L);
	gsi_fc_result =  !FIXNUMP(sensor_or_index) ? sensor_or_index : Nil;
    }
    else {
	if (SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
		(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
	    temp =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp = TRUEP(Nil);
	if (temp)
	    gsi_fc_result = gsi_structure;
	else
	    gsi_fc_result = Qnil;
    }
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_138;  /* "gsi_registration_of_item" */

/* GSI-REGISTRATION-OF-ITEM */
DLLEXPORT Object gsi_registration_of_item(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,373);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_138);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_registration_of_item(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_registration_of_item(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_138);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_item_append_flag;  /* |gsi_item_append_flag| */

static Object Qg2int_gsi_append_flag;  /* gsi-append-flag */

/* SHARED-GSI-ITEM-APPEND-FLAG */
int g2int_shared_gsi_item_append_flag(item)
    Object item;
{
    Object instance;
    int result_1, gsi_fc_result;

    x_note_fn_call(47,374);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_append_flag,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_item_append_flag;
    }
    gsi_fc_result = g2int_get_gsi_instance_plist_value(instance,
	    Qg2int_gsi_append_flag) ? (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_item_append_flag:;
    return result_1;
}

static Object string_constant_139;  /* "gsi_item_append_flag" */

/* GSI-ITEM-APPEND-FLAG */
DLLEXPORT int gsi_item_append_flag(item)
    Object item;
{
    Object result_1, in_recursive_gsi_context;
    int result_2;
    Declare_special(1);

    x_note_fn_call(47,375);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_139);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = INT_TO_FIXNUM(g2int_shared_gsi_item_append_flag(item));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_139);
    result_2 = FIXNUM_TO_INT(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_item_append_flag;  /* |gsi_set_item_append_flag| */

/* SHARED-GSI-SET-ITEM-APPEND-FLAG */
void g2int_shared_gsi_set_item_append_flag(item,value)
    Object item;
    int value;
{
    Object instance;
    char get_gsi_instance_plist_value_new_value;

    x_note_fn_call(47,376);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_item_append_flag,Qerror,T);
	goto end_shared_gsi_set_item_append_flag;
    }
    get_gsi_instance_plist_value_new_value =  !(value == (SI_Long)0L);
    g2int_set_gsi_instance_plist_value(instance,Qg2int_gsi_append_flag,
	    get_gsi_instance_plist_value_new_value ? T : Nil);
  end_shared_gsi_set_item_append_flag:;
}

static Object string_constant_140;  /* "gsi_set_item_append_flag" */

/* GSI-SET-ITEM-APPEND-FLAG */
DLLEXPORT void gsi_set_item_append_flag(item,value)
    Object item;
    int value;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,377);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_140);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_item_append_flag(item,value);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_140);
}

static Object Qg2int_gsi_item_delete_flag;  /* |gsi_item_delete_flag| */

static Object Qg2int_gsi_delete_flag;  /* gsi-delete-flag */

/* SHARED-GSI-ITEM-DELETE-FLAG */
int g2int_shared_gsi_item_delete_flag(item)
    Object item;
{
    Object instance;
    int result_1, gsi_fc_result;

    x_note_fn_call(47,378);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_delete_flag,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_item_delete_flag;
    }
    gsi_fc_result = g2int_get_gsi_instance_plist_value(instance,
	    Qg2int_gsi_delete_flag) ? (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_item_delete_flag:;
    return result_1;
}

static Object string_constant_141;  /* "gsi_item_delete_flag" */

/* GSI-ITEM-DELETE-FLAG */
DLLEXPORT int gsi_item_delete_flag(item)
    Object item;
{
    Object result_1, in_recursive_gsi_context;
    int result_2;
    Declare_special(1);

    x_note_fn_call(47,379);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_141);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = INT_TO_FIXNUM(g2int_shared_gsi_item_delete_flag(item));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_141);
    result_2 = FIXNUM_TO_INT(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_item_delete_flag;  /* |gsi_set_item_delete_flag| */

/* SHARED-GSI-SET-ITEM-DELETE-FLAG */
void g2int_shared_gsi_set_item_delete_flag(item,value)
    Object item;
    int value;
{
    Object instance;
    char get_gsi_instance_plist_value_new_value;

    x_note_fn_call(47,380);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_item_delete_flag,Qerror,T);
	goto end_shared_gsi_set_item_delete_flag;
    }
    get_gsi_instance_plist_value_new_value =  !(value == (SI_Long)0L);
    g2int_set_gsi_instance_plist_value(instance,Qg2int_gsi_delete_flag,
	    get_gsi_instance_plist_value_new_value ? T : Nil);
  end_shared_gsi_set_item_delete_flag:;
}

static Object string_constant_142;  /* "gsi_set_item_delete_flag" */

/* GSI-SET-ITEM-DELETE-FLAG */
DLLEXPORT void gsi_set_item_delete_flag(item,value)
    Object item;
    int value;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,381);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_142);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_item_delete_flag(item,value);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_142);
}

static Object Qg2int_gsi_update_items_flag;  /* |gsi_update_items_flag| */

static Object Qg2int_gsi_update_items_in_lists_and_arrays_flag;  /* gsi-update-items-in-lists-and-arrays-flag */

/* SHARED-GSI-UPDATE-ITEMS-FLAG */
int g2int_shared_gsi_update_items_flag(item)
    Object item;
{
    Object instance;
    int result_1, gsi_fc_result;

    x_note_fn_call(47,382);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_update_items_flag,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_update_items_flag;
    }
    gsi_fc_result = g2int_get_gsi_instance_plist_value(instance,
	    Qg2int_gsi_update_items_in_lists_and_arrays_flag) ? 
	    (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_update_items_flag:;
    return result_1;
}

static Object string_constant_143;  /* "gsi_update_items_flag" */

/* GSI-UPDATE-ITEMS-FLAG */
DLLEXPORT int gsi_update_items_flag(item)
    Object item;
{
    Object result_1, in_recursive_gsi_context;
    int result_2;
    Declare_special(1);

    x_note_fn_call(47,383);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_143);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = INT_TO_FIXNUM(g2int_shared_gsi_update_items_flag(item));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_143);
    result_2 = FIXNUM_TO_INT(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_update_items_flag;  /* |gsi_set_update_items_flag| */

/* SHARED-GSI-SET-UPDATE-ITEMS-FLAG */
void g2int_shared_gsi_set_update_items_flag(item,value)
    Object item;
    int value;
{
    Object instance;
    char get_gsi_instance_plist_value_new_value;

    x_note_fn_call(47,384);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_update_items_flag,Qerror,T);
	goto end_shared_gsi_set_update_items_flag;
    }
    get_gsi_instance_plist_value_new_value =  !(value == (SI_Long)0L);
    g2int_set_gsi_instance_plist_value(instance,
	    Qg2int_gsi_update_items_in_lists_and_arrays_flag,
	    get_gsi_instance_plist_value_new_value ? T : Nil);
  end_shared_gsi_set_update_items_flag:;
}

static Object string_constant_144;  /* "gsi_set_update_items_flag" */

/* GSI-SET-UPDATE-ITEMS-FLAG */
DLLEXPORT void gsi_set_update_items_flag(item,value)
    Object item;
    int value;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,385);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_144);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_update_items_flag(item,value);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_144);
}

static Object Qg2int_gsi_item_reference_flag;  /* |gsi_item_reference_flag| */

/* SHARED-GSI-ITEM-REFERENCE-FLAG */
int g2int_shared_gsi_item_reference_flag(item)
    Object item;
{
    Object instance;
    int result_1, gsi_fc_result;

    x_note_fn_call(47,386);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_reference_flag,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_item_reference_flag;
    }
    gsi_fc_result = g2int_get_gsi_instance_plist_value(instance,
	    Qg2int_gsi_reference_flag) ? (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_item_reference_flag:;
    return result_1;
}

static Object string_constant_145;  /* "gsi_item_reference_flag" */

/* GSI-ITEM-REFERENCE-FLAG */
DLLEXPORT int gsi_item_reference_flag(item)
    Object item;
{
    Object result_1, in_recursive_gsi_context;
    int result_2;
    Declare_special(1);

    x_note_fn_call(47,387);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_145);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = INT_TO_FIXNUM(g2int_shared_gsi_item_reference_flag(item));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_145);
    result_2 = FIXNUM_TO_INT(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_item_reference_flag;  /* |gsi_set_item_reference_flag| */

/* SHARED-GSI-SET-ITEM-REFERENCE-FLAG */
void g2int_shared_gsi_set_item_reference_flag(item,value)
    Object item;
    int value;
{
    Object instance;
    char get_gsi_instance_plist_value_new_value;

    x_note_fn_call(47,388);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_item_reference_flag,Qerror,T);
	goto end_shared_gsi_set_item_reference_flag;
    }
    get_gsi_instance_plist_value_new_value =  !(value == (SI_Long)0L);
    g2int_set_gsi_instance_plist_value(instance,Qg2int_gsi_reference_flag,
	    get_gsi_instance_plist_value_new_value ? T : Nil);
  end_shared_gsi_set_item_reference_flag:;
}

static Object string_constant_146;  /* "gsi_set_item_reference_flag" */

/* GSI-SET-ITEM-REFERENCE-FLAG */
DLLEXPORT void gsi_set_item_reference_flag(item,value)
    Object item;
    int value;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,389);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_146);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_item_reference_flag(item,value);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_146);
}

static Object Qg2int_gsi_item_name_is_ident_flag;  /* |gsi_item_name_is_ident_flag| */

static Object Qg2int_gsi_name_is_identifying_flag;  /* gsi-name-is-identifying-flag */

/* SHARED-GSI-ITEM-NAME-IS-IDENT-FLAG */
int g2int_shared_gsi_item_name_is_ident_flag(item)
    Object item;
{
    Object instance;
    int result_1, gsi_fc_result;

    x_note_fn_call(47,390);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_name_is_ident_flag,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_item_name_is_ident_flag;
    }
    gsi_fc_result = g2int_get_gsi_instance_plist_value(instance,
	    Qg2int_gsi_name_is_identifying_flag) ? (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_item_name_is_ident_flag:;
    return result_1;
}

static Object string_constant_147;  /* "gsi_item_name_is_ident_flag" */

/* GSI-ITEM-NAME-IS-IDENT-FLAG */
DLLEXPORT int gsi_item_name_is_ident_flag(item)
    Object item;
{
    Object result_1, in_recursive_gsi_context;
    int result_2;
    Declare_special(1);

    x_note_fn_call(47,391);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_147);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = INT_TO_FIXNUM(g2int_shared_gsi_item_name_is_ident_flag(item));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_147);
    result_2 = FIXNUM_TO_INT(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_item_name_is_ident_flag;  /* |gsi_set_item_name_is_ident_flag| */

/* SHARED-GSI-SET-ITEM-NAME-IS-IDENT-FLAG */
void g2int_shared_gsi_set_item_name_is_ident_flag(item,value)
    Object item;
    int value;
{
    Object instance;
    char get_gsi_instance_plist_value_new_value;

    x_note_fn_call(47,392);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_item_name_is_ident_flag,
		Qerror,T);
	goto end_shared_gsi_set_item_name_is_ident_flag;
    }
    get_gsi_instance_plist_value_new_value =  !(value == (SI_Long)0L);
    g2int_set_gsi_instance_plist_value(instance,
	    Qg2int_gsi_name_is_identifying_flag,
	    get_gsi_instance_plist_value_new_value ? T : Nil);
  end_shared_gsi_set_item_name_is_ident_flag:;
}

static Object string_constant_148;  /* "gsi_set_item_name_is_ident_flag" */

/* GSI-SET-ITEM-NAME-IS-IDENT-FLAG */
DLLEXPORT void gsi_set_item_name_is_ident_flag(item,value)
    Object item;
    int value;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,393);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_148);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_item_name_is_ident_flag(item,value);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_148);
}

static Object Qg2int_gsi_item_class_is_ident_flag;  /* |gsi_item_class_is_ident_flag| */

static Object Qg2int_gsi_class_is_identifying_flag;  /* gsi-class-is-identifying-flag */

/* SHARED-GSI-ITEM-CLASS-IS-IDENT-FLAG */
int g2int_shared_gsi_item_class_is_ident_flag(item)
    Object item;
{
    Object instance;
    int result_1, gsi_fc_result;

    x_note_fn_call(47,394);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_class_is_ident_flag,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_item_class_is_ident_flag;
    }
    gsi_fc_result = g2int_get_gsi_instance_plist_value(instance,
	    Qg2int_gsi_class_is_identifying_flag) ? (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_item_class_is_ident_flag:;
    return result_1;
}

static Object string_constant_149;  /* "gsi_item_class_is_ident_flag" */

/* GSI-ITEM-CLASS-IS-IDENT-FLAG */
DLLEXPORT int gsi_item_class_is_ident_flag(item)
    Object item;
{
    Object result_1, in_recursive_gsi_context;
    int result_2;
    Declare_special(1);

    x_note_fn_call(47,395);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_149);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = 
	      INT_TO_FIXNUM(g2int_shared_gsi_item_class_is_ident_flag(item));
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_149);
    result_2 = FIXNUM_TO_INT(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_item_class_is_iden_flag;  /* |gsi_set_item_class_is_iden_flag| */

/* SHARED-GSI-SET-ITEM-CLASS-IS-IDEN-FLAG */
void g2int_shared_gsi_set_item_class_is_iden_flag(item,value)
    Object item;
    int value;
{
    Object instance;
    char get_gsi_instance_plist_value_new_value;

    x_note_fn_call(47,396);
    instance = g2int_get_instance_for_read_1(item,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_item_class_is_iden_flag,
		Qerror,T);
	goto end_shared_gsi_set_item_class_is_iden_flag;
    }
    get_gsi_instance_plist_value_new_value =  !(value == (SI_Long)0L);
    g2int_set_gsi_instance_plist_value(instance,
	    Qg2int_gsi_class_is_identifying_flag,
	    get_gsi_instance_plist_value_new_value ? T : Nil);
  end_shared_gsi_set_item_class_is_iden_flag:;
}

static Object string_constant_150;  /* "gsi_set_item_class_is_iden_flag" */

/* GSI-SET-ITEM-CLASS-IS-IDEN-FLAG */
DLLEXPORT void gsi_set_item_class_is_iden_flag(item,value)
    Object item;
    int value;
{
    Object in_recursive_gsi_context;
    Declare_special(1);

    x_note_fn_call(47,397);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_150);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      g2int_shared_gsi_set_item_class_is_iden_flag(item,value);
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_150);
}

static Object Qg2int_gsi_int_of;   /* |gsi_int_of| */

/* SHARED-GSI-INT-OF */
SI_Long g2int_shared_gsi_int_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, instance_qm, value_qm;
    SI_Long result_1;
    SI_Long value_type;
    SI_Long gsi_fc_result;

    x_note_fn_call(47,398);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_int_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_int_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_integer_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_int_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_int_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    if ( !TRUEP(value_qm)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_item_has_no_value,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_int_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_int_of;
    }
    gsi_fc_result = FIXNUM_TO_LONG(value_qm);
    result_1 = gsi_fc_result;
  end_shared_gsi_int_of:;
    return result_1;
}

static Object string_constant_151;  /* "gsi_int_of" */

/* GSI-INT-OF */
DLLEXPORT SI_Long gsi_int_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,399);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_151);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_int_of(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_int_of(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_151);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_int;  /* |gsi_set_int| */

/* SHARED-GSI-SET-INT */
void g2int_shared_gsi_set_int(gsi_structure,gsi_fc_outer_new_value)
    Object gsi_structure;
    SI_Long gsi_fc_outer_new_value;
{
    Object instance, instance_qm, new_value, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long temp;

    x_note_fn_call(47,400);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_int,Qerror,T);
	goto end_shared_gsi_set_int;
    }
    instance_qm = instance;
    value = gsi_fc_outer_new_value;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_int,Qerror,T);
	goto end_shared_gsi_set_int;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_int,Qerror,T);
	goto end_shared_gsi_set_int;
    }
    new_value = LONG_TO_FIXNUM(value);
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,G2int_gsi_integer_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_int:;
}

static Object string_constant_152;  /* "gsi_set_int" */

/* GSI-SET-INT */
DLLEXPORT void gsi_set_int(gsi_structure,new_value)
    Object gsi_structure;
    SI_Long new_value;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,401);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_152);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_int(gsi_structure,new_value);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_int(gsi_structure,new_value);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_152);
}

static Object Qg2int_gsi_i64_of;   /* |gsi_i64_of| */

/* SHARED-GSI-I64-OF */
Object g2int_shared_gsi_i64_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    SI_Long value_type;

    x_note_fn_call(47,402);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_i64_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_i64_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_long_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_i64_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_i64_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    if ( !TRUEP(value_qm)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_item_has_no_value,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_i64_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_i64_of;
    }
    gsi_fc_result = value_qm;
    result_1 = gsi_fc_result;
  end_shared_gsi_i64_of:;
    return result_1;
}

static Object string_constant_153;  /* "gsi_i64_of" */

/* GSI-I64-OF */
DLLEXPORT Object gsi_i64_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,403);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_153);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_i64_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_i64_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_153);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_i64;  /* |gsi_set_i64| */

/* SHARED-GSI-SET-I64 */
void g2int_shared_gsi_set_i64(gsi_structure,new_value)
    Object gsi_structure, new_value;
{
    Object instance, instance_qm, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, new_long, temp_1;
    SI_Long temp;
    SI_int64 aref_new_value;

    x_note_fn_call(47,404);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_i64,Qerror,T);
	goto end_shared_gsi_set_i64;
    }
    instance_qm = instance;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,G2int_gsi_long_type_tag);
    new_long = g2int_allocate_managed_long_box();
    aref_new_value = INTEGER_TO_INT64(new_value);
    set_aref1(new_long,FIX((SI_Long)0L),INT64_TO_INTEGER(aref_new_value));
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_long;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_i64:;
}

static Object string_constant_154;  /* "gsi_set_i64" */

/* GSI-SET-I64 */
DLLEXPORT void gsi_set_i64(gsi_structure,new_value)
    Object gsi_structure, new_value;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,405);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_154);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_i64(gsi_structure,new_value);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_i64(gsi_structure,new_value);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_154);
}

static Object Qg2int_gsi_flt_of;   /* |gsi_flt_of| */

/* SHARED-GSI-FLT-OF */
double g2int_shared_gsi_flt_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, instance_qm, value_qm;
    SI_Long value_type;
    double result_1, gsi_fc_result;

    x_note_fn_call(47,406);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_flt_of,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_flt_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_64bit_float_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_flt_of,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_flt_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    if ( !TRUEP(value_qm)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_item_has_no_value,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_flt_of,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_flt_of;
    }
    gsi_fc_result = DFLOAT_ISAREF_1(value_qm,(SI_Long)0L);
    result_1 = 
	    inline_maybe_swap_float_bytes_for_alpha_gfloats(gsi_fc_result,
	    g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? (SI_Long)1L 
	    : (SI_Long)0L);
  end_shared_gsi_flt_of:;
    return result_1;
}

static Object string_constant_155;  /* "gsi_flt_of" */

/* GSI-FLT-OF */
DLLEXPORT double gsi_flt_of(gsi_structure)
    Object gsi_structure;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    volatile double result_1;
    double result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,407);
    result_1 = 0.0;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_155);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_flt_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_flt_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_155);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_flt;  /* |gsi_set_flt| */

/* SHARED-GSI-SET-FLT */
void g2int_shared_gsi_set_flt(gsi_structure,gsi_fc_outer_new_value)
    Object gsi_structure;
    double gsi_fc_outer_new_value;
{
    Object instance, instance_qm, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, amf_available_array_cons_qm, amf_array;
    Object temp, svref_new_value, amf_result, incff_1_arg, new_float, temp_2;
    SI_Long temp_1;
    double new_value;

    x_note_fn_call(47,408);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_flt,Qerror,T);
	goto end_shared_gsi_set_flt;
    }
    instance_qm = instance;
    new_value = 
	    inline_maybe_swap_float_bytes_for_alpha_gfloats(gsi_fc_outer_new_value,
	    g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? (SI_Long)1L 
	    : (SI_Long)0L);
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_64bit_float_type_tag);
    amf_available_array_cons_qm = 
	    ISVREF(G2int_vector_of_simple_float_array_pools,(SI_Long)1L);
    if (amf_available_array_cons_qm) {
	amf_array = M_CAR(amf_available_array_cons_qm);
	temp = G2int_vector_of_simple_float_array_pools;
	svref_new_value = M_CDR(amf_available_array_cons_qm);
	SVREF(temp,FIX((SI_Long)1L)) = svref_new_value;
	inline_note_reclaim_cons(amf_available_array_cons_qm,Qg2int_gensym);
	temp = G2int_available_gensym_conses;
	M_CDR(amf_available_array_cons_qm) = temp;
	G2int_available_gensym_conses = amf_available_array_cons_qm;
	amf_result = amf_array;
    }
    else {
	temp = FIXNUM_ADD1(G2int_created_simple_float_array_pool_arrays);
	G2int_created_simple_float_array_pool_arrays = temp;
	incff_1_arg = 
		g2int_bytes_per_double_float_simple_array(FIX((SI_Long)1L));
	temp = FIXNUM_ADD(G2int_simple_float_array_pool_memory_usage,
		incff_1_arg);
	G2int_simple_float_array_pool_memory_usage = temp;
	amf_result = g2int_generate_float_vector(FIX((SI_Long)1L));
    }
    new_float = amf_result;
    DFLOAT_ISASET_1(new_float,(SI_Long)0L,new_value);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_float;
    temp_1 = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp_1 && temp_1 <= (SI_Long)127L))
	temp_2 = Nil;
    else
	switch ((char)temp_1) {
	  case 0:
	    temp_2 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_2 = Qg2int_user;
	    break;
	  case 2:
	    temp_2 = Qg2int_context;
	    break;
	  case 3:
	    temp_2 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_2 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_2 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_2);
  end_shared_gsi_set_flt:;
}

static Object string_constant_156;  /* "gsi_set_flt" */

/* GSI-SET-FLT */
DLLEXPORT void gsi_set_flt(gsi_structure,new_value)
    Object gsi_structure;
    double new_value;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,409);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_156);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_flt(gsi_structure,new_value);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_flt(gsi_structure,new_value);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_156);
}

static Object Qg2int_gsi_log_of;   /* |gsi_log_of| */

/* SHARED-GSI-LOG-OF */
SI_Long g2int_shared_gsi_log_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, instance_qm, value_qm;
    SI_Long result_1;
    SI_Long value_type;
    SI_Long gsi_fc_result;

    x_note_fn_call(47,410);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_log_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_log_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_logical_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_log_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_log_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    if ( !TRUEP(value_qm)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_item_has_no_value,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_log_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_log_of;
    }
    gsi_fc_result = FIXNUM_TO_LONG(value_qm);
    result_1 = gsi_fc_result;
  end_shared_gsi_log_of:;
    return result_1;
}

static Object string_constant_157;  /* "gsi_log_of" */

/* GSI-LOG-OF */
DLLEXPORT SI_Long gsi_log_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,411);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_157);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_log_of(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_log_of(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_157);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_log;  /* |gsi_set_log| */

/* SHARED-GSI-SET-LOG */
void g2int_shared_gsi_set_log(gsi_structure,gsi_fc_outer_new_value)
    Object gsi_structure;
    SI_Long gsi_fc_outer_new_value;
{
    Object instance, instance_qm, new_value, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long temp;

    x_note_fn_call(47,412);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_log,Qerror,T);
	goto end_shared_gsi_set_log;
    }
    instance_qm = instance;
    value = gsi_fc_outer_new_value;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_log,Qerror,T);
	goto end_shared_gsi_set_log;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_log,Qerror,T);
	goto end_shared_gsi_set_log;
    }
    new_value = LONG_TO_FIXNUM(value);
    if (IFIX(new_value) < (SI_Long)-1000L || IFIX(new_value) > 
		(SI_Long)1000L) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_g2_logical_out_of_bounds,new_value,Nil,Nil,Nil,
		Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_log,Qerror,T);
	goto end_shared_gsi_set_log;
    }
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,G2int_gsi_logical_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_log:;
}

static Object string_constant_158;  /* "gsi_set_log" */

/* GSI-SET-LOG */
DLLEXPORT void gsi_set_log(gsi_structure,new_value)
    Object gsi_structure;
    SI_Long new_value;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,413);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_158);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_log(gsi_structure,new_value);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_log(gsi_structure,new_value);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_158);
}

static Object Qg2int_gsi_str_of;   /* |gsi_str_of| */

/* SHARED-GSI-STR-OF */
Object g2int_shared_gsi_str_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    SI_Long value_type;

    x_note_fn_call(47,414);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_str_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_str_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_string_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_str_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_str_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    if ( !TRUEP(value_qm)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_item_has_no_value,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_str_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_str_of;
    }
    gsi_fc_result = value_qm;
    result_1 = wide_api_p ? 
	    g2int_lisp_string_to_c_wide_string(gsi_fc_result) : 
	    g2int_lisp_string_to_c_string(gsi_fc_result);
  end_shared_gsi_str_of:;
    return result_1;
}

static Object string_constant_159;  /* "gsi_str_of" */

/* GSI-STR-OF */
DLLEXPORT Object gsi_str_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,415);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_159);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_str_of(G2int_gsi_wide_api_p,
		    gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_str_of(G2int_gsi_wide_api_p,
			    gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_159);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_str;  /* |gsi_set_str| */

/* SHARED-GSI-SET-STR */
void g2int_shared_gsi_set_str(wide_api_p,gsi_structure,gsi_fc_outer_new_value)
    Object wide_api_p, gsi_structure, gsi_fc_outer_new_value;
{
    Object instance, instance_qm, new_value, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, temp_1;
    SI_Long temp;

    x_note_fn_call(47,416);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_str,Qerror,T);
	goto end_shared_gsi_set_str;
    }
    instance_qm = instance;
    new_value = wide_api_p ? 
	    g2int_c_wide_string_to_gsi_string(gsi_fc_outer_new_value) : 
	    g2int_c_string_to_gsi_string(gsi_fc_outer_new_value);
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,G2int_gsi_string_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_str:;
}

static Object string_constant_160;  /* "gsi_set_str" */

/* GSI-SET-STR */
DLLEXPORT void gsi_set_str(gsi_structure,new_value)
    Object gsi_structure, new_value;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,417);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_160);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_str(G2int_gsi_wide_api_p,gsi_structure,
		    new_value);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_str(G2int_gsi_wide_api_p,
			    gsi_structure,new_value);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_160);
}

static Object Qg2int_gsi_usv_of;   /* |gsi_usv_of| */

/* SHARED-GSI-USV-OF */
Object g2int_shared_gsi_usv_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    SI_Long value_type;

    x_note_fn_call(47,418);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_usv_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_usv_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_unsigned_short_vector_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_usv_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_usv_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    if ( !TRUEP(value_qm)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_item_has_no_value,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_usv_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_usv_of;
    }
    gsi_fc_result = value_qm;
    result_1 = g2int_lisp_string_to_c_unsigned_short_vector(gsi_fc_result);
  end_shared_gsi_usv_of:;
    return result_1;
}

static Object string_constant_161;  /* "gsi_usv_of" */

/* GSI-USV-OF */
DLLEXPORT Object gsi_usv_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,419);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_161);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_usv_of(G2int_gsi_wide_api_p,
		    gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_usv_of(G2int_gsi_wide_api_p,
			    gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_161);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_usv;  /* |gsi_set_usv| */

/* SHARED-GSI-SET-USV */
void g2int_shared_gsi_set_usv(gsi_structure,gsi_fc_outer_new_value,
	    gsi_fc_outer_length)
    Object gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_length;
{
    Object instance, instance_qm, length_1, new_value;
    Object old_gsi_instance_value_type_qm, old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long temp;

    x_note_fn_call(47,420);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_usv,Qerror,T);
	goto end_shared_gsi_set_usv;
    }
    instance_qm = instance;
    value = gsi_fc_outer_length;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_usv,Qerror,T);
	goto end_shared_gsi_set_usv;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_usv,Qerror,T);
	goto end_shared_gsi_set_usv;
    }
    length_1 = LONG_TO_FIXNUM(value);
    new_value = 
	    g2int_c_unsigned_short_vector_to_text_string(gsi_fc_outer_new_value,
	    length_1);
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_unsigned_short_vector_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_usv:;
}

static Object string_constant_162;  /* "gsi_set_usv" */

/* GSI-SET-USV */
DLLEXPORT void gsi_set_usv(gsi_structure,new_value,length_1)
    Object gsi_structure, new_value;
    SI_Long length_1;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,421);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_162);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_usv(gsi_structure,new_value,length_1);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_usv(gsi_structure,new_value,length_1);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_162);
}

static Object Qg2int_gsi_sym_of;   /* |gsi_sym_of| */

/* SHARED-GSI-SYM-OF */
Object g2int_shared_gsi_sym_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result, string_1;
    SI_Long value_type;

    x_note_fn_call(47,422);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_sym_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_sym_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_symbol_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_sym_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_sym_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    if ( !TRUEP(value_qm)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_item_has_no_value,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_sym_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_sym_of;
    }
    gsi_fc_result = value_qm;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
  end_shared_gsi_sym_of:;
    return result_1;
}

static Object string_constant_163;  /* "gsi_sym_of" */

/* GSI-SYM-OF */
DLLEXPORT Object gsi_sym_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,423);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_163);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_sym_of(G2int_gsi_wide_api_p,
		    gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_sym_of(G2int_gsi_wide_api_p,
			    gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_163);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_sym;  /* |gsi_set_sym| */

/* SHARED-GSI-SET-SYM */
void g2int_shared_gsi_set_sym(wide_api_p,gsi_structure,gsi_fc_outer_new_value)
    Object wide_api_p, gsi_structure, gsi_fc_outer_new_value;
{
    Object instance, instance_qm, arg_symbol, new_value;
    Object old_gsi_instance_value_type_qm, old_gsi_instance_value_qm, temp_1;
    SI_Long temp;

    x_note_fn_call(47,424);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_sym,Qerror,T);
	goto end_shared_gsi_set_sym;
    }
    instance_qm = instance;
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_new_value,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_sym,Qerror,T);
	goto end_shared_gsi_set_sym;
    }
    new_value = arg_symbol;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,G2int_gsi_symbol_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_sym:;
}

/* GSI-SET-SYM */
DLLEXPORT void gsi_set_sym(gsi_structure,new_value)
    Object gsi_structure, new_value;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,425);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_132);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_sym(G2int_gsi_wide_api_p,gsi_structure,
		    new_value);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_sym(G2int_gsi_wide_api_p,
			    gsi_structure,new_value);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_132);
}

static Object Qg2int_gsi_element_count_of;  /* |gsi_element_count_of| */

/* SHARED-GSI-ELEMENT-COUNT-OF */
SI_Long g2int_shared_gsi_element_count_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, gsi_instance_extension;
    SI_Long result_1;
    SI_Long type;
    SI_Long gsi_fc_result;

    x_note_fn_call(47,426);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_element_count_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_element_count_of;
    }
    type = IFIX(ISVREF(instance,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    gsi_fc_result = gsi_instance_extension ? 
	    FIXNUM_TO_LONG(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L;
    if (gsi_fc_result);
    else if ((type == IFIX(G2int_gsi_string_type_tag) || type == 
	    IFIX(G2int_gsi_unsigned_short_vector_type_tag)) && 
	    ISVREF(instance,(SI_Long)2L))
	gsi_fc_result = FIXNUM_TO_LONG(g2int_lengthw(ISVREF(instance,
		(SI_Long)2L)));
    else if (type == IFIX(G2int_gsi_symbol_type_tag) && ISVREF(instance,
	    (SI_Long)2L))
	gsi_fc_result = FIXNUM_TO_LONG(g2int_lengthw(G2int_gsi_wide_api_p ?
		 g2int_symbol_name_text_string(ISVREF(instance,
		(SI_Long)2L)) : SYMBOL_NAME(ISVREF(instance,(SI_Long)2L))));
    else
	gsi_fc_result = (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_element_count_of:;
    return result_1;
}

static Object string_constant_164;  /* "gsi_element_count_of" */

/* GSI-ELEMENT-COUNT-OF */
DLLEXPORT SI_Long gsi_element_count_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,427);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_164);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_element_count_of(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_element_count_of(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_164);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_element_count;  /* |gsi_set_element_count| */

/* SHARED-GSI-SET-ELEMENT-COUNT */
void g2int_shared_gsi_set_element_count(gsi_structure,
	    gsi_fc_outer_element_count)
    Object gsi_structure;
    SI_Long gsi_fc_outer_element_count;
{
    Object element_count, instance, gsi_instance_extension;
    SI_Long value;

    x_note_fn_call(47,428);
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_element_count,Qerror,T);
	goto end_shared_gsi_set_element_count;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_element_count,Qerror,T);
	goto end_shared_gsi_set_element_count;
    }
    element_count = LONG_TO_FIXNUM(value);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_element_count,Qerror,T);
	goto end_shared_gsi_set_element_count;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	instance = g2int_get_instance_for_write_1(gsi_structure);
	if (FIXNUMP(instance)) {
	    g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,
		    Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_element_count,Qerror,T);
	    goto end_shared_gsi_set_element_count;
	}
	SVREF(instance,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
  end_shared_gsi_set_element_count:;
}

static Object string_constant_165;  /* "gsi_set_element_count" */

/* GSI-SET-ELEMENT-COUNT */
DLLEXPORT void gsi_set_element_count(gsi_structure,element_count)
    Object gsi_structure;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,429);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_165);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_element_count(gsi_structure,element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_element_count(gsi_structure,
			    element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_165);
}

static Object Qg2int_gsi_int_array_of;  /* |gsi_int_array_of| */

/* SHARED-GSI-INT-ARRAY-OF */
Object g2int_shared_gsi_int_array_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    Object gsi_instance_extension;
    SI_Long value_type;

    x_note_fn_call(47,430);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_int_array_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_int_array_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_integer_array_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_int_array_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_int_array_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    gsi_fc_result = value_qm;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    result_1 = (gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L) > (SI_Long)0L ? 
	    inline_extract_c_long_array(gsi_fc_result) : Nil;
  end_shared_gsi_int_array_of:;
    return result_1;
}

static Object string_constant_166;  /* "gsi_int_array_of" */

/* GSI-INT-ARRAY-OF */
DLLEXPORT Object gsi_int_array_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,431);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_166);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_int_array_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_int_array_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_166);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_int_list_of;  /* |gsi_int_list_of| */

/* SHARED-GSI-INT-LIST-OF */
Object g2int_shared_gsi_int_list_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    Object gsi_instance_extension;
    SI_Long value_type;

    x_note_fn_call(47,432);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_int_list_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_int_list_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_integer_list_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_int_list_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_int_list_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    gsi_fc_result = value_qm;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    result_1 = (gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L) > (SI_Long)0L ? 
	    inline_extract_c_long_array(gsi_fc_result) : Nil;
  end_shared_gsi_int_list_of:;
    return result_1;
}

static Object string_constant_167;  /* "gsi_int_list_of" */

/* GSI-INT-LIST-OF */
DLLEXPORT Object gsi_int_list_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,433);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_167);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_int_list_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_int_list_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_167);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_int_array;  /* |gsi_set_int_array| */

/* SHARED-GSI-SET-INT-ARRAY */
void g2int_shared_gsi_set_int_array(gsi_structure,gsi_fc_outer_new_value,
	    gsi_fc_outer_element_count)
    Object gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_element_count;
{
    Object instance, instance_qm, element_count, gsi_instance_extension, array;
    Object new_value, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, value_1, aref_new_value, temp;

    x_note_fn_call(47,434);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_int_array,Qerror,T);
	goto end_shared_gsi_set_int_array;
    }
    instance_qm = instance;
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_int_array,Qerror,T);
	goto end_shared_gsi_set_int_array;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_int_array,Qerror,T);
	goto end_shared_gsi_set_int_array;
    }
    element_count = LONG_TO_FIXNUM(value);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    if ( !(IFIX(element_count) < (SI_Long)1L)) {
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	value_1 = inline_get_c_long_element(gsi_fc_outer_new_value,index_1);
	if (IFIX(Most_positive_fixnum) < value_1) {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_int_array,Qerror,T);
	    goto end_shared_gsi_set_int_array;
	}
	if (value_1 < IFIX(Most_negative_fixnum)) {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_int_array,Qerror,T);
	    goto end_shared_gsi_set_int_array;
	}
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	array = g2int_gsi_make_appropriate_array(3,
		G2int_gsi_integer_array_type_tag,element_count,instance_qm);
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop_1:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop_1;
	aref_new_value = inline_get_c_long_element(gsi_fc_outer_new_value,
		index_1);
	BYTE_32_ISASET_1(array,index_1,aref_new_value);
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop_1;
      end_loop_1:;
	new_value = array;
    }
    else
	new_value = Nil;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_integer_array_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_int_array:;
}

static Object string_constant_168;  /* "gsi_set_int_array" */

/* GSI-SET-INT-ARRAY */
DLLEXPORT void gsi_set_int_array(gsi_structure,new_value,element_count)
    Object gsi_structure, new_value;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,435);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_168);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_int_array(gsi_structure,new_value,
		    element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_int_array(gsi_structure,new_value,
			    element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_168);
}

static Object Qg2int_gsi_set_int_list;  /* |gsi_set_int_list| */

/* SHARED-GSI-SET-INT-LIST */
void g2int_shared_gsi_set_int_list(gsi_structure,gsi_fc_outer_new_value,
	    gsi_fc_outer_element_count)
    Object gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_element_count;
{
    Object instance, instance_qm, element_count, gsi_instance_extension, array;
    Object new_value, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, value_1, aref_new_value, temp;

    x_note_fn_call(47,436);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_int_list,Qerror,T);
	goto end_shared_gsi_set_int_list;
    }
    instance_qm = instance;
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_int_list,Qerror,T);
	goto end_shared_gsi_set_int_list;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_int_list,Qerror,T);
	goto end_shared_gsi_set_int_list;
    }
    element_count = LONG_TO_FIXNUM(value);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    if ( !(IFIX(element_count) < (SI_Long)1L)) {
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	value_1 = inline_get_c_long_element(gsi_fc_outer_new_value,index_1);
	if (IFIX(Most_positive_fixnum) < value_1) {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_int_list,Qerror,T);
	    goto end_shared_gsi_set_int_list;
	}
	if (value_1 < IFIX(Most_negative_fixnum)) {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_int_list,Qerror,T);
	    goto end_shared_gsi_set_int_list;
	}
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	array = g2int_gsi_make_appropriate_array(3,
		G2int_gsi_integer_array_type_tag,element_count,instance_qm);
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop_1:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop_1;
	aref_new_value = inline_get_c_long_element(gsi_fc_outer_new_value,
		index_1);
	BYTE_32_ISASET_1(array,index_1,aref_new_value);
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop_1;
      end_loop_1:;
	new_value = array;
    }
    else
	new_value = Nil;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_integer_list_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_int_list:;
}

static Object string_constant_169;  /* "gsi_set_int_list" */

/* GSI-SET-INT-LIST */
DLLEXPORT void gsi_set_int_list(gsi_structure,new_value,element_count)
    Object gsi_structure, new_value;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,437);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_169);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_int_list(gsi_structure,new_value,
		    element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_int_list(gsi_structure,new_value,
			    element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_169);
}

static Object Qg2int_gsi_flt_array_of;  /* |gsi_flt_array_of| */

/* SHARED-GSI-FLT-ARRAY-OF */
Object g2int_shared_gsi_flt_array_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    Object gsi_instance_extension;
    SI_Long value_type;

    x_note_fn_call(47,438);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_flt_array_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_flt_array_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_64bit_float_array_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_flt_array_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_flt_array_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    gsi_fc_result = value_qm;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    result_1 = (gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L) > (SI_Long)0L ? 
	    inline_extract_c_double_array(gsi_fc_result) : Nil;
  end_shared_gsi_flt_array_of:;
    return result_1;
}

static Object string_constant_170;  /* "gsi_flt_array_of" */

/* GSI-FLT-ARRAY-OF */
DLLEXPORT Object gsi_flt_array_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,439);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_170);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_flt_array_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_flt_array_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_170);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_flt_list_of;  /* |gsi_flt_list_of| */

/* SHARED-GSI-FLT-LIST-OF */
Object g2int_shared_gsi_flt_list_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    Object gsi_instance_extension;
    SI_Long value_type;

    x_note_fn_call(47,440);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_flt_list_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_flt_list_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_64bit_float_list_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_flt_list_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_flt_list_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    gsi_fc_result = value_qm;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    result_1 = (gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L) > (SI_Long)0L ? 
	    inline_extract_c_double_array(gsi_fc_result) : Nil;
  end_shared_gsi_flt_list_of:;
    return result_1;
}

static Object string_constant_171;  /* "gsi_flt_list_of" */

/* GSI-FLT-LIST-OF */
DLLEXPORT Object gsi_flt_list_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,441);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_171);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_flt_list_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_flt_list_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_171);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_flt_array;  /* |gsi_set_flt_array| */

/* SHARED-GSI-SET-FLT-ARRAY */
void g2int_shared_gsi_set_flt_array(gsi_structure,gsi_fc_outer_new_value,
	    gsi_fc_outer_element_count)
    Object gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_element_count;
{
    Object instance, instance_qm, element_count, gsi_instance_extension, array;
    Object new_value, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, temp;
    double aref_new_value;

    x_note_fn_call(47,442);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_flt_array,Qerror,T);
	goto end_shared_gsi_set_flt_array;
    }
    instance_qm = instance;
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_flt_array,Qerror,T);
	goto end_shared_gsi_set_flt_array;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_flt_array,Qerror,T);
	goto end_shared_gsi_set_flt_array;
    }
    element_count = LONG_TO_FIXNUM(value);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    if ( !(IFIX(element_count) < (SI_Long)1L)) {
	array = g2int_gsi_make_appropriate_array(3,
		G2int_gsi_64bit_float_array_type_tag,element_count,
		instance_qm);
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	aref_new_value = 
		inline_get_c_double_element(gsi_fc_outer_new_value,index_1);
	DFLOAT_ISASET_1(array,index_1,aref_new_value);
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	new_value = array;
    }
    else
	new_value = Nil;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_64bit_float_array_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_flt_array:;
}

static Object string_constant_172;  /* "gsi_set_flt_array" */

/* GSI-SET-FLT-ARRAY */
DLLEXPORT void gsi_set_flt_array(gsi_structure,new_value,element_count)
    Object gsi_structure, new_value;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,443);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_172);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_flt_array(gsi_structure,new_value,
		    element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_flt_array(gsi_structure,new_value,
			    element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_172);
}

static Object Qg2int_gsi_set_flt_list;  /* |gsi_set_flt_list| */

/* SHARED-GSI-SET-FLT-LIST */
void g2int_shared_gsi_set_flt_list(gsi_structure,gsi_fc_outer_new_value,
	    gsi_fc_outer_element_count)
    Object gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_element_count;
{
    Object instance, instance_qm, element_count, gsi_instance_extension, array;
    Object new_value, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, temp;
    double aref_new_value;

    x_note_fn_call(47,444);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_flt_list,Qerror,T);
	goto end_shared_gsi_set_flt_list;
    }
    instance_qm = instance;
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_flt_list,Qerror,T);
	goto end_shared_gsi_set_flt_list;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_flt_list,Qerror,T);
	goto end_shared_gsi_set_flt_list;
    }
    element_count = LONG_TO_FIXNUM(value);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    if ( !(IFIX(element_count) < (SI_Long)1L)) {
	array = g2int_gsi_make_appropriate_array(3,
		G2int_gsi_64bit_float_array_type_tag,element_count,
		instance_qm);
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	aref_new_value = 
		inline_get_c_double_element(gsi_fc_outer_new_value,index_1);
	DFLOAT_ISASET_1(array,index_1,aref_new_value);
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	new_value = array;
    }
    else
	new_value = Nil;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_64bit_float_list_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_flt_list:;
}

static Object string_constant_173;  /* "gsi_set_flt_list" */

/* GSI-SET-FLT-LIST */
DLLEXPORT void gsi_set_flt_list(gsi_structure,new_value,element_count)
    Object gsi_structure, new_value;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,445);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_173);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_flt_list(gsi_structure,new_value,
		    element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_flt_list(gsi_structure,new_value,
			    element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_173);
}

static Object Qg2int_gsi_log_array_of;  /* |gsi_log_array_of| */

/* SHARED-GSI-LOG-ARRAY-OF */
Object g2int_shared_gsi_log_array_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    Object gsi_instance_extension;
    SI_Long value_type;

    x_note_fn_call(47,446);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_log_array_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_log_array_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_logical_array_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_log_array_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_log_array_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    gsi_fc_result = value_qm;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    result_1 = (gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L) > (SI_Long)0L ? 
	    inline_extract_c_long_array(gsi_fc_result) : Nil;
  end_shared_gsi_log_array_of:;
    return result_1;
}

static Object string_constant_174;  /* "gsi_log_array_of" */

/* GSI-LOG-ARRAY-OF */
DLLEXPORT Object gsi_log_array_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,447);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_174);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_log_array_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_log_array_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_174);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_log_list_of;  /* |gsi_log_list_of| */

/* SHARED-GSI-LOG-LIST-OF */
Object g2int_shared_gsi_log_list_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    Object gsi_instance_extension;
    SI_Long value_type;

    x_note_fn_call(47,448);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_log_list_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_log_list_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_logical_list_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_log_list_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_log_list_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    gsi_fc_result = value_qm;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    result_1 = (gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L) > (SI_Long)0L ? 
	    inline_extract_c_long_array(gsi_fc_result) : Nil;
  end_shared_gsi_log_list_of:;
    return result_1;
}

static Object string_constant_175;  /* "gsi_log_list_of" */

/* GSI-LOG-LIST-OF */
DLLEXPORT Object gsi_log_list_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,449);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_175);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_log_list_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_log_list_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_175);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_log_array;  /* |gsi_set_log_array| */

/* SHARED-GSI-SET-LOG-ARRAY */
void g2int_shared_gsi_set_log_array(gsi_structure,gsi_fc_outer_new_value,
	    gsi_fc_outer_element_count)
    Object gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_element_count;
{
    Object instance, instance_qm, element_count, gsi_instance_extension, array;
    Object new_value, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, aref_new_value, temp;

    x_note_fn_call(47,450);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_log_array,Qerror,T);
	goto end_shared_gsi_set_log_array;
    }
    instance_qm = instance;
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_log_array,Qerror,T);
	goto end_shared_gsi_set_log_array;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_log_array,Qerror,T);
	goto end_shared_gsi_set_log_array;
    }
    element_count = LONG_TO_FIXNUM(value);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    if ( !(IFIX(element_count) < (SI_Long)1L)) {
	array = g2int_gsi_make_appropriate_array(3,
		G2int_gsi_logical_array_type_tag,element_count,instance_qm);
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	aref_new_value = inline_get_c_long_element(gsi_fc_outer_new_value,
		index_1);
	BYTE_32_ISASET_1(array,index_1,aref_new_value);
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	new_value = array;
    }
    else
	new_value = Nil;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_logical_array_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_log_array:;
}

static Object string_constant_176;  /* "gsi_set_log_array" */

/* GSI-SET-LOG-ARRAY */
DLLEXPORT void gsi_set_log_array(gsi_structure,new_value,element_count)
    Object gsi_structure, new_value;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,451);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_176);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_log_array(gsi_structure,new_value,
		    element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_log_array(gsi_structure,new_value,
			    element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_176);
}

static Object Qg2int_gsi_set_log_list;  /* |gsi_set_log_list| */

/* SHARED-GSI-SET-LOG-LIST */
void g2int_shared_gsi_set_log_list(gsi_structure,gsi_fc_outer_new_value,
	    gsi_fc_outer_element_count)
    Object gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_element_count;
{
    Object instance, instance_qm, element_count, gsi_instance_extension, array;
    Object new_value, old_gsi_instance_value_type_qm;
    Object old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, aref_new_value, temp;

    x_note_fn_call(47,452);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_log_list,Qerror,T);
	goto end_shared_gsi_set_log_list;
    }
    instance_qm = instance;
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_log_list,Qerror,T);
	goto end_shared_gsi_set_log_list;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_log_list,Qerror,T);
	goto end_shared_gsi_set_log_list;
    }
    element_count = LONG_TO_FIXNUM(value);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    if ( !(IFIX(element_count) < (SI_Long)1L)) {
	array = g2int_gsi_make_appropriate_array(3,
		G2int_gsi_logical_array_type_tag,element_count,instance_qm);
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	aref_new_value = inline_get_c_long_element(gsi_fc_outer_new_value,
		index_1);
	BYTE_32_ISASET_1(array,index_1,aref_new_value);
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	new_value = array;
    }
    else
	new_value = Nil;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_logical_list_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_log_list:;
}

static Object string_constant_177;  /* "gsi_set_log_list" */

/* GSI-SET-LOG-LIST */
DLLEXPORT void gsi_set_log_list(gsi_structure,new_value,element_count)
    Object gsi_structure, new_value;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,453);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_177);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_log_list(gsi_structure,new_value,
		    element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_log_list(gsi_structure,new_value,
			    element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_177);
}

static Object Qg2int_gsi_sym_array_of;  /* |gsi_sym_array_of| */

/* SHARED-GSI-SYM-ARRAY-OF */
Object g2int_shared_gsi_sym_array_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    Object gsi_instance_extension;
    SI_Long value_type;

    x_note_fn_call(47,454);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_sym_array_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_sym_array_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_symbol_array_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_sym_array_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_sym_array_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    gsi_fc_result = value_qm;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    result_1 = (gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L) > (SI_Long)0L ? 
	    inline_extract_c_long_array(gsi_fc_result) : Nil;
  end_shared_gsi_sym_array_of:;
    return result_1;
}

static Object string_constant_178;  /* "gsi_sym_array_of" */

/* GSI-SYM-ARRAY-OF */
DLLEXPORT Object gsi_sym_array_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,455);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_178);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_sym_array_of(G2int_gsi_wide_api_p,
		    gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_sym_array_of(G2int_gsi_wide_api_p,
			    gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_178);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_sym_list_of;  /* |gsi_sym_list_of| */

/* SHARED-GSI-SYM-LIST-OF */
Object g2int_shared_gsi_sym_list_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    Object gsi_instance_extension;
    SI_Long value_type;

    x_note_fn_call(47,456);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_sym_list_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_sym_list_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_symbol_list_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_sym_list_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_sym_list_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    gsi_fc_result = value_qm;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    result_1 = (gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L) > (SI_Long)0L ? 
	    inline_extract_c_long_array(gsi_fc_result) : Nil;
  end_shared_gsi_sym_list_of:;
    return result_1;
}

static Object string_constant_179;  /* "gsi_sym_list_of" */

/* GSI-SYM-LIST-OF */
DLLEXPORT Object gsi_sym_list_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,457);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_179);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_sym_list_of(G2int_gsi_wide_api_p,
		    gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_sym_list_of(G2int_gsi_wide_api_p,
			    gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_179);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_sym_array;  /* |gsi_set_sym_array| */

/* SHARED-GSI-SET-SYM-ARRAY */
void g2int_shared_gsi_set_sym_array(wide_api_p,gsi_structure,
	    gsi_fc_outer_new_value,gsi_fc_outer_element_count)
    Object wide_api_p, gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_element_count;
{
    Object instance, instance_qm, element_count, gsi_instance_extension, array;
    Object svref_new_value, api_c_string, symbol, new_value;
    Object old_gsi_instance_value_type_qm, old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, temp;

    x_note_fn_call(47,458);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_sym_array,Qerror,T);
	goto end_shared_gsi_set_sym_array;
    }
    instance_qm = instance;
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_sym_array,Qerror,T);
	goto end_shared_gsi_set_sym_array;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_sym_array,Qerror,T);
	goto end_shared_gsi_set_sym_array;
    }
    element_count = LONG_TO_FIXNUM(value);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    if ( !(IFIX(element_count) < (SI_Long)1L)) {
	array = g2int_gsi_make_appropriate_array(3,
		G2int_gsi_symbol_array_type_tag,element_count,instance_qm);
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	    svref_new_value = 
		    inline_get_c_char_ptr_element(gsi_fc_outer_new_value,
		    FIX(index_1));
	else {
	    api_c_string = wide_api_p ? 
		    inline_get_c_wide_char_ptr_element(gsi_fc_outer_new_value,
		    FIX(index_1)) : 
		    inline_get_c_char_ptr_element(gsi_fc_outer_new_value,
		    FIX(index_1));
	    symbol =  !TRUEP(api_c_string) ? Nil : 
		    g2int_symbol_for_gsi_string(wide_api_p ? 
		    g2int_c_wide_string_to_text_string(api_c_string) : 
		    g2int_c_string_to_gensym_string(api_c_string));
	    svref_new_value = 
		    inline_extract_c_string(g2int_gsi_string_for_symbol(symbol,
		    G2int_gsi_wide_api_p));
	}
	ISVREF(array,index_1) = svref_new_value;
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	new_value = array;
    }
    else
	new_value = Nil;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_symbol_array_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_sym_array:;
}

static Object string_constant_180;  /* "gsi_set_sym_array" */

/* GSI-SET-SYM-ARRAY */
DLLEXPORT void gsi_set_sym_array(gsi_structure,new_value,element_count)
    Object gsi_structure, new_value;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,459);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_180);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_sym_array(G2int_gsi_wide_api_p,
		    gsi_structure,new_value,element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_sym_array(G2int_gsi_wide_api_p,
			    gsi_structure,new_value,element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_180);
}

static Object Qg2int_gsi_set_sym_list;  /* |gsi_set_sym_list| */

/* SHARED-GSI-SET-SYM-LIST */
void g2int_shared_gsi_set_sym_list(wide_api_p,gsi_structure,
	    gsi_fc_outer_new_value,gsi_fc_outer_element_count)
    Object wide_api_p, gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_element_count;
{
    Object instance, instance_qm, element_count, gsi_instance_extension, array;
    Object svref_new_value, api_c_string, symbol, new_value;
    Object old_gsi_instance_value_type_qm, old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, temp;

    x_note_fn_call(47,460);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_sym_list,Qerror,T);
	goto end_shared_gsi_set_sym_list;
    }
    instance_qm = instance;
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_sym_list,Qerror,T);
	goto end_shared_gsi_set_sym_list;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_sym_list,Qerror,T);
	goto end_shared_gsi_set_sym_list;
    }
    element_count = LONG_TO_FIXNUM(value);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    if ( !(IFIX(element_count) < (SI_Long)1L)) {
	array = g2int_gsi_make_appropriate_array(3,
		G2int_gsi_symbol_array_type_tag,element_count,instance_qm);
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	    svref_new_value = 
		    inline_get_c_char_ptr_element(gsi_fc_outer_new_value,
		    FIX(index_1));
	else {
	    api_c_string = wide_api_p ? 
		    inline_get_c_wide_char_ptr_element(gsi_fc_outer_new_value,
		    FIX(index_1)) : 
		    inline_get_c_char_ptr_element(gsi_fc_outer_new_value,
		    FIX(index_1));
	    symbol =  !TRUEP(api_c_string) ? Nil : 
		    g2int_symbol_for_gsi_string(wide_api_p ? 
		    g2int_c_wide_string_to_text_string(api_c_string) : 
		    g2int_c_string_to_gensym_string(api_c_string));
	    svref_new_value = 
		    inline_extract_c_string(g2int_gsi_string_for_symbol(symbol,
		    G2int_gsi_wide_api_p));
	}
	ISVREF(array,index_1) = svref_new_value;
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	new_value = array;
    }
    else
	new_value = Nil;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_symbol_list_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_sym_list:;
}

static Object string_constant_181;  /* "gsi_set_sym_list" */

/* GSI-SET-SYM-LIST */
DLLEXPORT void gsi_set_sym_list(gsi_structure,new_value,element_count)
    Object gsi_structure, new_value;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,461);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_181);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_sym_list(G2int_gsi_wide_api_p,
		    gsi_structure,new_value,element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_sym_list(G2int_gsi_wide_api_p,
			    gsi_structure,new_value,element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_181);
}

static Object Qg2int_gsi_str_array_of;  /* |gsi_str_array_of| */

/* SHARED-GSI-STR-ARRAY-OF */
Object g2int_shared_gsi_str_array_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    Object gsi_instance_extension;
    SI_Long value_type;

    x_note_fn_call(47,462);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_str_array_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_str_array_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_string_array_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_str_array_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_str_array_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    gsi_fc_result = value_qm;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    result_1 = (gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L) > (SI_Long)0L ? 
	    inline_extract_c_long_array(gsi_fc_result) : Nil;
  end_shared_gsi_str_array_of:;
    return result_1;
}

static Object string_constant_182;  /* "gsi_str_array_of" */

/* GSI-STR-ARRAY-OF */
DLLEXPORT Object gsi_str_array_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,463);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_182);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_str_array_of(G2int_gsi_wide_api_p,
		    gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_str_array_of(G2int_gsi_wide_api_p,
			    gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_182);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_str_list_of;  /* |gsi_str_list_of| */

/* SHARED-GSI-STR-LIST-OF */
Object g2int_shared_gsi_str_list_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object instance, result_1, instance_qm, value_qm, gsi_fc_result;
    Object gsi_instance_extension;
    SI_Long value_type;

    x_note_fn_call(47,464);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_str_list_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_str_list_of;
    }
    instance_qm = instance;
    value_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !EQ(FIX(value_type),G2int_gsi_string_list_type_tag)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(value_type),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_str_list_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_str_list_of;
    }
    value_qm = ISVREF(instance_qm,(SI_Long)2L);
    gsi_fc_result = value_qm;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    result_1 = (gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)7L)) : 
	    (SI_Long)0L) > (SI_Long)0L ? 
	    inline_extract_c_long_array(gsi_fc_result) : Nil;
  end_shared_gsi_str_list_of:;
    return result_1;
}

static Object string_constant_183;  /* "gsi_str_list_of" */

/* GSI-STR-LIST-OF */
DLLEXPORT Object gsi_str_list_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,465);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_183);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_str_list_of(G2int_gsi_wide_api_p,
		    gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_str_list_of(G2int_gsi_wide_api_p,
			    gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_183);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_str_array;  /* |gsi_set_str_array| */

/* SHARED-GSI-SET-STR-ARRAY */
void g2int_shared_gsi_set_str_array(wide_api_p,gsi_structure,
	    gsi_fc_outer_new_value,gsi_fc_outer_element_count)
    Object wide_api_p, gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_element_count;
{
    Object instance, instance_qm, element_count, gsi_instance_extension, array;
    Object api_c_string, svref_new_value, new_value;
    Object old_gsi_instance_value_type_qm, old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, temp;

    x_note_fn_call(47,466);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_str_array,Qerror,T);
	goto end_shared_gsi_set_str_array;
    }
    instance_qm = instance;
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_str_array,Qerror,T);
	goto end_shared_gsi_set_str_array;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_str_array,Qerror,T);
	goto end_shared_gsi_set_str_array;
    }
    element_count = LONG_TO_FIXNUM(value);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    if ( !(IFIX(element_count) < (SI_Long)1L)) {
	array = g2int_gsi_make_appropriate_array(3,
		G2int_gsi_string_array_type_tag,element_count,instance_qm);
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	api_c_string = wide_api_p ? 
		inline_get_c_wide_char_ptr_element(gsi_fc_outer_new_value,
		FIX(index_1)) : 
		inline_get_c_char_ptr_element(gsi_fc_outer_new_value,
		FIX(index_1));
	svref_new_value = inline_extract_c_string(wide_api_p ? 
		g2int_c_wide_string_to_gsi_string(api_c_string) : 
		g2int_c_string_to_gsi_string(api_c_string));
	ISVREF(array,index_1) = svref_new_value;
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	new_value = array;
    }
    else
	new_value = Nil;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_string_array_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_str_array:;
}

static Object string_constant_184;  /* "gsi_set_str_array" */

/* GSI-SET-STR-ARRAY */
DLLEXPORT void gsi_set_str_array(gsi_structure,new_value,element_count)
    Object gsi_structure, new_value;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,467);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_184);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_str_array(G2int_gsi_wide_api_p,
		    gsi_structure,new_value,element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_str_array(G2int_gsi_wide_api_p,
			    gsi_structure,new_value,element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_184);
}

static Object Qg2int_gsi_set_str_list;  /* |gsi_set_str_list| */

/* SHARED-GSI-SET-STR-LIST */
void g2int_shared_gsi_set_str_list(wide_api_p,gsi_structure,
	    gsi_fc_outer_new_value,gsi_fc_outer_element_count)
    Object wide_api_p, gsi_structure, gsi_fc_outer_new_value;
    SI_Long gsi_fc_outer_element_count;
{
    Object instance, instance_qm, element_count, gsi_instance_extension, array;
    Object api_c_string, svref_new_value, new_value;
    Object old_gsi_instance_value_type_qm, old_gsi_instance_value_qm, temp_1;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, temp;

    x_note_fn_call(47,468);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_str_list,Qerror,T);
	goto end_shared_gsi_set_str_list;
    }
    instance_qm = instance;
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_str_list,Qerror,T);
	goto end_shared_gsi_set_str_list;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_str_list,Qerror,T);
	goto end_shared_gsi_set_str_list;
    }
    element_count = LONG_TO_FIXNUM(value);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    if ( !(IFIX(element_count) < (SI_Long)1L)) {
	array = g2int_gsi_make_appropriate_array(3,
		G2int_gsi_string_array_type_tag,element_count,instance_qm);
	index_1 = (SI_Long)0L;
	ab_loop_bind_ = IFIX(element_count);
      next_loop:
	if (index_1 >= ab_loop_bind_)
	    goto end_loop;
	api_c_string = wide_api_p ? 
		inline_get_c_wide_char_ptr_element(gsi_fc_outer_new_value,
		FIX(index_1)) : 
		inline_get_c_char_ptr_element(gsi_fc_outer_new_value,
		FIX(index_1));
	svref_new_value = inline_extract_c_string(wide_api_p ? 
		g2int_c_wide_string_to_gsi_string(api_c_string) : 
		g2int_c_string_to_gsi_string(api_c_string));
	ISVREF(array,index_1) = svref_new_value;
	index_1 = index_1 + (SI_Long)1L;
	goto next_loop;
      end_loop:;
	new_value = array;
    }
    else
	new_value = Nil;
    old_gsi_instance_value_type_qm = instance_qm ? 
	    FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
	    (SI_Long)3L) : Nil;
    old_gsi_instance_value_qm = old_gsi_instance_value_type_qm ? 
	    ISVREF(instance_qm,(SI_Long)2L) : Nil;
    g2int_set_gsi_instance_value_type(instance_qm,
	    G2int_gsi_string_list_type_tag);
    SVREF(instance_qm,FIX((SI_Long)2L)) = new_value;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    temp = IFIX(ISVREF(instance_qm,(SI_Long)1L)) & (SI_Long)7L;
    if ( !((SI_Long)-128L <= temp && temp <= (SI_Long)127L))
	temp_1 = Nil;
    else
	switch ((char)temp) {
	  case 0:
	    temp_1 = Qg2int_gsi;
	    break;
	  case 1:
	    temp_1 = Qg2int_user;
	    break;
	  case 2:
	    temp_1 = Qg2int_context;
	    break;
	  case 3:
	    temp_1 = Qg2int_gsi_event_queue;
	    break;
	  case 4:
	    temp_1 = Qg2int_gsi_input_queue;
	    break;
	  default:
	    temp_1 = Nil;
	    break;
	}
    g2int_reclaim_gsi_instance_value(old_gsi_instance_value_type_qm,
	    old_gsi_instance_value_qm,instance_qm,temp_1);
  end_shared_gsi_set_str_list:;
}

static Object string_constant_185;  /* "gsi_set_str_list" */

/* GSI-SET-STR-LIST */
DLLEXPORT void gsi_set_str_list(gsi_structure,new_value,element_count)
    Object gsi_structure, new_value;
    SI_Long element_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,469);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_185);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_str_list(G2int_gsi_wide_api_p,
		    gsi_structure,new_value,element_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_str_list(G2int_gsi_wide_api_p,
			    gsi_structure,new_value,element_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_185);
}

static Object Qg2int_gsi_elements_of;  /* |gsi_elements_of| */

/* SHARED-GSI-ELEMENTS-OF */
Object g2int_shared_gsi_elements_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, result_1, instance_qm, gsi_fc_result;
    Object gsi_instance_extension, svref_new_value;
    SI_Long instance_type;

    x_note_fn_call(47,470);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_elements_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_elements_of;
    }
    instance_qm = instance;
    instance_type = IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !(EQ(FIX(instance_type),G2int_gsi_value_array_type_tag) || 
	    EQ(FIX(instance_type),G2int_gsi_value_list_type_tag) || 
	    EQ(FIX(instance_type),G2int_gsi_item_array_type_tag) || 
	    EQ(FIX(instance_type),G2int_gsi_item_list_type_tag) || 
	    EQ(FIX(instance_type),G2int_gsi_quantity_array_type_tag) || 
	    EQ(FIX(instance_type),G2int_gsi_quantity_list_type_tag) || 
	    EQ(FIX(instance_type),G2int_gsi_item_or_value_array_type_tag) 
	    || EQ(FIX(instance_type),
	    G2int_gsi_item_or_value_list_type_tag) || 
	    EQ(FIX(instance_type),G2int_gsi_sequence_type_tag))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		FIX(IFIX(ISVREF(instance_qm,(SI_Long)1L)) >>  -  - 
		(SI_Long)3L),Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_elements_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_elements_of;
    }
    gsi_fc_result = ISVREF(instance_qm,(SI_Long)2L);
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ((gsi_instance_extension ? IFIX(ISVREF(gsi_instance_extension,
	    (SI_Long)7L)) : (SI_Long)0L) > (SI_Long)0L) {
	svref_new_value = G2int_gsi_magic_number;
	SVREF(gsi_fc_result,FIX((SI_Long)0L)) = svref_new_value;
	result_1 = inline_extract_c_array(gsi_fc_result,
		G2int_gsi_magic_offset);
    }
    else
	result_1 = Nil;
  end_shared_gsi_elements_of:;
    return result_1;
}

static Object string_constant_186;  /* "gsi_elements_of" */

/* GSI-ELEMENTS-OF */
DLLEXPORT Object gsi_elements_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,471);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_186);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_elements_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_elements_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_186);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_elements;  /* |gsi_set_elements| */

/* SHARED-GSI-SET-ELEMENTS */
void g2int_shared_gsi_set_elements(gsi_structure,
	    gsi_fc_outer_element_array,gsi_fc_outer_element_count,
	    gsi_fc_outer_type_tag)
    Object gsi_structure, gsi_fc_outer_element_array;
    SI_Long gsi_fc_outer_element_count, gsi_fc_outer_type_tag;
{
    Object element_count, type_tag, magic_number, array, array_size;
    Object array_element_count, element_array, instance, instance_qm;
    Object gsi_instance_extension;
    SI_Long value;

    x_note_fn_call(47,472);
    value = gsi_fc_outer_element_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_elements,Qerror,T);
	goto end_shared_gsi_set_elements;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_elements,Qerror,T);
	goto end_shared_gsi_set_elements;
    }
    element_count = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_type_tag;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_elements,Qerror,T);
	goto end_shared_gsi_set_elements;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_elements,Qerror,T);
	goto end_shared_gsi_set_elements;
    }
    type_tag = LONG_TO_FIXNUM(value);
    if (IFIX(element_count) > (SI_Long)0L) {
	magic_number = inline_gsi_get_magic_header(gsi_fc_outer_element_array);
	if (IFIX(magic_number) == (SI_Long)5472500L)
	    array = inline_get_array_from_c(gsi_fc_outer_element_array,
		    G2int_gsi_magic_offset);
	else {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_bad_magic_number,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_elements,Qerror,T);
	    goto end_shared_gsi_set_elements;
	}
	array_size = g2int_gsi_managed_array_length(array);
	array_element_count = FIXNUM_SUB1(array_size);
	if (FIXNUM_GT(element_count,array_element_count)) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_count_out_of_array_bounds,element_count,
		    array_element_count,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_elements,Qerror,T);
	    goto end_shared_gsi_set_elements;
	}
	element_array = array;
    }
    else
	element_array = Nil;
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_elements,Qerror,T);
	goto end_shared_gsi_set_elements;
    }
    instance_qm = instance;
    if ( !(FIXNUM_EQ(type_tag,G2int_gsi_value_array_type_tag) || 
	    FIXNUM_EQ(type_tag,G2int_gsi_item_array_type_tag) || 
	    FIXNUM_EQ(type_tag,G2int_gsi_value_list_type_tag) || 
	    FIXNUM_EQ(type_tag,G2int_gsi_item_list_type_tag) || 
	    FIXNUM_EQ(type_tag,G2int_gsi_quantity_array_type_tag) || 
	    FIXNUM_EQ(type_tag,G2int_gsi_quantity_list_type_tag) || 
	    FIXNUM_EQ(type_tag,G2int_gsi_item_or_value_array_type_tag) || 
	    FIXNUM_EQ(type_tag,G2int_gsi_item_or_value_list_type_tag) || 
	    FIXNUM_EQ(type_tag,G2int_gsi_sequence_type_tag))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,
		type_tag,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_elements,Qerror,T);
	goto end_shared_gsi_set_elements;
    }
    SVREF(instance_qm,FIX((SI_Long)2L)) = element_array;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance_qm,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)7L)) = element_count;
    g2int_set_gsi_instance_value_type(instance_qm,type_tag);
  end_shared_gsi_set_elements:;
}

static Object string_constant_187;  /* "gsi_set_elements" */

/* GSI-SET-ELEMENTS */
DLLEXPORT void gsi_set_elements(gsi_structure,element_array,element_count,
	    type_tag)
    Object gsi_structure, element_array;
    SI_Long element_count, type_tag;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,473);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_187);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_elements(gsi_structure,element_array,
		    element_count,type_tag);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_elements(gsi_structure,
			    element_array,element_count,type_tag);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_187);
}

static Object Qg2int_gsi_attr_count_of;  /* |gsi_attr_count_of| */

/* SHARED-GSI-ATTR-COUNT-OF */
SI_Long g2int_shared_gsi_attr_count_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, gsi_instance_extension;
    SI_Long result_1, gsi_fc_result;

    x_note_fn_call(47,474);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_count_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_attr_count_of;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    gsi_fc_result = gsi_instance_extension ? 
	    FIXNUM_TO_LONG(ISVREF(gsi_instance_extension,(SI_Long)9L)) : 
	    (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_attr_count_of:;
    return result_1;
}

static Object string_constant_188;  /* "gsi_attr_count_of" */

/* GSI-ATTR-COUNT-OF */
DLLEXPORT SI_Long gsi_attr_count_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,475);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_188);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_attr_count_of(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_attr_count_of(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_188);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_attr_count;  /* |gsi_set_attr_count| */

/* SHARED-GSI-SET-ATTR-COUNT */
void g2int_shared_gsi_set_attr_count(gsi_structure,
	    gsi_fc_outer_attribute_count)
    Object gsi_structure;
    SI_Long gsi_fc_outer_attribute_count;
{
    Object attribute_count, instance, gsi_instance_extension, attributes;
    Object array_count;
    SI_Long value;

    x_note_fn_call(47,476);
    value = gsi_fc_outer_attribute_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_count,Qerror,T);
	goto end_shared_gsi_set_attr_count;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_count,Qerror,T);
	goto end_shared_gsi_set_attr_count;
    }
    attribute_count = LONG_TO_FIXNUM(value);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_count,Qerror,T);
	goto end_shared_gsi_set_attr_count;
    }
    if (IFIX(attribute_count) > (SI_Long)0L) {
	gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
	attributes = gsi_instance_extension ? 
		ISVREF(gsi_instance_extension,(SI_Long)8L) : Nil;
	array_count = length(attributes);
	if (FIXNUM_GT(attribute_count,FIXNUM_SUB1(array_count))) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_count_out_of_array_bounds,attribute_count,
		    FIXNUM_SUB1(array_count),Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_count,Qerror,T);
	    goto end_shared_gsi_set_attr_count;
	}
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)9L)) = attribute_count;
  end_shared_gsi_set_attr_count:;
}

static Object string_constant_189;  /* "gsi_set_attr_count" */

/* GSI-SET-ATTR-COUNT */
DLLEXPORT void gsi_set_attr_count(gsi_structure,attribute_count)
    Object gsi_structure;
    SI_Long attribute_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,477);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_189);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_attr_count(gsi_structure,attribute_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_attr_count(gsi_structure,
			    attribute_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_189);
}

static Object Qg2int_gsi_attrs_of;  /* |gsi_attrs_of| */

/* SHARED-GSI-ATTRS-OF */
Object g2int_shared_gsi_attrs_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, result_1, instance_qm, gsi_instance_extension;
    Object gsi_fc_result, attributes, magic_number_qm;

    x_note_fn_call(47,478);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attrs_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_attrs_of;
    }
    instance_qm = instance;
    gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
    if ((gsi_instance_extension ? IFIX(ISVREF(gsi_instance_extension,
	    (SI_Long)9L)) : (SI_Long)0L) < (SI_Long)1L)
	gsi_fc_result = Nil;
    else {
	gsi_instance_extension = ISVREF(instance_qm,(SI_Long)3L);
	attributes = gsi_instance_extension ? 
		ISVREF(gsi_instance_extension,(SI_Long)8L) : Nil;
	magic_number_qm = ISVREF(attributes,(SI_Long)0L);
	if ( !(FIXNUMP(magic_number_qm) && FIXNUM_EQ(magic_number_qm,
		G2int_gsi_magic_number))) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_bad_magic_number_in_query,Nil,Nil,Nil,Nil,
		    Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_attrs_of,Qerror,T);
	    result_1 = Qnil;
	    goto end_shared_gsi_attrs_of;
	}
	gsi_fc_result = inline_extract_c_array(attributes,
		G2int_gsi_magic_offset);
    }
    result_1 = gsi_fc_result;
  end_shared_gsi_attrs_of:;
    return result_1;
}

static Object string_constant_190;  /* "gsi_attrs_of" */

/* GSI-ATTRS-OF */
DLLEXPORT Object gsi_attrs_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,479);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_190);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_attrs_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_attrs_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_190);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_attrs;  /* |gsi_set_attrs| */

/* SHARED-GSI-SET-ATTRS */
void g2int_shared_gsi_set_attrs(gsi_structure,gsi_fc_outer_attribute_array,
	    gsi_fc_outer_attribute_count)
    Object gsi_structure, gsi_fc_outer_attribute_array;
    SI_Long gsi_fc_outer_attribute_count;
{
    Object attribute_count, magic_number, array, array_size;
    Object array_element_count, attribute_array, instance;
    Object gsi_instance_extension;
    SI_Long value;

    x_note_fn_call(47,480);
    value = gsi_fc_outer_attribute_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attrs,Qerror,T);
	goto end_shared_gsi_set_attrs;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attrs,Qerror,T);
	goto end_shared_gsi_set_attrs;
    }
    attribute_count = LONG_TO_FIXNUM(value);
    if (IFIX(attribute_count) > (SI_Long)0L) {
	magic_number = 
		inline_gsi_get_magic_header(gsi_fc_outer_attribute_array);
	if (IFIX(magic_number) == (SI_Long)5472500L)
	    array = inline_get_array_from_c(gsi_fc_outer_attribute_array,
		    G2int_gsi_magic_offset);
	else {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_bad_magic_number,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_attrs,Qerror,T);
	    goto end_shared_gsi_set_attrs;
	}
	array_size = g2int_gsi_managed_array_length(array);
	array_element_count = FIXNUM_SUB1(array_size);
	if (FIXNUM_GT(attribute_count,array_element_count)) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_count_out_of_array_bounds,attribute_count,
		    array_element_count,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_attrs,Qerror,T);
	    goto end_shared_gsi_set_attrs;
	}
	attribute_array = array;
    }
    else
	attribute_array = Nil;
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attrs,Qerror,T);
	goto end_shared_gsi_set_attrs;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)8L)) = attribute_array;
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)9L)) = attribute_count;
  end_shared_gsi_set_attrs:;
}

static Object string_constant_191;  /* "gsi_set_attrs" */

/* GSI-SET-ATTRS */
DLLEXPORT void gsi_set_attrs(gsi_structure,attribute_array,attribute_count)
    Object gsi_structure, attribute_array;
    SI_Long attribute_count;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,481);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_191);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_attrs(gsi_structure,attribute_array,
		    attribute_count);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_attrs(gsi_structure,
			    attribute_array,attribute_count);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_191);
}

/* LOOKUP-ATTR-BY-NAME-1 */
Object g2int_lookup_attr_by_name_1(enclosing_instance_qm,search_name)
    Object enclosing_instance_qm, search_name;
{
    Object gsi_instance_extension, attributes, attribute, attribute_name;
    SI_Long i, gensymed_symbol, gensymed_symbol_1, ab_loop_bind_;

    x_note_fn_call(47,482);
    gsi_instance_extension = ISVREF(enclosing_instance_qm,(SI_Long)3L);
    attributes = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)8L) : Nil;
    i = IFIX(G2int_gsi_magic_offset);
    gsi_instance_extension = ISVREF(enclosing_instance_qm,(SI_Long)3L);
    gensymed_symbol = gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)9L)) : (SI_Long)0L;
    gensymed_symbol_1 = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = gensymed_symbol + gensymed_symbol_1;
    attribute = Nil;
    attribute_name = Nil;
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    attribute = ISVREF(attributes,i);
    attribute_name = g2int_gsi_attribute_qualified_name(attribute);
    if (EQ(search_name,attribute_name))
	return VALUES_3(attribute,attributes,FIX(i));
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:
    return VALUES_1(Qnil);
}

static Object Qg2int_class_qualified_name;  /* class-qualified-name */

/* GSI-GET-ITEM-OF-ATTRIBUTE-NAMED */
Object g2int_gsi_get_item_of_attribute_named(instance,symbol)
    Object instance, symbol;
{
    Object gsi_instance_extension, attributes, attribute, attribute_spec, temp;
    Object type;
    SI_Long i, gensymed_symbol, gensymed_symbol_1, ab_loop_bind_;

    x_note_fn_call(47,483);
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    attributes = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)8L) : Nil;
    i = IFIX(G2int_gsi_magic_offset);
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    gensymed_symbol = gsi_instance_extension ? 
	    IFIX(ISVREF(gsi_instance_extension,(SI_Long)9L)) : (SI_Long)0L;
    gensymed_symbol_1 = IFIX(G2int_gsi_magic_offset);
    ab_loop_bind_ = gensymed_symbol + gensymed_symbol_1;
    attribute = Nil;
    attribute_spec = Nil;
  next_loop:
    if (i >= ab_loop_bind_)
	goto end_loop;
    attribute = ISVREF(attributes,i);
    attribute_spec = ISVREF(attribute,(SI_Long)1L);
    if (FIXNUMP(attribute_spec))
	temp = Qg2int_vector_element;
    else if (SYMBOLP(attribute_spec))
	temp = Qg2int_attribute;
    else if (CONSP(attribute_spec)) {
	type = M_CAR(attribute_spec);
	temp = EQ(type,Qg2int_class_qualified_name) ? Qg2int_attribute : type;
    }
    else
	temp = Qnil;
    if ((EQ(Qg2int_attribute,temp) ?  !(CONSP(attribute_spec) ? 
	    TRUEP(SECOND(attribute_spec)) : TRUEP(Nil)) : TRUEP(Nil)) ? 
	    EQ(symbol,CONSP(attribute_spec) ? THIRD(attribute_spec) : 
	    attribute_spec) : TRUEP(Nil)) {
	temp = ISVREF(attribute,(SI_Long)4L);
	goto end;
    }
    i = i + (SI_Long)1L;
    goto next_loop;
  end_loop:
    temp = Qnil;
  end:;
    return VALUES_1(temp);
}

static Object Qg2int_gsi_attr_by_name;  /* |gsi_attr_by_name| */

/* SHARED-GSI-ATTR-BY-NAME */
Object g2int_shared_gsi_attr_by_name(wide_api_p,gsi_structure,
	    gsi_fc_outer_search_name)
    Object wide_api_p, gsi_structure, gsi_fc_outer_search_name;
{
    Object arg_symbol, result_1, search_name, instance, attribute;
    Object gsi_fc_result;

    x_note_fn_call(47,484);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_search_name,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_by_name,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_attr_by_name;
    }
    search_name = arg_symbol;
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_by_name,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_attr_by_name;
    }
    attribute = g2int_lookup_attr_by_name_1(instance,search_name);
    if ( !TRUEP(attribute)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_attribute_name_not_found,search_name,Nil,Nil,Nil,
		Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_by_name,Qg2int_warning,T);
    }
    gsi_fc_result = attribute;
    result_1 = gsi_fc_result;
  end_shared_gsi_attr_by_name:;
    return result_1;
}

static Object string_constant_192;  /* "gsi_attr_by_name" */

/* GSI-ATTR-BY-NAME */
DLLEXPORT Object gsi_attr_by_name(gsi_structure,search_name)
    Object gsi_structure, search_name;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,485);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_192);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_attr_by_name(G2int_gsi_wide_api_p,
		    gsi_structure,search_name);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_attr_by_name(G2int_gsi_wide_api_p,
			    gsi_structure,search_name);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_192);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_attr_by_name;  /* |gsi_set_attr_by_name| */

/* SHARED-GSI-SET-ATTR-BY-NAME */
void g2int_shared_gsi_set_attr_by_name(wide_api_p,gsi_structure,
	    gsi_fc_outer_search_name,gsi_attr)
    Object wide_api_p, gsi_structure, gsi_fc_outer_search_name, gsi_attr;
{
    Object arg_symbol, search_name, instance, existing_attr, attributes, i;
    Object result;

    x_note_fn_call(47,486);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_search_name,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_by_name,Qerror,T);
	goto end_shared_gsi_set_attr_by_name;
    }
    search_name = arg_symbol;
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_by_name,Qerror,T);
	goto end_shared_gsi_set_attr_by_name;
    }
    result = g2int_lookup_attr_by_name_1(instance,search_name);
    MVS_3(result,existing_attr,attributes,i);
    if ( !TRUEP(existing_attr)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_attribute_name_not_found,search_name,Nil,Nil,Nil,
		Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_by_name,Qg2int_warning,T);
    }
    if (existing_attr)
	SVREF(attributes,i) = gsi_attr;
  end_shared_gsi_set_attr_by_name:;
}

static Object string_constant_193;  /* "gsi_set_attr_by_name" */

/* GSI-SET-ATTR-BY-NAME */
DLLEXPORT void gsi_set_attr_by_name(gsi_structure,search_name,gsi_attr)
    Object gsi_structure, search_name, gsi_attr;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,487);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_193);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_attr_by_name(G2int_gsi_wide_api_p,
		    gsi_structure,search_name,gsi_attr);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_attr_by_name(G2int_gsi_wide_api_p,
			    gsi_structure,search_name,gsi_attr);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_193);
}

static Object Qg2int_gsi_item_of_attr_by_name;  /* |gsi_item_of_attr_by_name| */

/* SHARED-GSI-ITEM-OF-ATTR-BY-NAME */
Object g2int_shared_gsi_item_of_attr_by_name(wide_api_p,gsi_structure,
	    gsi_fc_outer_search_name)
    Object wide_api_p, gsi_structure, gsi_fc_outer_search_name;
{
    Object arg_symbol, result_1, search_name, instance, attr, item_qm;
    Object gsi_fc_result;

    x_note_fn_call(47,488);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_search_name,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_attr_by_name,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_item_of_attr_by_name;
    }
    search_name = arg_symbol;
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_attr_by_name,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_item_of_attr_by_name;
    }
    attr = g2int_lookup_attr_by_name_1(instance,search_name);
    if ( !TRUEP(attr)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_attribute_name_not_found,search_name,Nil,Nil,Nil,
		Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_item_of_attr_by_name,
		Qg2int_warning,T);
    }
    if (attr) {
	item_qm = ISVREF(attr,(SI_Long)4L);
	if ( !TRUEP(item_qm)) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_missing_instance_structure,Nil,Nil,Nil,Nil,
		    Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_item_of_attr_by_name,Qerror,T);
	    result_1 = Qnil;
	    goto end_shared_gsi_item_of_attr_by_name;
	}
	gsi_fc_result = item_qm;
    }
    else
	gsi_fc_result = Nil;
    result_1 = gsi_fc_result;
  end_shared_gsi_item_of_attr_by_name:;
    return result_1;
}

static Object string_constant_194;  /* "gsi_item_of_attr_by_name" */

/* GSI-ITEM-OF-ATTR-BY-NAME */
DLLEXPORT Object gsi_item_of_attr_by_name(gsi_structure,search_name)
    Object gsi_structure, search_name;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,489);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_194);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_item_of_attr_by_name(G2int_gsi_wide_api_p,
		    gsi_structure,search_name);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_item_of_attr_by_name(G2int_gsi_wide_api_p,
			    gsi_structure,search_name);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_194);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_item_of_attr_by_name;  /* |gsi_set_item_of_attr_by_name| */

/* SHARED-GSI-SET-ITEM-OF-ATTR-BY-NAME */
void g2int_shared_gsi_set_item_of_attr_by_name(wide_api_p,gsi_structure,
	    gsi_fc_outer_search_name,gsi_instance)
    Object wide_api_p, gsi_structure, gsi_fc_outer_search_name, gsi_instance;
{
    Object arg_symbol, search_name, instance, attr;

    x_note_fn_call(47,490);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_search_name,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_item_of_attr_by_name,Qerror,T);
	goto end_shared_gsi_set_item_of_attr_by_name;
    }
    search_name = arg_symbol;
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_item_of_attr_by_name,Qerror,T);
	goto end_shared_gsi_set_item_of_attr_by_name;
    }
    attr = g2int_lookup_attr_by_name_1(instance,search_name);
    if ( !TRUEP(attr)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_attribute_name_not_found,search_name,Nil,Nil,Nil,
		Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_item_of_attr_by_name,
		Qg2int_warning,T);
    }
    if (attr)
	SVREF(attr,FIX((SI_Long)4L)) = gsi_instance;
  end_shared_gsi_set_item_of_attr_by_name:;
}

static Object string_constant_195;  /* "gsi_set_item_of_attr_by_name" */

/* GSI-SET-ITEM-OF-ATTR-BY-NAME */
DLLEXPORT void gsi_set_item_of_attr_by_name(gsi_structure,search_name,
	    gsi_instance)
    Object gsi_structure, search_name, gsi_instance;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,491);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_195);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_item_of_attr_by_name(G2int_gsi_wide_api_p,
		    gsi_structure,search_name,gsi_instance);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_item_of_attr_by_name(G2int_gsi_wide_api_p,
			    gsi_structure,search_name,gsi_instance);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_195);
}

static Object Qg2int_gsi_status_of;  /* |gsi_status_of| */

/* SHARED-GSI-STATUS-OF */
SI_Long g2int_shared_gsi_status_of(gsi_item)
    Object gsi_item;
{
    SI_Long result_1, gsi_fc_result;

    x_note_fn_call(47,492);
    if ( !(SIMPLE_VECTOR_P(gsi_item) && EQ(ISVREF(gsi_item,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_structure_has_no_status,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_status_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_status_of;
    }
    gsi_fc_result = FIXNUM_TO_LONG(ISVREF(gsi_item,(SI_Long)2L));
    result_1 = gsi_fc_result;
  end_shared_gsi_status_of:;
    return result_1;
}

static Object string_constant_196;  /* "gsi_status_of" */

/* GSI-STATUS-OF */
DLLEXPORT SI_Long gsi_status_of(gsi_item)
    Object gsi_item;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,493);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_196);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_status_of(gsi_item));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_status_of(gsi_item));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_196);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_status;  /* |gsi_set_status| */

/* SHARED-GSI-SET-STATUS */
void g2int_shared_gsi_set_status(gsi_item,gsi_fc_outer_new_status)
    Object gsi_item;
    SI_Long gsi_fc_outer_new_status;
{
    Object new_status;
    SI_Long value;

    x_note_fn_call(47,494);
    value = gsi_fc_outer_new_status;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_status,Qerror,T);
	goto end_shared_gsi_set_status;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_status,Qerror,T);
	goto end_shared_gsi_set_status;
    }
    new_status = LONG_TO_FIXNUM(value);
    if ( !(SIMPLE_VECTOR_P(gsi_item) && EQ(ISVREF(gsi_item,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_structure_has_no_status,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_status,Qerror,T);
	goto end_shared_gsi_set_status;
    }
    SVREF(gsi_item,FIX((SI_Long)2L)) = new_status;
  end_shared_gsi_set_status:;
}

static Object string_constant_197;  /* "gsi_set_status" */

/* GSI-SET-STATUS */
DLLEXPORT void gsi_set_status(gsi_item,new_status)
    Object gsi_item;
    SI_Long new_status;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,495);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_197);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_status(gsi_item,new_status);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_status(gsi_item,new_status);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_197);
}

static Object Qg2int_gsi_interval_of;  /* |gsi_interval_of| */

/* SHARED-GSI-INTERVAL-OF */
double g2int_shared_gsi_interval_of(gsi_intervaled_structure)
    Object gsi_intervaled_structure;
{
    Object temp, gsi_instance_extension;
    char temp_1;
    double result_1, gsi_fc_result;

    x_note_fn_call(47,496);
    if (SIMPLE_VECTOR_P(gsi_intervaled_structure) && 
	    EQ(ISVREF(gsi_intervaled_structure,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct))
	temp = ISVREF(gsi_intervaled_structure,(SI_Long)3L);
    else {
	if (SIMPLE_VECTOR_P(gsi_intervaled_structure) && 
		EQ(ISVREF(gsi_intervaled_structure,(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(gsi_intervaled_structure,
		    (SI_Long)3L);
	    temp_1 =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp_1 = TRUEP(Nil);
	if (temp_1) {
	    gsi_instance_extension = ISVREF(gsi_intervaled_structure,
		    (SI_Long)3L);
	    temp = gsi_instance_extension ? ISVREF(gsi_instance_extension,
		    (SI_Long)11L) : Nil;
	}
	else {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_structure_has_no_interval,Nil,Nil,Nil,Nil,
		    Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_interval_of,Qerror,T);
	    result_1 = 0.0;
	    goto end_shared_gsi_interval_of;
	}
    }
    temp = aref1(temp,FIX((SI_Long)0L));
    gsi_fc_result = DOUBLE_FLOAT_TO_DOUBLE(temp);
    result_1 = 
	    inline_maybe_swap_float_bytes_for_alpha_gfloats(gsi_fc_result,
	    g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? (SI_Long)1L 
	    : (SI_Long)0L);
  end_shared_gsi_interval_of:;
    return result_1;
}

static Object string_constant_198;  /* "gsi_interval_of" */

/* GSI-INTERVAL-OF */
DLLEXPORT double gsi_interval_of(gsi_intervaled_structure)
    Object gsi_intervaled_structure;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    volatile double result_1;
    double result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,497);
    result_1 = 0.0;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_198);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_interval_of(gsi_intervaled_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_interval_of(gsi_intervaled_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_198);
    result_2 = result_1;
    return result_2;
}

static Object Qgsi_set_interval;   /* gsi-set-interval */

static Object Qg2int_gsi_set_interval;  /* |gsi_set_interval| */

/* SHARED-GSI-SET-INTERVAL */
void g2int_shared_gsi_set_interval(gsi_intervaled_structure,
	    gsi_fc_outer_new_interval)
    Object gsi_intervaled_structure;
    double gsi_fc_outer_new_interval;
{
    Object amf_available_array_cons_qm, amf_array, temp, svref_new_value;
    Object amf_result, incff_1_arg, new_float, gsi_instance_extension;
    char temp_1;
    double new_interval;

    x_note_fn_call(47,498);
    new_interval = 
	    inline_maybe_swap_float_bytes_for_alpha_gfloats(gsi_fc_outer_new_interval,
	    g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? (SI_Long)1L 
	    : (SI_Long)0L);
    if (SIMPLE_VECTOR_P(gsi_intervaled_structure) && 
	    EQ(ISVREF(gsi_intervaled_structure,(SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct)) {
	amf_available_array_cons_qm = 
		ISVREF(G2int_vector_of_simple_float_array_pools,(SI_Long)1L);
	if (amf_available_array_cons_qm) {
	    amf_array = M_CAR(amf_available_array_cons_qm);
	    temp = G2int_vector_of_simple_float_array_pools;
	    svref_new_value = M_CDR(amf_available_array_cons_qm);
	    SVREF(temp,FIX((SI_Long)1L)) = svref_new_value;
	    inline_note_reclaim_cons(amf_available_array_cons_qm,
		    Qg2int_gensym);
	    temp = G2int_available_gensym_conses;
	    M_CDR(amf_available_array_cons_qm) = temp;
	    G2int_available_gensym_conses = amf_available_array_cons_qm;
	    amf_result = amf_array;
	}
	else {
	    temp = FIXNUM_ADD1(G2int_created_simple_float_array_pool_arrays);
	    G2int_created_simple_float_array_pool_arrays = temp;
	    incff_1_arg = 
		    g2int_bytes_per_double_float_simple_array(FIX((SI_Long)1L));
	    temp = FIXNUM_ADD(G2int_simple_float_array_pool_memory_usage,
		    incff_1_arg);
	    G2int_simple_float_array_pool_memory_usage = temp;
	    amf_result = g2int_generate_float_vector(FIX((SI_Long)1L));
	}
	new_float = amf_result;
	DFLOAT_ISASET_1(new_float,(SI_Long)0L,new_interval);
	SVREF(gsi_intervaled_structure,FIX((SI_Long)3L)) = new_float;
	g2int_gsi_message(2,Qgsi_set_interval,G2int_gsi_unexpected_operation);
    }
    else {
	if (SIMPLE_VECTOR_P(gsi_intervaled_structure) && 
		EQ(ISVREF(gsi_intervaled_structure,(SI_Long)0L),
		Qg2_defstruct_structure_name_gsi_instance_g2_struct)) {
	    gsi_instance_extension = ISVREF(gsi_intervaled_structure,
		    (SI_Long)3L);
	    temp_1 =  ! !(gsi_instance_extension ? 
		    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)11L)) : 
		    TRUEP(Nil));
	}
	else
	    temp_1 = TRUEP(Nil);
	if (temp_1) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_item_definitions_are_read_only,Nil,Nil,Nil,
		    Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_interval,Qerror,T);
	    goto end_shared_gsi_set_interval;
	}
	else {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_structure_has_no_interval,Nil,Nil,Nil,Nil,
		    Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_interval,Qerror,T);
	    goto end_shared_gsi_set_interval;
	}
    }
  end_shared_gsi_set_interval:;
}

static Object string_constant_199;  /* "gsi_set_interval" */

/* GSI-SET-INTERVAL */
DLLEXPORT void gsi_set_interval(gsi_intervaled_structure,new_interval)
    Object gsi_intervaled_structure;
    double new_interval;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,499);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_199);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_interval(gsi_intervaled_structure,
		    new_interval);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_interval(gsi_intervaled_structure,
			    new_interval);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_199);
}

static Object Qg2int_gsi_attr_name_of;  /* |gsi_attr_name_of| */

/* SHARED-GSI-ATTR-NAME-OF */
Object g2int_shared_gsi_attr_name_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object code, attribute_spec_qm, temp_1, type, result_1, gsi_fc_result;
    Object string_1;
    char temp;

    x_note_fn_call(47,500);
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Qg2int_attribute);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Qg2int_attribute);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_name_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_attr_name_of;
    }
    gsi_fc_result = g2int_gsi_attribute_qualified_name(gsi_structure);
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
  end_shared_gsi_attr_name_of:;
    return result_1;
}

static Object string_constant_200;  /* "gsi_attr_name_of" */

/* GSI-ATTR-NAME-OF */
DLLEXPORT Object gsi_attr_name_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,501);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_200);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_attr_name_of(G2int_gsi_wide_api_p,
		    gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_attr_name_of(G2int_gsi_wide_api_p,
			    gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_200);
    result_2 = result_1;
    return result_2;
}

/* SET-GSI-ATTRIBUTE-NAME */
Object g2int_set_gsi_attribute_name(attribute,attribute_name)
    Object attribute, attribute_name;
{
    Object attribute_name_text_string, length_1, double_colon_p;
    Object attribute_spec, temp;

    x_note_fn_call(47,502);
    attribute_name_text_string = g2int_symbol_name_text_string(attribute_name);
    length_1 = g2int_lengthw(attribute_name_text_string);
    double_colon_p = g2int_position_of_two_colons(attribute_name_text_string);
    attribute_spec = ISVREF(attribute,(SI_Long)1L);
    temp = double_colon_p ? 
	    g2int_gsi_intern(g2int_copy_partial_text_string(attribute_name_text_string,
	    double_colon_p)) : Nil;
    M_SECOND(attribute_spec) = temp;
    SVREF(attribute,FIX((SI_Long)2L)) = attribute_name;
    temp = double_colon_p ? 
	    g2int_gsi_intern(g2int_text_string_substring(attribute_name_text_string,
	    FIX(IFIX(double_colon_p) + (SI_Long)2L),length_1)) : 
	    attribute_name;
    M_THIRD(attribute_spec) = temp;
    return VALUES_1(Nil);
}

static Object Qg2int_gsi_set_attr_name;  /* |gsi_set_attr_name| */

/* SHARED-GSI-SET-ATTR-NAME */
void g2int_shared_gsi_set_attr_name(wide_api_p,gsi_structure,
	    gsi_fc_outer_attribute_name)
    Object wide_api_p, gsi_structure, gsi_fc_outer_attribute_name;
{
    Object arg_symbol, attribute_name, code, attribute_spec_qm, temp_1, type;
    char temp;

    x_note_fn_call(47,503);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_attribute_name,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_name,Qerror,T);
	goto end_shared_gsi_set_attr_name;
    }
    attribute_name = arg_symbol;
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Qg2int_attribute);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Qg2int_attribute);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_name,Qerror,T);
	goto end_shared_gsi_set_attr_name;
    }
    g2int_set_gsi_attribute_name(gsi_structure,attribute_name);
  end_shared_gsi_set_attr_name:;
}

static Object string_constant_201;  /* "gsi_set_attr_name" */

/* GSI-SET-ATTR-NAME */
DLLEXPORT void gsi_set_attr_name(gsi_structure,attribute_name)
    Object gsi_structure, attribute_name;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,504);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_201);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_attr_name(G2int_gsi_wide_api_p,
		    gsi_structure,attribute_name);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_attr_name(G2int_gsi_wide_api_p,
			    gsi_structure,attribute_name);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_201);
}

static Object Qg2int_gsi_unqualified_attr_name_of;  /* |gsi_unqualified_attr_name_of| */

/* SHARED-GSI-UNQUALIFIED-ATTR-NAME-OF */
Object g2int_shared_gsi_unqualified_attr_name_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object code, attribute_spec_qm, temp_1, type, result_1;
    Object resumable_attribute_spec, gsi_fc_result, string_1;
    char temp;

    x_note_fn_call(47,505);
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Qg2int_attribute);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Qg2int_attribute);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_unqualified_attr_name_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_unqualified_attr_name_of;
    }
    resumable_attribute_spec = attribute_spec_qm;
    gsi_fc_result = CONSP(resumable_attribute_spec) ? 
	    THIRD(resumable_attribute_spec) : resumable_attribute_spec;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
  end_shared_gsi_unqualified_attr_name_of:;
    return result_1;
}

static Object string_constant_202;  /* "gsi_unqualified_attr_name_of" */

/* GSI-UNQUALIFIED-ATTR-NAME-OF */
DLLEXPORT Object gsi_unqualified_attr_name_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,506);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_202);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_unqualified_attr_name_of(G2int_gsi_wide_api_p,
		    gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_unqualified_attr_name_of(G2int_gsi_wide_api_p,
			    gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_202);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_unqualified_attr_name;  /* |gsi_set_unqualified_attr_name| */

/* SHARED-GSI-SET-UNQUALIFIED-ATTR-NAME */
void g2int_shared_gsi_set_unqualified_attr_name(wide_api_p,gsi_structure,
	    gsi_fc_outer_attribute_name)
    Object wide_api_p, gsi_structure, gsi_fc_outer_attribute_name;
{
    Object arg_symbol, attribute_name, code, attribute_spec_qm, temp_1, type;
    char temp;

    x_note_fn_call(47,507);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_attribute_name,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_unqualified_attr_name,
		Qerror,T);
	goto end_shared_gsi_set_unqualified_attr_name;
    }
    attribute_name = arg_symbol;
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Qg2int_attribute);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Qg2int_attribute);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_unqualified_attr_name,
		Qerror,T);
	goto end_shared_gsi_set_unqualified_attr_name;
    }
    M_THIRD(attribute_spec_qm) = attribute_name;
  end_shared_gsi_set_unqualified_attr_name:;
}

static Object string_constant_203;  /* "gsi_set_unqualified_attr_name" */

/* GSI-SET-UNQUALIFIED-ATTR-NAME */
DLLEXPORT void gsi_set_unqualified_attr_name(gsi_structure,attribute_name)
    Object gsi_structure, attribute_name;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,508);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_203);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_unqualified_attr_name(G2int_gsi_wide_api_p,
		    gsi_structure,attribute_name);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_unqualified_attr_name(G2int_gsi_wide_api_p,
			    gsi_structure,attribute_name);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_203);
}

static Object Qg2int_gsi_attr_name_is_qualified;  /* |gsi_attr_name_is_qualified| */

/* SHARED-GSI-ATTR-NAME-IS-QUALIFIED */
SI_Long g2int_shared_gsi_attr_name_is_qualified(gsi_structure)
    Object gsi_structure;
{
    Object code, attribute_spec_qm, temp_1, type, resumable_attribute_spec;
    SI_Long result_1, gsi_fc_result;
    char temp;

    x_note_fn_call(47,509);
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Qg2int_attribute);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Qg2int_attribute);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_name_is_qualified,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_attr_name_is_qualified;
    }
    resumable_attribute_spec = attribute_spec_qm;
    gsi_fc_result = (CONSP(resumable_attribute_spec) ? 
	    TRUEP(SECOND(resumable_attribute_spec)) : TRUEP(Nil)) ? 
	    (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_attr_name_is_qualified:;
    return result_1;
}

static Object string_constant_204;  /* "gsi_attr_name_is_qualified" */

/* GSI-ATTR-NAME-IS-QUALIFIED */
DLLEXPORT SI_Long gsi_attr_name_is_qualified(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,510);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_204);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_attr_name_is_qualified(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_attr_name_is_qualified(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_204);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_class_qualifier_of;  /* |gsi_class_qualifier_of| */

/* SHARED-GSI-CLASS-QUALIFIER-OF */
Object g2int_shared_gsi_class_qualifier_of(wide_api_p,gsi_structure)
    Object wide_api_p, gsi_structure;
{
    Object code, attribute_spec_qm, temp_1, type, result_1;
    Object resumable_attribute_spec, class_qualifier_qm, gsi_fc_result;
    Object string_1;
    char temp;

    x_note_fn_call(47,511);
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Qg2int_attribute);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Qg2int_attribute);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_class_qualifier_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_class_qualifier_of;
    }
    resumable_attribute_spec = attribute_spec_qm;
    class_qualifier_qm = CONSP(resumable_attribute_spec) ? 
	    SECOND(resumable_attribute_spec) : Nil;
    if ( !TRUEP(class_qualifier_qm)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_structure_has_no_class_qualifier,Nil,Nil,Nil,Nil,
		Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_class_qualifier_of,Qerror,T);
	result_1 = Qnil;
	goto end_shared_gsi_class_qualifier_of;
    }
    gsi_fc_result = class_qualifier_qm;
    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
	result_1 = gsi_fc_result;
    else if ( !TRUEP(gsi_fc_result))
	result_1 = Nil;
    else {
	string_1 = g2int_gsi_string_for_symbol(gsi_fc_result,wide_api_p);
	result_1 = wide_api_p ? 
		g2int_lisp_string_to_c_wide_string(string_1) : 
		g2int_lisp_string_to_c_string(string_1);
    }
  end_shared_gsi_class_qualifier_of:;
    return result_1;
}

static Object string_constant_205;  /* "gsi_class_qualifier_of" */

/* GSI-CLASS-QUALIFIER-OF */
DLLEXPORT Object gsi_class_qualifier_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Object result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,512);
    result_1 = Nil;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_205);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    g2int_shared_gsi_class_qualifier_of(G2int_gsi_wide_api_p,
		    gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    g2int_shared_gsi_class_qualifier_of(G2int_gsi_wide_api_p,
			    gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_205);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_set_class_qualifier;  /* |gsi_set_class_qualifier| */

/* SHARED-GSI-SET-CLASS-QUALIFIER */
void g2int_shared_gsi_set_class_qualifier(wide_api_p,gsi_structure,
	    gsi_fc_outer_attribute_name)
    Object wide_api_p, gsi_structure, gsi_fc_outer_attribute_name;
{
    Object arg_symbol, attribute_name, code, attribute_spec_qm, temp_1, type;
    char temp;

    x_note_fn_call(47,513);
    arg_symbol = 
	    g2int_gsi_api_symbol_to_symbol_or_nil_1(gsi_fc_outer_attribute_name,
	    G2int_gsi_wide_api_p);
    if ( !SYMBOLP(arg_symbol)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_not_a_symbol,Nil,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_class_qualifier,Qerror,T);
	goto end_shared_gsi_set_class_qualifier;
    }
    attribute_name = arg_symbol;
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Qg2int_attribute);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Qg2int_attribute);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_class_qualifier,Qerror,T);
	goto end_shared_gsi_set_class_qualifier;
    }
    M_SECOND(attribute_spec_qm) = attribute_name;
  end_shared_gsi_set_class_qualifier:;
}

static Object string_constant_206;  /* "gsi_set_class_qualifier" */

/* GSI-SET-CLASS-QUALIFIER */
DLLEXPORT void gsi_set_class_qualifier(gsi_structure,attribute_name)
    Object gsi_structure, attribute_name;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,514);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_206);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_class_qualifier(G2int_gsi_wide_api_p,
		    gsi_structure,attribute_name);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_class_qualifier(G2int_gsi_wide_api_p,
			    gsi_structure,attribute_name);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_206);
}

static Object Qg2int_gsi_attr_is_array_index;  /* |gsi_attr_is_array_index| */

/* SHARED-GSI-ATTR-IS-ARRAY-INDEX */
SI_Long g2int_shared_gsi_attr_is_array_index(gsi_structure)
    Object gsi_structure;
{
    Object code, attribute_spec_qm, temp_1, type, resumable_attribute_spec;
    SI_Long result_1, gsi_fc_result;
    char temp;

    x_note_fn_call(47,515);
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Nil);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Nil);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_is_array_index,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_attr_is_array_index;
    }
    resumable_attribute_spec = attribute_spec_qm;
    if (FIXNUMP(resumable_attribute_spec))
	temp_1 = Qg2int_vector_element;
    else if (SYMBOLP(resumable_attribute_spec))
	temp_1 = Qg2int_attribute;
    else if (CONSP(resumable_attribute_spec)) {
	type = M_CAR(resumable_attribute_spec);
	temp_1 = EQ(type,Qg2int_class_qualified_name) ? Qg2int_attribute : 
		type;
    }
    else
	temp_1 = Qnil;
    gsi_fc_result = EQ(Qg2int_vector_element,temp_1) ? (SI_Long)1L : 
	    (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_attr_is_array_index:;
    return result_1;
}

static Object string_constant_207;  /* "gsi_attr_is_array_index" */

/* GSI-ATTR-IS-ARRAY-INDEX */
DLLEXPORT SI_Long gsi_attr_is_array_index(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,516);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_207);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_attr_is_array_index(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_attr_is_array_index(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_207);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_attr_array_index_of;  /* |gsi_attr_array_index_of| */

/* SHARED-GSI-ATTR-ARRAY-INDEX-OF */
SI_Long g2int_shared_gsi_attr_array_index_of(gsi_structure)
    Object gsi_structure;
{
    Object code, attribute_spec_qm, temp_1, type, resumable_attribute_spec;
    Object index_1;
    SI_Long result_1, gsi_fc_result;
    char temp;

    x_note_fn_call(47,517);
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Qg2int_vector_element);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Qg2int_vector_element);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_array_index_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_attr_array_index_of;
    }
    resumable_attribute_spec = attribute_spec_qm;
    index_1 = FIXNUMP(resumable_attribute_spec) ? resumable_attribute_spec 
	    : SECOND(resumable_attribute_spec);
    if ( !TRUEP(index_1)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_structure_has_no_class_qualifier,Nil,Nil,Nil,Nil,
		Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_array_index_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_attr_array_index_of;
    }
    gsi_fc_result = FIXNUM_TO_LONG(index_1);
    result_1 = gsi_fc_result;
  end_shared_gsi_attr_array_index_of:;
    return result_1;
}

static Object string_constant_208;  /* "gsi_attr_array_index_of" */

/* GSI-ATTR-ARRAY-INDEX-OF */
DLLEXPORT SI_Long gsi_attr_array_index_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,518);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_208);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_attr_array_index_of(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_attr_array_index_of(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_208);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_attr_array_index;  /* |gsi_set_attr_array_index| */

/* SHARED-GSI-SET-ATTR-ARRAY-INDEX */
void g2int_shared_gsi_set_attr_array_index(gsi_structure,
	    gsi_fc_outer_attribute_index)
    Object gsi_structure;
    SI_Long gsi_fc_outer_attribute_index;
{
    Object attribute_index, code, attribute_spec_qm, temp_1, type, attr_spec;
    SI_Long value;
    char temp;

    x_note_fn_call(47,519);
    value = gsi_fc_outer_attribute_index;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_array_index,Qerror,T);
	goto end_shared_gsi_set_attr_array_index;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_array_index,Qerror,T);
	goto end_shared_gsi_set_attr_array_index;
    }
    attribute_index = LONG_TO_FIXNUM(value);
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Nil);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Nil);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_array_index,Qerror,T);
	goto end_shared_gsi_set_attr_array_index;
    }
    attr_spec = attribute_spec_qm;
    if (FIXNUMP(attr_spec))
	temp_1 = Qg2int_vector_element;
    else if (SYMBOLP(attr_spec))
	temp_1 = Qg2int_attribute;
    else if (CONSP(attr_spec)) {
	type = M_CAR(attr_spec);
	temp_1 = EQ(type,Qg2int_class_qualified_name) ? Qg2int_attribute : 
		type;
    }
    else
	temp_1 = Qnil;
    if ( !EQ(Qg2int_vector_element,temp_1)) {
	if (CONSP(attr_spec))
	    g2int_reclaim_gensym_list_1(attr_spec);
	attr_spec = g2int_gensym_list_2(Qg2int_vector_element,Nil);
	SVREF(gsi_structure,FIX((SI_Long)1L)) = attr_spec;
    }
    M_SECOND(attr_spec) = attribute_index;
  end_shared_gsi_set_attr_array_index:;
}

static Object string_constant_209;  /* "gsi_set_attr_array_index" */

/* GSI-SET-ATTR-ARRAY-INDEX */
DLLEXPORT void gsi_set_attr_array_index(gsi_structure,attribute_index)
    Object gsi_structure;
    SI_Long attribute_index;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,520);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_209);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_attr_array_index(gsi_structure,
		    attribute_index);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_attr_array_index(gsi_structure,
			    attribute_index);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_209);
}

static Object Qg2int_gsi_attr_is_list_index;  /* |gsi_attr_is_list_index| */

/* SHARED-GSI-ATTR-IS-LIST-INDEX */
SI_Long g2int_shared_gsi_attr_is_list_index(gsi_structure)
    Object gsi_structure;
{
    Object code, attribute_spec_qm, temp_1, type, resumable_attribute_spec;
    SI_Long result_1, gsi_fc_result;
    char temp;

    x_note_fn_call(47,521);
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Nil);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Nil);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_is_list_index,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_attr_is_list_index;
    }
    resumable_attribute_spec = attribute_spec_qm;
    if (FIXNUMP(resumable_attribute_spec))
	temp_1 = Qg2int_vector_element;
    else if (SYMBOLP(resumable_attribute_spec))
	temp_1 = Qg2int_attribute;
    else if (CONSP(resumable_attribute_spec)) {
	type = M_CAR(resumable_attribute_spec);
	temp_1 = EQ(type,Qg2int_class_qualified_name) ? Qg2int_attribute : 
		type;
    }
    else
	temp_1 = Qnil;
    gsi_fc_result = EQ(Qg2int_list_element,temp_1) ? (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_attr_is_list_index:;
    return result_1;
}

static Object string_constant_210;  /* "gsi_attr_is_list_index" */

/* GSI-ATTR-IS-LIST-INDEX */
DLLEXPORT SI_Long gsi_attr_is_list_index(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,522);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_210);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_attr_is_list_index(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_attr_is_list_index(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_210);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_attr_list_index_of;  /* |gsi_attr_list_index_of| */

/* SHARED-GSI-ATTR-LIST-INDEX-OF */
SI_Long g2int_shared_gsi_attr_list_index_of(gsi_structure)
    Object gsi_structure;
{
    Object code, attribute_spec_qm, temp_1, type, resumable_attribute_spec;
    Object index_1;
    SI_Long result_1, gsi_fc_result;
    char temp;

    x_note_fn_call(47,523);
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Qg2int_list_element);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Qg2int_list_element);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_list_index_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_attr_list_index_of;
    }
    resumable_attribute_spec = attribute_spec_qm;
    index_1 = FIXNUMP(resumable_attribute_spec) ? resumable_attribute_spec 
	    : SECOND(resumable_attribute_spec);
    if ( !TRUEP(index_1)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_structure_has_no_class_qualifier,Nil,Nil,Nil,Nil,
		Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_list_index_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_attr_list_index_of;
    }
    gsi_fc_result = FIXNUM_TO_LONG(index_1);
    result_1 = gsi_fc_result;
  end_shared_gsi_attr_list_index_of:;
    return result_1;
}

static Object string_constant_211;  /* "gsi_attr_list_index_of" */

/* GSI-ATTR-LIST-INDEX-OF */
DLLEXPORT SI_Long gsi_attr_list_index_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,524);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_211);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_attr_list_index_of(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_attr_list_index_of(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_211);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_attr_list_index;  /* |gsi_set_attr_list_index| */

/* SHARED-GSI-SET-ATTR-LIST-INDEX */
void g2int_shared_gsi_set_attr_list_index(gsi_structure,
	    gsi_fc_outer_attribute_index)
    Object gsi_structure;
    SI_Long gsi_fc_outer_attribute_index;
{
    Object attribute_index, code, attribute_spec_qm, temp_1, type, attr_spec;
    SI_Long value;
    char temp;

    x_note_fn_call(47,525);
    value = gsi_fc_outer_attribute_index;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_list_index,Qerror,T);
	goto end_shared_gsi_set_attr_list_index;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_list_index,Qerror,T);
	goto end_shared_gsi_set_attr_list_index;
    }
    attribute_index = LONG_TO_FIXNUM(value);
    code =  !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct)) ? 
	    G2int_gsi_structure_has_no_attribute_name : Nil;
    attribute_spec_qm = Nil;
    if ( !TRUEP(code)) {
	attribute_spec_qm = ISVREF(gsi_structure,(SI_Long)1L);
	if ( !TRUEP(attribute_spec_qm))
	    code = G2int_gsi_structure_has_no_attribute_name;
	temp =  !TRUEP(Nil);
	if (temp);
	else {
	    if (FIXNUMP(attribute_spec_qm))
		temp_1 = Qg2int_vector_element;
	    else if (SYMBOLP(attribute_spec_qm))
		temp_1 = Qg2int_attribute;
	    else if (CONSP(attribute_spec_qm)) {
		type = M_CAR(attribute_spec_qm);
		temp_1 = EQ(type,Qg2int_class_qualified_name) ? 
			Qg2int_attribute : type;
	    }
	    else
		temp_1 = Qnil;
	    temp = EQ(temp_1,Nil);
	}
	if ( !temp)
	    code = G2int_gsi_invalid_attribute_type;
    }
    if (code) {
	g2int_set_gsi_error_message_1(Nil,code,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_list_index,Qerror,T);
	goto end_shared_gsi_set_attr_list_index;
    }
    attr_spec = attribute_spec_qm;
    if (FIXNUMP(attr_spec))
	temp_1 = Qg2int_vector_element;
    else if (SYMBOLP(attr_spec))
	temp_1 = Qg2int_attribute;
    else if (CONSP(attr_spec)) {
	type = M_CAR(attr_spec);
	temp_1 = EQ(type,Qg2int_class_qualified_name) ? Qg2int_attribute : 
		type;
    }
    else
	temp_1 = Qnil;
    if ( !EQ(Qg2int_list_element,temp_1)) {
	if (CONSP(attr_spec))
	    g2int_reclaim_gensym_list_1(attr_spec);
	attr_spec = g2int_gensym_list_2(Qg2int_list_element,Nil);
	SVREF(gsi_structure,FIX((SI_Long)1L)) = attr_spec;
    }
    M_SECOND(attr_spec) = attribute_index;
  end_shared_gsi_set_attr_list_index:;
}

static Object string_constant_212;  /* "gsi_set_attr_list_index" */

/* GSI-SET-ATTR-LIST-INDEX */
DLLEXPORT void gsi_set_attr_list_index(gsi_structure,attribute_index)
    Object gsi_structure;
    SI_Long attribute_index;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,526);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_212);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_attr_list_index(gsi_structure,
		    attribute_index);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_attr_list_index(gsi_structure,
			    attribute_index);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_212);
}

static Object Qg2int_gsi_attr_is_transient;  /* |gsi_attr_is_transient| */

/* SHARED-GSI-ATTR-IS-TRANSIENT */
SI_Long g2int_shared_gsi_attr_is_transient(gsi_structure)
    Object gsi_structure;
{
    SI_Long result_1, gsi_fc_result;

    x_note_fn_call(47,527);
    if ( !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_is_transient,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_attr_is_transient;
    }
    gsi_fc_result = (SI_Long)1L == ((SI_Long)1L & 
	    IFIX(ISVREF(gsi_structure,(SI_Long)3L))) ? (SI_Long)1L : 
	    (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_attr_is_transient:;
    return result_1;
}

static Object string_constant_213;  /* "gsi_attr_is_transient" */

/* GSI-ATTR-IS-TRANSIENT */
DLLEXPORT SI_Long gsi_attr_is_transient(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,528);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_213);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_attr_is_transient(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_attr_is_transient(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_213);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_attr_is_transient;  /* |gsi_set_attr_is_transient| */

/* SHARED-GSI-SET-ATTR-IS-TRANSIENT */
void g2int_shared_gsi_set_attr_is_transient(gsi_structure,
	    gsi_fc_outer_new_value)
    Object gsi_structure;
    SI_Long gsi_fc_outer_new_value;
{
    Object new_value;
    SI_Long value;

    x_note_fn_call(47,529);
    value = gsi_fc_outer_new_value;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_is_transient,Qerror,T);
	goto end_shared_gsi_set_attr_is_transient;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_is_transient,Qerror,T);
	goto end_shared_gsi_set_attr_is_transient;
    }
    new_value = LONG_TO_FIXNUM(value);
    if ( !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_is_transient,Qerror,T);
	goto end_shared_gsi_set_attr_is_transient;
    }
    g2int_set_gsi_attribute_is_transient_p(gsi_structure,(SI_Long)0L != 
	    IFIX(new_value) ? T : Nil);
  end_shared_gsi_set_attr_is_transient:;
}

static Object string_constant_214;  /* "gsi_set_attr_is_transient" */

/* GSI-SET-ATTR-IS-TRANSIENT */
DLLEXPORT void gsi_set_attr_is_transient(gsi_structure,new_value)
    Object gsi_structure;
    SI_Long new_value;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,530);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_214);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_attr_is_transient(gsi_structure,new_value);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_attr_is_transient(gsi_structure,
			    new_value);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_214);
}

static Object Qg2int_gsi_attr_is_identifying;  /* |gsi_attr_is_identifying| */

/* SHARED-GSI-ATTR-IS-IDENTIFYING */
SI_Long g2int_shared_gsi_attr_is_identifying(gsi_structure)
    Object gsi_structure;
{
    SI_Long result_1, gsi_fc_result;

    x_note_fn_call(47,531);
    if ( !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_attr_is_identifying,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_attr_is_identifying;
    }
    gsi_fc_result = (SI_Long)2L == ((SI_Long)2L & 
	    IFIX(ISVREF(gsi_structure,(SI_Long)3L))) ? (SI_Long)1L : 
	    (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_attr_is_identifying:;
    return result_1;
}

static Object string_constant_215;  /* "gsi_attr_is_identifying" */

/* GSI-ATTR-IS-IDENTIFYING */
DLLEXPORT SI_Long gsi_attr_is_identifying(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,532);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_215);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_attr_is_identifying(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_attr_is_identifying(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_215);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_attr_is_identifying;  /* |gsi_set_attr_is_identifying| */

/* SHARED-GSI-SET-ATTR-IS-IDENTIFYING */
void g2int_shared_gsi_set_attr_is_identifying(gsi_structure,
	    gsi_fc_outer_new_value)
    Object gsi_structure;
    SI_Long gsi_fc_outer_new_value;
{
    Object new_value;
    SI_Long value;

    x_note_fn_call(47,533);
    value = gsi_fc_outer_new_value;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_is_identifying,Qerror,T);
	goto end_shared_gsi_set_attr_is_identifying;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_is_identifying,Qerror,T);
	goto end_shared_gsi_set_attr_is_identifying;
    }
    new_value = LONG_TO_FIXNUM(value);
    if ( !(SIMPLE_VECTOR_P(gsi_structure) && EQ(ISVREF(gsi_structure,
	    (SI_Long)0L),
	    Qg2_defstruct_structure_name_gsi_attribute_g2_struct))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_incompatible_type,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_attr_is_identifying,Qerror,T);
	goto end_shared_gsi_set_attr_is_identifying;
    }
    g2int_set_gsi_attribute_is_identifying_p(gsi_structure,(SI_Long)0L != 
	    IFIX(new_value) ? T : Nil);
  end_shared_gsi_set_attr_is_identifying:;
}

static Object string_constant_216;  /* "gsi_set_attr_is_identifying" */

/* GSI-SET-ATTR-IS-IDENTIFYING */
DLLEXPORT void gsi_set_attr_is_identifying(gsi_structure,new_value)
    Object gsi_structure;
    SI_Long new_value;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,534);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_216);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_attr_is_identifying(gsi_structure,new_value);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_attr_is_identifying(gsi_structure,
			    new_value);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_216);
}

static Object Qg2int_gsi_is_item;  /* |gsi_is_item| */

/* SHARED-GSI-IS-ITEM */
SI_Long g2int_shared_gsi_is_item(gsi_structure)
    Object gsi_structure;
{
    Object instance, gsi_instance_extension;
    SI_Long result_1, gsi_fc_result;

    x_note_fn_call(47,535);
    instance = g2int_get_instance_for_read_1(gsi_structure,
	    G2int_gsi_incompatible_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_is_item,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_is_item;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    gsi_fc_result = (gsi_instance_extension ? 
	    TRUEP(ISVREF(gsi_instance_extension,(SI_Long)2L)) : 
	    TRUEP(Nil)) ? (SI_Long)1L : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_is_item:;
    return result_1;
}

static Object string_constant_217;  /* "gsi_is_item" */

/* GSI-IS-ITEM */
DLLEXPORT SI_Long gsi_is_item(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,536);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_217);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_is_item(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_is_item(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_217);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_class_type_of;  /* |gsi_class_type_of| */

/* SHARED-GSI-CLASS-TYPE-OF */
SI_Long g2int_shared_gsi_class_type_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, gsi_instance_extension;
    SI_Long result_1, gsi_fc_result;

    x_note_fn_call(47,537);
    instance = g2int_get_instance_for_read_1(gsi_structure,
	    G2int_gsi_incompatible_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_class_type_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_class_type_of;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    gsi_fc_result = gsi_instance_extension ? 
	    FIXNUM_TO_LONG(ISVREF(gsi_instance_extension,(SI_Long)3L)) : 
	    (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_class_type_of:;
    return result_1;
}

static Object string_constant_218;  /* "gsi_class_type_of" */

/* GSI-CLASS-TYPE-OF */
DLLEXPORT SI_Long gsi_class_type_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,538);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_218);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_class_type_of(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_class_type_of(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_218);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_set_class_type;  /* |gsi_set_class_type| */

/* SHARED-GSI-SET-CLASS-TYPE */
void g2int_shared_gsi_set_class_type(gsi_structure,gsi_fc_outer_type)
    Object gsi_structure;
    SI_Long gsi_fc_outer_type;
{
    Object type, instance, gsi_instance_extension;
    SI_Long value;
    SI_Long instance_type;

    x_note_fn_call(47,539);
    value = gsi_fc_outer_type;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_class_type,Qerror,T);
	goto end_shared_gsi_set_class_type;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_class_type,Qerror,T);
	goto end_shared_gsi_set_class_type;
    }
    type = LONG_TO_FIXNUM(value);
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_class_type,Qerror,T);
	goto end_shared_gsi_set_class_type;
    }
    instance_type = IFIX(ISVREF(instance,(SI_Long)1L)) >>  -  - (SI_Long)3L;
    if ( !(instance_type == IFIX(G2int_gsi_null_type_tag))) {
	if ( !(instance_type == IFIX(type) || FIXNUM_EQ(type,
		G2int_gsi_quantity_type_tag) && (instance_type == 
		IFIX(G2int_gsi_integer_type_tag) || instance_type == 
		IFIX(G2int_gsi_64bit_float_type_tag)))) {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_invalid_type,type,
		    Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_class_type,Qerror,T);
	    goto end_shared_gsi_set_class_type;
	}
    }
    else if ( !(FIXNUM_EQ(type,G2int_gsi_null_type_tag) || FIXNUM_EQ(type,
	    G2int_gsi_integer_type_tag) || FIXNUM_EQ(type,
	    G2int_gsi_logical_type_tag) || FIXNUM_EQ(type,
	    G2int_gsi_string_type_tag) || FIXNUM_EQ(type,
	    G2int_gsi_64bit_float_type_tag) || FIXNUM_EQ(type,
	    G2int_gsi_symbol_type_tag) || FIXNUM_EQ(type,
	    G2int_gsi_quantity_type_tag))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_invalid_type,type,Nil,
		Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_class_type,Qerror,T);
	goto end_shared_gsi_set_class_type;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(instance,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)3L)) = type;
  end_shared_gsi_set_class_type:;
}

static Object string_constant_219;  /* "gsi_set_class_type" */

/* GSI-SET-CLASS-TYPE */
DLLEXPORT void gsi_set_class_type(gsi_structure,type)
    Object gsi_structure;
    SI_Long type;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,540);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_219);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_class_type(gsi_structure,type);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_class_type(gsi_structure,type);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_219);
}

static Object Qg2int_gsi_history_count_of;  /* |gsi_history_count_of| */

/* SHARED-GSI-HISTORY-COUNT-OF */
SI_Long g2int_shared_gsi_history_count_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, gsi_instance_extension, history_qm;
    SI_Long result_1, gsi_fc_result;

    x_note_fn_call(47,541);
    instance = g2int_get_instance_for_read_1(gsi_structure,
	    G2int_gsi_incompatible_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_history_count_of,Qerror,T);
	result_1 = (SI_Long)0L;
	goto end_shared_gsi_history_count_of;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    history_qm = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)12L) : Nil;
    gsi_fc_result = history_qm ? FIXNUM_TO_LONG(ISVREF(history_qm,
	    (SI_Long)1L)) : (SI_Long)0L;
    result_1 = gsi_fc_result;
  end_shared_gsi_history_count_of:;
    return result_1;
}

static Object string_constant_220;  /* "gsi_history_count_of" */

/* GSI-HISTORY-COUNT-OF */
DLLEXPORT SI_Long gsi_history_count_of(gsi_structure)
    Object gsi_structure;
{
    volatile Object result_1;
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    SI_Long result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,542);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_220);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = 
		    LONG_TO_FIXNUM(g2int_shared_gsi_history_count_of(gsi_structure));
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = 
			    LONG_TO_FIXNUM(g2int_shared_gsi_history_count_of(gsi_structure));
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_220);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

static Object Qg2int_gsi_extract_history;  /* |gsi_extract_history| */

/* SHARED-GSI-EXTRACT-HISTORY */
void g2int_shared_gsi_extract_history(gsi_structure,values_result,
	    timestamps_result,type_result)
    Object gsi_structure, values_result, timestamps_result, type_result;
{
    Object instance, gsi_instance_extension, history_qm, history_type;
    Object history_values, temp;

    x_note_fn_call(47,543);
    instance = g2int_get_instance_for_read_1(gsi_structure,
	    G2int_gsi_incompatible_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_extract_history,Qerror,T);
	goto end_shared_gsi_extract_history;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    history_qm = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)12L) : Nil;
    if ( !TRUEP(history_qm)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_structure_has_no_history,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_extract_history,Qerror,T);
	goto end_shared_gsi_extract_history;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    history_type = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)3L) : FIX((SI_Long)0L);
    history_values = ISVREF(history_qm,(SI_Long)2L);
    if ( !(FIXNUMP(history_type) && FIXNUM_LE(FIX((SI_Long)-128L),
	    history_type) && FIXNUM_LE(history_type,FIX((SI_Long)127L)))) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_invalid_history_type,
		Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_extract_history,Qerror,T);
	goto end_shared_gsi_extract_history;
    }
    else
	switch (INTEGER_TO_CHAR(history_type)) {
	  case 1:
	  case 5:
	  case 3:
	  case 4:
	  case 11:
	    temp = inline_extract_c_long_array(history_values);
	    break;
	  case 6:
	    temp = inline_extract_c_double_array(history_values);
	    break;
	  case 8:
	  case 10:
	    temp = inline_extract_c_array(history_values,
		    G2int_gsi_magic_offset);
	    break;
	  default:
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_invalid_history_type,Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_extract_history,Qerror,T);
	    goto end_shared_gsi_extract_history;
	    break;
	}
    inline_assign_value_to_c_pointer(values_result,temp);
    inline_assign_value_to_c_pointer(timestamps_result,
	    inline_extract_c_double_array(ISVREF(history_qm,(SI_Long)3L)));
    inline_assign_fixnum_to_c_pointer(type_result,history_type);
  end_shared_gsi_extract_history:;
}

static Object string_constant_221;  /* "gsi_extract_history" */

/* GSI-EXTRACT-HISTORY */
DLLEXPORT void gsi_extract_history(gsi_structure,values_result,
	    timestamps_result,type_result)
    Object gsi_structure, values_result, timestamps_result, type_result;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,544);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_221);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_extract_history(gsi_structure,values_result,
		    timestamps_result,type_result);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_extract_history(gsi_structure,
			    values_result,timestamps_result,type_result);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_221);
}

static Object Qg2int_gsi_extract_history_spec;  /* |gsi_extract_history_spec| */

/* SHARED-GSI-EXTRACT-HISTORY-SPEC */
void g2int_shared_gsi_extract_history_spec(gsi_structure,max_count_result,
	    max_age_result,granularity_result)
    Object gsi_structure, max_count_result, max_age_result, granularity_result;
{
    Object instance, gsi_instance_extension, history_qm, history_spec;
    Object max_count_qm, max_age_qm, granularity_qm, temp;

    x_note_fn_call(47,545);
    instance = g2int_get_instance_for_read_1(gsi_structure,
	    G2int_gsi_incompatible_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_extract_history_spec,Qerror,T);
	goto end_shared_gsi_extract_history_spec;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    history_qm = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)12L) : Nil;
    if ( !TRUEP(history_qm)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_structure_has_no_history,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_extract_history_spec,Qerror,T);
	goto end_shared_gsi_extract_history_spec;
    }
    history_spec = ISVREF(history_qm,(SI_Long)4L);
    max_count_qm = SECOND(history_spec);
    max_age_qm = THIRD(history_spec);
    granularity_qm = FOURTH(history_spec);
    temp = max_count_qm;
    if (temp);
    else
	temp = FIX((SI_Long)0L);
    inline_assign_fixnum_to_c_pointer(max_count_result,temp);
    temp = max_age_qm;
    if (temp);
    else
	temp = FIX((SI_Long)0L);
    inline_assign_fixnum_to_c_pointer(max_age_result,temp);
    temp = granularity_qm;
    if (temp);
    else
	temp = FIX((SI_Long)1000L);
    inline_assign_fixnum_to_c_pointer(granularity_result,temp);
  end_shared_gsi_extract_history_spec:;
}

static Object string_constant_222;  /* "gsi_extract_history_spec" */

/* GSI-EXTRACT-HISTORY-SPEC */
DLLEXPORT void gsi_extract_history_spec(gsi_structure,max_count_result,
	    max_age_result,granularity_result)
    Object gsi_structure, max_count_result, max_age_result, granularity_result;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,546);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_222);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_extract_history_spec(gsi_structure,
		    max_count_result,max_age_result,granularity_result);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_extract_history_spec(gsi_structure,
			    max_count_result,max_age_result,
			    granularity_result);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_222);
}

static Object Qg2int_gsi_set_history;  /* |gsi_set_history| */

/* SHARED-GSI-SET-HISTORY */
void g2int_shared_gsi_set_history(wide_api_p,gsi_structure,c_value_array,
	    c_timestamp_array,gsi_fc_outer_tuple_count,
	    gsi_fc_outer_history_type,gsi_fc_outer_c_max_count,
	    gsi_fc_outer_c_max_age,gsi_fc_outer_c_granularity)
    Object wide_api_p, gsi_structure, c_value_array, c_timestamp_array;
    SI_Long gsi_fc_outer_tuple_count, gsi_fc_outer_history_type;
    SI_Long gsi_fc_outer_c_max_count, gsi_fc_outer_c_max_age;
    SI_Long gsi_fc_outer_c_granularity;
{
    Object tuple_count, history_type, c_max_count, c_max_age, c_granularity;
    Object instance, max_count_qm, max_age_qm, granularity_qm;
    Object gsi_instance_extension, old_history_qm, new_values, magic_number;
    Object value_count, history_structure, history_values, history_timestamps;
    Object api_c_string, svref_new_value, symbol;
    SI_Long value;
    SI_Long index_1, ab_loop_bind_, aref_new_value_1;
    double aref_new_value;

    x_note_fn_call(47,547);
    value = gsi_fc_outer_tuple_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    tuple_count = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_history_type;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    history_type = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_c_max_count;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    c_max_count = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_c_max_age;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    c_max_age = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_c_granularity;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    c_granularity = LONG_TO_FIXNUM(value);
    if (IFIX(c_max_count) > (SI_Long)0L && FIXNUM_GT(tuple_count,
		c_max_count)) {
	g2int_set_gsi_error_message_1(Nil,
		G2int_gsi_incompatible_history_spec,tuple_count,
		c_max_count,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    if ( !(c_value_array && c_timestamp_array)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_null_pointer_argument,
		Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    instance = g2int_get_instance_for_write_1(gsi_structure);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	goto end_shared_gsi_set_history;
    }
    max_count_qm = IFIX(c_max_count) == (SI_Long)0L ? Nil : c_max_count;
    max_age_qm = IFIX(c_max_age) == (SI_Long)0L ? Nil : c_max_age;
    granularity_qm = IFIX(c_granularity) == (SI_Long)1000L ? Nil : 
	    c_granularity;
    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
    old_history_qm = gsi_instance_extension ? 
	    ISVREF(gsi_instance_extension,(SI_Long)12L) : Nil;
    new_values = Nil;
    g2int_gsi_set_history_type(instance,history_type);
    if (EQ(history_type,G2int_gsi_value_type_tag) || EQ(history_type,
	    G2int_gsi_quantity_type_tag)) {
	magic_number = inline_gsi_get_magic_header(c_value_array);
	if (IFIX(magic_number) == (SI_Long)5472500L)
	    new_values = inline_get_array_from_c(c_value_array,
		    G2int_gsi_magic_offset);
	else {
	    g2int_set_gsi_error_message_1(Nil,G2int_gsi_bad_magic_number,
		    Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	    goto end_shared_gsi_set_history;
	}
	value_count = g2int_gsi_managed_array_length(new_values);
	if (FIXNUM_GT(tuple_count,FIXNUM_SUB1(value_count))) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_count_out_of_array_bounds,tuple_count,
		    FIXNUM_SUB1(value_count),Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	    goto end_shared_gsi_set_history;
	}
    }
    history_structure = g2int_make_gsi_history(8,instance,tuple_count,
	    new_values,Nil,Nil,max_count_qm,max_age_qm,granularity_qm);
    history_values = ISVREF(history_structure,(SI_Long)2L);
    history_timestamps = ISVREF(history_structure,(SI_Long)3L);
    index_1 = (SI_Long)0L;
    ab_loop_bind_ = IFIX(tuple_count);
  next_loop:
    if (index_1 >= ab_loop_bind_)
	goto end_loop;
    aref_new_value = inline_get_c_double_element(c_timestamp_array,index_1);
    DFLOAT_ISASET_1(history_timestamps,index_1,aref_new_value);
    index_1 = index_1 + (SI_Long)1L;
    goto next_loop;
  end_loop:;
    if ( !(FIXNUMP(history_type) && FIXNUM_LE(FIX((SI_Long)-128L),
	    history_type) && FIXNUM_LE(history_type,FIX((SI_Long)127L)))) {
	if ( !(EQ(history_type,G2int_gsi_value_type_tag) || 
		EQ(history_type,G2int_gsi_quantity_type_tag))) {
	    g2int_set_gsi_error_message_1(Nil,
		    G2int_gsi_invalid_history_type,Nil,Nil,Nil,Nil,Nil,Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
	    goto end_shared_gsi_set_history;
	}
    }
    else
	switch (INTEGER_TO_CHAR(history_type)) {
	  case 1:
	  case 5:
	    index_1 = (SI_Long)0L;
	    ab_loop_bind_ = IFIX(tuple_count);
	  next_loop_1:
	    if (index_1 >= ab_loop_bind_)
		goto end_loop_1;
	    aref_new_value_1 = inline_get_c_long_element(c_value_array,
		    index_1);
	    BYTE_32_ISASET_1(history_values,index_1,aref_new_value_1);
	    index_1 = index_1 + (SI_Long)1L;
	    goto next_loop_1;
	  end_loop_1:;
	    break;
	  case 6:
	    index_1 = (SI_Long)0L;
	    ab_loop_bind_ = IFIX(tuple_count);
	  next_loop_2:
	    if (index_1 >= ab_loop_bind_)
		goto end_loop_2;
	    aref_new_value = inline_get_c_double_element(c_value_array,
		    index_1);
	    DFLOAT_ISASET_1(history_values,index_1,aref_new_value);
	    index_1 = index_1 + (SI_Long)1L;
	    goto next_loop_2;
	  end_loop_2:;
	    break;
	  case 4:
	    index_1 = (SI_Long)0L;
	    ab_loop_bind_ = IFIX(tuple_count);
	  next_loop_3:
	    if (index_1 >= ab_loop_bind_)
		goto end_loop_3;
	    api_c_string = wide_api_p ? 
		    inline_get_c_wide_char_ptr_element(c_value_array,
		    FIX(index_1)) : 
		    inline_get_c_char_ptr_element(c_value_array,FIX(index_1));
	    svref_new_value = inline_extract_c_string(wide_api_p ? 
		    g2int_c_wide_string_to_gsi_string(api_c_string) : 
		    g2int_c_string_to_gsi_string(api_c_string));
	    ISVREF(history_values,index_1) = svref_new_value;
	    index_1 = index_1 + (SI_Long)1L;
	    goto next_loop_3;
	  end_loop_3:;
	    break;
	  case 3:
	    index_1 = (SI_Long)0L;
	    ab_loop_bind_ = IFIX(tuple_count);
	  next_loop_4:
	    if (index_1 >= ab_loop_bind_)
		goto end_loop_4;
	    if (g2int_gsi_option_is_set_p(G2int_gsi_new_symbol_api))
		svref_new_value = 
			inline_get_c_char_ptr_element(c_value_array,
			FIX(index_1));
	    else {
		api_c_string = wide_api_p ? 
			inline_get_c_wide_char_ptr_element(c_value_array,
			FIX(index_1)) : 
			inline_get_c_char_ptr_element(c_value_array,
			FIX(index_1));
		symbol =  !TRUEP(api_c_string) ? Nil : 
			g2int_symbol_for_gsi_string(wide_api_p ? 
			g2int_c_wide_string_to_text_string(api_c_string) : 
			g2int_c_string_to_gensym_string(api_c_string));
		svref_new_value = 
			inline_extract_c_string(g2int_gsi_string_for_symbol(symbol,
			G2int_gsi_wide_api_p));
	    }
	    ISVREF(history_values,index_1) = svref_new_value;
	    index_1 = index_1 + (SI_Long)1L;
	    goto next_loop_4;
	  end_loop_4:;
	    break;
	  default:
	    if ( !(EQ(history_type,G2int_gsi_value_type_tag) || 
		    EQ(history_type,G2int_gsi_quantity_type_tag))) {
		g2int_set_gsi_error_message_1(Nil,
			G2int_gsi_invalid_history_type,Nil,Nil,Nil,Nil,Nil,
			Nil);
		g2int_gsi_handle_error_1(Qg2int_gsi_set_history,Qerror,T);
		goto end_shared_gsi_set_history;
	    }
	    break;
	}
    gsi_instance_extension = ISVREF(gsi_structure,(SI_Long)3L);
    if ( !TRUEP(gsi_instance_extension)) {
	gsi_instance_extension = g2int_make_gsi_instance_extension_1();
	SVREF(gsi_structure,FIX((SI_Long)3L)) = gsi_instance_extension;
    }
    SVREF(gsi_instance_extension,FIX((SI_Long)12L)) = history_structure;
    if (old_history_qm)
	g2int_reclaim_gsi_history(old_history_qm);
  end_shared_gsi_set_history:;
}

static Object string_constant_223;  /* "gsi_set_history" */

/* GSI-SET-HISTORY */
DLLEXPORT void gsi_set_history(gsi_structure,c_value_array,
	    c_timestamp_array,tuple_count,history_type,c_max_count,
	    c_max_age,c_granularity)
    Object gsi_structure, c_value_array, c_timestamp_array;
    SI_Long tuple_count, history_type, c_max_count, c_max_age, c_granularity;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,548);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_223);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_history(G2int_gsi_wide_api_p,
		    gsi_structure,c_value_array,c_timestamp_array,
		    tuple_count,history_type,c_max_count,c_max_age,
		    c_granularity);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_history(G2int_gsi_wide_api_p,
			    gsi_structure,c_value_array,c_timestamp_array,
			    tuple_count,history_type,c_max_count,c_max_age,
			    c_granularity);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_223);
}

static Object Qg2int_shared_gsi_set_timestamp;  /* shared-gsi-set-timestamp */

static Object Qg2int_gsi_set_timestamp;  /* |gsi_set_timestamp| */

static Object float_constant;      /* 2.145934799E+# */

/* SHARED-GSI-SET-TIMESTAMP */
void g2int_shared_gsi_set_timestamp(gsi_instance,gsi_fc_outer_timestamp)
    Object gsi_instance;
    double gsi_fc_outer_timestamp;
{
    Object tag_temp, instance, gsi_instance_extension, instance_timestamp_qm;
    Object amf_available_array_cons_qm, amf_array, temp_1, svref_new_value;
    Object amf_result, incff_1_arg, new_float;
    char temp;
    double timestamp, timestamp_1, arg, arg_1;
    Declare_catch(1);
    XDeclare_area(1);
    XDeclare_frontier(1);
    Object result;

    x_note_fn_call(47,549);
    tag_temp = UNIQUE_TAG(Qg2int_shared_gsi_set_timestamp);
    if (PUSH_CATCH(tag_temp,0)) {
	timestamp = 
		inline_maybe_swap_float_bytes_for_alpha_gfloats(gsi_fc_outer_timestamp,
		g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? 
		(SI_Long)1L : (SI_Long)0L);
	instance = g2int_get_instance_for_write_1(gsi_instance);
	if (FIXNUMP(instance)) {
	    g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,
		    Nil);
	    g2int_gsi_handle_error_1(Qg2int_gsi_set_timestamp,Qerror,T);
	    result = VALUES_1(Qnil);
	    THROW(tag_temp,result);
	}
	gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
	instance_timestamp_qm = gsi_instance_extension ? 
		ISVREF(gsi_instance_extension,(SI_Long)10L) : Nil;
	if (PUSH_LOCAL_ALLOCATION(Local_area,0,0)) {
	    timestamp_1 = inline_convert_from_local_float_format(timestamp,
		    g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? 
		    (SI_Long)1L : (SI_Long)0L);
	    arg = timestamp_1;
	    arg_1 = 0.0;
	    if (arg > arg_1 &&  !inline_nanp_for_comparison(arg) &&  
		    !inline_nanp_for_comparison(arg_1)) {
		arg = timestamp_1;
		arg_1 = 2.145934799E+9;
		temp = arg < arg_1 &&  !inline_nanp_for_comparison(arg) ?  
			!inline_nanp_for_comparison(arg_1) : TRUEP(Qnil);
	    }
	    else
		temp = TRUEP(Nil);
	    if (temp) {
		if (instance_timestamp_qm && 
			INLINE_DOUBLE_FLOAT_VECTOR_P(instance_timestamp_qm) 
			!= (SI_Long)0L && 
			IFIX(SIMPLE_ARRAY_ANY_1_LENGTH(instance_timestamp_qm)) 
			== (SI_Long)1L)
		    DFLOAT_ISASET_1(instance_timestamp_qm,(SI_Long)0L,
			    timestamp);
		else {
		    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
		    if ( !TRUEP(gsi_instance_extension)) {
			gsi_instance_extension = 
				g2int_make_gsi_instance_extension_1();
			SVREF(instance,FIX((SI_Long)3L)) = 
				gsi_instance_extension;
		    }
		    amf_available_array_cons_qm = 
			    ISVREF(G2int_vector_of_simple_float_array_pools,
			    (SI_Long)1L);
		    if (amf_available_array_cons_qm) {
			amf_array = M_CAR(amf_available_array_cons_qm);
			temp_1 = G2int_vector_of_simple_float_array_pools;
			svref_new_value = M_CDR(amf_available_array_cons_qm);
			SVREF(temp_1,FIX((SI_Long)1L)) = svref_new_value;
			inline_note_reclaim_cons(amf_available_array_cons_qm,
				Qg2int_gensym);
			temp_1 = G2int_available_gensym_conses;
			M_CDR(amf_available_array_cons_qm) = temp_1;
			G2int_available_gensym_conses = 
				amf_available_array_cons_qm;
			amf_result = amf_array;
		    }
		    else {
			temp_1 = 
				FIXNUM_ADD1(G2int_created_simple_float_array_pool_arrays);
			G2int_created_simple_float_array_pool_arrays = temp_1;
			incff_1_arg = 
				g2int_bytes_per_double_float_simple_array(FIX((SI_Long)1L));
			temp_1 = 
				FIXNUM_ADD(G2int_simple_float_array_pool_memory_usage,
				incff_1_arg);
			G2int_simple_float_array_pool_memory_usage = temp_1;
			amf_result = 
				g2int_generate_float_vector(FIX((SI_Long)1L));
		    }
		    new_float = amf_result;
		    DFLOAT_ISASET_1(new_float,(SI_Long)0L,timestamp);
		    SVREF(gsi_instance_extension,FIX((SI_Long)10L)) = 
			    new_float;
		}
	    }
	    else {
		g2int_set_gsi_error_message_1(Nil,
			G2int_gsi_timestamp_out_of_bounds,
			DOUBLE_TO_DOUBLE_FLOAT(timestamp_1),float_constant,
			Nil,Nil,Nil,Nil);
		g2int_gsi_handle_error_1(Qg2int_gsi_set_timestamp,Qerror,T);
		result = VALUES_1(Qnil);
		THROW(tag_temp,result);
	    }
	}
	POP_LOCAL_ALLOCATION(0,0);
    }
    POP_CATCH(0);
}

static Object string_constant_224;  /* "gsi_set_timestamp" */

/* GSI-SET-TIMESTAMP */
DLLEXPORT void gsi_set_timestamp(gsi_instance,timestamp)
    Object gsi_instance;
    double timestamp;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,550);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_224);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_set_timestamp(gsi_instance,timestamp);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_set_timestamp(gsi_instance,timestamp);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_224);
}

static Object Qg2int_gsi_timestamp_of;  /* |gsi_timestamp_of| */

static Object Qg2int_timestamp_of;  /* timestamp_of */

/* SHARED-GSI-TIMESTAMP-OF */
double g2int_shared_gsi_timestamp_of(gsi_structure)
    Object gsi_structure;
{
    Object instance, gsi_instance_extension, timestamp_qm;
    double result_1, gsi_fc_result;

    x_note_fn_call(47,551);
    instance = g2int_get_instance_for_read_1(gsi_structure,Nil);
    if (FIXNUMP(instance)) {
	g2int_set_gsi_error_message_1(Nil,instance,Nil,Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_timestamp_of,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_timestamp_of;
    }
    gsi_instance_extension = ISVREF(instance,(SI_Long)3L);
    timestamp_qm = gsi_instance_extension ? ISVREF(gsi_instance_extension,
	    (SI_Long)10L) : Nil;
    if (timestamp_qm)
	gsi_fc_result = DFLOAT_ISAREF_1(timestamp_qm,(SI_Long)0L);
    else {
	g2int_gsi_warning(2,Qg2int_timestamp_of,G2int_gsi_timestamp_not_found);
	gsi_fc_result = 0.0;
    }
    result_1 = 
	    inline_maybe_swap_float_bytes_for_alpha_gfloats(gsi_fc_result,
	    g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? (SI_Long)1L 
	    : (SI_Long)0L);
  end_shared_gsi_timestamp_of:;
    return result_1;
}

static Object string_constant_225;  /* "gsi_timestamp_of" */

/* GSI-TIMESTAMP-OF */
DLLEXPORT double gsi_timestamp_of(gsi_structure)
    Object gsi_structure;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    volatile double result_1;
    double result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,552);
    result_1 = 0.0;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_225);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_timestamp_of(gsi_structure);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_timestamp_of(gsi_structure);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_225);
    result_2 = result_1;
    return result_2;
}

static Object Qg2int_gsi_encode_timestamp;  /* |gsi_encode_timestamp| */

/* SHARED-GSI-ENCODE-TIMESTAMP */
double g2int_shared_gsi_encode_timestamp(gsi_fc_outer_year,
	    gsi_fc_outer_month,gsi_fc_outer_day,gsi_fc_outer_hour,
	    gsi_fc_outer_minute,gsi_fc_outer_second)
    SI_Long gsi_fc_outer_year, gsi_fc_outer_month, gsi_fc_outer_day;
    SI_Long gsi_fc_outer_hour, gsi_fc_outer_minute, gsi_fc_outer_second;
{
    Object year, month, day, hour, minute, second_1, mangled_float;
    SI_Long value;
    double result_1, stamp, gsi_fc_result;

    x_note_fn_call(47,553);
    value = gsi_fc_outer_year;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    year = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_month;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    month = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_day;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    day = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_hour;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    hour = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_minute;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    minute = LONG_TO_FIXNUM(value);
    value = gsi_fc_outer_second;
    if (IFIX(Most_positive_fixnum) < value) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_large,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    if (value < IFIX(Most_negative_fixnum)) {
	g2int_set_gsi_error_message_1(Nil,G2int_gsi_integer_too_small,Nil,
		Nil,Nil,Nil,Nil,Nil);
	g2int_gsi_handle_error_1(Qg2int_gsi_encode_timestamp,Qerror,T);
	result_1 = 0.0;
	goto end_shared_gsi_encode_timestamp;
    }
    second_1 = LONG_TO_FIXNUM(value);
    mangled_float = 
	    g2int_gensym_encode_unix_time_as_managed_float(second_1,minute,
	    hour,day,month,year);
    stamp = DFLOAT_ISAREF_1(mangled_float,(SI_Long)0L);
    g2int_reclaim_managed_simple_float_array_of_length_1(mangled_float);
    gsi_fc_result = inline_convert_to_local_float_format(stamp,
	    g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? (SI_Long)1L 
	    : (SI_Long)0L);
    result_1 = 
	    inline_maybe_swap_float_bytes_for_alpha_gfloats(gsi_fc_result,
	    g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? (SI_Long)1L 
	    : (SI_Long)0L);
  end_shared_gsi_encode_timestamp:;
    return result_1;
}

static Object string_constant_226;  /* "gsi_encode_timestamp" */

/* GSI-ENCODE-TIMESTAMP */
DLLEXPORT double gsi_encode_timestamp(year,month,day,hour,minute,second_1)
    SI_Long year, month, day, hour, minute, second_1;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    volatile double result_1;
    double result_2;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,554);
    result_1 = 0.0;
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_226);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    result_1 = g2int_shared_gsi_encode_timestamp(year,month,day,
		    hour,minute,second_1);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    result_1 = g2int_shared_gsi_encode_timestamp(year,
			    month,day,hour,minute,second_1);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_226);
    result_2 = result_1;
    return result_2;
}

/* SHARED-GSI-DECODE-TIMESTAMP */
void g2int_shared_gsi_decode_timestamp(gsi_fc_outer_timestamp,year_result,
	    month_result,day_result,hour_result,minute_result,second_result)
    Object year_result, month_result, day_result, hour_result, minute_result;
    Object second_result;
    double gsi_fc_outer_timestamp;
{
    Object second_1, minute, hour, day, month, year;
    double timestamp;
    XDeclare_area(1);
    XDeclare_frontier(1);
    Object result;

    x_note_fn_call(47,555);
    timestamp = 
	    inline_maybe_swap_float_bytes_for_alpha_gfloats(gsi_fc_outer_timestamp,
	    g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? (SI_Long)1L 
	    : (SI_Long)0L);
    if (PUSH_LOCAL_ALLOCATION(Local_area,0,0)) {
	result = g2int_gensym_decode_unix_time(DOUBLE_TO_DOUBLE_FLOAT(inline_convert_from_local_float_format(timestamp,
		g2int_gsi_option_is_set_p(G2int_gsi_use_gfloats) ? 
		(SI_Long)1L : (SI_Long)0L)));
	MVS_6(result,second_1,minute,hour,day,month,year);
	inline_assign_fixnum_to_c_pointer(year_result,year);
	inline_assign_fixnum_to_c_pointer(month_result,month);
	inline_assign_fixnum_to_c_pointer(day_result,day);
	inline_assign_fixnum_to_c_pointer(hour_result,hour);
	inline_assign_fixnum_to_c_pointer(minute_result,minute);
	inline_assign_fixnum_to_c_pointer(second_result,second_1);
    }
    POP_LOCAL_ALLOCATION(0,0);
}

static Object string_constant_227;  /* "gsi_decode_timestamp" */

/* GSI-DECODE-TIMESTAMP */
DLLEXPORT void gsi_decode_timestamp(timestamp,year_result,month_result,
	    day_result,hour_result,minute_result,second_result)
    Object year_result, month_result, day_result, hour_result, minute_result;
    Object second_result;
    double timestamp;
{
    Object in_recursive_gsi_context, in_unprotected_gsi_api_call_p;
    Object shutdown_catch_tag, top_level_error_catcher_tag, abort_level_0_tag;
    Declare_catch(1);
    Declare_special(4);

    x_note_fn_call(47,556);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_227);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,3);
      if ( !TRUEP(g2int_protect_gsi_api_call_p())) {
	  in_unprotected_gsi_api_call_p = T;
	  PUSH_SPECIAL(G2int_in_unprotected_gsi_api_call_p,in_unprotected_gsi_api_call_p,
		  0);
	    g2int_shared_gsi_decode_timestamp(timestamp,year_result,
		    month_result,day_result,hour_result,minute_result,
		    second_result);
	  POP_SPECIAL();
      }
      else {
	  if (PUSH_CATCH(Qg2int_gsi_catch,0)) {
	      shutdown_catch_tag = Qg2int_gsi_catch;
	      top_level_error_catcher_tag = Qg2int_gsi_catch;
	      abort_level_0_tag = Qg2int_gsi_catch;
	      PUSH_SPECIAL(G2int_abort_level_0_tag,abort_level_0_tag,2);
		PUSH_SPECIAL(G2int_top_level_error_catcher_tag,top_level_error_catcher_tag,
			1);
		  PUSH_SPECIAL(G2int_shutdown_catch_tag,shutdown_catch_tag,0);
		    g2int_shared_gsi_decode_timestamp(timestamp,
			    year_result,month_result,day_result,
			    hour_result,minute_result,second_result);
		  POP_SPECIAL();
		POP_SPECIAL();
	      POP_SPECIAL();
	  }
	  POP_CATCH(0);
      }
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_227);
}

/* SHARED-GSI-MAJOR-VERSION */
SI_Long g2int_shared_gsi_major_version()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,557);
    gsi_fc_result = 
	    FIXNUM_TO_LONG(G2int_major_version_number_of_current_gensym_product_line);
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_228;  /* "gsi_major_version" */

/* GSI-MAJOR-VERSION */
DLLEXPORT SI_Long gsi_major_version()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,558);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_228);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_major_version());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_228);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

/* SHARED-GSI-MINOR-VERSION */
SI_Long g2int_shared_gsi_minor_version()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,559);
    gsi_fc_result = 
	    FIXNUM_TO_LONG(g2int_chestnut_floorf_function(G2int_minor_version_number_of_current_gensym_product_line,
	    FIX((SI_Long)10L)));
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_229;  /* "gsi_minor_version" */

/* GSI-MINOR-VERSION */
DLLEXPORT SI_Long gsi_minor_version()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,560);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_229);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_minor_version());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_229);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

/* SHARED-GSI-REVISION-NUMBER */
SI_Long g2int_shared_gsi_revision_number()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,561);
    gsi_fc_result = 
	    FIXNUM_TO_LONG(G2int_revision_number_of_current_gensym_product_line);
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_230;  /* "gsi_revision_number" */

/* GSI-REVISION-NUMBER */
DLLEXPORT SI_Long gsi_revision_number()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,562);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_230);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_revision_number());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_230);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

/* SHARED-GSI-RELEASE-QUALITY */
SI_Long g2int_shared_gsi_release_quality()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,563);
    gsi_fc_result = 
	    FIXNUM_TO_LONG(G2int_release_quality_of_current_gensym_product_line);
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_231;  /* "gsi_release_quality" */

/* GSI-RELEASE-QUALITY */
DLLEXPORT SI_Long gsi_release_quality()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,564);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_231);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_release_quality());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_231);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

/* BUILD-ID-LETTER-OFFSET */
Object g2int_build_id_letter_offset(letter)
    Object letter;
{
    SI_Long temp, temp_1;

    x_note_fn_call(47,565);
    temp = IFIX(CHAR_CODE(letter)) - (SI_Long)64L;
    temp_1 = IFIX(G2int_max_build_id_letter);
    return VALUES_1(FIX(MIN(temp,temp_1)));
}

/* BUILD-ID-DIGIT-OFFSET */
Object g2int_build_id_digit_offset(letter)
    Object letter;
{
    SI_Long temp, temp_1;

    x_note_fn_call(47,566);
    temp = IFIX(CHAR_CODE(letter)) - (SI_Long)48L;
    temp_1 = IFIX(G2int_max_build_id_digit);
    return VALUES_1(FIX(MIN(temp,temp_1)));
}

Object G2int_year_bit_offset = UNBOUND;

/* ENCODE-BUILD-IDENTIFICATION-INTEGER */
Object g2int_encode_build_identification_integer(build_id_string)
    Object build_id_string;
{
    Object year_offset, month_offset;
    SI_Long temp, day;

    x_note_fn_call(47,567);
    year_offset = g2int_build_id_letter_offset(CHAR(build_id_string,
	    FIX((SI_Long)0L)));
    month_offset = g2int_build_id_letter_offset(CHAR(build_id_string,
	    FIX((SI_Long)1L)));
    temp = (SI_Long)10L * 
	    IFIX(g2int_build_id_digit_offset(CHAR(build_id_string,
	    FIX((SI_Long)2L))));
    day = temp + IFIX(g2int_build_id_digit_offset(CHAR(build_id_string,
	    FIX((SI_Long)3L))));
    return VALUES_1(FIX(day + (IFIX(month_offset) << (SI_Long)5L) + 
	    (IFIX(year_offset) << (SI_Long)10L)));
}

Object G2int_build_identification_integer = UNBOUND;

/* SHARED-GSI-BUILD-ID-INTEGER */
SI_Long g2int_shared_gsi_build_id_integer()
{
    SI_Long gsi_fc_result, result_1;

    x_note_fn_call(47,568);
    gsi_fc_result = FIXNUM_TO_LONG(G2int_build_identification_integer);
    result_1 = gsi_fc_result;
    return result_1;
}

static Object string_constant_232;  /* "gsi_build_id_integer" */

/* GSI-BUILD-ID-INTEGER */
DLLEXPORT SI_Long gsi_build_id_integer()
{
    Object result_1, in_recursive_gsi_context;
    SI_Long result_2;
    Declare_special(1);

    x_note_fn_call(47,569);
    result_1 = FIX((SI_Long)0L);
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_entering_gsi,
	    G2int_gsi_run_state_type_api,string_constant_232);
    in_recursive_gsi_context =  ! 
	    !TRUEP(G2int_top_level_error_catcher_tag) ? T : Nil;
    PUSH_SPECIAL(G2int_in_recursive_gsi_context,in_recursive_gsi_context,0);
      result_1 = LONG_TO_FIXNUM(g2int_shared_gsi_build_id_integer());
    POP_SPECIAL();
    g2int_call_gsi_callback(4,G2int_gsi_run_state_change,
	    G2int_gsi_run_state_direction_leaving_gsi,
	    G2int_gsi_run_state_type_api,string_constant_232);
    result_2 = FIXNUM_TO_LONG(result_1);
    return result_2;
}

/* HANDLE-EXTEND-CURRENT-TEXT-STRING-ERROR */
Object g2int_handle_extend_current_text_string_error()
{
    x_note_fn_call(47,570);
    return error((SI_Long)1L,
	    "wide-string-extension failure (unimplemented GSI error!)");
}

void gsi_INIT()
{
    Object option_array, array, temp, reclaim_structure_for_gsi_application;
    Object Qg2int_handle_extend_current_text_string_error, AB_package;
    Object Qg2int_year_bit_offset, Qg2int_month_bit_offset;
    Object Qg2int_day_bit_offset, Qg2int_max_number_of_bits_for_year_code;
    Object Qg2int_max_number_of_bits_for_month_code;
    Object Qg2int_max_number_of_bits_for_day_code, Qg2int_max_build_id_letter;
    Object Qg2int_max_build_id_digit, Qg2int_gsi_owner_is_context;
    Object Qg2int_gsi_owner_is_gsi, Qg2int_gsi_owner_is_user, Qg2int_int2;
    Object Qg2int_gsi_wakeup_icp_socket_active_p, Qg2int_gsi_wakeup_icp_socket;
    Object list_constant_100, Qg2int_gsi_icp_sockets_waiting_for_connect;
    Object list_constant_114, array_constant_26, array_constant_25;
    Object list_constant_113, array_constant_24, array_constant_23;
    Object Qg2int_system_icon_title_string, string_constant_353;
    Object Qg2int_system_window_title_string, Qlaunch_gsi;
    Object Qg2int_launch_functionqm, Qg2int_system_run_function;
    Object Qg2int_system_top_level_function, Qg2int_run_gsi_process_top_level;
    Object G2_DEFSTRUCT_STRUCTURE_NAME_package, list_constant_112;
    Object list_constant_111, list_constant_110, list_constant_109;
    Object Qg2int_unicode_utf_8, Qg2int_unicode_utf_7, list_constant_108;
    Object list_constant_107, list_constant_106, list_constant_105;
    Object list_constant_104, Qg2int_us_ascii, Qg2int_iso_8859_10;
    Object Qg2int_iso_8859_9, Qg2int_iso_8859_8, Qg2int_iso_8859_7;
    Object Qg2int_iso_8859_6, Qg2int_iso_8859_5, Qg2int_iso_8859_4;
    Object Qg2int_iso_8859_3, Qg2int_iso_8859_2, Qg2int_iso_8859_1;
    Object Qg2int_utf_g, list_constant_103, Qg2int_gb_2312_euc, Qg2int_gb_2312;
    Object Qg2int_chinese, Qg2int_lf, Qg2int_japanese, Qg2int_x_compound_text;
    Object list_constant_102, Qg2int_ks_c_5601_euc, Qg2int_ks_c_5601;
    Object Qg2int_korean, list_constant_101, Qg2int_shift_jis_x_0208;
    Object Qg2int_jis_x_0208_euc, Qg2int_jis_x_0208;
    Object Qg2int_gsi_references_in_use, Qg2int_make_default_gsi_application;
    Object list_constant_99, Qg2int_default_gsi_application, Kfuncall;
    Object Qg2int_have_default_gsi_application, Qg2int_gsi_application;
    Object Qg2int_reclaim_structure, Qg2int_utilities2;
    Object Qg2int_gsi_application_count;
    Object Qg2int_chain_of_available_gsi_applications;
    Object Qg2int_type_description_of_type;
    Object Qg2int_type_description_of_unique_type_name_of_gensym_structure;
    Object string_constant_352, Qg2int_unique_structure_type_of_ab_nameqm;
    Object Qg2int_ab_name_of_unique_structure_type, array_constant_22;
    Object string_constant_351, string_constant_350, string_constant_349;
    Object string_constant_348, string_constant_347, string_constant_346;
    Object string_constant_345, string_constant_344, string_constant_343;
    Object string_constant_342, string_constant_341, string_constant_340;
    Object string_constant_339, string_constant_338, string_constant_337;
    Object string_constant_336, string_constant_335, string_constant_334;
    Object string_constant_333, string_constant_332, string_constant_331;
    Object string_constant_330, string_constant_329, string_constant_328;
    Object array_constant_21, Qg2int_gsi_run_state_type_signal;
    Object Qg2int_gsi_run_state_type_wait, Qg2int_gsi_run_state_type_callback;
    Object Qg2int_gsi_run_state_type_api;
    Object Qg2int_gsi_run_state_direction_entering_gsi_by_signal;
    Object Qg2int_gsi_run_state_direction_leaving_watchdog;
    Object Qg2int_gsi_run_state_direction_entering_watchdog;
    Object Qg2int_gsi_run_state_direction_leaving_gsi;
    Object Qg2int_gsi_run_state_direction_entering_gsi, list_constant_98;
    Object list_constant_97, list_constant_96, list_constant_95;
    Object list_constant_94, list_constant_93, list_constant_92;
    Object list_constant_91, list_constant_90, list_constant_89;
    Object list_constant_88, list_constant_87, list_constant_86;
    Object list_constant_85, list_constant_84, list_constant_83;
    Object list_constant_82, list_constant_81, list_constant_80;
    Object list_constant_79, list_constant_78, list_constant_77;
    Object list_constant_76, list_constant_75, list_constant_74;
    Object list_constant_73, list_constant_72, list_constant_71;
    Object list_constant_70, list_constant_69, list_constant_68;
    Object list_constant_67, list_constant_66, list_constant_65;
    Object list_constant_64, list_constant_63, list_constant_62;
    Object list_constant_61, list_constant_60, list_constant_59;
    Object list_constant_58, list_constant_57, list_constant_56;
    Object list_constant_55, list_constant_54, list_constant_53;
    Object list_constant_52, list_constant_51, list_constant_50;
    Object list_constant_49, list_constant_48, list_constant_47;
    Object list_constant_46, list_constant_45, list_constant_44;
    Object list_constant_43, list_constant_42, list_constant_41;
    Object list_constant_40, list_constant_39, list_constant_38;
    Object list_constant_37, list_constant_36, list_constant_35;
    Object list_constant_34, list_constant_33, list_constant_32;
    Object list_constant_31, list_constant_30, list_constant_29;
    Object list_constant_28, list_constant_27, list_constant_26;
    Object list_constant_25, list_constant_24, list_constant_23;
    Object list_constant_22, list_constant_21, list_constant_20;
    Object list_constant_19, list_constant_18, list_constant_17;
    Object list_constant_16, list_constant_15, list_constant_14;
    Object list_constant_13, list_constant_12, list_constant_11;
    Object list_constant_10, list_constant_9, list_constant_8, list_constant_7;
    Object list_constant_6, list_constant_5, list_constant_4, list_constant_3;
    Object list_constant_2, list_constant_1, list_constant;
    Object string_constant_327, string_constant_326, string_constant_325;
    Object string_constant_324, string_constant_323, string_constant_322;
    Object string_constant_321, string_constant_320, string_constant_319;
    Object string_constant_318, string_constant_317, string_constant_316;
    Object string_constant_315, string_constant_314, string_constant_313;
    Object string_constant_312, string_constant_311, string_constant_310;
    Object string_constant_309, string_constant_308, string_constant_307;
    Object string_constant_306, string_constant_305, string_constant_304;
    Object string_constant_303, string_constant_302, string_constant_301;
    Object string_constant_300, string_constant_299, string_constant_298;
    Object string_constant_297, string_constant_296, string_constant_295;
    Object string_constant_294, string_constant_293, string_constant_292;
    Object string_constant_291, string_constant_290, string_constant_289;
    Object string_constant_288, string_constant_287, string_constant_286;
    Object string_constant_285, string_constant_284, string_constant_283;
    Object string_constant_282, string_constant_281, string_constant_280;
    Object string_constant_279, string_constant_278, string_constant_277;
    Object string_constant_276, string_constant_275, string_constant_274;
    Object string_constant_273, string_constant_272, string_constant_271;
    Object string_constant_270, string_constant_269, string_constant_268;
    Object string_constant_267, string_constant_266, string_constant_265;
    Object string_constant_264, string_constant_263, string_constant_262;
    Object string_constant_261, string_constant_260, string_constant_259;
    Object string_constant_258, string_constant_257, string_constant_256;
    Object string_constant_255, string_constant_254, string_constant_253;
    Object string_constant_252, string_constant_251, string_constant_250;
    Object string_constant_249, string_constant_248, string_constant_247;
    Object string_constant_246, string_constant_245, string_constant_244;
    Object string_constant_243, string_constant_242, string_constant_241;
    Object string_constant_240, string_constant_239, string_constant_238;
    Object string_constant_237, string_constant_236, string_constant_235;
    Object string_constant_234, string_constant_233;
    Object Qg2int_gsi_max_number_of_identifying_attributes;
    Object Qg2int_initial_maximum_number_of_contexts, Qg2int_gsi_false;
    Object Qg2int_gsi_true, Qg2int_gsi_failure, Qg2int_gsi_success;
    Object Qg2int_gsi_base_user_error_code, Qg2int_gsi_base_success_code;
    Object Qg2int_gsi_base_information_code, Qg2int_gsi_rpc_late_async_abort;
    Object Qg2int_gsi_rpc_async_abort, Qg2int_gsi_timestamp_not_found;
    Object Qg2int_gsi_attribute_name_not_found, Qg2int_gsi_base_warning_code;
    Object Qg2int_gsi_network_error, Qg2int_gsi_application_load_failed;
    Object Qg2int_gsi_invalid_option_index, Qg2int_gsi_callback_name_not_found;
    Object Qg2int_gsi_context_has_been_shut_down;
    Object Qg2int_gsi_context_has_been_killed, Qg2int_gsi_no_license;
    Object Qg2int_gsi_not_a_symbol, Qg2int_gsi_integer_too_small;
    Object Qg2int_gsi_integer_too_large, Qg2int_gsi_illegal_error_arguments;
    Object Qg2int_gsi_unknown_calling_procedure_index;
    Object Qg2int_gsi_resumable_icp_error, Qg2int_gsi_invalid_attribute_type;
    Object Qg2int_gsi_invalid_return_value_kind;
    Object Qg2int_gsi_invalid_return_value_index, Qg2int_gsi_error_in_connect;
    Object Qg2int_gsi_unknown_string_conversion_style;
    Object Qg2int_gsi_connection_denied, Qg2int_gsi_maximum_contexts_exceeded;
    Object Qg2int_gsi_cannot_establish_listener, Qg2int_gsi_uncaught_exception;
    Object Qg2int_gsi_invalid_history_type, Qg2int_gsi_unknown_type_tag;
    Object Qg2int_gsi_malformed_socket, Qg2int_gsi_bad_rpc_state;
    Object Qg2int_gsi_no_more_rpc_identifiers;
    Object Qg2int_gsi_circularity_not_supported;
    Object Qg2int_gsi_index_space_full_error;
    Object Qg2int_gsi_undefined_structure_method_error;
    Object Qg2int_gsi_extend_current_text_string_error;
    Object Qg2int_gsi_maximum_text_string_length_error;
    Object Qg2int_gsi_icp_message_out_of_synch_case_2;
    Object Qg2int_gsi_icp_message_too_long, Qg2int_gsi_incompatible_structure2;
    Object Qg2int_gsi_no_name_in_registered_item;
    Object Qg2int_gsi_invalid_handle_for_context, Qg2int_gsi_invalid_timestamp;
    Object Qg2int_gsi_timestamp_out_of_bounds;
    Object Qg2int_gsi_invalid_handle_of_nth, Qg2int_gsi_invalid_handle;
    Object Qg2int_gsi_context_undefined, Qg2int_gsi_bad_magic_number_in_query;
    Object Qg2int_gsi_type_for_data_service, Qg2int_gsi_invalid_type;
    Object Qg2int_gsi_incompatible_history_spec;
    Object Qg2int_gsi_structure_has_no_history;
    Object Qg2int_gsi_illegal_nesting_of_run_loop;
    Object Qg2int_gsi_noop_code_accessed, Qg2int_gsi_item_has_no_value;
    Object Qg2int_gsi_null_pointer_argument;
    Object Qg2int_gsi_ownerous_reclamation_violation;
    Object Qg2int_gsi_connection_lost, Qg2int_gsi_custom_user_error;
    Object Qg2int_gsi_reserved_error_code;
    Object Qg2int_gsi_rpc_error_from_g2_procedure;
    Object Qg2int_gsi_rpc_error_from_g2, Qg2int_gsi_argument_count_too_big;
    Object Qg2int_gsi_no_class_name_specified;
    Object Qg2int_gsi_structure_has_no_class_qualifier;
    Object Qg2int_gsi_incompatible_structure;
    Object Qg2int_gsi_count_out_of_array_bounds;
    Object Qg2int_gsi_missing_attribute_name;
    Object Qg2int_gsi_g2_logical_out_of_bounds;
    Object Qg2int_gsi_no_class_in_registered_item;
    Object Qg2int_gsi_identifying_attribute_index_out_of_range;
    Object Qg2int_gsi_invalid_context, Qg2int_gsi_bad_magic_number;
    Object Qg2int_gsi_internal_memory_inconsistency;
    Object Qg2int_gsi_unexpected_operation;
    Object Qg2int_gsi_incorrect_argument_count;
    Object Qg2int_gsi_remote_declaration_not_found;
    Object Qg2int_gsi_invalid_call_handle, Qg2int_gsi_local_function_undefined;
    Object Qg2int_gsi_incompatible_type, Qg2int_gsi_missing_instance_structure;
    Object Qg2int_gsi_structure_has_no_attribute_name;
    Object Qg2int_gsi_structure_has_no_status;
    Object Qg2int_gsi_structure_has_no_interval;
    Object Qg2int_gsi_structure_has_no_timed_flag;
    Object Qg2int_gsi_structure_has_no_timestamp;
    Object Qg2int_gsi_structure_has_no_instance;
    Object Qg2int_gsi_structure_has_no_identifying_attrs;
    Object Qg2int_gsi_structure_has_no_handle;
    Object Qg2int_gsi_item_definitions_are_read_only;
    Object Qg2int_gsi_invalid_network_address;
    Object Qg2int_gsi_invalid_decnet_object_name;
    Object Qg2int_gsi_invalid_tcp_port_number;
    Object Qg2int_gsi_invalid_network_combo, Qg2int_gsi_invalid_protocol;
    Object Qg2int_gsi_error_code_out_of_range;

    x_note_fn_call(47,571);
    SET_PACKAGE("AB");
    AB_package = STATIC_PACKAGE("AB");
    Qg2int_gsi_error_code_out_of_range = 
	    STATIC_SYMBOL("GSI-ERROR-CODE-OUT-OF-RANGE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_error_code_out_of_range,FIX((SI_Long)-1L));
    Qg2int_gsi_invalid_protocol = STATIC_SYMBOL("GSI-INVALID-PROTOCOL",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_protocol,FIX((SI_Long)1L));
    Qg2int_gsi_invalid_network_combo = 
	    STATIC_SYMBOL("GSI-INVALID-NETWORK-COMBO",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_network_combo,FIX((SI_Long)2L));
    Qg2int_gsi_invalid_tcp_port_number = 
	    STATIC_SYMBOL("GSI-INVALID-TCP-PORT-NUMBER",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_tcp_port_number,FIX((SI_Long)3L));
    Qg2int_gsi_invalid_decnet_object_name = 
	    STATIC_SYMBOL("GSI-INVALID-DECNET-OBJECT-NAME",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_decnet_object_name,FIX((SI_Long)4L));
    Qg2int_gsi_invalid_network_address = 
	    STATIC_SYMBOL("GSI-INVALID-NETWORK-ADDRESS",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_network_address,FIX((SI_Long)5L));
    Qg2int_gsi_item_definitions_are_read_only = 
	    STATIC_SYMBOL("GSI-ITEM-DEFINITIONS-ARE-READ-ONLY",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_item_definitions_are_read_only,
	    FIX((SI_Long)6L));
    Qg2int_gsi_structure_has_no_handle = 
	    STATIC_SYMBOL("GSI-STRUCTURE-HAS-NO-HANDLE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_structure_has_no_handle,FIX((SI_Long)7L));
    Qg2int_gsi_structure_has_no_identifying_attrs = 
	    STATIC_SYMBOL("GSI-STRUCTURE-HAS-NO-IDENTIFYING-ATTRS",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_structure_has_no_identifying_attrs,
	    FIX((SI_Long)8L));
    Qg2int_gsi_structure_has_no_instance = 
	    STATIC_SYMBOL("GSI-STRUCTURE-HAS-NO-INSTANCE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_structure_has_no_instance,FIX((SI_Long)9L));
    Qg2int_gsi_structure_has_no_timestamp = 
	    STATIC_SYMBOL("GSI-STRUCTURE-HAS-NO-TIMESTAMP",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_structure_has_no_timestamp,FIX((SI_Long)10L));
    Qg2int_gsi_structure_has_no_timed_flag = 
	    STATIC_SYMBOL("GSI-STRUCTURE-HAS-NO-TIMED-FLAG",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_structure_has_no_timed_flag,FIX((SI_Long)11L));
    Qg2int_gsi_structure_has_no_interval = 
	    STATIC_SYMBOL("GSI-STRUCTURE-HAS-NO-INTERVAL",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_structure_has_no_interval,FIX((SI_Long)12L));
    Qg2int_gsi_structure_has_no_status = 
	    STATIC_SYMBOL("GSI-STRUCTURE-HAS-NO-STATUS",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_structure_has_no_status,FIX((SI_Long)13L));
    Qg2int_gsi_structure_has_no_attribute_name = 
	    STATIC_SYMBOL("GSI-STRUCTURE-HAS-NO-ATTRIBUTE-NAME",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_structure_has_no_attribute_name,
	    FIX((SI_Long)14L));
    Qg2int_gsi_missing_instance_structure = 
	    STATIC_SYMBOL("GSI-MISSING-INSTANCE-STRUCTURE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_missing_instance_structure,FIX((SI_Long)15L));
    Qg2int_gsi_incompatible_type = STATIC_SYMBOL("GSI-INCOMPATIBLE-TYPE",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_incompatible_type,FIX((SI_Long)16L));
    Qg2int_gsi_local_function_undefined = 
	    STATIC_SYMBOL("GSI-LOCAL-FUNCTION-UNDEFINED",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_local_function_undefined,FIX((SI_Long)17L));
    Qg2int_gsi_invalid_call_handle = 
	    STATIC_SYMBOL("GSI-INVALID-CALL-HANDLE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_call_handle,FIX((SI_Long)18L));
    Qg2int_gsi_remote_declaration_not_found = 
	    STATIC_SYMBOL("GSI-REMOTE-DECLARATION-NOT-FOUND",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_remote_declaration_not_found,
	    FIX((SI_Long)19L));
    Qg2int_gsi_incorrect_argument_count = 
	    STATIC_SYMBOL("GSI-INCORRECT-ARGUMENT-COUNT",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_incorrect_argument_count,FIX((SI_Long)20L));
    Qg2int_gsi_unexpected_operation = 
	    STATIC_SYMBOL("GSI-UNEXPECTED-OPERATION",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_unexpected_operation,FIX((SI_Long)21L));
    Qg2int_gsi_internal_memory_inconsistency = 
	    STATIC_SYMBOL("GSI-INTERNAL-MEMORY-INCONSISTENCY",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_internal_memory_inconsistency,
	    FIX((SI_Long)22L));
    Qg2int_gsi_bad_magic_number = STATIC_SYMBOL("GSI-BAD-MAGIC-NUMBER",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_bad_magic_number,FIX((SI_Long)23L));
    Qg2int_gsi_invalid_context = STATIC_SYMBOL("GSI-INVALID-CONTEXT",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_context,FIX((SI_Long)24L));
    Qg2int_gsi_identifying_attribute_index_out_of_range = 
	    STATIC_SYMBOL("GSI-IDENTIFYING-ATTRIBUTE-INDEX-OUT-OF-RANGE",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_identifying_attribute_index_out_of_range,
	    FIX((SI_Long)25L));
    Qg2int_gsi_no_class_in_registered_item = 
	    STATIC_SYMBOL("GSI-NO-CLASS-IN-REGISTERED-ITEM",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_no_class_in_registered_item,FIX((SI_Long)26L));
    Qg2int_gsi_g2_logical_out_of_bounds = 
	    STATIC_SYMBOL("GSI-G2-LOGICAL-OUT-OF-BOUNDS",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_g2_logical_out_of_bounds,FIX((SI_Long)27L));
    Qg2int_gsi_missing_attribute_name = 
	    STATIC_SYMBOL("GSI-MISSING-ATTRIBUTE-NAME",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_missing_attribute_name,FIX((SI_Long)28L));
    Qg2int_gsi_count_out_of_array_bounds = 
	    STATIC_SYMBOL("GSI-COUNT-OUT-OF-ARRAY-BOUNDS",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_count_out_of_array_bounds,FIX((SI_Long)29L));
    Qg2int_gsi_incompatible_structure = 
	    STATIC_SYMBOL("GSI-INCOMPATIBLE-STRUCTURE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_incompatible_structure,FIX((SI_Long)30L));
    Qg2int_gsi_structure_has_no_class_qualifier = 
	    STATIC_SYMBOL("GSI-STRUCTURE-HAS-NO-CLASS-QUALIFIER",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_structure_has_no_class_qualifier,
	    FIX((SI_Long)31L));
    Qg2int_gsi_no_class_name_specified = 
	    STATIC_SYMBOL("GSI-NO-CLASS-NAME-SPECIFIED",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_no_class_name_specified,FIX((SI_Long)32L));
    Qg2int_gsi_argument_count_too_big = 
	    STATIC_SYMBOL("GSI-ARGUMENT-COUNT-TOO-BIG",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_argument_count_too_big,FIX((SI_Long)33L));
    Qg2int_gsi_rpc_error_from_g2 = STATIC_SYMBOL("GSI-RPC-ERROR-FROM-G2",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_rpc_error_from_g2,FIX((SI_Long)34L));
    Qg2int_gsi_rpc_error_from_g2_procedure = 
	    STATIC_SYMBOL("GSI-RPC-ERROR-FROM-G2-PROCEDURE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_rpc_error_from_g2_procedure,FIX((SI_Long)35L));
    Qg2int_gsi_reserved_error_code = 
	    STATIC_SYMBOL("GSI-RESERVED-ERROR-CODE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_reserved_error_code,FIX((SI_Long)36L));
    Qg2int_gsi_custom_user_error = STATIC_SYMBOL("GSI-CUSTOM-USER-ERROR",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_custom_user_error,FIX((SI_Long)37L));
    Qg2int_gsi_connection_lost = STATIC_SYMBOL("GSI-CONNECTION-LOST",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_connection_lost,FIX((SI_Long)38L));
    Qg2int_gsi_ownerous_reclamation_violation = 
	    STATIC_SYMBOL("GSI-OWNEROUS-RECLAMATION-VIOLATION",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_ownerous_reclamation_violation,
	    FIX((SI_Long)39L));
    Qg2int_gsi_null_pointer_argument = 
	    STATIC_SYMBOL("GSI-NULL-POINTER-ARGUMENT",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_null_pointer_argument,FIX((SI_Long)40L));
    Qg2int_gsi_item_has_no_value = STATIC_SYMBOL("GSI-ITEM-HAS-NO-VALUE",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_item_has_no_value,FIX((SI_Long)41L));
    Qg2int_gsi_noop_code_accessed = STATIC_SYMBOL("GSI-NOOP-CODE-ACCESSED",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_noop_code_accessed,FIX((SI_Long)42L));
    Qg2int_gsi_illegal_nesting_of_run_loop = 
	    STATIC_SYMBOL("GSI-ILLEGAL-NESTING-OF-RUN-LOOP",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_illegal_nesting_of_run_loop,FIX((SI_Long)43L));
    Qg2int_gsi_structure_has_no_history = 
	    STATIC_SYMBOL("GSI-STRUCTURE-HAS-NO-HISTORY",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_structure_has_no_history,FIX((SI_Long)44L));
    Qg2int_gsi_incompatible_history_spec = 
	    STATIC_SYMBOL("GSI-INCOMPATIBLE-HISTORY-SPEC",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_incompatible_history_spec,FIX((SI_Long)45L));
    Qg2int_gsi_invalid_type = STATIC_SYMBOL("GSI-INVALID-TYPE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_type,FIX((SI_Long)46L));
    Qg2int_gsi_type_for_data_service = 
	    STATIC_SYMBOL("GSI-TYPE-FOR-DATA-SERVICE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_type_for_data_service,FIX((SI_Long)47L));
    Qg2int_gsi_bad_magic_number_in_query = 
	    STATIC_SYMBOL("GSI-BAD-MAGIC-NUMBER-IN-QUERY",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_bad_magic_number_in_query,FIX((SI_Long)48L));
    Qg2int_gsi_context_undefined = STATIC_SYMBOL("GSI-CONTEXT-UNDEFINED",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_context_undefined,FIX((SI_Long)49L));
    Qg2int_gsi_invalid_handle = STATIC_SYMBOL("GSI-INVALID-HANDLE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_handle,FIX((SI_Long)50L));
    Qg2int_gsi_invalid_handle_of_nth = 
	    STATIC_SYMBOL("GSI-INVALID-HANDLE-OF-NTH",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_handle_of_nth,FIX((SI_Long)51L));
    Qg2int_gsi_timestamp_out_of_bounds = 
	    STATIC_SYMBOL("GSI-TIMESTAMP-OUT-OF-BOUNDS",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_timestamp_out_of_bounds,FIX((SI_Long)52L));
    Qg2int_gsi_invalid_timestamp = STATIC_SYMBOL("GSI-INVALID-TIMESTAMP",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_timestamp,FIX((SI_Long)53L));
    Qg2int_gsi_invalid_handle_for_context = 
	    STATIC_SYMBOL("GSI-INVALID-HANDLE-FOR-CONTEXT",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_handle_for_context,FIX((SI_Long)54L));
    Qg2int_gsi_no_name_in_registered_item = 
	    STATIC_SYMBOL("GSI-NO-NAME-IN-REGISTERED-ITEM",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_no_name_in_registered_item,FIX((SI_Long)55L));
    Qg2int_gsi_incompatible_structure2 = 
	    STATIC_SYMBOL("GSI-INCOMPATIBLE-STRUCTURE2",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_incompatible_structure2,FIX((SI_Long)56L));
    Qg2int_gsi_icp_message_too_long = 
	    STATIC_SYMBOL("GSI-ICP-MESSAGE-TOO-LONG",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_icp_message_too_long,FIX((SI_Long)57L));
    Qg2int_gsi_icp_message_out_of_synch_case_2 = 
	    STATIC_SYMBOL("GSI-ICP-MESSAGE-OUT-OF-SYNCH-CASE-2",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_icp_message_out_of_synch_case_2,
	    FIX((SI_Long)58L));
    Qg2int_gsi_maximum_text_string_length_error = 
	    STATIC_SYMBOL("GSI-MAXIMUM-TEXT-STRING-LENGTH-ERROR",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_maximum_text_string_length_error,
	    FIX((SI_Long)59L));
    Qg2int_gsi_extend_current_text_string_error = 
	    STATIC_SYMBOL("GSI-EXTEND-CURRENT-TEXT-STRING-ERROR",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_extend_current_text_string_error,
	    FIX((SI_Long)60L));
    Qg2int_gsi_undefined_structure_method_error = 
	    STATIC_SYMBOL("GSI-UNDEFINED-STRUCTURE-METHOD-ERROR",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_undefined_structure_method_error,
	    FIX((SI_Long)61L));
    Qg2int_gsi_index_space_full_error = 
	    STATIC_SYMBOL("GSI-INDEX-SPACE-FULL-ERROR",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_index_space_full_error,FIX((SI_Long)62L));
    Qg2int_gsi_circularity_not_supported = 
	    STATIC_SYMBOL("GSI-CIRCULARITY-NOT-SUPPORTED",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_circularity_not_supported,FIX((SI_Long)63L));
    Qg2int_gsi_no_more_rpc_identifiers = 
	    STATIC_SYMBOL("GSI-NO-MORE-RPC-IDENTIFIERS",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_no_more_rpc_identifiers,FIX((SI_Long)64L));
    Qg2int_gsi_bad_rpc_state = STATIC_SYMBOL("GSI-BAD-RPC-STATE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_bad_rpc_state,FIX((SI_Long)65L));
    Qg2int_gsi_malformed_socket = STATIC_SYMBOL("GSI-MALFORMED-SOCKET",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_malformed_socket,FIX((SI_Long)66L));
    Qg2int_gsi_unknown_type_tag = STATIC_SYMBOL("GSI-UNKNOWN-TYPE-TAG",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_unknown_type_tag,FIX((SI_Long)67L));
    Qg2int_gsi_invalid_history_type = 
	    STATIC_SYMBOL("GSI-INVALID-HISTORY-TYPE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_history_type,FIX((SI_Long)68L));
    Qg2int_gsi_uncaught_exception = STATIC_SYMBOL("GSI-UNCAUGHT-EXCEPTION",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_uncaught_exception,FIX((SI_Long)69L));
    Qg2int_gsi_cannot_establish_listener = 
	    STATIC_SYMBOL("GSI-CANNOT-ESTABLISH-LISTENER",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_cannot_establish_listener,FIX((SI_Long)70L));
    Qg2int_gsi_maximum_contexts_exceeded = 
	    STATIC_SYMBOL("GSI-MAXIMUM-CONTEXTS-EXCEEDED",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_maximum_contexts_exceeded,FIX((SI_Long)71L));
    Qg2int_gsi_connection_denied = STATIC_SYMBOL("GSI-CONNECTION-DENIED",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_connection_denied,FIX((SI_Long)72L));
    Qg2int_gsi_unknown_string_conversion_style = 
	    STATIC_SYMBOL("GSI-UNKNOWN-STRING-CONVERSION-STYLE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_unknown_string_conversion_style,
	    FIX((SI_Long)73L));
    Qg2int_gsi_error_in_connect = STATIC_SYMBOL("GSI-ERROR-IN-CONNECT",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_error_in_connect,FIX((SI_Long)74L));
    Qg2int_gsi_invalid_return_value_index = 
	    STATIC_SYMBOL("GSI-INVALID-RETURN-VALUE-INDEX",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_return_value_index,FIX((SI_Long)75L));
    Qg2int_gsi_invalid_return_value_kind = 
	    STATIC_SYMBOL("GSI-INVALID-RETURN-VALUE-KIND",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_return_value_kind,FIX((SI_Long)76L));
    Qg2int_gsi_invalid_attribute_type = 
	    STATIC_SYMBOL("GSI-INVALID-ATTRIBUTE-TYPE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_attribute_type,FIX((SI_Long)77L));
    Qg2int_gsi_resumable_icp_error = 
	    STATIC_SYMBOL("GSI-RESUMABLE-ICP-ERROR",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_resumable_icp_error,FIX((SI_Long)78L));
    Qg2int_gsi_unknown_calling_procedure_index = 
	    STATIC_SYMBOL("GSI-UNKNOWN-CALLING-PROCEDURE-INDEX",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_unknown_calling_procedure_index,
	    FIX((SI_Long)79L));
    Qg2int_gsi_illegal_error_arguments = 
	    STATIC_SYMBOL("GSI-ILLEGAL-ERROR-ARGUMENTS",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_illegal_error_arguments,FIX((SI_Long)80L));
    Qg2int_gsi_integer_too_large = STATIC_SYMBOL("GSI-INTEGER-TOO-LARGE",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_integer_too_large,FIX((SI_Long)81L));
    Qg2int_gsi_integer_too_small = STATIC_SYMBOL("GSI-INTEGER-TOO-SMALL",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_integer_too_small,FIX((SI_Long)82L));
    Qg2int_gsi_not_a_symbol = STATIC_SYMBOL("GSI-NOT-A-SYMBOL",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_not_a_symbol,FIX((SI_Long)83L));
    Qg2int_gsi_no_license = STATIC_SYMBOL("GSI-NO-LICENSE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_no_license,FIX((SI_Long)84L));
    Qg2int_gsi_context_has_been_killed = 
	    STATIC_SYMBOL("GSI-CONTEXT-HAS-BEEN-KILLED",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_context_has_been_killed,FIX((SI_Long)85L));
    Qg2int_gsi_context_has_been_shut_down = 
	    STATIC_SYMBOL("GSI-CONTEXT-HAS-BEEN-SHUT-DOWN",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_context_has_been_shut_down,FIX((SI_Long)86L));
    Qg2int_gsi_callback_name_not_found = 
	    STATIC_SYMBOL("GSI-CALLBACK-NAME-NOT-FOUND",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_callback_name_not_found,FIX((SI_Long)87L));
    Qg2int_gsi_invalid_option_index = 
	    STATIC_SYMBOL("GSI-INVALID-OPTION-INDEX",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_invalid_option_index,FIX((SI_Long)88L));
    Qg2int_gsi_application_load_failed = 
	    STATIC_SYMBOL("GSI-APPLICATION-LOAD-FAILED",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_application_load_failed,FIX((SI_Long)89L));
    Qg2int_gsi_network_error = STATIC_SYMBOL("GSI-NETWORK-ERROR",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_network_error,FIX((SI_Long)90L));
    Qg2int_gsi_base_warning_code = STATIC_SYMBOL("GSI-BASE-WARNING-CODE",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_base_warning_code,FIX((SI_Long)256L));
    Qg2int_gsi_attribute_name_not_found = 
	    STATIC_SYMBOL("GSI-ATTRIBUTE-NAME-NOT-FOUND",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_attribute_name_not_found,FIX((SI_Long)256L));
    Qg2int_gsi_timestamp_not_found = 
	    STATIC_SYMBOL("GSI-TIMESTAMP-NOT-FOUND",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_timestamp_not_found,FIX((SI_Long)257L));
    Qg2int_gsi_rpc_async_abort = STATIC_SYMBOL("GSI-RPC-ASYNC-ABORT",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_rpc_async_abort,FIX((SI_Long)258L));
    Qg2int_gsi_rpc_late_async_abort = 
	    STATIC_SYMBOL("GSI-RPC-LATE-ASYNC-ABORT",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_rpc_late_async_abort,FIX((SI_Long)259L));
    Qg2int_gsi_base_information_code = 
	    STATIC_SYMBOL("GSI-BASE-INFORMATION-CODE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_base_information_code,FIX((SI_Long)512L));
    Qg2int_gsi_base_success_code = STATIC_SYMBOL("GSI-BASE-SUCCESS-CODE",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_base_success_code,FIX((SI_Long)768L));
    Qg2int_gsi_base_user_error_code = 
	    STATIC_SYMBOL("GSI-BASE-USER-ERROR-CODE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_base_user_error_code,FIX((SI_Long)1024L));
    Qg2int_gsi_success = STATIC_SYMBOL("GSI-SUCCESS",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_success,FIX((SI_Long)0L));
    Qg2int_gsi_failure = STATIC_SYMBOL("GSI-FAILURE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_failure,FIX((SI_Long)1L));
    Qg2int_gsi_true = STATIC_SYMBOL("GSI-TRUE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_true,FIX((SI_Long)1L));
    Qg2int_gsi_false = STATIC_SYMBOL("GSI-FALSE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_false,FIX((SI_Long)0L));
    Qg2int_initial_maximum_number_of_contexts = 
	    STATIC_SYMBOL("INITIAL-MAXIMUM-NUMBER-OF-CONTEXTS",AB_package);
    SET_SYMBOL_VALUE(Qg2int_initial_maximum_number_of_contexts,
	    FIX((SI_Long)50L));
    Qg2int_gsi_max_number_of_identifying_attributes = 
	    STATIC_SYMBOL("GSI-MAX-NUMBER-OF-IDENTIFYING-ATTRIBUTES",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_max_number_of_identifying_attributes,
	    FIX((SI_Long)6L));
    if (G2int_next_available_context_number == UNBOUND)
	G2int_next_available_context_number = FIX((SI_Long)0L);
    if (G2int_fake_array_of_one_wrapper == UNBOUND)
	G2int_fake_array_of_one_wrapper = Nil;
    if (G2int_reusable_circularity_table == UNBOUND)
	G2int_reusable_circularity_table = Nil;
    if (G2int_array_element_attribute_spec == UNBOUND)
	G2int_array_element_attribute_spec = Nil;
    if (G2int_list_element_attribute_spec == UNBOUND)
	G2int_list_element_attribute_spec = Nil;
    if (G2int_item_name_attribute_spec == UNBOUND)
	G2int_item_name_attribute_spec = Nil;
    if (G2int_simple_item_value_attribute_spec == UNBOUND)
	G2int_simple_item_value_attribute_spec = Nil;
    if (G2int_reusable_name_instance == UNBOUND)
	G2int_reusable_name_instance = Nil;
    if (G2int_reusable_value_instance == UNBOUND)
	G2int_reusable_value_instance = Nil;
    if (G2int_within_run_loop_extent == UNBOUND)
	G2int_within_run_loop_extent = Nil;
    if (G2int_gsi_shutdown_reason == UNBOUND)
	G2int_gsi_shutdown_reason = Nil;
    string_constant_233 = STATIC_STRING("Error Code out of range.");
    list_constant_66 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)-1L),
	    string_constant_233);
    string_constant_234 = 
	    STATIC_STRING("Invalid network protocol ~a - only tcpip is supported");
    list_constant_67 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)1L),
	    string_constant_234);
    string_constant_235 = 
	    STATIC_STRING("Duplication of network protocol ~a - please specify one of each");
    list_constant_68 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)2L),
	    string_constant_235);
    string_constant_236 = 
	    STATIC_STRING("Invalid TCP port number ~a - please specify an integer number");
    list_constant_69 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)3L),
	    string_constant_236);
    string_constant_237 = 
	    STATIC_STRING("DECnet is no longer supported (object name ~a)");
    list_constant_70 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)4L),
	    string_constant_237);
    string_constant_238 = 
	    STATIC_STRING("Invalid network address ~a - does not conform to TCP/IP");
    list_constant_71 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)5L),
	    string_constant_238);
    string_constant_239 = 
	    STATIC_STRING("Item registrations are read-only - make modifications through G2");
    list_constant_72 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)6L),
	    string_constant_239);
    string_constant_240 = 
	    STATIC_STRING("Access function received structure with no handle element");
    list_constant_73 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)7L),
	    string_constant_240);
    string_constant_241 = 
	    STATIC_STRING("Access function received structure with no identifying attribute elements");
    list_constant_74 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)8L),
	    string_constant_241);
    string_constant_242 = 
	    STATIC_STRING("Access function received an incompatible structure as an argument");
    list_constant_75 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)9L),
	    string_constant_242);
    string_constant_243 = 
	    STATIC_STRING("Access function received structure with no timestamp element");
    list_constant_76 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)10L),
	    string_constant_243);
    string_constant_244 = 
	    STATIC_STRING("Access function received structure with no is-timed element");
    list_constant_77 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)11L),
	    string_constant_244);
    string_constant_245 = 
	    STATIC_STRING("Access function received structure with no interval element");
    list_constant_78 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)12L),
	    string_constant_245);
    string_constant_246 = 
	    STATIC_STRING("Access function received structure with no status element");
    list_constant_79 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)13L),
	    string_constant_246);
    string_constant_247 = 
	    STATIC_STRING("Access function expected an attribute structure");
    list_constant_80 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)14L),
	    string_constant_247);
    string_constant_248 = 
	    STATIC_STRING("Nothing was found where an embedded value or instance structure was expected");
    list_constant_81 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)15L),
	    string_constant_248);
    string_constant_249 = 
	    STATIC_STRING("Type mismatch - value of type ~a passed to this function");
    list_constant_82 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)16L),
	    string_constant_249);
    string_constant_250 = 
	    STATIC_STRING("GSI could not find function ~a which G2 attempted to invoke");
    list_constant_83 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)17L),
	    string_constant_250);
    string_constant_251 = 
	    STATIC_STRING("Call handle specified was not for an outstanding RPC");
    list_constant_84 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)18L),
	    string_constant_251);
    string_constant_252 = 
	    STATIC_STRING("No remote procedure declaration was found for ~a. Ensure gsi_rpc_declare_remote() called");
    list_constant_85 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)19L),
	    string_constant_252);
    string_constant_253 = 
	    STATIC_STRING("Remote procedure ~a passed/received ~a arguments - ~a were expected");
    list_constant_86 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)20L),
	    string_constant_253);
    string_constant_254 = 
	    STATIC_STRING("This operation not thought to be useful and may imply a misunderstanding of GSI");
    list_constant_87 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)21L),
	    string_constant_254);
    string_constant_255 = 
	    STATIC_STRING("Internal memory inconsistency encountered in GSI - please contact customer support");
    list_constant_88 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)22L),
	    string_constant_255);
    string_constant_256 = 
	    STATIC_STRING("Bad magic number - address received was not the head of an array");
    list_constant_89 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)23L),
	    string_constant_256);
    string_constant_257 = STATIC_STRING("Context ~a is invalid or inactive");
    list_constant_90 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)24L),
	    string_constant_257);
    string_constant_258 = 
	    STATIC_STRING("Identifying attribute index ~a is out of the acceptable range (1..6)");
    list_constant_91 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)25L),
	    string_constant_258);
    string_constant_259 = 
	    STATIC_STRING("The class name is in the registration corresponding to the handle of this registered item");
    list_constant_92 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)26L),
	    string_constant_259);
    string_constant_260 = 
	    STATIC_STRING("Logical ~a is out of bounds. Logicals in GSI may range from -1000 to 1000 inclusive");
    list_constant_93 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)27L),
	    string_constant_260);
    string_constant_261 = 
	    STATIC_STRING("Requested attribute name where there was none");
    list_constant_94 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)28L),
	    string_constant_261);
    string_constant_262 = 
	    STATIC_STRING("Count ~a out of bounds for array of size ~a");
    list_constant_95 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)29L),
	    string_constant_262);
    string_constant_263 = 
	    STATIC_STRING("Received null pointer argument, or a structure type incompatible with requested operation");
    list_constant_96 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)30L),
	    string_constant_263);
    string_constant_264 = 
	    STATIC_STRING("Requested class qualifier where there was none");
    list_constant_34 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)31L),
	    string_constant_264);
    string_constant_265 = 
	    STATIC_STRING("Attempt to pass item without specifying class name");
    list_constant_35 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)32L),
	    string_constant_265);
    string_constant_266 = 
	    STATIC_STRING("Argument count ~a too large for provided argument array of length ~a");
    list_constant_36 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)33L),
	    string_constant_266);
    string_constant_267 = 
	    STATIC_STRING("Remote procedure invocation failed with level ~a error: ~a");
    list_constant_37 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)34L),
	    string_constant_267);
    string_constant_268 = 
	    STATIC_STRING("Invocation of remote procedure ~a failed with level ~a error:~%~a");
    list_constant_38 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)35L),
	    string_constant_268);
    string_constant_269 = 
	    STATIC_STRING("Reserved error code ~a signalled by user.  Codes below ~a are reserved");
    list_constant_39 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)36L),
	    string_constant_269);
    string_constant_270 = 
	    STATIC_STRING("The following custom error has been signalled: ~a");
    list_constant_40 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)37L),
	    string_constant_270);
    string_constant_271 = 
	    STATIC_STRING("Connection was lost or ICP protocol error occurred: ~a");
    list_constant_41 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)38L),
	    string_constant_271);
    string_constant_272 = 
	    STATIC_STRING("Attempted to reclaim a structure not owned (allocated) by user");
    list_constant_42 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)39L),
	    string_constant_272);
    string_constant_273 = 
	    STATIC_STRING("Access function received null pointer argument");
    list_constant_43 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)40L),
	    string_constant_273);
    string_constant_274 = 
	    STATIC_STRING("Attempted to access value when none present - see GSI_NULL_TAG");
    list_constant_44 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)41L),
	    string_constant_274);
    string_constant_275 = 
	    STATIC_STRING("Support for desired network transport type (TCP/IP) not linked in to your executable");
    list_constant_45 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)42L),
	    string_constant_275);
    string_constant_276 = 
	    STATIC_STRING("Attempt to call gsi_run_loop from within the extent of a previous call to gsi_run_loop");
    list_constant_46 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)43L),
	    string_constant_276);
    string_constant_277 = 
	    STATIC_STRING("Attempted to access history when none present - see gsi_history_count_of()");
    list_constant_47 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)44L),
	    string_constant_277);
    string_constant_278 = 
	    STATIC_STRING("Type code ~a is invalid - see documentation for valid type codes");
    list_constant_48 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)46L),
	    string_constant_278);
    string_constant_279 = 
	    STATIC_STRING("Type code ~a is invalid for return to data served variable");
    list_constant_49 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)47L),
	    string_constant_279);
    string_constant_280 = 
	    STATIC_STRING("Attempt to load ~a values into a history whose spec allows for no more than ~a");
    list_constant_50 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)45L),
	    string_constant_280);
    string_constant_281 = 
	    STATIC_STRING("Attempted to access non-existent data - perhaps reclaimed or never allocated\?");
    list_constant_51 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)48L),
	    string_constant_281);
    string_constant_282 = 
	    STATIC_STRING("Context -1 is the undefined context - operation attempted outside of any context");
    list_constant_52 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)49L),
	    string_constant_282);
    string_constant_283 = 
	    STATIC_STRING("The handle of the registered_item is invalid");
    list_constant_53 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)50L),
	    string_constant_283);
    string_constant_284 = 
	    STATIC_STRING("The handle of registered_items[~d] is invalid");
    list_constant_54 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)51L),
	    string_constant_284);
    string_constant_285 = 
	    STATIC_STRING("Out-of-range timestamp seen:~%~\n\t\t\t\t    timestamp: ~d  Valid range: 0.0 < t < ~d");
    list_constant_55 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)52L),
	    string_constant_285);
    string_constant_286 = 
	    STATIC_STRING("Invalid timestamp seen in timestamped object.");
    list_constant_56 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)53L),
	    string_constant_286);
    string_constant_287 = 
	    STATIC_STRING("The handle ~a is not known in context ~a");
    list_constant_57 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)54L),
	    string_constant_287);
    string_constant_288 = 
	    STATIC_STRING("The name is in the registration corresponding to the handle of this registered item");
    list_constant_58 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)55L),
	    string_constant_288);
    string_constant_289 = 
	    STATIC_STRING("Received null pointer argument, or incompatible type for second structure argument");
    list_constant_59 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)56L),
	    string_constant_289);
    string_constant_290 = 
	    STATIC_STRING("ICP message series too long -- please call Gensym customer support");
    list_constant_60 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)57L),
	    string_constant_290);
    string_constant_291 = STATIC_STRING("~5T Protocol out-of-synch (case 2)");
    list_constant_61 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)58L),
	    string_constant_291);
    string_constant_292 = 
	    STATIC_STRING("Attempting to allocate ~a element string, ~\n   which is beyond the established maximum of ~a.");
    list_constant_62 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)59L),
	    string_constant_292);
    string_constant_293 = 
	    STATIC_STRING("Trying to write a string longer than 2MB!");
    list_constant_63 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)60L),
	    string_constant_293);
    string_constant_294 = 
	    STATIC_STRING("Call to structure method where none was defined.");
    list_constant_64 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)61L),
	    string_constant_294);
    string_constant_295 = STATIC_STRING("Index space full!");
    list_constant_2 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)62L),
	    string_constant_295);
    string_constant_296 = 
	    STATIC_STRING("Could not find attribute with qualified name of ~a");
    list_constant_3 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)256L),
	    string_constant_296);
    string_constant_297 = 
	    STATIC_STRING("No timestamp specified.\t The 0.0 value returned does not construe a valid timestamp");
    list_constant_4 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)257L),
	    string_constant_297);
    string_constant_298 = 
	    STATIC_STRING("The local call to ~A made by G2 has been aborted by G2 - no values returned");
    list_constant_5 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)258L),
	    string_constant_298);
    string_constant_299 = 
	    STATIC_STRING("An RPC has been aborted by the client before returning");
    list_constant_6 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)259L),
	    string_constant_299);
    string_constant_300 = 
	    STATIC_STRING("Self referencing items may not yet be sent to G2 - sorry");
    list_constant_7 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)63L),
	    string_constant_300);
    string_constant_301 = 
	    STATIC_STRING("The limit of outstanding calls to G2 procedures has been reached");
    list_constant_8 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)64L),
	    string_constant_301);
    string_constant_302 = 
	    STATIC_STRING("Internal state of RPC identifier is unknown.");
    list_constant_9 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)65L),
	    string_constant_302);
    string_constant_303 = 
	    STATIC_STRING("GSI socket malformed- extension data missing");
    list_constant_10 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)66L),
	    string_constant_303);
    string_constant_304 = 
	    STATIC_STRING("GSI structure contains unknown type tag.");
    list_constant_11 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)67L),
	    string_constant_304);
    string_constant_305 = 
	    STATIC_STRING("GSI found an invalid value type for this history.");
    list_constant_12 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)68L),
	    string_constant_305);
    string_constant_306 = STATIC_STRING("GSI uncaught exception.");
    list_constant_13 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)69L),
	    string_constant_306);
    string_constant_307 = 
	    STATIC_STRING("Could not make exact ICP connection.~%");
    list_constant_14 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)70L),
	    string_constant_307);
    string_constant_308 = 
	    STATIC_STRING("Connection rejected - GSI bridge context limit (~d) exceeded.");
    list_constant_15 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)71L),
	    string_constant_308);
    string_constant_309 = 
	    STATIC_STRING("Connection denied - the G2 at ~a has disallowed connections from GSI");
    list_constant_16 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)72L),
	    string_constant_309);
    string_constant_310 = 
	    STATIC_STRING("No license is available for a connection over \"~a\".");
    list_constant_17 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)84L),
	    string_constant_310);
    string_constant_311 = STATIC_STRING("Unknown string conversion style");
    list_constant_18 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)73L),
	    string_constant_311);
    string_constant_312 = STATIC_STRING("Error during connection attempt: ~a");
    list_constant_19 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)74L),
	    string_constant_312);
    string_constant_313 = STATIC_STRING("Invalid return value index");
    list_constant_20 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)75L),
	    string_constant_313);
    string_constant_314 = STATIC_STRING("Invalid return value kind");
    list_constant_21 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)76L),
	    string_constant_314);
    string_constant_315 = STATIC_STRING("Invalid attribute type");
    list_constant_22 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)77L),
	    string_constant_315);
    string_constant_316 = STATIC_STRING("~a");
    list_constant_23 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)78L),
	    string_constant_316);
    string_constant_317 = STATIC_STRING("Unknown calling procedure index");
    list_constant_24 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)79L),
	    string_constant_317);
    string_constant_318 = STATIC_STRING("Illegal error arguments: ~a");
    list_constant_25 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)80L),
	    string_constant_318);
    string_constant_319 = 
	    STATIC_STRING("gsi_int argument was larger than 536870911");
    list_constant_26 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)81L),
	    string_constant_319);
    string_constant_320 = 
	    STATIC_STRING("gsi_int argument was smaller than -536870912");
    list_constant_27 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)82L),
	    string_constant_320);
    string_constant_321 = 
	    STATIC_STRING("Invalid gsi_symbol argument (use gsi_make_symbol)");
    list_constant_28 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)83L),
	    string_constant_321);
    string_constant_322 = STATIC_STRING("Context ~a has been killed");
    list_constant_29 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)85L),
	    string_constant_322);
    string_constant_323 = STATIC_STRING("Context ~a has been shut down");
    list_constant_30 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)86L),
	    string_constant_323);
    string_constant_324 = STATIC_STRING("Invalid GSI callback name: ~A");
    list_constant_31 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)87L),
	    string_constant_324);
    string_constant_325 = STATIC_STRING("Invalid GSI option index: ~D");
    list_constant_32 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)88L),
	    string_constant_325);
    string_constant_326 = 
	    STATIC_STRING("Failed to successfully load the application ~A");
    list_constant = STATIC_LIST((SI_Long)2L,FIX((SI_Long)89L),
	    string_constant_326);
    string_constant_327 = 
	    STATIC_STRING("Network error event: socket-handle is ~D, event-status is ~D");
    list_constant_1 = STATIC_LIST((SI_Long)2L,FIX((SI_Long)90L),
	    string_constant_327);
    list_constant_33 = STATIC_LIST((SI_Long)2L,list_constant,list_constant_1);
    list_constant_65 = STATIC_LIST_STAR((SI_Long)32L,list_constant_2,
	    list_constant_3,list_constant_4,list_constant_5,
	    list_constant_6,list_constant_7,list_constant_8,
	    list_constant_9,list_constant_10,list_constant_11,
	    list_constant_12,list_constant_13,list_constant_14,
	    list_constant_15,list_constant_16,list_constant_17,
	    list_constant_18,list_constant_19,list_constant_20,
	    list_constant_21,list_constant_22,list_constant_23,
	    list_constant_24,list_constant_25,list_constant_26,
	    list_constant_27,list_constant_28,list_constant_29,
	    list_constant_30,list_constant_31,list_constant_32,
	    list_constant_33);
    list_constant_97 = STATIC_LIST_STAR((SI_Long)32L,list_constant_34,
	    list_constant_35,list_constant_36,list_constant_37,
	    list_constant_38,list_constant_39,list_constant_40,
	    list_constant_41,list_constant_42,list_constant_43,
	    list_constant_44,list_constant_45,list_constant_46,
	    list_constant_47,list_constant_48,list_constant_49,
	    list_constant_50,list_constant_51,list_constant_52,
	    list_constant_53,list_constant_54,list_constant_55,
	    list_constant_56,list_constant_57,list_constant_58,
	    list_constant_59,list_constant_60,list_constant_61,
	    list_constant_62,list_constant_63,list_constant_64,
	    list_constant_65);
    list_constant_98 = STATIC_LIST_STAR((SI_Long)32L,list_constant_66,
	    list_constant_67,list_constant_68,list_constant_69,
	    list_constant_70,list_constant_71,list_constant_72,
	    list_constant_73,list_constant_74,list_constant_75,
	    list_constant_76,list_constant_77,list_constant_78,
	    list_constant_79,list_constant_80,list_constant_81,
	    list_constant_82,list_constant_83,list_constant_84,
	    list_constant_85,list_constant_86,list_constant_87,
	    list_constant_88,list_constant_89,list_constant_90,
	    list_constant_91,list_constant_92,list_constant_93,
	    list_constant_94,list_constant_95,list_constant_96,
	    list_constant_97);
    G2int_gsi_error_code_table = list_constant_98;
    if (G2int_gsi_scheduled_tasks_time_limit == UNBOUND)
	G2int_gsi_scheduled_tasks_time_limit = 
		g2int_fixnum_time_interval(FIX((SI_Long)200L));
    Qg2int_gsi_run_state_direction_entering_gsi = 
	    STATIC_SYMBOL("GSI-RUN-STATE-DIRECTION-ENTERING-GSI",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_run_state_direction_entering_gsi,
	    FIX((SI_Long)1L));
    Qg2int_gsi_run_state_direction_leaving_gsi = 
	    STATIC_SYMBOL("GSI-RUN-STATE-DIRECTION-LEAVING-GSI",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_run_state_direction_leaving_gsi,
	    FIX((SI_Long)2L));
    Qg2int_gsi_run_state_direction_entering_watchdog = 
	    STATIC_SYMBOL("GSI-RUN-STATE-DIRECTION-ENTERING-WATCHDOG",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_run_state_direction_entering_watchdog,
	    FIX((SI_Long)3L));
    Qg2int_gsi_run_state_direction_leaving_watchdog = 
	    STATIC_SYMBOL("GSI-RUN-STATE-DIRECTION-LEAVING-WATCHDOG",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_run_state_direction_leaving_watchdog,
	    FIX((SI_Long)4L));
    Qg2int_gsi_run_state_direction_entering_gsi_by_signal = 
	    STATIC_SYMBOL("GSI-RUN-STATE-DIRECTION-ENTERING-GSI-BY-SIGNAL",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_run_state_direction_entering_gsi_by_signal,
	    FIX((SI_Long)5L));
    Qg2int_gsi_run_state_type_api = STATIC_SYMBOL("GSI-RUN-STATE-TYPE-API",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_run_state_type_api,FIX((SI_Long)1L));
    Qg2int_gsi_run_state_type_callback = 
	    STATIC_SYMBOL("GSI-RUN-STATE-TYPE-CALLBACK",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_run_state_type_callback,FIX((SI_Long)2L));
    Qg2int_gsi_run_state_type_wait = 
	    STATIC_SYMBOL("GSI-RUN-STATE-TYPE-WAIT",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_run_state_type_wait,FIX((SI_Long)3L));
    Qg2int_gsi_run_state_type_signal = 
	    STATIC_SYMBOL("GSI-RUN-STATE-TYPE-SIGNAL",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_run_state_type_signal,FIX((SI_Long)4L));
    string_constant = STATIC_STRING("gsi_signal_handler");
    if (G2int_gsi_global_option_array == UNBOUND) {
	option_array = make_array(3,G2int_gsi_number_of_options,
		Kinitial_element,Klocal);
	SVREF(option_array,G2int_gsi_one_cycle) = Nil;
	SVREF(option_array,G2int_gsi_use_gfloats) = Nil;
	SVREF(option_array,G2int_gsi_no_signal_handlers) = Nil;
	SVREF(option_array,G2int_gsi_trace_run_state) = Nil;
	G2int_gsi_global_option_array = option_array;
    }
    if (G2int_callback_is_global_array == UNBOUND) {
	array = make_array(1,G2int_gsi_number_of_callbacks);
	SVREF(array,G2int_gsi_set_up) = T;
	SVREF(array,G2int_gsi_read_callback) = T;
	SVREF(array,G2int_gsi_write_callback) = T;
	SVREF(array,G2int_gsi_open_fd) = T;
	SVREF(array,G2int_gsi_close_fd) = T;
	SVREF(array,G2int_gsi_writing_fd) = T;
	SVREF(array,G2int_gsi_not_writing_fd) = T;
	SVREF(array,G2int_gsi_error_handler) = T;
	SVREF(array,G2int_gsi_run_state_change) = T;
	SVREF(array,G2int_gsi_idle) = T;
	G2int_callback_is_global_array = array;
    }
    array_constant_21 = STATIC_ARRAY(Qt,(SI_Long)1L,FIX((SI_Long)25L));
    Qab_g2int_gsi_set_up = STATIC_SYMBOL("gsi_set_up",AB_package);
    Qab_g2int_gsi_get_tcp_port = STATIC_SYMBOL("gsi_get_tcp_port",AB_package);
    Qab_g2int_gsi_pause_context = STATIC_SYMBOL("gsi_pause_context",
	    AB_package);
    Qab_g2int_gsi_resume_context = STATIC_SYMBOL("gsi_resume_context",
	    AB_package);
    Qab_g2int_gsi_shutdown_context = STATIC_SYMBOL("gsi_shutdown_context",
	    AB_package);
    Qab_g2int_gsi_g2_poll = STATIC_SYMBOL("gsi_g2_poll",AB_package);
    Qab_g2int_gsi_read_callback = STATIC_SYMBOL("gsi_read_callback",
	    AB_package);
    Qab_g2int_gsi_write_callback = STATIC_SYMBOL("gsi_write_callback",
	    AB_package);
    Qab_g2int_gsi_open_fd = STATIC_SYMBOL("gsi_open_fd",AB_package);
    Qab_g2int_gsi_close_fd = STATIC_SYMBOL("gsi_close_fd",AB_package);
    Qab_g2int_gsi_initialize_context = 
	    STATIC_SYMBOL("gsi_initialize_context",AB_package);
    Qab_g2int_gsi_receive_registration = 
	    STATIC_SYMBOL("gsi_receive_registration",AB_package);
    Qab_g2int_gsi_receive_deregistrations = 
	    STATIC_SYMBOL("gsi_receive_deregistrations",AB_package);
    Qab_g2int_gsi_get_data = STATIC_SYMBOL("gsi_get_data",AB_package);
    Qab_g2int_gsi_set_data = STATIC_SYMBOL("gsi_set_data",AB_package);
    Qab_g2int_gsi_receive_message = STATIC_SYMBOL("gsi_receive_message",
	    AB_package);
    Qab_g2int_gsi_run_state_change = STATIC_SYMBOL("gsi_run_state_change",
	    AB_package);
    Qab_g2int_gsi_error_handler = STATIC_SYMBOL("gsi_error_handler",
	    AB_package);
    Qab_g2int_gsi_missing_procedure_handler = 
	    STATIC_SYMBOL("gsi_missing_procedure_handler",AB_package);
    Qab_g2int_gsi_idle = STATIC_SYMBOL("gsi_idle",AB_package);
    Qab_g2int_gsi_start_context = STATIC_SYMBOL("gsi_start_context",
	    AB_package);
    Qab_g2int_gsi_reset_context = STATIC_SYMBOL("gsi_reset_context",
	    AB_package);
    Qab_g2int_gsi_writing_fd = STATIC_SYMBOL("gsi_writing_fd",AB_package);
    Qab_g2int_gsi_not_writing_fd = STATIC_SYMBOL("gsi_not_writing_fd",
	    AB_package);
    ISASET_1(array_constant_21,(SI_Long)0L,Qab_g2int_gsi_set_up);
    ISASET_1(array_constant_21,(SI_Long)1L,Qab_g2int_gsi_get_tcp_port);
    ISASET_1(array_constant_21,(SI_Long)2L,Qab_g2int_gsi_pause_context);
    ISASET_1(array_constant_21,(SI_Long)3L,Qab_g2int_gsi_resume_context);
    ISASET_1(array_constant_21,(SI_Long)4L,Qab_g2int_gsi_shutdown_context);
    ISASET_1(array_constant_21,(SI_Long)5L,Qab_g2int_gsi_g2_poll);
    ISASET_1(array_constant_21,(SI_Long)6L,Qab_g2int_gsi_read_callback);
    ISASET_1(array_constant_21,(SI_Long)7L,Qab_g2int_gsi_write_callback);
    ISASET_1(array_constant_21,(SI_Long)8L,Qab_g2int_gsi_open_fd);
    ISASET_1(array_constant_21,(SI_Long)9L,Qab_g2int_gsi_close_fd);
    ISASET_1(array_constant_21,(SI_Long)10L,Qab_g2int_gsi_initialize_context);
    ISASET_1(array_constant_21,(SI_Long)11L,
	    Qab_g2int_gsi_receive_registration);
    ISASET_1(array_constant_21,(SI_Long)12L,
	    Qab_g2int_gsi_receive_deregistrations);
    ISASET_1(array_constant_21,(SI_Long)13L,Qab_g2int_gsi_get_data);
    ISASET_1(array_constant_21,(SI_Long)14L,Qab_g2int_gsi_set_data);
    ISASET_1(array_constant_21,(SI_Long)15L,Qab_g2int_gsi_receive_message);
    ISASET_1(array_constant_21,(SI_Long)16L,Qab_g2int_gsi_run_state_change);
    ISASET_1(array_constant_21,(SI_Long)17L,Qab_g2int_gsi_error_handler);
    ISASET_1(array_constant_21,(SI_Long)18L,
	    Qab_g2int_gsi_missing_procedure_handler);
    ISASET_1(array_constant_21,(SI_Long)20L,Qab_g2int_gsi_idle);
    ISASET_1(array_constant_21,(SI_Long)21L,Qab_g2int_gsi_start_context);
    ISASET_1(array_constant_21,(SI_Long)22L,Qab_g2int_gsi_reset_context);
    ISASET_1(array_constant_21,(SI_Long)23L,Qab_g2int_gsi_writing_fd);
    ISASET_1(array_constant_21,(SI_Long)24L,Qab_g2int_gsi_not_writing_fd);
    if (G2int_gsi_callback_name_symbol_array == UNBOUND)
	G2int_gsi_callback_name_symbol_array = array_constant_21;
    array_constant_22 = STATIC_ARRAY(Qt,(SI_Long)1L,FIX((SI_Long)25L));
    string_constant_28 = STATIC_STRING("gsi_set_up");
    string_constant_328 = STATIC_STRING("gsi_get_tcp_port");
    string_constant_329 = STATIC_STRING("gsi_pause_context");
    string_constant_330 = STATIC_STRING("gsi_resume_context");
    string_constant_331 = STATIC_STRING("gsi_shutdown_context");
    string_constant_332 = STATIC_STRING("gsi_g2_poll");
    string_constant_333 = STATIC_STRING("gsi_read_callback");
    string_constant_334 = STATIC_STRING("gsi_write_callback");
    string_constant_335 = STATIC_STRING("gsi_open_fd");
    string_constant_336 = STATIC_STRING("gsi_close_fd");
    string_constant_337 = STATIC_STRING("gsi_initialize_context");
    string_constant_338 = STATIC_STRING("gsi_receive_registration");
    string_constant_339 = STATIC_STRING("gsi_receive_deregistrations");
    string_constant_340 = STATIC_STRING("gsi_get_data");
    string_constant_341 = STATIC_STRING("gsi_set_data");
    string_constant_342 = STATIC_STRING("gsi_receive_message");
    string_constant_343 = STATIC_STRING("gsi_run_state_change");
    string_constant_344 = STATIC_STRING("gsi_error_handler");
    string_constant_345 = STATIC_STRING("gsi_missing_procedure_handler");
    string_constant_346 = STATIC_STRING("gsi_watchdog_function");
    string_constant_347 = STATIC_STRING("gsi_idle");
    string_constant_348 = STATIC_STRING("gsi_start_context");
    string_constant_349 = STATIC_STRING("gsi_reset_context");
    string_constant_350 = STATIC_STRING("gsi_writing_fd");
    string_constant_351 = STATIC_STRING("gsi_not_writing_fd");
    ISASET_1(array_constant_22,(SI_Long)0L,string_constant_28);
    ISASET_1(array_constant_22,(SI_Long)1L,string_constant_328);
    ISASET_1(array_constant_22,(SI_Long)2L,string_constant_329);
    ISASET_1(array_constant_22,(SI_Long)3L,string_constant_330);
    ISASET_1(array_constant_22,(SI_Long)4L,string_constant_331);
    ISASET_1(array_constant_22,(SI_Long)5L,string_constant_332);
    ISASET_1(array_constant_22,(SI_Long)6L,string_constant_333);
    ISASET_1(array_constant_22,(SI_Long)7L,string_constant_334);
    ISASET_1(array_constant_22,(SI_Long)8L,string_constant_335);
    ISASET_1(array_constant_22,(SI_Long)9L,string_constant_336);
    ISASET_1(array_constant_22,(SI_Long)10L,string_constant_337);
    ISASET_1(array_constant_22,(SI_Long)11L,string_constant_338);
    ISASET_1(array_constant_22,(SI_Long)12L,string_constant_339);
    ISASET_1(array_constant_22,(SI_Long)13L,string_constant_340);
    ISASET_1(array_constant_22,(SI_Long)14L,string_constant_341);
    ISASET_1(array_constant_22,(SI_Long)15L,string_constant_342);
    ISASET_1(array_constant_22,(SI_Long)16L,string_constant_343);
    ISASET_1(array_constant_22,(SI_Long)17L,string_constant_344);
    ISASET_1(array_constant_22,(SI_Long)18L,string_constant_345);
    ISASET_1(array_constant_22,(SI_Long)19L,string_constant_346);
    ISASET_1(array_constant_22,(SI_Long)20L,string_constant_347);
    ISASET_1(array_constant_22,(SI_Long)21L,string_constant_348);
    ISASET_1(array_constant_22,(SI_Long)22L,string_constant_349);
    ISASET_1(array_constant_22,(SI_Long)23L,string_constant_350);
    ISASET_1(array_constant_22,(SI_Long)24L,string_constant_351);
    if (G2int_gsi_callback_name_string_array == UNBOUND)
	G2int_gsi_callback_name_string_array = array_constant_22;
    string_constant_1 = STATIC_STRING("gsin_set_up");
    string_constant_2 = STATIC_STRING("gsin_get_tcp_port");
    string_constant_3 = STATIC_STRING("gsin_pause_context");
    string_constant_4 = STATIC_STRING("gsin_resume_context");
    string_constant_5 = STATIC_STRING("gsin_shutdown_context");
    string_constant_6 = STATIC_STRING("gsin_g2_poll");
    string_constant_7 = STATIC_STRING("gsin_read_callback");
    string_constant_8 = STATIC_STRING("gsin_write_callback");
    string_constant_9 = STATIC_STRING("gsin_open_fd");
    string_constant_10 = STATIC_STRING("gsin_close_fd");
    string_constant_11 = STATIC_STRING("gsin_initialize_context");
    string_constant_12 = STATIC_STRING("gsin_receive_registration");
    string_constant_13 = STATIC_STRING("gsin_receive_deregistrations");
    string_constant_14 = STATIC_STRING("gsin_get_data");
    string_constant_15 = STATIC_STRING("gsin_set_data");
    string_constant_16 = STATIC_STRING("gsin_receive_message");
    string_constant_17 = STATIC_STRING("gsin_run_state_change");
    string_constant_18 = STATIC_STRING("gsin_error_handler");
    string_constant_19 = STATIC_STRING("gsin_missing_procedure_handler");
    Qab_g2int_gsi_watchdog_function = 
	    STATIC_SYMBOL("gsi_watchdog_function",AB_package);
    string_constant_20 = STATIC_STRING("gsin_watchdog_function");
    string_constant_21 = STATIC_STRING("gsin_idle");
    string_constant_22 = STATIC_STRING("gsin_start_context");
    string_constant_23 = STATIC_STRING("gsin_reset_context");
    string_constant_24 = STATIC_STRING("gsin_writing_fd");
    string_constant_25 = STATIC_STRING("gsin_not_writing_fd");
    G2_DEFSTRUCT_STRUCTURE_NAME_package = 
	    STATIC_PACKAGE("G2-DEFSTRUCT-STRUCTURE-NAME");
    Qg2_defstruct_structure_name_gsi_application_g2_struct = 
	    STATIC_SYMBOL("GSI-APPLICATION-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qg2int_gsi_application = STATIC_SYMBOL("GSI-APPLICATION",AB_package);
    Qg2int_ab_name_of_unique_structure_type = 
	    STATIC_SYMBOL("AB-NAME-OF-UNIQUE-STRUCTURE-TYPE",AB_package);
    g2int_mutate_global_property(Qg2_defstruct_structure_name_gsi_application_g2_struct,
	    Qg2int_gsi_application,Qg2int_ab_name_of_unique_structure_type);
    Qg2int_unique_structure_type_of_ab_nameqm = 
	    STATIC_SYMBOL("UNIQUE-STRUCTURE-TYPE-OF-AB-NAME\?",AB_package);
    g2int_mutate_global_property(Qg2int_gsi_application,
	    Qg2_defstruct_structure_name_gsi_application_g2_struct,
	    Qg2int_unique_structure_type_of_ab_nameqm);
    if (G2int_the_type_description_of_gsi_application == UNBOUND)
	G2int_the_type_description_of_gsi_application = Nil;
    string_constant_352 = 
	    STATIC_STRING("43Dy8l83-2y1n83-2y8m8k1l8m0000001l1n8n83*Wy1l83-3yksk0k0");
    temp = G2int_the_type_description_of_gsi_application;
    G2int_the_type_description_of_gsi_application = 
	    g2int_load_and_initialize_type_description(temp,
	    g2int_regenerate_optimized_constant(string_constant_352));
    Qg2int_type_description_of_unique_type_name_of_gensym_structure = 
	    STATIC_SYMBOL("TYPE-DESCRIPTION-OF-UNIQUE-TYPE-NAME-OF-GENSYM-STRUCTURE",
	    AB_package);
    g2int_mutate_global_property(Qg2_defstruct_structure_name_gsi_application_g2_struct,
	    G2int_the_type_description_of_gsi_application,
	    Qg2int_type_description_of_unique_type_name_of_gensym_structure);
    Qg2int_type_description_of_type = 
	    STATIC_SYMBOL("TYPE-DESCRIPTION-OF-TYPE",AB_package);
    g2int_mutate_global_property(Qg2int_gsi_application,
	    G2int_the_type_description_of_gsi_application,
	    Qg2int_type_description_of_type);
    Qg2int_chain_of_available_gsi_applications = 
	    STATIC_SYMBOL("CHAIN-OF-AVAILABLE-GSI-APPLICATIONS",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qg2int_chain_of_available_gsi_applications,
	    G2int_chain_of_available_gsi_applications);
    Qg2int_utilities2 = STATIC_SYMBOL("UTILITIES2",AB_package);
    g2int_record_system_variable(Qg2int_chain_of_available_gsi_applications,
	    Qg2int_utilities2,Nil,Qnil,Qt,Qnil,Qnil);
    Qg2int_gsi_application_count = STATIC_SYMBOL("GSI-APPLICATION-COUNT",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qg2int_gsi_application_count,
	    G2int_gsi_application_count);
    g2int_record_system_variable(Qg2int_gsi_application_count,
	    Qg2int_utilities2,FIX((SI_Long)0L),Qnil,Qt,Qnil,Qnil);
    Qg2int_reclaim_structure = STATIC_SYMBOL("RECLAIM-STRUCTURE",AB_package);
    reclaim_structure_for_gsi_application = 
	    STATIC_FUNCTION(g2int_reclaim_structure_for_gsi_application,
	    NIL,FALSE,1,1);
    g2int_record_direct_structure_method(Qg2int_reclaim_structure,
	    Qg2int_gsi_application,reclaim_structure_for_gsi_application);
    if (G2int_loadable_bridges_enabled_p == UNBOUND)
	G2int_loadable_bridges_enabled_p = Nil;
    Qg2int_have_default_gsi_application = 
	    STATIC_SYMBOL("HAVE-DEFAULT-GSI-APPLICATION",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qg2int_have_default_gsi_application,
	    G2int_have_default_gsi_application);
    Qg2int_gsi = STATIC_SYMBOL("GSI",AB_package);
    g2int_record_system_variable(Qg2int_have_default_gsi_application,
	    Qg2int_gsi,Nil,Qnil,Qt,Qnil,Qnil);
    Qg2int_default_gsi_application = 
	    STATIC_SYMBOL("DEFAULT-GSI-APPLICATION",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qg2int_default_gsi_application,
	    G2int_default_gsi_application);
    Kfuncall = STATIC_SYMBOL("FUNCALL",Pkeyword);
    Qg2int_make_default_gsi_application = 
	    STATIC_SYMBOL("MAKE-DEFAULT-GSI-APPLICATION",AB_package);
    list_constant_99 = STATIC_LIST((SI_Long)2L,Kfuncall,
	    Qg2int_make_default_gsi_application);
    g2int_record_system_variable(Qg2int_default_gsi_application,Qg2int_gsi,
	    list_constant_99,Qnil,Qnil,Qnil,Qnil);
    Qg2int_default = STATIC_SYMBOL("DEFAULT",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_make_default_gsi_application,
	    STATIC_FUNCTION(g2int_make_default_gsi_application,NIL,FALSE,0,0));
    if (G2int_all_gsi_applications == UNBOUND)
	G2int_all_gsi_applications = Nil;
    if (G2int_current_gsi_application == UNBOUND)
	G2int_current_gsi_application = Nil;
    string_constant_26 = STATIC_STRING("~(~A~)");
    string_constant_27 = STATIC_STRING("gsi_set_options_from_compile");
    Qg2int_load_gsi_application = STATIC_SYMBOL("LOAD-GSI-APPLICATION",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_load_gsi_application,
	    STATIC_FUNCTION(g2int_load_gsi_application,NIL,FALSE,1,1));
    Qg2int_gsi_set_current_application = 
	    STATIC_SYMBOL("gsi_set_current_application",AB_package);
    string_constant_29 = STATIC_STRING("gsi_set_current_application");
    Qg2int_gsi_catch = STATIC_SYMBOL("GSI-CATCH",AB_package);
    Qg2int_gsi_initialize_callback = 
	    STATIC_SYMBOL("gsi_initialize_callback",AB_package);
    string_constant_30 = STATIC_STRING("gsi_initialize_callback");
    if (G2int_pending_gsi_callbacks == UNBOUND)
	G2int_pending_gsi_callbacks = Nil;
    if (G2int_enable_global_errors == UNBOUND)
	G2int_enable_global_errors = Nil;
    Qg2int_handle_watchdog_task = STATIC_SYMBOL("HANDLE-WATCHDOG-TASK",
	    AB_package);
    Qg2_defstruct_structure_name_schedule_task_g2_struct = 
	    STATIC_SYMBOL("SCHEDULE-TASK-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    string_constant_31 = STATIC_STRING("gsi_watchdog");
    SET_SYMBOL_FUNCTION(Qg2int_handle_watchdog_task,
	    STATIC_FUNCTION(g2int_handle_watchdog_task,NIL,FALSE,1,1));
    string_constant_32 = STATIC_STRING("gsi_initialize_error_variable");
    if (G2int_gsi_wide_api_p == UNBOUND)
	G2int_gsi_wide_api_p = Nil;
    if (G2int_gsi_use_references_p == UNBOUND)
	G2int_gsi_use_references_p = Nil;
    Qg2int_gsi_references_in_use = STATIC_SYMBOL("GSI-REFERENCES-IN-USE",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qg2int_gsi_references_in_use,
	    G2int_gsi_references_in_use);
    if (G2int_gsi_references_in_use == UNBOUND)
	G2int_gsi_references_in_use = FIX((SI_Long)0L);
    Qg2int_user = STATIC_SYMBOL("USER",AB_package);
    Qg2int_gsi_set_option = STATIC_SYMBOL("gsi_set_option",AB_package);
    string_constant_33 = STATIC_STRING("gsi_set_option");
    Qg2int_gsi_reset_option = STATIC_SYMBOL("gsi_reset_option",AB_package);
    string_constant_34 = STATIC_STRING("gsi_reset_option");
    Qg2int_gsi_option_is_set = STATIC_SYMBOL("gsi_option_is_set",AB_package);
    string_constant_35 = STATIC_STRING("gsi_option_is_set");
    if (G2int_in_error_handler == UNBOUND)
	G2int_in_error_handler = Nil;
    string_constant_36 = STATIC_STRING("~%~a ~a occurred in ~a");
    Qg2int_warning = STATIC_SYMBOL("WARNING",AB_package);
    string_constant_37 = STATIC_STRING("Warning");
    string_constant_38 = STATIC_STRING("Error");
    string_constant_39 = STATIC_STRING("~%  ~a~%~%");
    string_constant_40 = 
	    STATIC_STRING("~%Not calling the user error handler, because a user error handler is already running.~2%");
    Qg2int_fatal = STATIC_SYMBOL("FATAL",AB_package);
    Qg2int_connection = STATIC_SYMBOL("CONNECTION",AB_package);
    list_constant_100 = STATIC_LIST((SI_Long)2L,Qunsigned_byte,
	    FIX((SI_Long)16L));
    array_constant = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)64L));
    UBYTE_16_ISASET_1(array_constant,(SI_Long)0L,(SI_Long)65L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)1L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)2L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)3L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)4L,(SI_Long)103L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)5L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)6L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)7L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)8L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)9L,(SI_Long)104L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)10L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)11L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)12L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)13L,(SI_Long)98L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)14L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)15L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)16L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)17L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)18L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)19L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)20L,(SI_Long)117L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)21L,(SI_Long)103L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)22L,(SI_Long)104L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)23L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)24L,(SI_Long)44L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)25L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)26L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)27L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)28L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)29L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)30L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)31L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)32L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)33L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)34L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)35L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)36L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)37L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)38L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)39L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)40L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)41L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)42L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)43L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)44L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)45L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)46L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)47L,(SI_Long)104L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)48L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)49L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)50L,(SI_Long)32L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)51L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)52L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)53L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)54L,(SI_Long)117L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)55L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)56L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)57L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)58L,(SI_Long)100L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)62L,(SI_Long)59L);
    UBYTE_16_ISASET_1(array_constant,(SI_Long)63L,(SI_Long)57344L);
    Qg2int_tformat_text_string = STATIC_SYMBOL("TFORMAT-TEXT-STRING",
	    AB_package);
    string_constant_41 = 
	    STATIC_STRING("~%Undefined error - please notify Gensym customer support.~%~%");
    Qg2int_utf_g = STATIC_SYMBOL("UTF-G",AB_package);
    Qg2int_iso_8859_1 = STATIC_SYMBOL("ISO-8859-1",AB_package);
    Qg2int_iso_8859_2 = STATIC_SYMBOL("ISO-8859-2",AB_package);
    Qg2int_iso_8859_3 = STATIC_SYMBOL("ISO-8859-3",AB_package);
    Qg2int_iso_8859_4 = STATIC_SYMBOL("ISO-8859-4",AB_package);
    Qg2int_iso_8859_5 = STATIC_SYMBOL("ISO-8859-5",AB_package);
    Qg2int_iso_8859_6 = STATIC_SYMBOL("ISO-8859-6",AB_package);
    Qg2int_iso_8859_7 = STATIC_SYMBOL("ISO-8859-7",AB_package);
    Qg2int_iso_8859_8 = STATIC_SYMBOL("ISO-8859-8",AB_package);
    Qg2int_iso_8859_9 = STATIC_SYMBOL("ISO-8859-9",AB_package);
    Qg2int_iso_8859_10 = STATIC_SYMBOL("ISO-8859-10",AB_package);
    Qg2int_us_ascii = STATIC_SYMBOL("US-ASCII",AB_package);
    Qg2int_jis_x_0208 = STATIC_SYMBOL("JIS-X-0208",AB_package);
    Khan_unification_mode = STATIC_SYMBOL("HAN-UNIFICATION-MODE",Pkeyword);
    Qg2int_japanese = STATIC_SYMBOL("JAPANESE",AB_package);
    list_constant_101 = STATIC_LIST((SI_Long)2L,Khan_unification_mode,
	    Qg2int_japanese);
    list_constant_104 = STATIC_CONS(Qg2int_jis_x_0208,list_constant_101);
    Qg2int_jis_x_0208_euc = STATIC_SYMBOL("JIS-X-0208-EUC",AB_package);
    list_constant_105 = STATIC_CONS(Qg2int_jis_x_0208_euc,list_constant_101);
    Qg2int_shift_jis_x_0208 = STATIC_SYMBOL("SHIFT-JIS-X-0208",AB_package);
    list_constant_106 = STATIC_CONS(Qg2int_shift_jis_x_0208,list_constant_101);
    Qg2int_ks_c_5601 = STATIC_SYMBOL("KS-C-5601",AB_package);
    Qg2int_korean = STATIC_SYMBOL("KOREAN",AB_package);
    list_constant_102 = STATIC_LIST((SI_Long)2L,Khan_unification_mode,
	    Qg2int_korean);
    list_constant_107 = STATIC_CONS(Qg2int_ks_c_5601,list_constant_102);
    Qg2int_ks_c_5601_euc = STATIC_SYMBOL("KS-C-5601-EUC",AB_package);
    list_constant_108 = STATIC_CONS(Qg2int_ks_c_5601_euc,list_constant_102);
    Qg2int_unicode_utf_7 = STATIC_SYMBOL("UNICODE-UTF-7",AB_package);
    Qg2int_unicode_utf_8 = STATIC_SYMBOL("UNICODE-UTF-8",AB_package);
    Qg2int_x_compound_text = STATIC_SYMBOL("X-COMPOUND-TEXT",AB_package);
    Kunicode_line_separator_export_translation = 
	    STATIC_SYMBOL("UNICODE-LINE-SEPARATOR-EXPORT-TRANSLATION",
	    Pkeyword);
    Qg2int_lf = STATIC_SYMBOL("LF",AB_package);
    list_constant_109 = STATIC_LIST((SI_Long)5L,Qg2int_x_compound_text,
	    Khan_unification_mode,Qg2int_japanese,
	    Kunicode_line_separator_export_translation,Qg2int_lf);
    Qg2int_gb_2312 = STATIC_SYMBOL("GB-2312",AB_package);
    Qg2int_chinese = STATIC_SYMBOL("CHINESE",AB_package);
    list_constant_103 = STATIC_LIST((SI_Long)2L,Khan_unification_mode,
	    Qg2int_chinese);
    list_constant_110 = STATIC_CONS(Qg2int_gb_2312,list_constant_103);
    Qg2int_gb_2312_euc = STATIC_SYMBOL("GB-2312-EUC",AB_package);
    list_constant_111 = STATIC_CONS(Qg2int_gb_2312_euc,list_constant_103);
    list_constant_112 = STATIC_LIST((SI_Long)22L,Qg2int_utf_g,
	    Qg2int_iso_8859_1,Qg2int_iso_8859_2,Qg2int_iso_8859_3,
	    Qg2int_iso_8859_4,Qg2int_iso_8859_5,Qg2int_iso_8859_6,
	    Qg2int_iso_8859_7,Qg2int_iso_8859_8,Qg2int_iso_8859_9,
	    Qg2int_iso_8859_10,Qg2int_us_ascii,list_constant_104,
	    list_constant_105,list_constant_106,list_constant_107,
	    list_constant_108,Qg2int_unicode_utf_7,Qg2int_unicode_utf_8,
	    list_constant_109,list_constant_110,list_constant_111);
    G2int_gsi_text_conversion_style_list = list_constant_112;
    Qg2int_wide_string = STATIC_SYMBOL("WIDE-STRING",AB_package);
    Qg2int_gensym_string = STATIC_SYMBOL("GENSYM-STRING",AB_package);
    if (G2int_gsi_gensym_string_text_conversion_style_array == UNBOUND)
	G2int_gsi_gensym_string_text_conversion_style_array = 
		g2int_make_transcode_purpose_array(Nil,
		G2int_gsi_text_conversion_style_list);
    if (G2int_gsi_wide_string_text_conversion_style_array == UNBOUND)
	G2int_gsi_wide_string_text_conversion_style_array = 
		g2int_make_transcode_purpose_array(T,
		G2int_gsi_text_conversion_style_list);
    G2int_current_gsi_string_conversion_style_code = Nil;
    string_constant_42 = STATIC_STRING("gsi_string_conversion_style");
    Qg2int_gsi_set_string_conversion_style = 
	    STATIC_SYMBOL("gsi_set_string_conversion_style",AB_package);
    string_constant_43 = STATIC_STRING("gsi_set_string_conversion_style");
    Qg2int_gsi_convert_str_to_ustr = 
	    STATIC_SYMBOL("gsi_convert_str_to_ustr",AB_package);
    string_constant_44 = STATIC_STRING("gsi_convert_str_to_ustr");
    Qg2int_gsi_convert_wstr_to_ustr = 
	    STATIC_SYMBOL("gsi_convert_wstr_to_ustr",AB_package);
    string_constant_45 = STATIC_STRING("gsi_convert_wstr_to_ustr");
    Qg2int_gsi_convert_ustr_to_str = 
	    STATIC_SYMBOL("gsi_convert_ustr_to_str",AB_package);
    string_constant_46 = STATIC_STRING("gsi_convert_ustr_to_str");
    Qg2int_gsi_convert_ustr_to_wstr = 
	    STATIC_SYMBOL("gsi_convert_ustr_to_wstr",AB_package);
    string_constant_47 = STATIC_STRING("gsi_convert_ustr_to_wstr");
    Qg2int_rpc_arg_list = STATIC_SYMBOL("RPC-ARG-LIST",AB_package);
    Qg2int_gsi_icp_facility = STATIC_SYMBOL("GSI_ICP_FACILITY",AB_package);
    Qg2int_gsi_string_facility = STATIC_SYMBOL("GSI_STRING_FACILITY",
	    AB_package);
    Qg2int_gsi_structure_facility = STATIC_SYMBOL("GSI_STRUCTURE_FACILITY",
	    AB_package);
    Qg2int_gensym = STATIC_SYMBOL("GENSYM",AB_package);
    Qg2_defstruct_structure_name_gsi_instance_g2_struct = 
	    STATIC_SYMBOL("GSI-INSTANCE-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qg2_defstruct_structure_name_gsi_transfer_wrapper_g2_struct = 
	    STATIC_SYMBOL("GSI-TRANSFER-WRAPPER-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qg2_defstruct_structure_name_gsi_attribute_g2_struct = 
	    STATIC_SYMBOL("GSI-ATTRIBUTE-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qg2_defstruct_structure_name_gsi_history_g2_struct = 
	    STATIC_SYMBOL("GSI-HISTORY-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qg2_defstruct_structure_name_gsi_array_wrapper_g2_struct = 
	    STATIC_SYMBOL("GSI-ARRAY-WRAPPER-G2-STRUCT",
	    G2_DEFSTRUCT_STRUCTURE_NAME_package);
    Qg2int_managed_array = STATIC_SYMBOL("MANAGED-ARRAY",AB_package);
    Qg2int_managed_string_array = STATIC_SYMBOL("MANAGED-STRING-ARRAY",
	    AB_package);
    Qg2int_simple_integer_vector = STATIC_SYMBOL("SIMPLE-INTEGER-VECTOR",
	    AB_package);
    Qg2int_simple_float_array = STATIC_SYMBOL("SIMPLE-FLOAT-ARRAY",AB_package);
    Qg2int_gsi_reclaim_facility = STATIC_SYMBOL("GSI_RECLAIM_FACILITY",
	    AB_package);
    Qg2int_context = STATIC_SYMBOL("CONTEXT",AB_package);
    Qg2int_gsi_event_queue = STATIC_SYMBOL("GSI-EVENT-QUEUE",AB_package);
    Qg2int_gsi_input_queue = STATIC_SYMBOL("GSI-INPUT-QUEUE",AB_package);
    Qg2int_reclaim_gsi_instance_value = 
	    STATIC_SYMBOL("RECLAIM-GSI-INSTANCE-VALUE",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_reclaim_gsi_instance_value,
	    STATIC_FUNCTION(g2int_reclaim_gsi_instance_value,NIL,FALSE,4,4));
    Qg2int_reclaim_gsi_user_transfer_wrapper = 
	    STATIC_SYMBOL("RECLAIM-GSI-USER-TRANSFER-WRAPPER",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_reclaim_gsi_user_transfer_wrapper,
	    STATIC_FUNCTION(g2int_reclaim_gsi_user_transfer_wrapper,NIL,
	    FALSE,1,1));
    Qg2int_attribute = STATIC_SYMBOL("ATTRIBUTE",AB_package);
    Qab_g2int_make_gsi_history = STATIC_SYMBOL("MAKE_GSI_HISTORY",AB_package);
    if (G2int_gsi_transfer_array_for_deregistration == UNBOUND)
	G2int_gsi_transfer_array_for_deregistration = Nil;
    if (G2int_gsi_sensor_to_deregisterqm == UNBOUND)
	G2int_gsi_sensor_to_deregisterqm = Nil;
    if (G2int_index_of_gsi_sensor_to_deregisterqm == UNBOUND)
	G2int_index_of_gsi_sensor_to_deregisterqm = FIX((SI_Long)-1L);
    Qg2int_get_icp_socket_from_context = 
	    STATIC_SYMBOL("GET-ICP-SOCKET-FROM-CONTEXT",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_get_icp_socket_from_context,
	    STATIC_FUNCTION(g2int_get_icp_socket_from_context,NIL,FALSE,2,2));
    G2int_gsi_io_unblocked = FIX((SI_Long)1L);
    G2int_gsi_io_blocked = FIX((SI_Long)0L);
    Qg2int_gsi_connection_loss_notifier = 
	    STATIC_SYMBOL("GSI-CONNECTION-LOSS-NOTIFIER",AB_package);
    Qg2int_gsi_read_state_change = STATIC_SYMBOL("GSI-READ-STATE-CHANGE",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_gsi_read_state_change,
	    STATIC_FUNCTION(g2int_gsi_read_state_change,NIL,FALSE,2,2));
    Qg2int_gsi_write_state_change = STATIC_SYMBOL("GSI-WRITE-STATE-CHANGE",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_gsi_write_state_change,
	    STATIC_FUNCTION(g2int_gsi_write_state_change,NIL,FALSE,2,2));
    string_constant_48 = STATIC_STRING("Connection closed - context ~a~%");
    Qg2int_gsi_internals = STATIC_SYMBOL("GSI_INTERNALS",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_gsi_connection_loss_notifier,
	    STATIC_FUNCTION(g2int_gsi_connection_loss_notifier,NIL,FALSE,2,2));
    Qg2int_run_gsi = STATIC_SYMBOL("RUN-GSI",AB_package);
    Qg2int_run_gsi_process_top_level = 
	    STATIC_SYMBOL("RUN-GSI-PROCESS-TOP-LEVEL",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_run_gsi_process_top_level,
	    STATIC_FUNCTION(g2int_run_gsi_process_top_level,NIL,FALSE,1,1));
    Qg2int_system_top_level_function = 
	    STATIC_SYMBOL("SYSTEM-TOP-LEVEL-FUNCTION",AB_package);
    g2int_mutate_global_property(Qg2int_gsi,
	    Qg2int_run_gsi_process_top_level,Qg2int_system_top_level_function);
    Qg2int_system_run_function = STATIC_SYMBOL("SYSTEM-RUN-FUNCTION",
	    AB_package);
    g2int_mutate_global_property(Qg2int_gsi,Qg2int_run_gsi,
	    Qg2int_system_run_function);
    Qg2int_launch_functionqm = STATIC_SYMBOL("LAUNCH-FUNCTION\?",AB_package);
    Qlaunch_gsi = STATIC_SYMBOL("LAUNCH-GSI",AB_package);
    SET_SYMBOL_FUNCTION(Qlaunch_gsi,STATIC_FUNCTION(launch_gsi,NIL,FALSE,0,0));
    set_get(Qg2int_gsi,Qg2int_launch_functionqm,Qlaunch_gsi);
    string_constant_353 = STATIC_STRING("Gensym");
    Qg2int_system_window_title_string = 
	    STATIC_SYMBOL("SYSTEM-WINDOW-TITLE-STRING",AB_package);
    g2int_mutate_global_property(Qg2int_gsi,string_constant_353,
	    Qg2int_system_window_title_string);
    Qg2int_system_icon_title_string = 
	    STATIC_SYMBOL("SYSTEM-ICON-TITLE-STRING",AB_package);
    g2int_mutate_global_property(Qg2int_gsi,string_constant_353,
	    Qg2int_system_icon_title_string);
    Qg2int_gsi_error_handler = STATIC_SYMBOL("GSI-ERROR-HANDLER",AB_package);
    string_constant_49 = STATIC_STRING("from");
    string_constant_50 = STATIC_STRING("to");
    if (G2int_default_gsi_extension_tcp_address == UNBOUND)
	G2int_default_gsi_extension_tcp_address = FIX((SI_Long)22041L);
    if (G2int_gsi_extension_tcp_addressqm == UNBOUND)
	G2int_gsi_extension_tcp_addressqm = Nil;
    if (G2int_gsi_is_not_initialized == UNBOUND)
	G2int_gsi_is_not_initialized = T;
    Qg2int_vector_element = STATIC_SYMBOL("VECTOR-ELEMENT",AB_package);
    Qg2int_list_element = STATIC_SYMBOL("LIST-ELEMENT",AB_package);
    Qg2int_name = STATIC_SYMBOL("NAME",AB_package);
    Qg2int_current_value = STATIC_SYMBOL("CURRENT-VALUE",AB_package);
    if (G2int_enable_run_gsi == UNBOUND)
	G2int_enable_run_gsi = Nil;
    Qg2int_top_level_error_catcher = 
	    STATIC_SYMBOL("TOP-LEVEL-ERROR-CATCHER",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_run_gsi,STATIC_FUNCTION(g2int_run_gsi,NIL,
	    FALSE,1,1));
    Qg2int_gsi_start = STATIC_SYMBOL("gsi_start",AB_package);
    string_constant_51 = STATIC_STRING("gsi_start");
    array_constant_1 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_1,(SI_Long)0L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_1,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_1,(SI_Long)2L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_1,(SI_Long)3L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_1,(SI_Long)4L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_1,(SI_Long)6L,(SI_Long)5L);
    UBYTE_16_ISASET_1(array_constant_1,(SI_Long)7L,(SI_Long)57344L);
    Qab_g2int_derive_network_listeners = 
	    STATIC_SYMBOL("DERIVE_NETWORK_LISTENERS",AB_package);
    array_constant_23 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)1L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)2L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)3L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)4L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)5L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)6L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)7L,(SI_Long)120L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)8L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)9L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)10L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)14L,(SI_Long)11L);
    UBYTE_16_ISASET_1(array_constant_23,(SI_Long)15L,(SI_Long)57344L);
    array_constant_3 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)1L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)2L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)3L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)4L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)5L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)6L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)7L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)8L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)9L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)10L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)14L,(SI_Long)11L);
    UBYTE_16_ISASET_1(array_constant_3,(SI_Long)15L,(SI_Long)57344L);
    array_constant_4 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)1L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)2L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)3L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)4L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)5L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)6L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)7L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)8L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)9L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)14L,(SI_Long)10L);
    UBYTE_16_ISASET_1(array_constant_4,(SI_Long)15L,(SI_Long)57344L);
    array_constant_5 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)2L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)3L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)4L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)5L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)6L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)7L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)14L,(SI_Long)8L);
    UBYTE_16_ISASET_1(array_constant_5,(SI_Long)15L,(SI_Long)57344L);
    array_constant_24 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_24,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_24,(SI_Long)1L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_24,(SI_Long)2L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_24,(SI_Long)3L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_24,(SI_Long)4L,(SI_Long)117L);
    UBYTE_16_ISASET_1(array_constant_24,(SI_Long)5L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_24,(SI_Long)6L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_24,(SI_Long)14L,(SI_Long)7L);
    UBYTE_16_ISASET_1(array_constant_24,(SI_Long)15L,(SI_Long)57344L);
    list_constant_113 = STATIC_LIST((SI_Long)5L,array_constant_23,
	    array_constant_3,array_constant_4,array_constant_5,
	    array_constant_24);
    G2int_gsi_flag_arguments = list_constant_113;
    array_constant_2 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)1L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)2L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)3L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)4L,(SI_Long)119L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)5L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)6L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)7L,(SI_Long)107L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)14L,(SI_Long)8L);
    UBYTE_16_ISASET_1(array_constant_2,(SI_Long)15L,(SI_Long)57344L);
    array_constant_25 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_25,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_25,(SI_Long)1L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_25,(SI_Long)2L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_25,(SI_Long)3L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_25,(SI_Long)4L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_25,(SI_Long)5L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_25,(SI_Long)6L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_25,(SI_Long)7L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_25,(SI_Long)14L,(SI_Long)8L);
    UBYTE_16_ISASET_1(array_constant_25,(SI_Long)15L,(SI_Long)57344L);
    array_constant_26 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_26,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_26,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_26,(SI_Long)2L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_26,(SI_Long)3L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_26,(SI_Long)4L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_26,(SI_Long)6L,(SI_Long)5L);
    UBYTE_16_ISASET_1(array_constant_26,(SI_Long)7L,(SI_Long)57344L);
    array_constant_6 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)32L));
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)2L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)3L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)4L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)5L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)6L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)7L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)8L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)9L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)10L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)11L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)12L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)13L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)14L,(SI_Long)102L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)15L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)16L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)17L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)18L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)19L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)20L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)21L,(SI_Long)109L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)22L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)30L,(SI_Long)23L);
    UBYTE_16_ISASET_1(array_constant_6,(SI_Long)31L,(SI_Long)57344L);
    array_constant_7 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)24L));
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)2L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)3L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)4L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)5L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)6L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)7L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)8L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)9L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)10L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)11L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)12L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)13L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)14L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)15L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)16L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)17L,(SI_Long)109L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)18L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)22L,(SI_Long)19L);
    UBYTE_16_ISASET_1(array_constant_7,(SI_Long)23L,(SI_Long)57344L);
    array_constant_8 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)24L));
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)2L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)3L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)4L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)5L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)6L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)7L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)8L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)9L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)10L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)11L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)12L,(SI_Long)119L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)13L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)14L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)15L,(SI_Long)107L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)22L,(SI_Long)16L);
    UBYTE_16_ISASET_1(array_constant_8,(SI_Long)23L,(SI_Long)57344L);
    array_constant_9 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)2L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)3L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)4L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)5L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)6L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)7L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)8L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)9L,(SI_Long)104L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)10L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)11L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)12L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)14L,(SI_Long)13L);
    UBYTE_16_ISASET_1(array_constant_9,(SI_Long)15L,(SI_Long)57344L);
    array_constant_10 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)2L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)3L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)4L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)5L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)6L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)7L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)8L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)9L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)10L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)11L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)12L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)14L,(SI_Long)13L);
    UBYTE_16_ISASET_1(array_constant_10,(SI_Long)15L,(SI_Long)57344L);
    array_constant_11 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)40L));
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)0L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)2L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)3L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)4L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)5L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)6L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)7L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)8L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)9L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)10L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)11L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)12L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)13L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)14L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)15L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)16L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)17L,(SI_Long)122L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)18L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)19L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)20L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)21L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)22L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)23L,(SI_Long)45L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)24L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)25L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)26L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)27L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)28L,(SI_Long)110L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)29L,(SI_Long)103L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)38L,(SI_Long)30L);
    UBYTE_16_ISASET_1(array_constant_11,(SI_Long)39L,(SI_Long)57344L);
    list_constant_114 = STATIC_LIST((SI_Long)9L,array_constant_2,
	    array_constant_25,array_constant_26,array_constant_6,
	    array_constant_7,array_constant_8,array_constant_9,
	    array_constant_10,array_constant_11);
    G2int_gsi_keyword_arguments = list_constant_114;
    Qg2int_string_equalw = STATIC_SYMBOL("STRING-EQUALW",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_string_equalw,
	    STATIC_FUNCTION(g2int_string_equalw,NIL,FALSE,2,2));
    if (G2int_gsi_command_line_network == UNBOUND)
	G2int_gsi_command_line_network = Nil;
    if (G2int_gsi_command_line_host == UNBOUND)
	G2int_gsi_command_line_host = Nil;
    if (G2int_gsi_command_line_port == UNBOUND)
	G2int_gsi_command_line_port = Nil;
    array_constant_12 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_12,(SI_Long)7L,(SI_Long)57344L);
    array_constant_13 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)0L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)1L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)2L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)3L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)4L,(SI_Long)108L);
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)5L,(SI_Long)104L);
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)6L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)7L,(SI_Long)115L);
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)8L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)14L,(SI_Long)9L);
    UBYTE_16_ISASET_1(array_constant_13,(SI_Long)15L,(SI_Long)57344L);
    array_constant_14 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_14,(SI_Long)0L,(SI_Long)84L);
    UBYTE_16_ISASET_1(array_constant_14,(SI_Long)6L,(SI_Long)1L);
    UBYTE_16_ISASET_1(array_constant_14,(SI_Long)7L,(SI_Long)57344L);
    Qg2int_tcp_ip = STATIC_SYMBOL("TCP-IP",AB_package);
    string_constant_52 = STATIC_STRING("~%Unknown network type ~A~%");
    array_constant_15 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_15,(SI_Long)0L,(SI_Long)49L);
    UBYTE_16_ISASET_1(array_constant_15,(SI_Long)1L,(SI_Long)49L);
    UBYTE_16_ISASET_1(array_constant_15,(SI_Long)2L,(SI_Long)49L);
    UBYTE_16_ISASET_1(array_constant_15,(SI_Long)3L,(SI_Long)49L);
    UBYTE_16_ISASET_1(array_constant_15,(SI_Long)6L,(SI_Long)4L);
    UBYTE_16_ISASET_1(array_constant_15,(SI_Long)7L,(SI_Long)57344L);
    array_constant_16 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_16,(SI_Long)0L,(SI_Long)71L);
    UBYTE_16_ISASET_1(array_constant_16,(SI_Long)1L,(SI_Long)50L);
    UBYTE_16_ISASET_1(array_constant_16,(SI_Long)2L,(SI_Long)48L);
    UBYTE_16_ISASET_1(array_constant_16,(SI_Long)6L,(SI_Long)3L);
    UBYTE_16_ISASET_1(array_constant_16,(SI_Long)7L,(SI_Long)57344L);
    Qg2int_get_preset_tcp_port = STATIC_SYMBOL("GET_PRESET_TCP_PORT",
	    AB_package);
    array_constant_17 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_17,(SI_Long)0L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_17,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_17,(SI_Long)2L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_17,(SI_Long)3L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_17,(SI_Long)4L,(SI_Long)111L);
    UBYTE_16_ISASET_1(array_constant_17,(SI_Long)5L,(SI_Long)114L);
    UBYTE_16_ISASET_1(array_constant_17,(SI_Long)6L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_17,(SI_Long)14L,(SI_Long)7L);
    UBYTE_16_ISASET_1(array_constant_17,(SI_Long)15L,(SI_Long)57344L);
    Qg2int_do_not_use = STATIC_SYMBOL("DO-NOT-USE",AB_package);
    string_constant_53 = STATIC_STRING("Waiting to accept a connection on:~%");
    string_constant_54 = STATIC_STRING("~a:~a:~a~a~%");
    Ksecure_p = STATIC_SYMBOL("SECURE-P",Pkeyword);
    array_constant_18 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)0L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)1L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)2L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)3L,(SI_Long)105L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)4L,(SI_Long)112L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)5L,(SI_Long)101L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)6L,(SI_Long)120L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)7L,(SI_Long)97L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)8L,(SI_Long)99L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)9L,(SI_Long)116L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)14L,(SI_Long)10L);
    UBYTE_16_ISASET_1(array_constant_18,(SI_Long)15L,(SI_Long)57344L);
    Qg2int_register_gsi_connection_callbacks = 
	    STATIC_SYMBOL("REGISTER-GSI-CONNECTION-CALLBACKS",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_register_gsi_connection_callbacks,
	    STATIC_FUNCTION(g2int_register_gsi_connection_callbacks,NIL,
	    FALSE,2,2));
    Qg2int_gsi_establish_listener = STATIC_SYMBOL("gsi_establish_listener",
	    AB_package);
    string_constant_55 = STATIC_STRING("gsi_establish_listener");
    Qg2int_gsi_establish_secure_listener = 
	    STATIC_SYMBOL("gsi_establish_secure_listener",AB_package);
    string_constant_56 = STATIC_STRING("gsi_establish_secure_listener");
    string_constant_57 = STATIC_STRING("gsi_close_listeners");
    Qg2int_gsi_icp_sockets_waiting_for_connect = 
	    STATIC_SYMBOL("GSI-ICP-SOCKETS-WAITING-FOR-CONNECT",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qg2int_gsi_icp_sockets_waiting_for_connect,
	    G2int_gsi_icp_sockets_waiting_for_connect);
    Qg2int_int2 = STATIC_SYMBOL("INT2",AB_package);
    g2int_record_system_variable(Qg2int_gsi_icp_sockets_waiting_for_connect,
	    Qg2int_int2,Nil,Qnil,Qnil,Qnil,Qnil);
    array_constant_19 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)8L));
    UBYTE_16_ISASET_1(array_constant_19,(SI_Long)0L,(SI_Long)76L);
    UBYTE_16_ISASET_1(array_constant_19,(SI_Long)1L,(SI_Long)79L);
    UBYTE_16_ISASET_1(array_constant_19,(SI_Long)2L,(SI_Long)67L);
    UBYTE_16_ISASET_1(array_constant_19,(SI_Long)3L,(SI_Long)65L);
    UBYTE_16_ISASET_1(array_constant_19,(SI_Long)4L,(SI_Long)76L);
    UBYTE_16_ISASET_1(array_constant_19,(SI_Long)6L,(SI_Long)5L);
    UBYTE_16_ISASET_1(array_constant_19,(SI_Long)7L,(SI_Long)57344L);
    Qg2int_g2 = STATIC_SYMBOL("G2",AB_package);
    Qg2int_gsi_maybe_notice_delayed_connection_failure = 
	    STATIC_SYMBOL("GSI-MAYBE-NOTICE-DELAYED-CONNECTION-FAILURE",
	    AB_package);
    Qg2int_requested = STATIC_SYMBOL("REQUESTED",AB_package);
    Qg2int_gsi_maybe_initiate_delayed_connection = 
	    STATIC_SYMBOL("GSI-MAYBE-INITIATE-DELAYED-CONNECTION",AB_package);
    string_constant_58 = STATIC_STRING("~%Connected to: ~A~A~%");
    array_constant_20 = STATIC_ARRAY(list_constant_100,(SI_Long)1L,
	    FIX((SI_Long)16L));
    UBYTE_16_ISASET_1(array_constant_20,(SI_Long)0L,(SI_Long)84L);
    UBYTE_16_ISASET_1(array_constant_20,(SI_Long)1L,(SI_Long)67L);
    UBYTE_16_ISASET_1(array_constant_20,(SI_Long)2L,(SI_Long)80L);
    UBYTE_16_ISASET_1(array_constant_20,(SI_Long)3L,(SI_Long)95L);
    UBYTE_16_ISASET_1(array_constant_20,(SI_Long)4L,(SI_Long)73L);
    UBYTE_16_ISASET_1(array_constant_20,(SI_Long)5L,(SI_Long)80L);
    UBYTE_16_ISASET_1(array_constant_20,(SI_Long)14L,(SI_Long)6L);
    UBYTE_16_ISASET_1(array_constant_20,(SI_Long)15L,(SI_Long)57344L);
    SET_SYMBOL_FUNCTION(Qg2int_gsi_maybe_initiate_delayed_connection,
	    STATIC_FUNCTION(g2int_gsi_maybe_initiate_delayed_connection,
	    NIL,FALSE,1,1));
    Qab_g2int_gsi_initiate_connection = 
	    STATIC_SYMBOL("gsi_initiate_connection",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_gsi_maybe_notice_delayed_connection_failure,
	    STATIC_FUNCTION(g2int_gsi_maybe_notice_delayed_connection_failure,
	    NIL,FALSE,1,1));
    Qg2int_gsi_wakeup_icp_socket = STATIC_SYMBOL("GSI-WAKEUP-ICP-SOCKET",
	    AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qg2int_gsi_wakeup_icp_socket,
	    G2int_gsi_wakeup_icp_socket);
    g2int_record_system_variable(Qg2int_gsi_wakeup_icp_socket,Qg2int_int2,
	    Nil,Qnil,Qnil,Qnil,Qnil);
    Qg2int_gsi_wakeup_icp_socket_active_p = 
	    STATIC_SYMBOL("GSI-WAKEUP-ICP-SOCKET-ACTIVE-P",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qg2int_gsi_wakeup_icp_socket_active_p,
	    G2int_gsi_wakeup_icp_socket_active_p);
    g2int_record_system_variable(Qg2int_gsi_wakeup_icp_socket_active_p,
	    Qg2int_int2,Nil,Qnil,Qnil,Qnil,Qnil);
    Qg2int_gsi_wakeup_maybe_notice_delayed_connection_failure = 
	    STATIC_SYMBOL("GSI-WAKEUP-MAYBE-NOTICE-DELAYED-CONNECTION-FAILURE",
	    AB_package);
    Qg2int_gsi_wakeup_maybe_initiate_delayed_connection = 
	    STATIC_SYMBOL("GSI-WAKEUP-MAYBE-INITIATE-DELAYED-CONNECTION",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_gsi_wakeup_maybe_initiate_delayed_connection,
	    STATIC_FUNCTION(g2int_gsi_wakeup_maybe_initiate_delayed_connection,
	    NIL,FALSE,1,1));
    SET_SYMBOL_FUNCTION(Qg2int_gsi_wakeup_maybe_notice_delayed_connection_failure,
	    STATIC_FUNCTION(g2int_gsi_wakeup_maybe_notice_delayed_connection_failure,
	    NIL,FALSE,1,1));
    Qg2int_gsi_set_context_limit = STATIC_SYMBOL("gsi_set_context_limit",
	    AB_package);
    string_constant_59 = STATIC_STRING("gsi_set_context_limit");
    string_constant_60 = STATIC_STRING("gsi_set_local_home");
    Qg2int_gsi_flush = STATIC_SYMBOL("gsi_flush",AB_package);
    string_constant_61 = STATIC_STRING("gsi_flush");
    Qg2int_gsi_kill_context = STATIC_SYMBOL("gsi_kill_context",AB_package);
    string_constant_62 = STATIC_STRING("gsi_kill_context");
    Qg2int_gsi_context_received_data = 
	    STATIC_SYMBOL("gsi_context_received_data",AB_package);
    string_constant_63 = STATIC_STRING("gsi_context_received_data");
    string_constant_64 = STATIC_STRING("gsi_listener_socket");
    Qg2int_gsi_context_socket = STATIC_SYMBOL("gsi_context_socket",AB_package);
    string_constant_65 = STATIC_STRING("gsi_context_socket");
    Qg2int_gsi_context_remote_start_time = 
	    STATIC_SYMBOL("gsi_context_remote_start_time",AB_package);
    string_constant_66 = STATIC_STRING("gsi_context_remote_start_time");
    Qg2int_gsi_context_remote_host = 
	    STATIC_SYMBOL("gsi_context_remote_host",AB_package);
    string_constant_67 = STATIC_STRING("gsi_context_remote_host");
    Qg2int_gsi_context_remote_port = 
	    STATIC_SYMBOL("gsi_context_remote_port",AB_package);
    string_constant_68 = STATIC_STRING("gsi_context_remote_port");
    Qg2int_gsi_context_remote_home = 
	    STATIC_SYMBOL("gsi_context_remote_home",AB_package);
    string_constant_69 = STATIC_STRING("gsi_context_remote_home");
    Qg2int_gsi_context_user_data = STATIC_SYMBOL("gsi_context_user_data",
	    AB_package);
    string_constant_70 = STATIC_STRING("gsi_context_user_data");
    Qg2int_gsi_set_context_user_data = 
	    STATIC_SYMBOL("gsi_set_context_user_data",AB_package);
    string_constant_71 = STATIC_STRING("gsi_set_context_user_data");
    string_constant_72 = STATIC_STRING("gsi_initiate_connection");
    Qg2int_gsi_initiate_connection_w_u_d = 
	    STATIC_SYMBOL("gsi_initiate_connection_w_u_d",AB_package);
    string_constant_73 = STATIC_STRING("gsi_initiate_connection_w_u_d");
    Qg2int_gsi_initiate_secure_connection = 
	    STATIC_SYMBOL("gsi_initiate_secure_connection",AB_package);
    Qg2int_secure = STATIC_SYMBOL("SECURE",AB_package);
    string_constant_74 = STATIC_STRING("gsi_initiate_secure_connection");
    Qg2int_gsi_initiate_secure_conn_w_u_d = 
	    STATIC_SYMBOL("gsi_initiate_secure_conn_w_u_d",AB_package);
    string_constant_75 = STATIC_STRING("gsi_initiate_secure_conn_w_u_d");
    string_constant_76 = STATIC_STRING("gsi_wakeup");
    string_constant_77 = STATIC_STRING("gsi_last_error");
    string_constant_78 = STATIC_STRING("");
    string_constant_79 = STATIC_STRING("gsi_last_error_message");
    string_constant_80 = STATIC_STRING("gsi_last_error_call_handle");
    string_constant_81 = STATIC_STRING("gsi_clear_last_error");
    Qg2int_gsi_error_message = STATIC_SYMBOL("gsi_error_message",AB_package);
    string_constant_82 = STATIC_STRING("gsi_error_message");
    Qg2int_gsi_signal_error = STATIC_SYMBOL("gsi_signal_error",AB_package);
    Qab_g2int_gsi_signal_error = STATIC_SYMBOL("GSI_SIGNAL_ERROR",AB_package);
    string_constant_83 = STATIC_STRING("gsi_signal_error");
    string_constant_84 = STATIC_STRING("gsi_wait");
    string_constant_85 = STATIC_STRING("gsi_is_idle");
    Qg2int_localnet = STATIC_SYMBOL("LOCALNET",AB_package);
    string_constant_86 = STATIC_STRING("gsi_has_network_connections");
    Qg2int_gsi_set_pause_timeout = STATIC_SYMBOL("gsi_set_pause_timeout",
	    AB_package);
    string_constant_87 = STATIC_STRING("gsi_set_pause_timeout");
    string_constant_88 = STATIC_STRING("gsi_pause");
    Qg2int_gsi_set_run_loop_timeout = 
	    STATIC_SYMBOL("gsi_set_run_loop_timeout",AB_package);
    string_constant_89 = STATIC_STRING("gsi_set_run_loop_timeout");
    Qg2int_gsi_run_loop = STATIC_SYMBOL("gsi_run_loop",AB_package);
    string_constant_90 = STATIC_STRING("gsi_run_loop");
    Qg2int_outer_loop = STATIC_SYMBOL("OUTER-LOOP",AB_package);
    Qg2int_handle_icp_messages = STATIC_SYMBOL("HANDLE-ICP-MESSAGES",
	    AB_package);
    Qg2int_abort_level_0 = STATIC_SYMBOL("ABORT-LEVEL-0",AB_package);
    Qg2int_gsi_return_message = STATIC_SYMBOL("gsi_return_message",AB_package);
    string_constant_91 = STATIC_STRING("gsi_return_message");
    Qg2int_write_icp_gsi_value_vector = 
	    STATIC_SYMBOL("WRITE-ICP-GSI-VALUE-VECTOR",AB_package);
    string_constant_92 = 
	    STATIC_STRING("resumable icp synch error: ~S expected, ~S found");
    Qg2int_true = STATIC_SYMBOL("TRUE",AB_package);
    Qg2int_false = STATIC_SYMBOL("FALSE",AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_write_icp_gsi_value_vector,
	    STATIC_FUNCTION(g2int_write_icp_gsi_value_vector,NIL,FALSE,1,1));
    Qg2int_gsi_reference_flag = STATIC_SYMBOL("GSI-REFERENCE-FLAG",AB_package);
    Qg2int_item_index_space = STATIC_SYMBOL("ITEM-INDEX-SPACE",AB_package);
    if (G2int_send_timestamp_with_gsi_sensor_p == UNBOUND)
	G2int_send_timestamp_with_gsi_sensor_p = Nil;
    Qg2int_send_icp_receive_values_for_gsi_sensors_with_timestamp = 
	    STATIC_SYMBOL("SEND-ICP-RECEIVE-VALUES-FOR-GSI-SENSORS-WITH-TIMESTAMP",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_send_icp_receive_values_for_gsi_sensors_with_timestamp,
	    STATIC_FUNCTION(g2int_send_icp_receive_values_for_gsi_sensors_with_timestamp,
	    NIL,FALSE,1,1));
    Qg2int_send_icp_receive_values_for_gsi_sensors_without_timestamp = 
	    STATIC_SYMBOL("SEND-ICP-RECEIVE-VALUES-FOR-GSI-SENSORS-WITHOUT-TIMESTAMP",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_send_icp_receive_values_for_gsi_sensors_without_timestamp,
	    STATIC_FUNCTION(g2int_send_icp_receive_values_for_gsi_sensors_without_timestamp,
	    NIL,FALSE,1,1));
    Qg2int_write_icp_gsi_values = STATIC_SYMBOL("WRITE-ICP-GSI-VALUES",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_write_icp_gsi_values,
	    STATIC_FUNCTION(g2int_write_icp_gsi_values,NIL,FALSE,1,1));
    Qg2int_send_icp_receive_timestamped_gsi_sensor_value_vector = 
	    STATIC_SYMBOL("SEND-ICP-RECEIVE-TIMESTAMPED-GSI-SENSOR-VALUE-VECTOR",
	    AB_package);
    Qg2int_send_icp_receive_gsi_sensor_value_vector = 
	    STATIC_SYMBOL("SEND-ICP-RECEIVE-GSI-SENSOR-VALUE-VECTOR",
	    AB_package);
    Qg2int_gsi_return_values = STATIC_SYMBOL("gsi_return_values",AB_package);
    string_constant_93 = STATIC_STRING("gsi_return_values");
    Qg2int_gsi_return_timed_values = 
	    STATIC_SYMBOL("gsi_return_timed_values",AB_package);
    string_constant_94 = STATIC_STRING("gsi_return_timed_values");
    Qg2int_gsi_return_attrs = STATIC_SYMBOL("gsi_return_attrs",AB_package);
    string_constant_95 = STATIC_STRING("gsi_return_attrs");
    Qg2int_gsi_return_timed_attrs = STATIC_SYMBOL("gsi_return_timed_attrs",
	    AB_package);
    string_constant_96 = STATIC_STRING("gsi_return_timed_attrs");
    Qg2int_gsi_make_array = STATIC_SYMBOL("gsi_make_array",AB_package);
    string_constant_97 = STATIC_STRING("gsi_make_array");
    Qg2int_gsi_reclaim_array = STATIC_SYMBOL("gsi_reclaim_array",AB_package);
    string_constant_98 = STATIC_STRING("gsi_reclaim_array");
    string_constant_99 = STATIC_STRING("gsi_make_item");
    string_constant_100 = STATIC_STRING("gsi_reclaim_item");
    Qg2int_gsi_make_items = STATIC_SYMBOL("gsi_make_items",AB_package);
    string_constant_101 = STATIC_STRING("gsi_make_items");
    Qg2int_gsi_reclaim_items = STATIC_SYMBOL("gsi_reclaim_items",AB_package);
    string_constant_102 = STATIC_STRING("gsi_reclaim_items");
    Qg2int_gsi_make_registered_items = 
	    STATIC_SYMBOL("gsi_make_registered_items",AB_package);
    string_constant_103 = STATIC_STRING("gsi_make_registered_items");
    Qg2int_gsi_reclaim_registered_items = 
	    STATIC_SYMBOL("gsi_reclaim_registered_items",AB_package);
    string_constant_104 = STATIC_STRING("gsi_reclaim_registered_items");
    Qg2int_gsi_make_attrs = STATIC_SYMBOL("gsi_make_attrs",AB_package);
    string_constant_105 = STATIC_STRING("gsi_make_attrs");
    Qg2int_gsi_reclaim_attrs = STATIC_SYMBOL("gsi_reclaim_attrs",AB_package);
    string_constant_106 = STATIC_STRING("gsi_reclaim_attrs");
    Qg2int_gsi_make_attrs_with_items = 
	    STATIC_SYMBOL("gsi_make_attrs_with_items",AB_package);
    string_constant_107 = STATIC_STRING("gsi_make_attrs_with_items");
    Qg2int_gsi_reclaim_attrs_with_items = 
	    STATIC_SYMBOL("gsi_reclaim_attrs_with_items",AB_package);
    string_constant_108 = STATIC_STRING("gsi_reclaim_attrs_with_items");
    string_constant_109 = STATIC_STRING("gsi_make_symbol");
    Qg2int_gsi_symbol_name = STATIC_SYMBOL("gsi_symbol_name",AB_package);
    string_constant_110 = STATIC_STRING("gsi_symbol_name");
    Qg2int_gsi_symbol_user_data = STATIC_SYMBOL("gsi_symbol_user_data",
	    AB_package);
    Qg2int_gsi_user_data_of_symbol = 
	    STATIC_SYMBOL("GSI-USER-DATA-OF-SYMBOL",AB_package);
    string_constant_111 = STATIC_STRING("gsi_symbol_user_data");
    Qg2int_gsi_set_symbol_user_data = 
	    STATIC_SYMBOL("gsi_set_symbol_user_data",AB_package);
    string_constant_112 = STATIC_STRING("gsi_set_symbol_user_data");
    string_constant_113 = STATIC_STRING("gsi_current_context");
    string_constant_114 = STATIC_STRING("gsi_current_context_is_secure");
    Qg2int_gsi_context_is_secure = STATIC_SYMBOL("gsi_context_is_secure",
	    AB_package);
    string_constant_115 = STATIC_STRING("gsi_context_is_secure");
    Qg2int_gsi_registration_of_handle = 
	    STATIC_SYMBOL("gsi_registration_of_handle",AB_package);
    string_constant_116 = STATIC_STRING("gsi_registration_of_handle");
    Qg2int_gsi_user_data_of = STATIC_SYMBOL("gsi_user_data_of",AB_package);
    string_constant_117 = STATIC_STRING("gsi_user_data_of");
    Qg2int_gsi_set_user_data = STATIC_SYMBOL("gsi_set_user_data",AB_package);
    string_constant_118 = STATIC_STRING("gsi_set_user_data");
    Qg2int_gsi_item_of_identifying_attr_of = 
	    STATIC_SYMBOL("gsi_item_of_identifying_attr_of",AB_package);
    string_constant_119 = STATIC_STRING("gsi_item_of_identifying_attr_of");
    Qg2int_gsi_item_of_attr = STATIC_SYMBOL("gsi_item_of_attr",AB_package);
    string_constant_120 = STATIC_STRING("gsi_item_of_attr");
    Qg2int_gsi_set_item_of_attr = STATIC_SYMBOL("gsi_set_item_of_attr",
	    AB_package);
    string_constant_121 = STATIC_STRING("gsi_set_item_of_attr");
    Qg2int_gsi_item_of_registered_item = 
	    STATIC_SYMBOL("gsi_item_of_registered_item",AB_package);
    string_constant_122 = STATIC_STRING("gsi_item_of_registered_item");
    Qg2int_gsi_simple_content_copy = 
	    STATIC_SYMBOL("gsi_simple_content_copy",AB_package);
    string_constant_123 = STATIC_STRING("gsi_simple_content_copy");
    Qg2int_gsi_clear_item = STATIC_SYMBOL("gsi_clear_item",AB_package);
    string_constant_124 = STATIC_STRING("gsi_clear_item");
    Qg2int_gsi_owner_is_user = STATIC_SYMBOL("GSI-OWNER-IS-USER",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_owner_is_user,FIX((SI_Long)0L));
    Qg2int_gsi_owner_is_gsi = STATIC_SYMBOL("GSI-OWNER-IS-GSI",AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_owner_is_gsi,FIX((SI_Long)1L));
    Qg2int_gsi_owner_is_context = STATIC_SYMBOL("GSI-OWNER-IS-CONTEXT",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_gsi_owner_is_context,FIX((SI_Long)2L));
    Qg2int_gsi_owner_of = STATIC_SYMBOL("gsi_owner_of",AB_package);
    string_constant_125 = STATIC_STRING("gsi_owner_of");
    Qg2int_gsi_class_name_of = STATIC_SYMBOL("gsi_class_name_of",AB_package);
    string_constant_126 = STATIC_STRING("gsi_class_name_of");
    Qg2int_gsi_set_class_name = STATIC_SYMBOL("gsi_set_class_name",AB_package);
    string_constant_127 = STATIC_STRING("gsi_set_class_name");
    Qg2int_gsi_name_of = STATIC_SYMBOL("gsi_name_of",AB_package);
    string_constant_128 = STATIC_STRING("gsi_name_of");
    Qg2int_gsi_set_name = STATIC_SYMBOL("gsi_set_name",AB_package);
    string_constant_129 = STATIC_STRING("gsi_set_name");
    Qg2int_gsi_type_of = STATIC_SYMBOL("gsi_type_of",AB_package);
    string_constant_130 = STATIC_STRING("gsi_type_of");
    Qg2int_gsi_item_has_a_value = STATIC_SYMBOL("gsi_item_has_a_value",
	    AB_package);
    string_constant_131 = STATIC_STRING("gsi_item_has_a_value");
    Qg2int_gsi_set_type = STATIC_SYMBOL("gsi_set_type",AB_package);
    string_constant_132 = STATIC_STRING("gsi_set_sym");
    string_constant_133 = STATIC_STRING("gsi_set_type with GSI_NULL_TAG");
    string_constant_134 = STATIC_STRING("gsi_set_handle");
    string_constant_135 = 
	    STATIC_STRING("error in gsi_set_type: use ~A instead");
    string_constant_136 = STATIC_STRING("gsi_set_type");
    Qg2int_gsi_handle_of = STATIC_SYMBOL("gsi_handle_of",AB_package);
    string_constant_137 = STATIC_STRING("gsi_handle_of");
    Qg2int_gsi_set_handle = STATIC_SYMBOL("gsi_set_handle",AB_package);
    string_constant_138 = STATIC_STRING("gsi_registration_of_item");
    Qg2int_gsi_item_append_flag = STATIC_SYMBOL("gsi_item_append_flag",
	    AB_package);
    Qg2int_gsi_append_flag = STATIC_SYMBOL("GSI-APPEND-FLAG",AB_package);
    string_constant_139 = STATIC_STRING("gsi_item_append_flag");
    Qg2int_gsi_set_item_append_flag = 
	    STATIC_SYMBOL("gsi_set_item_append_flag",AB_package);
    string_constant_140 = STATIC_STRING("gsi_set_item_append_flag");
    Qg2int_gsi_item_delete_flag = STATIC_SYMBOL("gsi_item_delete_flag",
	    AB_package);
    Qg2int_gsi_delete_flag = STATIC_SYMBOL("GSI-DELETE-FLAG",AB_package);
    string_constant_141 = STATIC_STRING("gsi_item_delete_flag");
    Qg2int_gsi_set_item_delete_flag = 
	    STATIC_SYMBOL("gsi_set_item_delete_flag",AB_package);
    string_constant_142 = STATIC_STRING("gsi_set_item_delete_flag");
    Qg2int_gsi_update_items_flag = STATIC_SYMBOL("gsi_update_items_flag",
	    AB_package);
    Qg2int_gsi_update_items_in_lists_and_arrays_flag = 
	    STATIC_SYMBOL("GSI-UPDATE-ITEMS-IN-LISTS-AND-ARRAYS-FLAG",
	    AB_package);
    string_constant_143 = STATIC_STRING("gsi_update_items_flag");
    Qg2int_gsi_set_update_items_flag = 
	    STATIC_SYMBOL("gsi_set_update_items_flag",AB_package);
    string_constant_144 = STATIC_STRING("gsi_set_update_items_flag");
    Qg2int_gsi_item_reference_flag = 
	    STATIC_SYMBOL("gsi_item_reference_flag",AB_package);
    string_constant_145 = STATIC_STRING("gsi_item_reference_flag");
    Qg2int_gsi_set_item_reference_flag = 
	    STATIC_SYMBOL("gsi_set_item_reference_flag",AB_package);
    string_constant_146 = STATIC_STRING("gsi_set_item_reference_flag");
    Qg2int_gsi_item_name_is_ident_flag = 
	    STATIC_SYMBOL("gsi_item_name_is_ident_flag",AB_package);
    Qg2int_gsi_name_is_identifying_flag = 
	    STATIC_SYMBOL("GSI-NAME-IS-IDENTIFYING-FLAG",AB_package);
    string_constant_147 = STATIC_STRING("gsi_item_name_is_ident_flag");
    Qg2int_gsi_set_item_name_is_ident_flag = 
	    STATIC_SYMBOL("gsi_set_item_name_is_ident_flag",AB_package);
    string_constant_148 = STATIC_STRING("gsi_set_item_name_is_ident_flag");
    Qg2int_gsi_item_class_is_ident_flag = 
	    STATIC_SYMBOL("gsi_item_class_is_ident_flag",AB_package);
    Qg2int_gsi_class_is_identifying_flag = 
	    STATIC_SYMBOL("GSI-CLASS-IS-IDENTIFYING-FLAG",AB_package);
    string_constant_149 = STATIC_STRING("gsi_item_class_is_ident_flag");
    Qg2int_gsi_set_item_class_is_iden_flag = 
	    STATIC_SYMBOL("gsi_set_item_class_is_iden_flag",AB_package);
    string_constant_150 = STATIC_STRING("gsi_set_item_class_is_iden_flag");
    Qg2int_gsi_int_of = STATIC_SYMBOL("gsi_int_of",AB_package);
    string_constant_151 = STATIC_STRING("gsi_int_of");
    Qg2int_gsi_set_int = STATIC_SYMBOL("gsi_set_int",AB_package);
    string_constant_152 = STATIC_STRING("gsi_set_int");
    Qg2int_gsi_i64_of = STATIC_SYMBOL("gsi_i64_of",AB_package);
    string_constant_153 = STATIC_STRING("gsi_i64_of");
    Qg2int_gsi_set_i64 = STATIC_SYMBOL("gsi_set_i64",AB_package);
    string_constant_154 = STATIC_STRING("gsi_set_i64");
    Qg2int_gsi_flt_of = STATIC_SYMBOL("gsi_flt_of",AB_package);
    string_constant_155 = STATIC_STRING("gsi_flt_of");
    Qg2int_gsi_set_flt = STATIC_SYMBOL("gsi_set_flt",AB_package);
    string_constant_156 = STATIC_STRING("gsi_set_flt");
    Qg2int_gsi_log_of = STATIC_SYMBOL("gsi_log_of",AB_package);
    string_constant_157 = STATIC_STRING("gsi_log_of");
    Qg2int_gsi_set_log = STATIC_SYMBOL("gsi_set_log",AB_package);
    string_constant_158 = STATIC_STRING("gsi_set_log");
    Qg2int_gsi_str_of = STATIC_SYMBOL("gsi_str_of",AB_package);
    string_constant_159 = STATIC_STRING("gsi_str_of");
    Qg2int_gsi_set_str = STATIC_SYMBOL("gsi_set_str",AB_package);
    string_constant_160 = STATIC_STRING("gsi_set_str");
    Qg2int_gsi_usv_of = STATIC_SYMBOL("gsi_usv_of",AB_package);
    string_constant_161 = STATIC_STRING("gsi_usv_of");
    Qg2int_gsi_set_usv = STATIC_SYMBOL("gsi_set_usv",AB_package);
    string_constant_162 = STATIC_STRING("gsi_set_usv");
    Qg2int_gsi_sym_of = STATIC_SYMBOL("gsi_sym_of",AB_package);
    string_constant_163 = STATIC_STRING("gsi_sym_of");
    Qg2int_gsi_set_sym = STATIC_SYMBOL("gsi_set_sym",AB_package);
    Qg2int_gsi_element_count_of = STATIC_SYMBOL("gsi_element_count_of",
	    AB_package);
    string_constant_164 = STATIC_STRING("gsi_element_count_of");
    Qg2int_gsi_set_element_count = STATIC_SYMBOL("gsi_set_element_count",
	    AB_package);
    string_constant_165 = STATIC_STRING("gsi_set_element_count");
    Qg2int_gsi_int_array_of = STATIC_SYMBOL("gsi_int_array_of",AB_package);
    string_constant_166 = STATIC_STRING("gsi_int_array_of");
    Qg2int_gsi_int_list_of = STATIC_SYMBOL("gsi_int_list_of",AB_package);
    string_constant_167 = STATIC_STRING("gsi_int_list_of");
    Qg2int_gsi_set_int_array = STATIC_SYMBOL("gsi_set_int_array",AB_package);
    string_constant_168 = STATIC_STRING("gsi_set_int_array");
    Qg2int_gsi_set_int_list = STATIC_SYMBOL("gsi_set_int_list",AB_package);
    string_constant_169 = STATIC_STRING("gsi_set_int_list");
    Qg2int_gsi_flt_array_of = STATIC_SYMBOL("gsi_flt_array_of",AB_package);
    string_constant_170 = STATIC_STRING("gsi_flt_array_of");
    Qg2int_gsi_flt_list_of = STATIC_SYMBOL("gsi_flt_list_of",AB_package);
    string_constant_171 = STATIC_STRING("gsi_flt_list_of");
    Qg2int_gsi_set_flt_array = STATIC_SYMBOL("gsi_set_flt_array",AB_package);
    string_constant_172 = STATIC_STRING("gsi_set_flt_array");
    Qg2int_gsi_set_flt_list = STATIC_SYMBOL("gsi_set_flt_list",AB_package);
    string_constant_173 = STATIC_STRING("gsi_set_flt_list");
    Qg2int_gsi_log_array_of = STATIC_SYMBOL("gsi_log_array_of",AB_package);
    string_constant_174 = STATIC_STRING("gsi_log_array_of");
    Qg2int_gsi_log_list_of = STATIC_SYMBOL("gsi_log_list_of",AB_package);
    string_constant_175 = STATIC_STRING("gsi_log_list_of");
    Qg2int_gsi_set_log_array = STATIC_SYMBOL("gsi_set_log_array",AB_package);
    string_constant_176 = STATIC_STRING("gsi_set_log_array");
    Qg2int_gsi_set_log_list = STATIC_SYMBOL("gsi_set_log_list",AB_package);
    string_constant_177 = STATIC_STRING("gsi_set_log_list");
    Qg2int_gsi_sym_array_of = STATIC_SYMBOL("gsi_sym_array_of",AB_package);
    string_constant_178 = STATIC_STRING("gsi_sym_array_of");
    Qg2int_gsi_sym_list_of = STATIC_SYMBOL("gsi_sym_list_of",AB_package);
    string_constant_179 = STATIC_STRING("gsi_sym_list_of");
    Qg2int_gsi_set_sym_array = STATIC_SYMBOL("gsi_set_sym_array",AB_package);
    string_constant_180 = STATIC_STRING("gsi_set_sym_array");
    Qg2int_gsi_set_sym_list = STATIC_SYMBOL("gsi_set_sym_list",AB_package);
    string_constant_181 = STATIC_STRING("gsi_set_sym_list");
    Qg2int_gsi_str_array_of = STATIC_SYMBOL("gsi_str_array_of",AB_package);
    string_constant_182 = STATIC_STRING("gsi_str_array_of");
    Qg2int_gsi_str_list_of = STATIC_SYMBOL("gsi_str_list_of",AB_package);
    string_constant_183 = STATIC_STRING("gsi_str_list_of");
    Qg2int_gsi_set_str_array = STATIC_SYMBOL("gsi_set_str_array",AB_package);
    string_constant_184 = STATIC_STRING("gsi_set_str_array");
    Qg2int_gsi_set_str_list = STATIC_SYMBOL("gsi_set_str_list",AB_package);
    string_constant_185 = STATIC_STRING("gsi_set_str_list");
    Qg2int_gsi_elements_of = STATIC_SYMBOL("gsi_elements_of",AB_package);
    string_constant_186 = STATIC_STRING("gsi_elements_of");
    Qg2int_gsi_set_elements = STATIC_SYMBOL("gsi_set_elements",AB_package);
    string_constant_187 = STATIC_STRING("gsi_set_elements");
    Qg2int_gsi_attr_count_of = STATIC_SYMBOL("gsi_attr_count_of",AB_package);
    string_constant_188 = STATIC_STRING("gsi_attr_count_of");
    Qg2int_gsi_set_attr_count = STATIC_SYMBOL("gsi_set_attr_count",AB_package);
    string_constant_189 = STATIC_STRING("gsi_set_attr_count");
    Qg2int_gsi_attrs_of = STATIC_SYMBOL("gsi_attrs_of",AB_package);
    string_constant_190 = STATIC_STRING("gsi_attrs_of");
    Qg2int_gsi_set_attrs = STATIC_SYMBOL("gsi_set_attrs",AB_package);
    string_constant_191 = STATIC_STRING("gsi_set_attrs");
    Qg2int_class_qualified_name = STATIC_SYMBOL("CLASS-QUALIFIED-NAME",
	    AB_package);
    Qg2int_gsi_attr_by_name = STATIC_SYMBOL("gsi_attr_by_name",AB_package);
    string_constant_192 = STATIC_STRING("gsi_attr_by_name");
    Qg2int_gsi_set_attr_by_name = STATIC_SYMBOL("gsi_set_attr_by_name",
	    AB_package);
    string_constant_193 = STATIC_STRING("gsi_set_attr_by_name");
    Qg2int_gsi_item_of_attr_by_name = 
	    STATIC_SYMBOL("gsi_item_of_attr_by_name",AB_package);
    string_constant_194 = STATIC_STRING("gsi_item_of_attr_by_name");
    Qg2int_gsi_set_item_of_attr_by_name = 
	    STATIC_SYMBOL("gsi_set_item_of_attr_by_name",AB_package);
    string_constant_195 = STATIC_STRING("gsi_set_item_of_attr_by_name");
    Qg2int_gsi_status_of = STATIC_SYMBOL("gsi_status_of",AB_package);
    string_constant_196 = STATIC_STRING("gsi_status_of");
    Qg2int_gsi_set_status = STATIC_SYMBOL("gsi_set_status",AB_package);
    string_constant_197 = STATIC_STRING("gsi_set_status");
    Qg2int_gsi_interval_of = STATIC_SYMBOL("gsi_interval_of",AB_package);
    string_constant_198 = STATIC_STRING("gsi_interval_of");
    Qgsi_set_interval = STATIC_SYMBOL("GSI-SET-INTERVAL",AB_package);
    Qg2int_gsi_set_interval = STATIC_SYMBOL("gsi_set_interval",AB_package);
    string_constant_199 = STATIC_STRING("gsi_set_interval");
    Qg2int_gsi_attr_name_of = STATIC_SYMBOL("gsi_attr_name_of",AB_package);
    string_constant_200 = STATIC_STRING("gsi_attr_name_of");
    Qg2int_gsi_set_attr_name = STATIC_SYMBOL("gsi_set_attr_name",AB_package);
    string_constant_201 = STATIC_STRING("gsi_set_attr_name");
    Qg2int_gsi_unqualified_attr_name_of = 
	    STATIC_SYMBOL("gsi_unqualified_attr_name_of",AB_package);
    string_constant_202 = STATIC_STRING("gsi_unqualified_attr_name_of");
    Qg2int_gsi_set_unqualified_attr_name = 
	    STATIC_SYMBOL("gsi_set_unqualified_attr_name",AB_package);
    string_constant_203 = STATIC_STRING("gsi_set_unqualified_attr_name");
    Qg2int_gsi_attr_name_is_qualified = 
	    STATIC_SYMBOL("gsi_attr_name_is_qualified",AB_package);
    string_constant_204 = STATIC_STRING("gsi_attr_name_is_qualified");
    Qg2int_gsi_class_qualifier_of = STATIC_SYMBOL("gsi_class_qualifier_of",
	    AB_package);
    string_constant_205 = STATIC_STRING("gsi_class_qualifier_of");
    Qg2int_gsi_set_class_qualifier = 
	    STATIC_SYMBOL("gsi_set_class_qualifier",AB_package);
    string_constant_206 = STATIC_STRING("gsi_set_class_qualifier");
    Qg2int_gsi_attr_is_array_index = 
	    STATIC_SYMBOL("gsi_attr_is_array_index",AB_package);
    string_constant_207 = STATIC_STRING("gsi_attr_is_array_index");
    Qg2int_gsi_attr_array_index_of = 
	    STATIC_SYMBOL("gsi_attr_array_index_of",AB_package);
    string_constant_208 = STATIC_STRING("gsi_attr_array_index_of");
    Qg2int_gsi_set_attr_array_index = 
	    STATIC_SYMBOL("gsi_set_attr_array_index",AB_package);
    string_constant_209 = STATIC_STRING("gsi_set_attr_array_index");
    Qg2int_gsi_attr_is_list_index = STATIC_SYMBOL("gsi_attr_is_list_index",
	    AB_package);
    string_constant_210 = STATIC_STRING("gsi_attr_is_list_index");
    Qg2int_gsi_attr_list_index_of = STATIC_SYMBOL("gsi_attr_list_index_of",
	    AB_package);
    string_constant_211 = STATIC_STRING("gsi_attr_list_index_of");
    Qg2int_gsi_set_attr_list_index = 
	    STATIC_SYMBOL("gsi_set_attr_list_index",AB_package);
    string_constant_212 = STATIC_STRING("gsi_set_attr_list_index");
    Qg2int_gsi_attr_is_transient = STATIC_SYMBOL("gsi_attr_is_transient",
	    AB_package);
    string_constant_213 = STATIC_STRING("gsi_attr_is_transient");
    Qg2int_gsi_set_attr_is_transient = 
	    STATIC_SYMBOL("gsi_set_attr_is_transient",AB_package);
    string_constant_214 = STATIC_STRING("gsi_set_attr_is_transient");
    Qg2int_gsi_attr_is_identifying = 
	    STATIC_SYMBOL("gsi_attr_is_identifying",AB_package);
    string_constant_215 = STATIC_STRING("gsi_attr_is_identifying");
    Qg2int_gsi_set_attr_is_identifying = 
	    STATIC_SYMBOL("gsi_set_attr_is_identifying",AB_package);
    string_constant_216 = STATIC_STRING("gsi_set_attr_is_identifying");
    Qg2int_gsi_is_item = STATIC_SYMBOL("gsi_is_item",AB_package);
    string_constant_217 = STATIC_STRING("gsi_is_item");
    Qg2int_gsi_class_type_of = STATIC_SYMBOL("gsi_class_type_of",AB_package);
    string_constant_218 = STATIC_STRING("gsi_class_type_of");
    Qg2int_gsi_set_class_type = STATIC_SYMBOL("gsi_set_class_type",AB_package);
    string_constant_219 = STATIC_STRING("gsi_set_class_type");
    Qg2int_gsi_history_count_of = STATIC_SYMBOL("gsi_history_count_of",
	    AB_package);
    string_constant_220 = STATIC_STRING("gsi_history_count_of");
    Qg2int_gsi_extract_history = STATIC_SYMBOL("gsi_extract_history",
	    AB_package);
    string_constant_221 = STATIC_STRING("gsi_extract_history");
    Qg2int_gsi_extract_history_spec = 
	    STATIC_SYMBOL("gsi_extract_history_spec",AB_package);
    string_constant_222 = STATIC_STRING("gsi_extract_history_spec");
    Qg2int_gsi_set_history = STATIC_SYMBOL("gsi_set_history",AB_package);
    string_constant_223 = STATIC_STRING("gsi_set_history");
    Qg2int_shared_gsi_set_timestamp = 
	    STATIC_SYMBOL("SHARED-GSI-SET-TIMESTAMP",AB_package);
    Qg2int_gsi_set_timestamp = STATIC_SYMBOL("gsi_set_timestamp",AB_package);
    float_constant = STATIC_FLOAT(2.145934799E+9);
    string_constant_224 = STATIC_STRING("gsi_set_timestamp");
    Qg2int_gsi_timestamp_of = STATIC_SYMBOL("gsi_timestamp_of",AB_package);
    Qg2int_timestamp_of = STATIC_SYMBOL("TIMESTAMP_OF",AB_package);
    string_constant_225 = STATIC_STRING("gsi_timestamp_of");
    Qg2int_gsi_encode_timestamp = STATIC_SYMBOL("gsi_encode_timestamp",
	    AB_package);
    string_constant_226 = STATIC_STRING("gsi_encode_timestamp");
    string_constant_227 = STATIC_STRING("gsi_decode_timestamp");
    string_constant_228 = STATIC_STRING("gsi_major_version");
    string_constant_229 = STATIC_STRING("gsi_minor_version");
    string_constant_230 = STATIC_STRING("gsi_revision_number");
    string_constant_231 = STATIC_STRING("gsi_release_quality");
    Qg2int_max_build_id_digit = STATIC_SYMBOL("MAX-BUILD-ID-DIGIT",AB_package);
    SET_SYMBOL_VALUE(Qg2int_max_build_id_digit,FIX((SI_Long)9L));
    Qg2int_max_build_id_letter = STATIC_SYMBOL("MAX-BUILD-ID-LETTER",
	    AB_package);
    SET_SYMBOL_VALUE(Qg2int_max_build_id_letter,FIX((SI_Long)26L));
    Qg2int_max_number_of_bits_for_day_code = 
	    STATIC_SYMBOL("MAX-NUMBER-OF-BITS-FOR-DAY-CODE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_max_number_of_bits_for_day_code,FIX((SI_Long)5L));
    Qg2int_max_number_of_bits_for_month_code = 
	    STATIC_SYMBOL("MAX-NUMBER-OF-BITS-FOR-MONTH-CODE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_max_number_of_bits_for_month_code,
	    FIX((SI_Long)5L));
    Qg2int_max_number_of_bits_for_year_code = 
	    STATIC_SYMBOL("MAX-NUMBER-OF-BITS-FOR-YEAR-CODE",AB_package);
    SET_SYMBOL_VALUE(Qg2int_max_number_of_bits_for_year_code,FIX((SI_Long)5L));
    Qg2int_day_bit_offset = STATIC_SYMBOL("DAY-BIT-OFFSET",AB_package);
    SET_SYMBOL_VALUE(Qg2int_day_bit_offset,FIX((SI_Long)0L));
    Qg2int_month_bit_offset = STATIC_SYMBOL("MONTH-BIT-OFFSET",AB_package);
    SET_SYMBOL_VALUE(Qg2int_month_bit_offset,
	    G2int_max_number_of_bits_for_day_code);
    Qg2int_year_bit_offset = STATIC_SYMBOL("YEAR-BIT-OFFSET",AB_package);
    SET_SYMBOL_VALUE_LOCATION(Qg2int_year_bit_offset,G2int_year_bit_offset);
    SET_SYMBOL_VALUE(Qg2int_year_bit_offset,
	    FIXNUM_ADD(G2int_month_bit_offset,
	    G2int_max_number_of_bits_for_month_code));
    G2int_build_identification_integer = 
	    g2int_encode_build_identification_integer(G2int_build_identification_string);
    string_constant_232 = STATIC_STRING("gsi_build_id_integer");
    Qg2int_handle_extend_current_text_string_error = 
	    STATIC_SYMBOL("HANDLE-EXTEND-CURRENT-TEXT-STRING-ERROR",
	    AB_package);
    SET_SYMBOL_FUNCTION(Qg2int_handle_extend_current_text_string_error,
	    STATIC_FUNCTION(g2int_handle_extend_current_text_string_error,
	    NIL,FALSE,0,0));
}
